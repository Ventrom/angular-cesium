{"version":3,"file":"angular-cesium.umd.js","sources":["../../../projects/angular-cesium/src/lib/angular-cesium/services/viewer-factory/viewer-factory.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/viewer-configuration/viewer-configuration.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/cesium/cesium.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/cesium-enhancements/StaticGeometryColorBatch.ts","../../../projects/angular-cesium/src/lib/angular-cesium/cesium-enhancements/ConfigurationService.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/scene-mode.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/camera/camera.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/consts/cesium-event.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/consts/pickOptions.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/context-menu/context-menu.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/coordinate-converter/coordinate-converter.service.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/basic-drawer/basic-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/primitives-drawer/primitives-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/geo-utils/geo-utils.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/arc-drawer/arc-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/entities-drawer/enums/graphics-type.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/entities-drawer/optimized-entity-collection.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/entities-drawer/entities-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/billboard-drawer/billboard-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/czml-drawer/czml-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/ellipse-drawer/ellipse-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/label-drawer/label-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/point-drawer/point-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/polygon-drawer/polygon-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/polyline-drawer/polyline-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/ac-keyboard-action.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/keyboard-control/predefined-actions.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/keyboard-control/keyboard-control.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/event-observers/cesium-pure-event-observer.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/event-observers/cesium-long-press-observer.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/cesium-event-builder.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/plonter/plonter.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/utils/utils.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/event-observers/cesium-drag-drop-helper.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/map-events-manager.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-layers/map-layers.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/maps-manager/maps-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/screenshot/screenshot.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-map/ac-map.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/layer-service/layer-service.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/action-type.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/computation-cache/computation-cache.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/utils/checker.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/ellipse-drawer/dynamic-ellipse-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/dynamic-polyline-drawer/dynamic-polyline-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/static-primitive-drawer/static-primitive-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/static-circle-drawer/static-circle-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/static-polyline-drawer/static-polyline-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/static-polygon-drawer/polygon-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/static-dynamic/ellipse-drawer/ellipse-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/model-drawer/model-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/box-dawer/box-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/corridor-dawer/corridor-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/cylinder-dawer/cylinder-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/ellipoid-drawer/ellipsoid-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/polyline-volume-dawer/polyline-volume-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/wall-dawer/wall-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/rectangle-dawer/rectangle-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/label-primitive-drawer/label-primitive-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/billboard-primitive-drawer/billboard-primitive-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/point-primitive-drawer/point-primitive-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/drawers/html-drawer/html-drawer.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-layer/ac-layer.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/entity-on-map/entity-on-map.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-billboard/ac-billboard.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/json-mapper/json-mapper.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/smart-assigner/smart-assigner.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/cesium-properties/cesium-properties.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/basic-desc/basic-desc.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-billborad-desc/ac-billborad-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-ellipse-desc/ac-ellipse-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polyline-desc/ac-polyline-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/pipes/pixel-offset/pixel-offset.pipe.ts","../../../projects/angular-cesium/src/lib/angular-cesium/pipes/radians-to-degrees/radians-to-degrees.pipe.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-label-desc/ac-label-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/utils/utils.module.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-circle-desc/ac-circle-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-arc-desc/ac-arc-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/ac-entity.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/ac-notification.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/map-layer-provider-options.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/models/map-terrain-provider-options.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-map-layer-provider/ac-map-layer-provider.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-map-terrain-provider/ac-map-terrain-provider.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-point-desc/ac-point-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-label/ac-label.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polyline/ac-polyline.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-ellipse/ac-ellipse.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-point/ac-point.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-html/ac-html.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-circle/ac-circle.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-arc/ac-arc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polygon-desc/ac-polygon-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-default-plonter/ac-default-plonter.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polygon/ac-polygon.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/basic-primitive-desc/basic-static-primitive-desc.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-static-ellipse-desc/ac-static-ellipse-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-dynamic-ellipse-desc/ac-dynamic-ellipse-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-dynamic-polyline-desc/ac-dynamic-polyline-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-static-polygon-desc/ac-static-polygon-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-static-circle-desc/ac-static-circle-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-dynamic-circle-desc/ac-dynamic-circle-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/static-dynamic/ac-static-polyline-desc/ac-static-polyline-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-model-desc/ac-model-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-3d-tileset/ac-tileset-3d.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-box-desc/ac-box-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-cylinder-desc/ac-cylinder-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-corridor-desc/ac-corridor-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-ellipsoid-desc/ac-ellipsoid-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polyline-volume-desc/ac-polyline-volume-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-wall-desc/ac-wall-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-rectangle-desc/ac-rectangle-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-billboard-primitive-desc/ac-billboard-primitive-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-label-primitive-desc/ac-label-primitive-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-polyline-primitive-desc/ac-polyline-primitive-desc.component.ts","../../../projects/angular-cesium/src/lib/cesium-extender/primitives/html.ts","../../../projects/angular-cesium/src/lib/cesium-extender/collections/html.ts","../../../projects/angular-cesium/src/lib/cesium-extender/extender.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/ac-html-manager/ac-html-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/directives/ac-html/ac-html.directive.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-html-desc/ac-html-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/directives/ac-html-container/ac-html-container.directive.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-context-menu-wrapper/ac-context-menu-wrapper.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-array-desc/ac-array-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-point-primitive-desc/ac-point-primitive-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-primitive-polyline/ac-primitive-polyline.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/pipes/pipe-config-map.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-czml-desc/ac-czml-desc.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/components/ac-rectangle/ac-rectangle.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium/angular-cesium.module.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/disposable-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/map-events-mananger/consts/cesium-event-modifier.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium/services/selection-manager/selection-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium/index.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/edit-mode.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/edit-actions.enum.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/edit-point.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/utils.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/points-editor/points-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/label-props.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-point.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/points-editor/points-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/points-editor/points-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/edit-polyline.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-polygon.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/polygons-editor/polygons-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/polygons-editor/polygons-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/polygons-editor/polygons-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/edit-arc.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-circle.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/circles-editor/circles-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/circles-editor/circles-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/circles-editor/circles-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-ellipse.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/ellipses-editor/ellipses-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/ellipses-editor/ellipses-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/ellipses-editor/ellipses-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-polyline.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-rectangle.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/point-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/polyline-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/polygon-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/rectangle-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/circle-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/ellipse-editor-observable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/hippodrome-editor-oboservable.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/models/editable-hippodrome.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/polyline-editor/polylines-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/polyline-editor/polylines-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/polylines-editor/polylines-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/hippodrome-editor/hippodrome-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/hippodrome-editor/hippodrome-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/hippodrome-editor/hippodrome-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/draggable-to-map.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/directives/draggable-to-map.directive.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/toolbar/ac-toolbar/ac-toolbar.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/toolbar/ac-toolbar/drag-icon.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/toolbar/ac-toolbar-button/ac-toolbar-button.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/range-and-bearing/range-and-bearing.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/zoom-to-rectangle.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/rectangles-editor/rectangles-manager.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/services/entity-editors/rectangles-editor/rectangles-editor.service.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/components/rectangles-editor/rectangles-editor.component.ts","../../../projects/angular-cesium/src/lib/angular-cesium-widgets/angular-cesium-widgets.module.ts","../../../projects/angular-cesium/src/public_api.ts","../../../projects/angular-cesium/src/angular-cesium.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class ViewerFactory {\n  cesium: any;\n\n\n  constructor() {\n    this.cesium = Cesium;\n  }\n\n  /**\n   * Creates a viewer with default or custom options\n   * @param mapContainer - container to initialize the viewer on\n   * @param options - Options to create the viewer with - Optional\n   *\n   * @returns new viewer\n   */\n  createViewer(mapContainer: HTMLElement, options?: any) {\n    let viewer = null;\n    if (options) {\n      viewer = new this.cesium.Viewer(mapContainer, {\n        contextOptions: {\n          webgl: {preserveDrawingBuffer: true}\n        },\n        ...options\n      });\n    } else {\n      viewer = new this.cesium.Viewer(mapContainer,\n        {\n          contextOptions: {\n            webgl: {preserveDrawingBuffer: true}\n          },\n        });\n    }\n\n    return viewer;\n  }\n}\n","import { Injectable } from '@angular/core';\n\n/**\n * Service for setting cesium viewer map options.\n * defaulty angular-cesium doesnt provide this service and viewer is created with default options.\n * In order set specific options you must set this service as provider in your component and\n * set the wanted options.\n * ```typescript\n * constructor(viewerConf :ViewerConfiguration ) {\n *   viewerConf.viewerOptions = { timeline: false };\n * }\n * ```\n * notice this configuration will be for all <ac-maps> in your component.\n */\n@Injectable()\nexport class ViewerConfiguration {\n  /**\n   * cesium viewer options According to [Viewer]{@link https://cesiumjs.org/Cesium/Build/Documentation/Viewer.html?classFilter=vie}\n   */\n  private _viewerOptions: object | object[];\n  private _viewerModifier: Function | Function[];\n  private nextViewerOptionsIndex = 0;\n  private nextViewerModifierIndex = 0;\n\n  get viewerOptions(): object | object[] {\n    return this._viewerOptions;\n  }\n\n  Ã;\n\n  getNextViewerOptions(): object | object[] {\n    if (this._viewerOptions instanceof Array) {\n      return this._viewerOptions[this.nextViewerOptionsIndex++];\n    } else {\n      return this._viewerOptions;\n    }\n  }\n\n  /**\n   * Can be used to set initial map viewer options.\n   * If there is more than one map you can give the function an array of options.\n   * The map initialized first will be set with the first option object in the options array and so on.\n   */\n  set viewerOptions(value: object | object[]) {\n    this._viewerOptions = value;\n  }\n\n  get viewerModifier(): Function | Function[] {\n    return this._viewerModifier;\n  }\n\n  getNextViewerModifier(): Function | Function[] {\n    if (this._viewerModifier instanceof Array) {\n      return this._viewerModifier[this.nextViewerModifierIndex++];\n    } else {\n      return this._viewerModifier;\n    }\n  }\n\n  /**\n   * Can be used to set map viewer options after the map has been initialized.\n   * If there is more than one map you can give the function an array of functions.\n   * The map initialized first will be set with the first option object in the options array and so on.\n   */\n  set viewerModifier(value: Function | Function[]) {\n    this._viewerModifier = value;\n  }\n}\n","import { Injectable, NgZone, Optional } from '@angular/core';\nimport { ViewerFactory } from '../viewer-factory/viewer-factory.service';\nimport { ViewerConfiguration } from '../viewer-configuration/viewer-configuration.service';\nimport { AcMapComponent } from '../../components/ac-map/ac-map.component';\n\n/**\n *  Service that initialize cesium viewer and expose cesium viewer and scene.\n */\n@Injectable()\nexport class CesiumService {\n  private cesiumViewer: any;\n  private map: AcMapComponent;\n\n  constructor(private ngZone: NgZone, private viewerFactory: ViewerFactory, @Optional() private viewerConfiguration: ViewerConfiguration) {\n  }\n\n  init(mapContainer: HTMLElement, map: AcMapComponent) {\n    this.map = map;\n    this.ngZone.runOutsideAngular(() => {\n      const options = this.viewerConfiguration ? this.viewerConfiguration.getNextViewerOptions() : undefined;\n      this.cesiumViewer = this.viewerFactory.createViewer(mapContainer, options);\n\n      const viewerModifier = this.viewerConfiguration && this.viewerConfiguration.getNextViewerModifier();\n      if (typeof viewerModifier === 'function') {\n        viewerModifier(this.cesiumViewer);\n      }\n    });\n  }\n\n  /**\n   * For more information see https://cesiumjs.org/Cesium/Build/Documentation/Viewer.html?classFilter=viewe\n   * @returns cesiumViewer\n   */\n  getViewer() {\n    return this.cesiumViewer;\n  }\n\n  /**\n   * For more information see https://cesiumjs.org/Cesium/Build/Documentation/Scene.html?classFilter=scene\n   * @returns cesium scene\n   */\n  getScene() {\n    return this.cesiumViewer.scene;\n  }\n\n  /**\n   * For more information see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API\n   * @returns cesium canvas\n   */\n  getCanvas(): HTMLCanvasElement {\n    return this.cesiumViewer.canvas as HTMLCanvasElement;\n  }\n\n  getMap(): AcMapComponent {\n    return this.map;\n  }\n}\n","/**\n * Fix for the constant entity shadowing.\n * PR in Cesium repo: https://github.com/AnalyticalGraphicsInc/cesium/pull/5736\n */\n\n// tslint:disable\nconst AssociativeArray = Cesium.AssociativeArray;\nconst Color = Cesium.Color;\nconst ColorGeometryInstanceAttribute = Cesium.ColorGeometryInstanceAttribute;\nconst defined = Cesium.defined;\nconst DistanceDisplayCondition = Cesium.DistanceDisplayCondition;\nconst DistanceDisplayConditionGeometryInstanceAttribute = Cesium.DistanceDisplayConditionGeometryInstanceAttribute;\nconst ShowGeometryInstanceAttribute = Cesium.ShowGeometryInstanceAttribute;\nconst Primitive = Cesium.Primitive;\nconst ShadowMode = Cesium.ShadowMode;\nconst BoundingSphereState = Cesium.BoundingSphereState;\nconst ColorMaterialProperty = Cesium.ColorMaterialProperty;\nconst MaterialProperty = Cesium.MaterialProperty;\nconst Property = Cesium.Property;\n\nvar colorScratch = new Color();\nvar distanceDisplayConditionScratch = new DistanceDisplayCondition();\nvar defaultDistanceDisplayCondition = new DistanceDisplayCondition();\n\nfunction Batch(primitives, translucent, appearanceType, depthFailAppearanceType, depthFailMaterialProperty, closed, shadows) {\n  this.translucent = translucent;\n  this.appearanceType = appearanceType;\n  this.depthFailAppearanceType = depthFailAppearanceType;\n  this.depthFailMaterialProperty = depthFailMaterialProperty;\n  this.depthFailMaterial = undefined;\n  this.closed = closed;\n  this.shadows = shadows;\n  this.primitives = primitives;\n  this.createPrimitive = false;\n  this.waitingOnCreate = false;\n  this.primitive = undefined;\n  this.oldPrimitive = undefined;\n  this.geometry = new AssociativeArray();\n  this.updaters = new AssociativeArray();\n  this.updatersWithAttributes = new AssociativeArray();\n  this.attributes = new AssociativeArray();\n  this.subscriptions = new AssociativeArray();\n  this.showsUpdated = new AssociativeArray();\n  this.itemsToRemove = [];\n  this.invalidated = false;\n  \n  var removeMaterialSubscription;\n  if (defined(depthFailMaterialProperty)) {\n    removeMaterialSubscription = depthFailMaterialProperty.definitionChanged.addEventListener(Batch.prototype.onMaterialChanged, this);\n  }\n  this.removeMaterialSubscription = removeMaterialSubscription;\n}\n\nBatch.prototype.onMaterialChanged = function () {\n  this.invalidated = true;\n};\n\nBatch.prototype.isMaterial = function (updater) {\n  var material = this.depthFailMaterialProperty;\n  var updaterMaterial = updater.depthFailMaterialProperty;\n  if (updaterMaterial === material) {\n    return true;\n  }\n  if (defined(material)) {\n    return material.equals(updaterMaterial);\n  }\n  return false;\n};\n\nBatch.prototype.add = function (updater, instance) {\n  var id = updater.id;\n  this.createPrimitive = true;\n  this.geometry.set(id, instance);\n  this.updaters.set(id, updater);\n  if (!updater.hasConstantFill || !updater.fillMaterialProperty.isConstant || !Property.isConstant(updater.distanceDisplayConditionProperty)) {\n    this.updatersWithAttributes.set(id, updater);\n  } else {\n    var that = this;\n    this.subscriptions.set(id, updater.entity.definitionChanged.addEventListener(function (entity, propertyName, newValue, oldValue) {\n      if (propertyName === 'isShowing') {\n        that.showsUpdated.set(updater.id, updater);\n      }\n    }));\n  }\n};\n\nBatch.prototype.remove = function (updater) {\n  var id = updater.id;\n  this.createPrimitive = this.geometry.remove(id) || this.createPrimitive;\n  if (this.updaters.remove(id)) {\n    this.updatersWithAttributes.remove(id);\n    var unsubscribe = this.subscriptions.get(id);\n    if (defined(unsubscribe)) {\n      unsubscribe();\n      this.subscriptions.remove(id);\n    }\n  }\n};\n\nBatch.prototype.update = function (time) {\n  var isUpdated = true;\n  var removedCount = 0;\n  var primitive = this.primitive;\n  var primitives = this.primitives;\n  var attributes;\n  var i;\n  \n  if (this.createPrimitive) {\n    var geometries = this.geometry.values;\n    if (geometries.length > 0) {\n      if (defined(primitive)) {\n        if (!defined(this.oldPrimitive)) {\n          this.oldPrimitive = primitive;\n        } else {\n          primitives.remove(primitive);\n        }\n      }\n      \n      for (i = 0; i < geometries.length; i++) {\n        var geometryItem = geometries[i];\n        var originalAttributes = geometryItem.attributes;\n        attributes = this.attributes.get(geometryItem.id.id);\n        \n        if (defined(attributes)) {\n          if (defined(originalAttributes.show)) {\n            originalAttributes.show.value = attributes.show;\n          }\n          if (defined(originalAttributes.color)) {\n            originalAttributes.color.value = attributes.color;\n          }\n          if (defined(originalAttributes.depthFailColor)) {\n            originalAttributes.depthFailColor.value = attributes.depthFailColor;\n          }\n        }\n      }\n      \n      var depthFailAppearance;\n      if (defined(this.depthFailAppearanceType)) {\n        if (defined(this.depthFailMaterialProperty)) {\n          this.depthFailMaterial = MaterialProperty.getValue(time, this.depthFailMaterialProperty, this.depthFailMaterial);\n        }\n        depthFailAppearance = new this.depthFailAppearanceType({\n          material: this.depthFailMaterial,\n          translucent: this.translucent,\n          closed: this.closed\n        });\n      }\n      \n      primitive = new Primitive({\n        show: false,\n        asynchronous: true,\n        geometryInstances: geometries,\n        appearance: new this.appearanceType({\n          flat: this.shadows === ShadowMode.DISABLED || this.shadows === ShadowMode.CAST_ONLY,\n          translucent: this.translucent,\n          closed: this.closed\n        }),\n        depthFailAppearance: depthFailAppearance,\n        shadows: this.shadows\n      });\n      primitives.add(primitive);\n      isUpdated = false;\n    } else {\n      if (defined(primitive)) {\n        primitives.remove(primitive);\n        primitive = undefined;\n      }\n      var oldPrimitive = this.oldPrimitive;\n      if (defined(oldPrimitive)) {\n        primitives.remove(oldPrimitive);\n        this.oldPrimitive = undefined;\n      }\n    }\n    \n    this.attributes.removeAll();\n    this.primitive = primitive;\n    this.createPrimitive = false;\n    this.waitingOnCreate = true;\n  } else if (defined(primitive) && primitive.ready) {\n    primitive.show = true;\n    if (defined(this.oldPrimitive)) {\n      primitives.remove(this.oldPrimitive);\n      this.oldPrimitive = undefined;\n    }\n    \n    if (defined(this.depthFailAppearanceType) && !(this.depthFailMaterialProperty instanceof ColorMaterialProperty)) {\n      this.depthFailMaterial = MaterialProperty.getValue(time, this.depthFailMaterialProperty, this.depthFailMaterial);\n      this.primitive.depthFailAppearance.material = this.depthFailMaterial;\n    }\n    \n    var updatersWithAttributes = this.updatersWithAttributes.values;\n    var length = updatersWithAttributes.length;\n    var waitingOnCreate = this.waitingOnCreate;\n    for (i = 0; i < length; i++) {\n      var updater = updatersWithAttributes[i];\n      var instance = this.geometry.get(updater.id);\n      \n      attributes = this.attributes.get(instance.id.id);\n      if (!defined(attributes)) {\n        attributes = primitive.getGeometryInstanceAttributes(instance.id);\n        this.attributes.set(instance.id.id, attributes);\n      }\n      \n      if (!updater.fillMaterialProperty.isConstant || waitingOnCreate) {\n        var colorProperty = updater.fillMaterialProperty.color;\n        var resultColor = Property.getValueOrDefault(colorProperty, time, Color.WHITE, colorScratch);\n        if (!Color.equals(attributes._lastColor, resultColor)) {\n          attributes._lastColor = Color.clone(resultColor, attributes._lastColor);\n          attributes.color = ColorGeometryInstanceAttribute.toValue(resultColor, attributes.color);\n          if ((this.translucent && attributes.color[3] === 255) || (!this.translucent && attributes.color[3] !== 255)) {\n            this.itemsToRemove[removedCount++] = updater;\n          }\n        }\n      }\n      \n      if (defined(this.depthFailAppearanceType) && updater.depthFailMaterialProperty instanceof ColorMaterialProperty && (!updater.depthFailMaterialProperty.isConstant || waitingOnCreate)) {\n        var depthFailColorProperty = updater.depthFailMaterialProperty.color;\n        var depthColor = Property.getValueOrDefault(depthFailColorProperty, time, Color.WHITE, colorScratch);\n        if (!Color.equals(attributes._lastDepthFailColor, depthColor)) {\n          attributes._lastDepthFailColor = Color.clone(depthColor, attributes._lastDepthFailColor);\n          attributes.depthFailColor = ColorGeometryInstanceAttribute.toValue(depthColor, attributes.depthFailColor);\n        }\n      }\n      \n      var show = updater.entity.isShowing && (updater.hasConstantFill || updater.isFilled(time));\n      var currentShow = attributes.show[0] === 1;\n      if (show !== currentShow) {\n        attributes.show = ShowGeometryInstanceAttribute.toValue(show, attributes.show);\n      }\n      \n      var distanceDisplayConditionProperty = updater.distanceDisplayConditionProperty;\n      if (!Property.isConstant(distanceDisplayConditionProperty)) {\n        var distanceDisplayCondition = Property.getValueOrDefault(distanceDisplayConditionProperty, time, defaultDistanceDisplayCondition, distanceDisplayConditionScratch);\n        if (!DistanceDisplayCondition.equals(distanceDisplayCondition, attributes._lastDistanceDisplayCondition)) {\n          attributes._lastDistanceDisplayCondition = DistanceDisplayCondition.clone(distanceDisplayCondition, attributes._lastDistanceDisplayCondition);\n          attributes.distanceDisplayCondition = DistanceDisplayConditionGeometryInstanceAttribute.toValue(distanceDisplayCondition, attributes.distanceDisplayCondition);\n        }\n      }\n    }\n    \n    this.updateShows(primitive);\n    this.waitingOnCreate = false;\n  } else if (defined(primitive) && !primitive.ready) {\n    isUpdated = false;\n  }\n  this.itemsToRemove.length = removedCount;\n  return isUpdated;\n};\n\nBatch.prototype.updateShows = function (primitive) {\n  var showsUpdated = this.showsUpdated.values;\n  var length = showsUpdated.length;\n  for (var i = 0; i < length; i++) {\n    var updater = showsUpdated[i];\n    var instance = this.geometry.get(updater.id);\n    \n    var attributes = this.attributes.get(instance.id.id);\n    if (!defined(attributes)) {\n      attributes = primitive.getGeometryInstanceAttributes(instance.id);\n      this.attributes.set(instance.id.id, attributes);\n    }\n    \n    var show = updater.entity.isShowing;\n    var currentShow = attributes.show[0] === 1;\n    if (show !== currentShow) {\n      attributes.show = ShowGeometryInstanceAttribute.toValue(show, attributes.show);\n    }\n  }\n  this.showsUpdated.removeAll();\n};\n\nBatch.prototype.contains = function (updater) {\n  return this.updaters.contains(updater.id);\n};\n\nBatch.prototype.getBoundingSphere = function (updater, result) {\n  var primitive = this.primitive;\n  if (!primitive.ready) {\n    return BoundingSphereState.PENDING;\n  }\n  var attributes = primitive.getGeometryInstanceAttributes(updater.entity);\n  if (!defined(attributes) || !defined(attributes.boundingSphere) ||//\n    (defined(attributes.show) && attributes.show[0] === 0)) {\n    return BoundingSphereState.FAILED;\n  }\n  attributes.boundingSphere.clone(result);\n  return BoundingSphereState.DONE;\n};\n\nBatch.prototype.removeAllPrimitives = function () {\n  var primitives = this.primitives;\n  \n  var primitive = this.primitive;\n  if (defined(primitive)) {\n    primitives.remove(primitive);\n    this.primitive = undefined;\n    this.geometry.removeAll();\n    this.updaters.removeAll();\n  }\n  \n  var oldPrimitive = this.oldPrimitive;\n  if (defined(oldPrimitive)) {\n    primitives.remove(oldPrimitive);\n    this.oldPrimitive = undefined;\n  }\n};\n\nBatch.prototype.destroy = function () {\n  var primitive = this.primitive;\n  var primitives = this.primitives;\n  if (defined(primitive)) {\n    primitives.remove(primitive);\n  }\n  var oldPrimitive = this.oldPrimitive;\n  if (defined(oldPrimitive)) {\n    primitives.remove(oldPrimitive);\n  }\n  if (defined(this.removeMaterialSubscription)) {\n    this.removeMaterialSubscription();\n  }\n};\n\n\nlet wasFixed = false;\n\nexport function fixCesiumEntitiesShadows() {\n  if (wasFixed) {\n    return;\n  }\n  Cesium.StaticGeometryColorBatch.prototype.add = function (time: any, updater: any) {\n    var items;\n    var translucent;\n    var instance = updater.createFillGeometryInstance(time);\n    if (instance.attributes.color.value[3] === 255) {\n      items = this._solidItems;\n      translucent = false;\n    } else {\n      items = this._translucentItems;\n      translucent = true;\n    }\n    \n    var length = items.length;\n    for (var i = 0; i < length; i++) {\n      var item = items[i];\n      if (item.isMaterial(updater)) {\n        item.add(updater, instance);\n        return;\n      }\n      \n    }\n    \n    var batch: any = new Batch(this._primitives, translucent, this._appearanceType, this._depthFailAppearanceType, updater.depthFailMaterialProperty, this._closed, this._shadows);\n    batch.add(updater, instance);\n    items.push(batch);\n  };\n  wasFixed = true;\n}\n","import { Inject, Injectable, InjectionToken, Optional } from '@angular/core';\nimport { fixCesiumEntitiesShadows } from './StaticGeometryColorBatch';\n\nexport const ANGULAR_CESIUM_CONFIG = new InjectionToken('ANGULAR_CESIUM_CONFIG');\n\n@Injectable()\nexport class ConfigurationService {\n  constructor(@Optional() @Inject(ANGULAR_CESIUM_CONFIG) private config: any) {\n    const fixEntitiesShadows = config ? config.fixEntitiesShadows : true;\n    if (fixEntitiesShadows !== false) {\n      fixCesiumEntitiesShadows();\n    }\n  }\n}\n","/**\n * Cesium scene modes\n */\nexport enum SceneMode {\n  SCENE3D,\n  COLUMBUS_VIEW,\n  SCENE2D,\n  PERFORMANCE_SCENE2D\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../cesium/cesium.service';\nimport { SceneMode } from '../../models/scene-mode.enum';\n\n/**\n *  The service exposes the scene's camera and screenSpaceCameraController\n *  SceneMode.PERFORMANCE_SCENE2D -  is a 3D scene mode that acts like Cesium 2D mode,\n *  but is more efficient performance wise.\n */\n@Injectable()\nexport class CameraService {\n  static PERFORMANCE_2D_ALTITUDE = 25000000;\n\n  private viewer: any;\n  private scene: any;\n  private camera: any;\n  private screenSpaceCameraController: any;\n  private morphListenerCancelFn: any;\n  private lastRotate: boolean;\n  private lastTilt: boolean;\n  private lastLook: boolean;\n  private isSceneModePerformance2D = false;\n\n  constructor() {\n  }\n\n  init(cesiumService: CesiumService) {\n    this.viewer = cesiumService.getViewer();\n    this.scene = cesiumService.getScene();\n    this.screenSpaceCameraController = this.scene.screenSpaceCameraController;\n    this.camera = this.scene.camera;\n    this.lastRotate = this.screenSpaceCameraController.enableRotate;\n    this.lastTilt = this.screenSpaceCameraController.enableTilt;\n    this.lastLook = this.screenSpaceCameraController.enableLook;\n  }\n\n  _listenToSceneModeMorph(callback: Function) {\n    this.morphListenerCancelFn = this.scene.morphStart.addEventListener(\n      callback\n    );\n  }\n\n  _revertCameraProperties() {\n    this.isSceneModePerformance2D = false;\n    this.enableTilt(this.lastTilt);\n    this.enableRotate(this.lastRotate);\n    this.enableLook(this.lastLook);\n  }\n\n  /**\n   * Gets the scene's camera\n   */\n  getCamera() {\n    return this.camera;\n  }\n\n  /**\n   * Gets the scene's screenSpaceCameraController\n   */\n  getScreenSpaceCameraController() {\n    return this.screenSpaceCameraController;\n  }\n\n  /**\n   * Gets the minimum zoom value in meters\n   */\n  getMinimumZoom(): number {\n    return this.screenSpaceCameraController.minimumZoomDistance;\n  }\n\n  /**\n   * Sets the minimum zoom value in meters\n   * @param zoom amount\n   */\n  setMinimumZoom(amount: number): void {\n    this.screenSpaceCameraController.minimumZoomDistance = amount;\n  }\n\n  /**\n   * Gets the maximum zoom value in meters\n   */\n  getMaximumZoom(): number {\n    return this.screenSpaceCameraController.maximumZoomDistance;\n  }\n\n  /**\n   * Sets the maximum zoom value in meters\n   * @param zoom amount\n   */\n  setMaximumZoom(amount: number): void {\n    this.screenSpaceCameraController.maximumZoomDistance = amount;\n  }\n\n  /**\n   * Sets if the camera is able to tilt\n   */\n  enableTilt(tilt: boolean): void {\n    this.screenSpaceCameraController.enableTilt = tilt;\n  }\n\n  /**\n   * Sets if the camera is able to rotate\n   */\n  enableRotate(rotate: boolean): void {\n    this.screenSpaceCameraController.enableRotate = rotate;\n  }\n\n  /**\n   * Sets if the camera is able to free-look\n   */\n  enableLook(lock: boolean): void {\n    this.screenSpaceCameraController.enableLook = lock;\n  }\n\n  /**\n   * Sets if the camera is able to translate\n   */\n  enableTranslate(translate: boolean): void {\n    this.screenSpaceCameraController.enableTranslate = translate;\n  }\n\n  /**\n   * Sets if the camera is able to zoom\n   */\n  enableZoom(zoom: boolean): void {\n    this.screenSpaceCameraController.enableZoom = zoom;\n  }\n\n  /**\n   * Sets if the camera receives inputs\n   */\n  enableInputs(inputs: boolean): void {\n    this.screenSpaceCameraController.enableInputs = inputs;\n  }\n\n  /**\n   * Sets the map's SceneMode\n   * @param sceneMode - The SceneMode to morph the scene into.\n   * @param duration - The duration of scene morph animations, in seconds\n   */\n  setSceneMode(sceneMode: SceneMode, duration?: number) {\n    switch (sceneMode) {\n      case SceneMode.SCENE3D: {\n        if (this.isSceneModePerformance2D) {\n          this._revertCameraProperties();\n        }\n\n        this.scene.morphTo3D(duration);\n\n        break;\n      }\n      case SceneMode.COLUMBUS_VIEW: {\n        if (this.isSceneModePerformance2D) {\n          this._revertCameraProperties();\n        }\n\n        this.scene.morphToColumbusView(duration);\n\n        break;\n      }\n      case SceneMode.SCENE2D: {\n        if (this.isSceneModePerformance2D) {\n          this._revertCameraProperties();\n        }\n        this.scene.morphTo2D(duration);\n\n        break;\n      }\n      case SceneMode.PERFORMANCE_SCENE2D: {\n        this.isSceneModePerformance2D = true;\n        this.lastLook = this.screenSpaceCameraController.enableLook;\n        this.lastTilt = this.screenSpaceCameraController.enableTilt;\n        this.lastRotate = this.screenSpaceCameraController.enableRotate;\n        this.screenSpaceCameraController.enableTilt = false;\n        this.screenSpaceCameraController.enableRotate = false;\n        this.screenSpaceCameraController.enableLook = false;\n        if (this.morphListenerCancelFn) {\n          this.morphListenerCancelFn();\n        }\n        this.scene.morphToColumbusView(duration);\n        const morphCompleteEventListener = this.scene.morphComplete.addEventListener(\n          () => {\n            this.camera.setView({\n              destination: Cesium.Cartesian3.fromDegrees(\n                0.0,\n                0.0,\n                Math.min(\n                  CameraService.PERFORMANCE_2D_ALTITUDE,\n                  this.getMaximumZoom()\n                )\n              ),\n              orientation: {\n                pitch: Cesium.Math.toRadians(-90)\n              }\n            });\n            morphCompleteEventListener();\n            this._listenToSceneModeMorph(\n              this._revertCameraProperties.bind(this)\n            );\n          }\n        );\n\n        break;\n      }\n    }\n  }\n\n  /**\n   * Flies the camera to a destination\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Camera.html?classFilter=cam#flyTo\n   */\n  cameraFlyTo(options: any) {\n    if (options) {\n      return this.camera.flyTo(options);\n    }\n  }\n\n  /**\n   * Flies the camera to a target\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Viewer.html?classFilter=viewer#flyTo\n   * @returns Promise<boolean>\n   */\n  flyTo(target: any, options?: any) {\n    return this.viewer.flyTo(target, options);\n  }\n\n  /**\n   * Zooms amount along the camera's view vector.\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Camera.html#zoomIn\n   */\n  zoomIn(amount: number) {\n    return this.camera.zoomIn(amount || this.camera.defaultZoomAmount);\n  }\n\n  /**\n   * Zooms amount along the opposite direction of the camera's view vector.\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Camera.html#zoomOut\n   */\n  zoomOut(amount: number) {\n    return this.camera.zoomOut(amount || this.camera.defaultZoomAmount);\n  }\n\n  /**\n   * Zoom the camera to a target\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Viewer.html?classFilter=viewer#zoomTo\n   * @returns Promise<boolean>\n   */\n  zoomTo(target: any, offset?: any) {\n    return this.viewer.zoomTo(target, offset);\n  }\n\n  /**\n   * Flies the camera to a destination\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Camera.html?classFilter=camera#setView\n   * @param options viewer options\n   */\n  setView(options: any) {\n    this.camera.setView(options);\n  }\n\n  /**\n   * Set camera's rotation\n   */\n  setRotation(degreesInRadians: number) {\n    this.setView({orientation: {heading: degreesInRadians}});\n  }\n\n  /**\n   * Locks or unlocks camera rotation\n   */\n  lockRotation(lock: boolean) {\n    this.scene.screenSpaceCameraController.enableRotate = !lock;\n  }\n\n  /**\n   * Make the camera track a specific entity\n   * API: https://cesiumjs.org/Cesium/Build/Documentation/Viewer.html?classFilter=viewer#trackedEntity\n   * @param cesiumEntity - cesium entity( billboard, polygon...) to track\n   * @param options - track entity options\n   */\n  trackEntity(\n    cesiumEntity?: any,\n    options?: { flyTo: boolean; flyToDuration?: number; altitude?: number }\n  ) {\n    const flyTo = (options && options.flyTo) || false;\n\n    this.viewer.trackedEntity = undefined;\n    return new Promise<void>(resolve => {\n      if (flyTo) {\n        const flyToDuration = (options && options.flyToDuration) || 1;\n        const altitude = (options && options.altitude) || 10000;\n\n        // Calc entity flyTo position and wanted altitude\n        const entPosCar3 = cesiumEntity.position.getValue(Cesium.JulianDate.now());\n        const entPosCart = Cesium.Cartographic.fromCartesian(entPosCar3);\n        const zoomAmount = altitude - entPosCart.height;\n        entPosCart.height = altitude;\n        const flyToPosition = Cesium.Cartesian3.fromRadians(\n          entPosCart.longitude,\n          entPosCart.latitude,\n          entPosCart.height\n        );\n\n        this.cameraFlyTo({\n          duration: flyToDuration,\n          destination: flyToPosition,\n          complete: () => {\n            this.viewer.trackedEntity = cesiumEntity;\n            setTimeout(() => {\n              if (zoomAmount > 0) {\n                this.camera.zoomOut(zoomAmount);\n              } else {\n                this.camera.zoomIn(zoomAmount);\n              }\n            }, 0);\n            resolve();\n          }\n        });\n      } else {\n        this.viewer.trackedEntity = cesiumEntity;\n        resolve();\n      }\n    });\n  }\n\n  untrackEntity() {\n    this.trackEntity();\n  }\n}\n","/**\n * Event options for registration on map-event-manager.\n */\nexport enum CesiumEvent {\n  MOUSE_MOVE = Cesium.ScreenSpaceEventType.MOUSE_MOVE,\n  LEFT_CLICK = Cesium.ScreenSpaceEventType.LEFT_CLICK,\n  LEFT_DOUBLE_CLICK = Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK,\n  LEFT_DOWN = Cesium.ScreenSpaceEventType.LEFT_DOWN,\n  LEFT_UP = Cesium.ScreenSpaceEventType.LEFT_UP,\n  MIDDLE_CLICK = Cesium.ScreenSpaceEventType.MIDDLE_CLICK,\n  MIDDLE_DOUBLE_CLICK = Cesium.ScreenSpaceEventType.MIDDLE_DOUBLE_CLICK,\n  MIDDLE_DOWN = Cesium.ScreenSpaceEventType.MIDDLE_DOWN,\n  MIDDLE_UP = Cesium.ScreenSpaceEventType.MIDDLE_UP,\n  PINCH_START = Cesium.ScreenSpaceEventType.PINCH_START,\n  PINCH_END = Cesium.ScreenSpaceEventType.PINCH_END,\n  PINCH_MOVE = Cesium.ScreenSpaceEventType.PINCH_MOVE,\n  RIGHT_CLICK = Cesium.ScreenSpaceEventType.RIGHT_CLICK,\n  RIGHT_DOUBLE_CLICK = Cesium.ScreenSpaceEventType.RIGHT_DOUBLE_CLICK,\n  RIGHT_DOWN = Cesium.ScreenSpaceEventType.RIGHT_DOWN,\n  RIGHT_UP = Cesium.ScreenSpaceEventType.RIGHT_UP,\n  WHEEL = Cesium.ScreenSpaceEventType.WHEEL,\n  LONG_LEFT_PRESS = 110,\n  LONG_RIGHT_PRESS,\n  LONG_MIDDLE_PRESS,\n  LEFT_CLICK_DRAG,\n  RIGHT_CLICK_DRAG,\n  MIDDLE_CLICK_DRAG,\n}\n","/**\n *  NO_PICK,    - will not pick entities\n *  PICK_FIRST  - first entity will be picked . use Cesium.scene.pick()\n *  PICK_ONE    - in case a few entities are picked plonter is resolved . use Cesium.scene.drillPick()\n *  PICK_ALL    - all entities are picked. use Cesium.scene.drillPick()\n */\nexport enum PickOptions {\n  NO_PICK,\n  PICK_FIRST,\n  PICK_ONE,\n  PICK_ALL\n}\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { Cartesian3 } from '../../models/cartesian3';\nimport { ContextMenuOptions } from '../../models/context-menu-options';\nimport { MapEventsManagerService } from '../map-events-mananger/map-events-manager';\nimport { CesiumEvent } from '../map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../map-events-mananger/consts/pickOptions.enum';\nimport { DisposableObservable } from '../map-events-mananger/disposable-observable';\nimport { BasicContextMenu } from '../../models/basic-context-menu';\nimport { Subscription } from 'rxjs';\n\n\n/**\n * The Service manages a singleton context menu over the map. It should be initialized with MapEventsManager.\n * The Service allows opening and closing of the context menu and passing data to the context menu inner component.\n *\n * notice, `data` will be injected to your custom menu component into the `data` field in the component.\n * __Usage :__\n * ```\n *  ngOnInit() {\n *   this.clickEvent$ = this.eventsManager.register({ event: CesiumEvent.RIGHT_CLICK, pick: PickOptions.PICK_ONE });\n *   this.clickEvent$.subscribe(result => {\n *    if (result.entities) {\n *      const pickedMarker = result.entities[0];\n *      this.contextMenuService.open(MapContextmenuComponent, pickedMarker.position, {\n *        data: {\n *          myData: data,\n *          onDelete: () => this.delete(pickedMarker.id)\n *        }\n *      });\n *    }\n *   });\n *  }\n *\n *\n *  private delete(id) {\n *    this.mapMenu.close();\n *    this.detailedSiteService.removeMarker(id);\n *  }\n * ```\n */\n@Injectable()\nexport class ContextMenuService {\n  private _showContextMenu = false;\n  private _options: ContextMenuOptions;\n  private _position: Cartesian3;\n  private _content: BasicContextMenu;\n  private mapEventsManager: MapEventsManagerService;\n  private leftClickRegistration: DisposableObservable<any>;\n  private leftClickSubscription: Subscription;\n  private _contextMenuChangeNotifier = new EventEmitter();\n  private _onOpen = new EventEmitter();\n  private _onClose = new EventEmitter();\n  private _defaultContextMenuOptions: ContextMenuOptions = {\n    closeOnLeftCLick: true,\n    closeOnLeftClickPriority: 10,\n  };\n\n  get contextMenuChangeNotifier(): EventEmitter<any> {\n    return this._contextMenuChangeNotifier;\n  }\n\n  get showContextMenu(): boolean {\n    return this._showContextMenu;\n  }\n\n  get options(): ContextMenuOptions {\n    return this._options;\n  }\n\n  get position(): Cartesian3 {\n    return this._position;\n  }\n\n  get content(): BasicContextMenu {\n    return this._content;\n  }\n\n  get onOpen(): EventEmitter<any> {\n    return this._onOpen;\n  }\n\n  get onClose(): EventEmitter<any> {\n    return this._onClose;\n  }\n\n\n  init(mapEventsManager: MapEventsManagerService) {\n    this.mapEventsManager = mapEventsManager;\n  }\n\n  open<D>(contentComponent: any, position: Cartesian3, options: ContextMenuOptions<D> = {}) {\n    this.close();\n    this._content = contentComponent;\n    this._position = position;\n    this._options = Object.assign({}, this._defaultContextMenuOptions, options);\n    this._showContextMenu = true;\n    if (this.mapEventsManager && this._options.closeOnLeftCLick) {\n      this.leftClickRegistration = this.mapEventsManager.register({\n        event: CesiumEvent.LEFT_CLICK,\n        pick: PickOptions.NO_PICK,\n        priority: this._options.closeOnLeftClickPriority,\n      });\n      this.leftClickSubscription = this.leftClickRegistration.subscribe(() => {\n        this.leftClickSubscription.unsubscribe();\n        this.close();\n      });\n    }\n\n    this._contextMenuChangeNotifier.emit();\n    this._onOpen.emit();\n  }\n\n  close() {\n    this._content = undefined;\n    this._position = undefined;\n    this._options = undefined;\n    this._showContextMenu = false;\n    if (this.leftClickRegistration) {\n      this.leftClickRegistration.dispose();\n      this.leftClickRegistration = undefined;\n    }\n    if (this.leftClickSubscription) {\n      this.leftClickSubscription.unsubscribe();\n      this.leftClickSubscription = undefined;\n    }\n\n    this._contextMenuChangeNotifier.emit();\n    this._onClose.emit();\n  }\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { CesiumService } from '../cesium/cesium.service';\nimport * as geodesy from 'geodesy';\nimport { hemisphere, LatLon, LatLonEllipsoidal, Utm } from 'geodesy';\nimport { Cartesian3 } from '../../models/cartesian3';\n\nconst LatLonVectors = geodesy['LatLonVectors']; // doesnt exists on typings\n\nwindow['geodesy'] = geodesy;\n\n/**\n *  Given different types of coordinates, we provide you a service converting those types to the most common other types.\n *  We are using the geodesy implementation of UTM conversion. see: https://github.com/chrisveness/geodesy.\n *\n * @example\n * import { Component, OnInit } from '@angular/core';\n * import { CoordinateConverter } from 'angular2-cesium';\n *\n * @Component({\n * \t\tselector:'my-component',\n * \t\ttemplate:'<div>{{showCartographic}}</div>',\n * \t\tproviders:[CoordinateConverter]\n * })\n * export class MyComponent implements OnInit {\n * \t\tshowCartographic;\n *\n * \t\tconstructor(private coordinateConverter:CoordinateConverter){\n * \t\t}\n *\n * \t\tngOnInit(){\n * \t\t\tthis.showCartographic = this.coordinateConverter.degreesToCartographic(5, 5, 5);\n *  }\n * }\n *\n */\n@Injectable()\nexport class CoordinateConverter {\n  constructor(@Optional() private cesiumService?: CesiumService) {\n  }\n\n  static cartesian3ToLatLon(cartesian3: Cartesian3, ellipsoid?: any): {lon: number, lat: number; height: number} {\n    const cart = Cesium.Cartographic.fromCartesian(cartesian3, ellipsoid);\n    return {\n      lon: Cesium.Math.toDegrees(cart.longitude),\n      lat: Cesium.Math.toDegrees(cart.latitude),\n      height: cart.height\n    };\n  }\n\n  screenToCartesian3(screenPos: { x: number, y: number }, addMapCanvasBoundsToPos?: boolean) {\n    if (!this.cesiumService) {\n      throw new Error('ANGULAR2-CESIUM - Cesium service should be provided in order' +\n        ' to do screen position calculations');\n    } else {\n      const screenPosition = { ...screenPos };\n      if (addMapCanvasBoundsToPos) {\n        const mapBounds = this.cesiumService.getViewer().canvas.getBoundingClientRect();\n        screenPosition.x += mapBounds.left;\n        screenPosition.y += mapBounds.top;\n      }\n\n      const camera = this.cesiumService.getViewer().camera;\n      return camera.pickEllipsoid(screenPosition);\n    }\n  }\n\n  screenToCartographic(screenPos: { x: number, y: number }, ellipsoid?: any) {\n    return this.cartesian3ToCartographic(this.screenToCartesian3(screenPos), ellipsoid);\n  }\n\n  cartesian3ToCartographic(cartesian: Cartesian3, ellipsoid?: any) {\n    return Cesium.Cartographic.fromCartesian(cartesian, ellipsoid);\n  }\n\n  degreesToCartographic(longitude: number, latitude: number, height?: number) {\n    return Cesium.Cartographic.fromDegrees(longitude, latitude, height);\n  }\n\n  radiansToCartographic(longitude: number, latitude: number, height?: number) {\n    return Cesium.Cartographic.fromRadians(longitude, latitude, height);\n  }\n\n  degreesToUTM(longitude: number, latitude: number) {\n    return new LatLonEllipsoidal(latitude, longitude).toUtm();\n  }\n\n  UTMToDegrees(zone: number, hemisphereType: hemisphere, easting: number, northing: number) {\n    return this.geodesyToCesiumObject(new Utm(zone, hemisphereType, easting, northing).toLatLonE());\n  }\n\n  private geodesyToCesiumObject(geodesyRadians: LatLon) {\n    return {\n      longitude: geodesyRadians.lon,\n      latitude: geodesyRadians.lat,\n      height: geodesyRadians['height'] ? geodesyRadians['height'] : 0\n    };\n  }\n\n  /**\n   * middle point between two points\n   * @param first  (latitude,longitude) in radians\n   * @param second (latitude,longitude) in radians\n   */\n  midPointToCartesian3(first: { latitude: number, longitude: number }, second: { latitude: number, longitude: number }) {\n    const toDeg = (rad: number) => Cesium.Math.toDegrees(rad);\n    const firstPoint = new LatLonVectors(toDeg(first.latitude), toDeg(first.longitude));\n    const secondPoint = new LatLonVectors(toDeg(second.latitude), toDeg(second.longitude));\n    const middlePoint: any = firstPoint.midpointTo(secondPoint);\n\n    return Cesium.Cartesian3.fromDegrees(middlePoint.lon, middlePoint.lat);\n  }\n\n  middlePointByScreen(position0: Cartesian3, position1: Cartesian3): Cartesian3 {\n    const scene = this.cesiumService.getScene();\n    const screenPosition1 = Cesium.SceneTransforms.wgs84ToWindowCoordinates(scene, position0);\n    const screenPosition2 = Cesium.SceneTransforms.wgs84ToWindowCoordinates(scene, position1);\n    const middleScreenPoint =\n      new Cesium.Cartesian2((screenPosition2.x + screenPosition1.x) / 2.0, (screenPosition2.y + screenPosition1.y) / 2.0);\n    return scene.pickPosition(middleScreenPoint);\n  }\n\n  /**\n   * initial bearing between two points\n   *\n   * * @return bearing in degrees\n   * @param first - {latitude,longitude} in radians\n   * @param second - {latitude,longitude} in radians\n   */\n  bearingTo(first: { latitude: number, longitude: number }, second: { latitude: number, longitude: number }) {\n    const toDeg = (rad: number) => Cesium.Math.toDegrees(rad);\n    const firstPoint = new LatLonVectors(toDeg(first.latitude), toDeg(first.longitude));\n    const secondPoint = new LatLonVectors(toDeg(second.latitude), toDeg(second.longitude));\n    const bearing = firstPoint.bearingTo(secondPoint);\n\n    return bearing;\n  }\n\n  /**\n   * initial bearing between two points\n   *\n   * @return bearing in degrees\n   */\n  bearingToCartesian(firstCartesian3: Cartesian3, secondCartesian3: Cartesian3) {\n    const firstCart = Cesium.Cartographic.fromCartesian(firstCartesian3);\n    const secondCart = Cesium.Cartographic.fromCartesian(secondCartesian3);\n\n    return this.bearingTo(firstCart, secondCart);\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/**\n *  Abstract drawer. All drawers extends this class.\n */\n\nexport abstract class BasicDrawerService {\n  protected _propsAssigner: Function;\n\n  constructor() {\n  }\n\n  abstract add(cesiumProps: any, ...args: any[]): any;\n\n  abstract update(primitive: any, cesiumProps: any, ...args: any[]): void;\n\n  abstract remove(primitive: any): void;\n\n  abstract removeAll(): void;\n\n  abstract setShow(showValue: boolean): void;\n\n  abstract init(options?: any): any;\n\n  setPropsAssigner(assigner: Function) {\n    this._propsAssigner = assigner;\n  }\n}\n","import { CesiumService } from '../../cesium/cesium.service';\nimport { BasicDrawerService } from '../basic-drawer/basic-drawer.service';\n\n/**\n *  General primitives drawer responsible of drawing Cesium primitives.\n *  Drawers the handle Cesium primitives extend it.\n */\nexport abstract class PrimitivesDrawerService extends BasicDrawerService {\n  private _show = true;\n  private _primitiveCollectionWrap: any;\n  protected _cesiumCollection: any;\n  protected _propsAssigner: Function;\n\n  constructor(private drawerType: any, private cesiumService: CesiumService) {\n    super();\n  }\n\n  init() {\n    this._cesiumCollection = new this.drawerType();\n    this._primitiveCollectionWrap = new Cesium.PrimitiveCollection({destroyPrimitives: false});\n    this._primitiveCollectionWrap.add(this._cesiumCollection);\n    this.cesiumService.getScene().primitives.add(this._primitiveCollectionWrap);\n  }\n\n  add(cesiumProps: any, ...args: any[]): any {\n    return this._cesiumCollection.add(cesiumProps);\n  }\n\n  update(entity: any, cesiumProps: any, ...args: any[]) {\n    if (this._propsAssigner) {\n      this._propsAssigner(entity, cesiumProps);\n    } else {\n      Object.assign(entity, cesiumProps);\n    }\n  }\n\n  remove(entity: any) {\n    this._cesiumCollection.remove(entity);\n  }\n\n  removeAll() {\n    this._cesiumCollection.removeAll();\n  }\n\n  setShow(showValue: boolean) {\n    this._show = showValue;\n    this._primitiveCollectionWrap.show = showValue;\n  }\n\n  getShow(): boolean {\n    return this._show;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../cesium/cesium.service';\nimport { Cartesian3 } from '../../models/cartesian3';\nimport { Vec3 } from '../../models/vec3';\n\n@Injectable()\nexport class GeoUtilsService {\n  static pointByLocationDistanceAndAzimuth(currentLocation: any, meterDistance: number, radianAzimuth: number, deprecated?) {\n    const distance = meterDistance / Cesium.Ellipsoid.WGS84.maximumRadius;\n    const cartographicLocation =\n      currentLocation instanceof Cesium.Cartesian3 ? Cesium.Cartographic.fromCartesian(currentLocation) : currentLocation;\n    const cartesianLocation =\n      currentLocation instanceof Cesium.Cartesian3\n        ? currentLocation\n        : Cesium.Cartesian3.fromRadians(currentLocation.longitude, currentLocation.latitude, currentLocation.height);\n\n    let resultPosition;\n    let resultDistance;\n    let counter = 0;\n    let distanceFactorRangeMax = 0.1;\n    let distanceFactorRangeMin = -0.1;\n    while (\n      counter === 0 ||\n      (counter < 16 && Math.max(resultDistance, meterDistance) / Math.min(resultDistance, meterDistance) > 1.000001)\n      ) {\n      const factor = distanceFactorRangeMin + (distanceFactorRangeMax - distanceFactorRangeMin) / 2;\n      resultPosition = GeoUtilsService._pointByLocationDistanceAndAzimuth(cartographicLocation, distance * (1 + factor), radianAzimuth);\n      resultDistance = this.distance(cartesianLocation, resultPosition);\n\n      if (resultDistance > meterDistance) {\n        distanceFactorRangeMax = distanceFactorRangeMin + (distanceFactorRangeMax - distanceFactorRangeMin) / 2;\n      } else {\n        distanceFactorRangeMin = distanceFactorRangeMin + (distanceFactorRangeMax - distanceFactorRangeMin) / 2;\n      }\n      counter++;\n    }\n\n    return resultPosition;\n  }\n\n  static _pointByLocationDistanceAndAzimuth(cartographicLocation: any, distance: number, radianAzimuth: number) {\n    const curLat = cartographicLocation.latitude;\n    const curLon = cartographicLocation.longitude;\n    const destinationLat = Math.asin(\n      Math.sin(curLat) * Math.cos(distance) + Math.cos(curLat) * Math.sin(distance) * Math.cos(radianAzimuth),\n    );\n\n    let destinationLon =\n      curLon +\n      Math.atan2(\n        Math.sin(radianAzimuth) * Math.sin(distance) * Math.cos(curLat),\n        Math.cos(distance) - Math.sin(curLat) * Math.sin(destinationLat),\n      );\n\n    destinationLon = ((destinationLon + 3 * Math.PI) % (2 * Math.PI)) - Math.PI;\n\n    return Cesium.Cartesian3.fromRadians(destinationLon, destinationLat);\n  }\n\n  static distance(pos0: Cartesian3, pos1: Cartesian3): number {\n    return Cesium.Cartesian3.distance(pos0, pos1);\n  }\n\n  static getPositionsDelta(position0: Cartesian3, position1: Cartesian3): Vec3 {\n    return {\n      x: position1.x - position0.x,\n      y: position1.y - position0.y,\n      z: position1.z - position0.z,\n    };\n  }\n\n  static addDeltaToPosition(position: Cartesian3, delta: Vec3, updateReference = false): Cartesian3 {\n    if (updateReference) {\n      position.x += delta.x;\n      position.y += delta.y;\n      position.z += delta.z;\n      const cartographic = Cesium.Cartographic.fromCartesian(position);\n      cartographic.height = 0;\n      const cartesian = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, cartographic.height);\n      position.x = cartesian.x;\n      position.y = cartesian.y;\n      position.z = cartesian.z;\n      return position;\n    } else {\n      const cartesian = new Cesium.Cartesian3(position.x + delta.x, position.y + delta.y, position.z + delta.z);\n      const cartographic = Cesium.Cartographic.fromCartesian(cartesian);\n      cartographic.height = 0;\n      return Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, cartographic.height);\n    }\n  }\n\n  static middleCartesian3Point(position0: Cartesian3, position1: Cartesian3) {\n    return new Cesium.Cartesian3(position1.x - position0.x / 2, position1.y - position0.y / 2, position1.z - position0.z / 2);\n  }\n\n  constructor(private cesiumService: CesiumService) {\n  }\n\n  screenPositionToCartesian3(screenPos: { x: number; y: number }) {\n    const camera = this.cesiumService.getViewer().camera;\n    return camera.pickEllipsoid(screenPos);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\nimport { GeoUtilsService } from '../../geo-utils/geo-utils.service';\n\n/**\n +  This drawer is responsible for drawing an arc over the Cesium map.\n +  This implementation uses simple PolylineGeometry and Primitive parameters.\n +  This doesn't allow us to change the position, color, etc.. of the arc but setShow only.\n */\n\n@Injectable()\nexport class ArcDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PolylineCollection, cesiumService);\n  }\n\n  _calculateArcPositions(cesiumProps: any) {\n    const quality = cesiumProps.quality || 18;\n    const delta = (cesiumProps.delta) / quality;\n    const pointsArray = [];\n    for (let i = 0; i < quality + 1; ++i) {\n      const point =\n        GeoUtilsService.pointByLocationDistanceAndAzimuth(cesiumProps.center, cesiumProps.radius, cesiumProps.angle + delta * i, true);\n      pointsArray.push(point);\n    }\n\n    return pointsArray;\n  }\n\n  _calculateTriangle(cesiumProps: any) {\n    return [\n      cesiumProps.center,\n      GeoUtilsService.pointByLocationDistanceAndAzimuth(cesiumProps.center, cesiumProps.radius, cesiumProps.angle, true)\n    ];\n  }\n\n  _calculateArc(cesiumProps: any) {\n    const arcPoints = this._calculateArcPositions(cesiumProps);\n    return cesiumProps.drawEdges ? arcPoints.concat(this._calculateTriangle(cesiumProps)) : arcPoints;\n  }\n\n  add(cesiumProps: any): any {\n    cesiumProps.positions = this._calculateArc(cesiumProps);\n    if (cesiumProps.color) {\n      const material = Cesium.Material.fromType('Color');\n      material.uniforms.color = cesiumProps.color;\n      cesiumProps.material = material;\n    }\n\n    return this._cesiumCollection.add(cesiumProps);\n  }\n\n  update(primitive: any, cesiumProps: any) {\n    if (!cesiumProps.constantColor && cesiumProps.color &&\n      !primitive.material.uniforms.color.equals(cesiumProps.color)) {\n      primitive.material.uniforms.color = cesiumProps.color;\n    }\n    primitive.width = cesiumProps.width !== undefined ? cesiumProps.width : primitive.width;\n    primitive.show = cesiumProps.show !== undefined ? cesiumProps.show : primitive.show;\n    primitive.distanceDisplayCondition = cesiumProps.distanceDisplayCondition !== undefined ?\n      cesiumProps.distanceDisplayCondition : primitive.distanceDisplayCondition;\n    primitive.positions = this._calculateArc(cesiumProps);\n\n    return primitive;\n  }\n}\n","export enum GraphicsType {\n  ellipse = Cesium.EllipseGraphics,\n  ellipsoid = Cesium.EllipsoidGraphics,\n  polygon = Cesium.PolygonGraphics,\n  polyline = Cesium.PolylineGraphics,\n  polylineVolume = Cesium.PolylineVolumeGraphics,\n  box = Cesium.BoxGraphics,\n  corridor = Cesium.CorridorGraphics,\n  cylinder = Cesium.CylinderGraphics,\n  label = Cesium.LabelGraphics,\n  billboard = Cesium.BillboardGraphics,\n  model = Cesium.ModelGraphics,\n  path = Cesium.PathGraphics,\n  point = Cesium.PointGraphics,\n  rectangle = Cesium.RectangleGraphics,\n  wall = Cesium.WallGraphics,\n}\n","export class OptimizedEntityCollection {\n  private _updateRate: number;\n  private _collectionSize: number;\n  private _isSuspended = false;\n  private _isHardSuspend = false;\n  private _suspensionTimeout: any;\n  private _onEventSuspensionCallback: { once: boolean, callback: Function };\n  private _onEventResumeCallback: { once: boolean, callback: Function };\n\n  constructor(private entityCollection: any, collectionSize = -1, updateRate = -1) {\n    this._updateRate = updateRate;\n    this._collectionSize = collectionSize;\n\n  }\n\n  setShow(show: boolean) {\n    this.entityCollection.show = show;\n  }\n\n  get isSuspended(): boolean {\n    return this._isSuspended;\n  }\n\n  get updateRate(): number {\n    return this._updateRate;\n  }\n\n  set updateRate(value: number) {\n    this._updateRate = value;\n  }\n\n  get collectionSize(): number {\n    return this._collectionSize;\n  }\n\n  set collectionSize(value: number) {\n    this._collectionSize = value;\n  }\n\n  collection() {\n    return this.entityCollection;\n  }\n\n  isFree(): boolean {\n    return this._collectionSize < 1 || this.entityCollection.values.length < this._collectionSize;\n  }\n\n  add(entity: any) {\n    this.suspend();\n    return this.entityCollection.add(entity);\n  }\n\n  remove(entity: any) {\n    this.suspend();\n    return this.entityCollection.remove(entity);\n  }\n\n  removeNoSuspend(entity: any) {\n    this.entityCollection.remove(entity);\n  }\n\n  removeAll() {\n    this.suspend();\n    this.entityCollection.removeAll();\n  }\n\n  onEventSuspension(callback: Function, once = false): Function {\n    this._onEventSuspensionCallback = {callback, once};\n    return () => {\n      this._onEventSuspensionCallback = undefined;\n    };\n  }\n\n  onEventResume(callback: Function, once = false): Function {\n    this._onEventResumeCallback = {callback, once};\n    if (!this._isSuspended) {\n      this.triggerEventResume();\n    }\n    return () => {\n      this._onEventResumeCallback = undefined;\n    };\n  }\n\n  triggerEventSuspension() {\n    if (this._onEventSuspensionCallback !== undefined) {\n      const callback = this._onEventSuspensionCallback.callback;\n      if (this._onEventSuspensionCallback.once) {\n        this._onEventSuspensionCallback = undefined;\n      }\n      callback();\n    }\n  }\n\n  triggerEventResume() {\n    if (this._onEventResumeCallback !== undefined) {\n      const callback = this._onEventResumeCallback.callback;\n      if (this._onEventResumeCallback.once) {\n        this._onEventResumeCallback = undefined;\n      }\n      callback();\n    }\n  }\n\n  public suspend() {\n    if (this._updateRate < 0) {\n      return;\n    }\n    if (this._isHardSuspend) {\n      return;\n    }\n    if (!this._isSuspended) {\n      this._isSuspended = true;\n      this.entityCollection.suspendEvents();\n      this.triggerEventSuspension();\n      this._suspensionTimeout = setTimeout(() => {\n        this.entityCollection.resumeEvents();\n        this.triggerEventResume();\n        this._isSuspended = false;\n        this._suspensionTimeout = undefined;\n      }, this._updateRate);\n    }\n  }\n\n  public hardSuspend() {\n    this.entityCollection.suspendEvents();\n    this._isHardSuspend = true;\n  }\n\n  public hardResume() {\n    this.entityCollection.resumeEvents();\n    this._isHardSuspend = false;\n  }\n\n}\n","import { BasicDrawerService } from '../basic-drawer/basic-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from './enums/graphics-type.enum';\nimport { EntitiesDrawerOptions } from '../../../models/entities-drawer-options';\nimport { OptimizedEntityCollection } from './optimized-entity-collection';\n\n/**\n *  General primitives drawer responsible of drawing Cesium primitives.\n *  Drawers the handle Cesium primitives extend it.\n */\n\nexport class EntitiesDrawerService extends BasicDrawerService {\n  private entityCollections = new Map<any, OptimizedEntityCollection>();\n  private graphicsTypeName: string;\n\n  constructor(\n    private cesiumService: CesiumService,\n    private graphicsType: GraphicsType,\n    private defaultOptions: EntitiesDrawerOptions = {\n      collectionMaxSize: -1,\n      collectionSuspensionTime: -1,\n      collectionsNumber: 1,\n    },\n  ) {\n    super();\n    this.graphicsTypeName = GraphicsType[this.graphicsType];\n\n    // Fix bad enum compilation\n    for (const i in GraphicsType) {\n      if (GraphicsType[i] as any === this.graphicsType) {\n        this.graphicsTypeName = i;\n      }\n    }\n  }\n\n  private getFreeEntitiesCollection(): OptimizedEntityCollection {\n    let freeEntityCollection = null;\n    this.entityCollections.forEach(entityCollection => {\n      if (entityCollection.isFree()) {\n        freeEntityCollection = entityCollection;\n      }\n    });\n\n    return freeEntityCollection;\n  }\n\n  init(options?: EntitiesDrawerOptions) {\n    const finalOptions = options || this.defaultOptions;\n    const dataSources = [];\n    for (let i = 0; i < finalOptions.collectionsNumber; i++) {\n      const dataSource = new Cesium.CustomDataSource(this.graphicsTypeName);\n      dataSources.push(dataSource);\n      this.cesiumService.getViewer().dataSources.add(dataSource);\n      this.entityCollections.set(\n        dataSource.entities,\n        new OptimizedEntityCollection(dataSource.entities, finalOptions.collectionMaxSize, finalOptions.collectionSuspensionTime),\n      );\n    }\n\n    return dataSources;\n  }\n\n  add(cesiumProps: any): any {\n    const optimizedEntityCollection = this.getFreeEntitiesCollection();\n    if (optimizedEntityCollection === null) {\n      throw new Error('No more free entity collections');\n    }\n\n    const entityObject = {\n      position: cesiumProps.position !== undefined ? cesiumProps.position : undefined,\n      description: cesiumProps.description !== undefined ? cesiumProps.description : undefined,\n      orientation: cesiumProps.orientation !== undefined ? cesiumProps.orientation : undefined,\n      viewFrom: cesiumProps.viewFrom !== undefined ? cesiumProps.viewFrom : undefined,\n      [this.graphicsTypeName]: cesiumProps,\n    };\n\n    if (cesiumProps.name !== undefined) {\n      entityObject.name = cesiumProps.name;\n    }\n    if (cesiumProps.availability !== undefined) {\n      entityObject.availability = cesiumProps.availability;\n    }\n\n    return optimizedEntityCollection.add(entityObject);\n  }\n\n  update(entity: any, cesiumProps: any) {\n    this.suspendEntityCollection(entity);\n\n    if (entity.position instanceof Cesium.CallbackProperty) {\n      if (entity.position._isConstant) {\n        entity.position = cesiumProps.position;\n      }\n    }\n    entity.position = cesiumProps.position !== undefined ? cesiumProps.position : undefined;\n    entity.name = cesiumProps.name !== undefined ? cesiumProps.name : entity.name;\n    entity.description = cesiumProps.description !== undefined ? cesiumProps.description : entity.description;\n    entity.orientation = cesiumProps.orientation !== undefined ? cesiumProps.orientation : entity.orientation;\n    entity.viewFrom = cesiumProps.viewFrom !== undefined ? cesiumProps.viewFrom : entity.viewFrom;\n    entity.availability = cesiumProps.availability !== undefined ? cesiumProps.availability : cesiumProps.availability;\n\n    if (this._propsAssigner) {\n      this._propsAssigner(entity[this.graphicsTypeName], cesiumProps);\n    } else {\n      Object.assign(entity[this.graphicsTypeName], cesiumProps);\n    }\n  }\n\n  remove(entity: any) {\n    const optimizedEntityCollection = this.entityCollections.get(entity.entityCollection);\n    optimizedEntityCollection.remove(entity);\n  }\n\n  removeAll() {\n    this.entityCollections.forEach(entityCollection => {\n      entityCollection.removeAll();\n    });\n  }\n\n  setShow(showValue: boolean) {\n    this.entityCollections.forEach(entityCollection => {\n      entityCollection.setShow(showValue);\n    });\n  }\n\n  private suspendEntityCollection(entity: any) {\n    const id = entity.entityCollection;\n    if (!this.entityCollections.has(id)) {\n      throw new Error('No EntityCollection for entity.entityCollection');\n    }\n\n    const entityCollection = this.entityCollections.get(id);\n    entityCollection.suspend();\n  }\n}\n\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing billboards.\n */\n@Injectable()\nexport class BillboardDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.billboard);\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { BasicDrawerService } from '../basic-drawer/basic-drawer.service';\nimport { EntitiesDrawerOptions } from '../../../models/entities-drawer-options';\n\n/**\n *  This drawer is responsible for drawing czml dataSources.\n */\n@Injectable()\nexport class CzmlDrawerService extends BasicDrawerService {\n\n  czmlStream: any;\n\n  constructor(\n    private cesiumService: CesiumService,\n  ) {\n    super();\n  }\n\n\n  init(options?: EntitiesDrawerOptions) {\n    const dataSources = [];\n\n    this.czmlStream = new Cesium.CzmlDataSource('czml');\n\n    dataSources.push(this.czmlStream);\n\n    this.cesiumService.getViewer().dataSources.add(this.czmlStream);\n\n    return dataSources;\n  }\n\n  // returns the packet, provided by the stream\n  add(cesiumProps: any): any {\n\n    this.czmlStream.process(cesiumProps.czmlPacket);\n\n    return cesiumProps;\n  }\n\n  update(entity: any, cesiumProps: any) {\n    this.czmlStream.process(cesiumProps.czmlPacket);\n  }\n\n  remove(entity: any) {\n    this.czmlStream.entities.removeById(entity.acEntity.id);\n  }\n\n  removeAll() {\n    this.czmlStream.entities.removeAll();\n  }\n\n  setShow(showValue: boolean) {\n    this.czmlStream.entities.show = showValue;\n  }\n\n}\n\n\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing ellipses.\n */\n@Injectable()\nexport class EllipseDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.ellipse);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing labels.\n */\n@Injectable()\nexport class LabelDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.label);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing points.\n */\n@Injectable()\nexport class PointDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.point);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing polygons.\n */\n@Injectable()\nexport class PolygonDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.polygon);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible of drawing polylines.\n */\n@Injectable()\nexport class PolylineDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.polyline);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\n\n/**\n *  This drawer is responsible of drawing polylines as primitives.\n *  This drawer is more efficient than PolylineDrawerService when drawing dynamic polylines.\n */\n@Injectable()\nexport class PolylinePrimitiveDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PolylineCollection, cesiumService);\n  }\n\n  add(cesiumProps: any) {\n    return this._cesiumCollection.add(this.withColorMaterial(cesiumProps));\n  }\n\n  update(cesiumObject: any, cesiumProps: any) {\n    if (cesiumProps.material instanceof Cesium.Color) {\n      if (cesiumObject.material && cesiumObject.material.uniforms &&\n        cesiumObject.material.uniforms.color instanceof Cesium.Color) {\n        this.withColorMaterial(cesiumProps);\n      } else if (!cesiumObject.material.uniforms.color.equals(cesiumProps.material)) {\n        cesiumObject.material.uniforms.color = cesiumProps.material;\n      }\n    }\n    super.update(cesiumObject, cesiumProps);\n  }\n\n  withColorMaterial(cesiumProps: any) {\n    if (cesiumProps.material instanceof Cesium.Color) {\n      const material = Cesium.Material.fromType('Color');\n      material.uniforms.color = cesiumProps.material;\n      cesiumProps.material = material;\n    }\n\n    return cesiumProps;\n  }\n}\n","export enum KeyboardAction {\n  CAMERA_FORWARD,\n  CAMERA_BACKWARD,\n  CAMERA_RIGHT,\n  CAMERA_LEFT,\n  CAMERA_UP,\n  CAMERA_DOWN,\n  CAMERA_LOOK_RIGHT,\n  CAMERA_LOOK_LEFT,\n  CAMERA_LOOK_UP,\n  CAMERA_LOOK_DOWN,\n  CAMERA_TWIST_RIGHT,\n  CAMERA_TWIST_LEFT,\n  CAMERA_ROTATE_RIGHT,\n  CAMERA_ROTATE_LEFT,\n  CAMERA_ROTATE_UP,\n  CAMERA_ROTATE_DOWN,\n  CAMERA_ZOOM_IN,\n  CAMERA_ZOOM_OUT,\n}\n","import { KeyboardAction } from '../../models/ac-keyboard-action.enum';\nimport { KeyboardControlActionFn } from './keyboard-control.service';\nimport { CesiumService } from '../cesium/cesium.service';\n\nconst CAMERA_MOVEMENT_DEFAULT_FACTOR = 100.0;\nconst CAMERA_LOOK_DEFAULT_FACTOR = 0.01;\nconst CAMERA_TWIST_DEFAULT_FACTOR = 0.01;\nconst CAMERA_ROTATE_DEFAULT_FACTOR = 0.01;\n\nexport const PREDEFINED_KEYBOARD_ACTIONS: { [key: number]: KeyboardControlActionFn } = {\n  /**\n   * Moves the camera forward, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_FORWARD]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveForward(moveRate);\n  },\n  /**\n   * Moves the camera backward, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_BACKWARD]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveBackward(moveRate);\n  },\n  /**\n   * Moves the camera up, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_UP]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveUp(moveRate);\n  },\n  /**\n   * Moves the camera down, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_DOWN]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveDown(moveRate);\n  },\n  /**\n   * Moves the camera right, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_RIGHT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveRight(moveRate);\n  },\n  /**\n   * Moves the camera left, accepts a numeric parameter named `moveRate` that controls\n   * the factor of movement, according to the camera height.\n   */\n  [KeyboardAction.CAMERA_LEFT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const scene = cesiumService.getScene();\n    const cameraHeight = scene.globe.ellipsoid.cartesianToCartographic(camera.position).height;\n    const moveRate = cameraHeight / (params.moveRate || CAMERA_MOVEMENT_DEFAULT_FACTOR);\n    camera.moveLeft(moveRate);\n  },\n  /**\n   * Changes the camera to look to the right, accepts a numeric parameter named `lookFactor` that controls\n   * the factor of looking, according to the camera current position.\n   */\n  [KeyboardAction.CAMERA_LOOK_RIGHT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const currentPosition = camera.positionCartographic;\n    const lookFactor = params.lookFactor || CAMERA_LOOK_DEFAULT_FACTOR;\n    camera.lookRight(currentPosition.latitude * lookFactor);\n  },\n  /**\n   * Changes the camera to look to the left, accepts a numeric parameter named `lookFactor` that controls\n   * the factor of looking, according to the camera current position.\n   */\n  [KeyboardAction.CAMERA_LOOK_LEFT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const currentPosition = camera.positionCartographic;\n    const lookFactor = params.lookFactor || CAMERA_LOOK_DEFAULT_FACTOR;\n    camera.lookLeft(currentPosition.latitude * lookFactor);\n  },\n  /**\n   * Changes the camera to look up, accepts a numeric parameter named `lookFactor` that controls\n   * the factor of looking, according to the camera current position.\n   */\n  [KeyboardAction.CAMERA_LOOK_UP]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const currentPosition = camera.positionCartographic;\n    const lookFactor = params.lookFactor || CAMERA_LOOK_DEFAULT_FACTOR;\n    camera.lookUp(currentPosition.longitude * (lookFactor * -1));\n  },\n  /**\n   * Changes the camera to look down, accepts a numeric parameter named `lookFactor` that controls\n   * the factor of looking, according to the camera current position.\n   */\n  [KeyboardAction.CAMERA_LOOK_DOWN]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const currentPosition = camera.positionCartographic;\n    const lookFactor = params.lookFactor || CAMERA_LOOK_DEFAULT_FACTOR;\n    camera.lookDown(currentPosition.longitude * (lookFactor * -1));\n  },\n  /**\n   * Twists the camera to the right, accepts a numeric parameter named `amount` that controls\n   * the twist amount\n   */\n  [KeyboardAction.CAMERA_TWIST_RIGHT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.amount || CAMERA_TWIST_DEFAULT_FACTOR;\n    camera.twistRight(lookFactor);\n  },\n  /**\n   * Twists the camera to the left, accepts a numeric parameter named `amount` that controls\n   * the twist amount\n   */\n  [KeyboardAction.CAMERA_TWIST_LEFT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.amount || CAMERA_TWIST_DEFAULT_FACTOR;\n    camera.twistLeft(lookFactor);\n  },\n  /**\n   * Rotates the camera to the right, accepts a numeric parameter named `angle` that controls\n   * the rotation angle\n   */\n  [KeyboardAction.CAMERA_ROTATE_RIGHT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.angle || CAMERA_ROTATE_DEFAULT_FACTOR;\n    camera.rotateRight(lookFactor);\n  },\n  /**\n   * Rotates the camera to the left, accepts a numeric parameter named `angle` that controls\n   * the rotation angle\n   */\n  [KeyboardAction.CAMERA_ROTATE_LEFT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.angle || CAMERA_ROTATE_DEFAULT_FACTOR;\n    camera.rotateLeft(lookFactor);\n  },\n  /**\n   * Rotates the camera upwards, accepts a numeric parameter named `angle` that controls\n   * the rotation angle\n   */\n  [KeyboardAction.CAMERA_ROTATE_UP]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.angle || CAMERA_ROTATE_DEFAULT_FACTOR;\n    camera.rotateUp(lookFactor);\n  },\n  /**\n   * Rotates the camera downwards, accepts a numeric parameter named `angle` that controls\n   * the rotation angle\n   */\n  [KeyboardAction.CAMERA_ROTATE_DOWN]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const lookFactor = params.angle || CAMERA_ROTATE_DEFAULT_FACTOR;\n    camera.rotateDown(lookFactor);\n  },\n  /**\n   * Zoom in into the current camera center position, accepts a numeric parameter named\n   * `amount` that controls the amount of zoom in meters.\n   */\n  [KeyboardAction.CAMERA_ZOOM_IN]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const amount = params.amount;\n    camera.zoomIn(amount);\n  },\n  /**\n   * Zoom out from the current camera center position, accepts a numeric parameter named\n   * `amount` that controls the amount of zoom in meters.\n   */\n  [KeyboardAction.CAMERA_ZOOM_OUT]: (cesiumService: CesiumService, params: any) => {\n    const camera = cesiumService.getViewer().camera;\n    const amount = params.amount;\n    camera.zoomOut(amount);\n  },\n};\n","import { isNumber } from 'util';\nimport { Inject, Injectable, NgZone } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { KeyboardAction } from '../../models/ac-keyboard-action.enum';\nimport { CesiumService } from '../cesium/cesium.service';\nimport { PREDEFINED_KEYBOARD_ACTIONS } from './predefined-actions';\n\nexport type KeyboardControlActionFn = (cesiumService: CesiumService, params: any, event: KeyboardEvent) => boolean | void;\nexport type KeyboardControlValidationFn = (cesiumService: CesiumService, params: any, event: KeyboardEvent) => boolean;\nexport type KeyboardControlDoneFn = (cesiumService: CesiumService, event: KeyboardEvent) => boolean;\n\nexport interface KeyboardControlParams {\n  action: KeyboardAction | KeyboardControlActionFn;\n  validation?: KeyboardControlValidationFn;\n  params?: { [paramName: string]: any };\n  done?: KeyboardControlDoneFn;\n}\n\nexport interface KeyboardControlDefinition {\n  [keyboardCharCode: string]: KeyboardControlParams;\n}\n\nenum KeyEventState {\n  IGNORED,\n  NOT_PRESSED,\n  PRESSED,\n}\n\ninterface ActiveDefinition {\n  keyboardEvent: KeyboardEvent;\n  state: KeyEventState;\n  action: KeyboardControlParams;\n}\n\n/**\n *  Service that manages keyboard keys and execute actions per request.\n *  Inject the keyboard control service into any layer, under your `ac-map` component,\n *  And defined you keyboard handlers using `setKeyboardControls`.\n *\n * <caption>Simple Example</caption>\n * ```typescript\n * Component({\n *   selector: 'keyboard-control-layer',\n *   template: '',\n * })\n * export class KeyboardControlLayerComponent implements OnInit, OnDestroy {\n *   constructor(private keyboardControlService: KeyboardControlService) {}\n *\n *   ngOnInit() {\n *     this.keyboardControlService.setKeyboardControls({\n *       W: { action: KeyboardAction.CAMERA_FORWARD },\n *       S: { action: KeyboardAction.CAMERA_BACKWARD },\n *       D: { action: KeyboardAction.CAMERA_RIGHT },\n *       A: { action: KeyboardAction.CAMERA_LEFT },\n *     });\n *    }\n *\n *   ngOnDestroy() {\n *     this.keyboardControlService.removeKeyboardControls();\n *   }\n * }\n * ```\n *\n * <caption>Advanced Example</caption>\n * ```typescript\n * Component({\n *   selector: 'keyboard-control-layer',\n *   template: '',\n * })\n * export class KeyboardControlLayerComponent implements OnInit, OnDestroy {\n *   constructor(private keyboardControlService: KeyboardControlService) {}\n *\n *   private myCustomValue = 10;\n *\n *   ngOnInit() {\n *     this.keyboardControlService.setKeyboardControls({\n *       W: {\n *          action: KeyboardAction.CAMERA_FORWARD,\n *          validate: (camera, scene, params, key) => {\n *            // Replace `checkCamera` you with your validation logic\n *            if (checkCamera(camera) || params.customParams === true) {\n *              return true;\n *            }\n *\n *            return false;\n *          },\n *          params: () => {\n *            return {\n *              myValue: this.myCustomValue,\n *            };\n *          },\n *        }\n *     });\n *    }\n *\n *   ngOnDestroy() {\n *     this.keyboardControlService.removeKeyboardControls();\n *   }\n * }\n * ```\n * <b>Predefined keyboard actions:</b>\n * + `KeyboardAction.CAMERA_FORWARD` - Moves the camera forward, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_BACKWARD` - Moves the camera backward, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_UP` - Moves the camera up, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_DOWN` - Moves the camera down, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_RIGHT` - Moves the camera right, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_LEFT` - Moves the camera left, accepts a numeric parameter named `moveRate` that controls\n * the factor of movement, according to the camera height.\n * + `KeyboardAction.CAMERA_LOOK_RIGHT` - Changes the camera to look to the right, accepts a numeric parameter named `lookFactor` that\n * controls the factor of looking, according to the camera current position.\n * + `KeyboardAction.CAMERA_LOOK_LEFT` - Changes the camera to look to the left, accepts a numeric parameter named `lookFactor` that\n * controls the factor of looking, according to the camera current position.\n * + `KeyboardAction.CAMERA_LOOK_UP` - Changes the camera to look up, accepts a numeric parameter named `lookFactor` that controls\n * the factor of looking, according to the camera current position.\n * + `KeyboardAction.CAMERA_LOOK_DOWN` - Changes the camera to look down, accepts a numeric parameter named `lookFactor` that controls\n * the factor of looking, according to the camera current position.\n * + `KeyboardAction.CAMERA_TWIST_RIGHT` - Twists the camera to the right, accepts a numeric parameter named `amount` that controls\n * the twist amount\n * + `KeyboardAction.CAMERA_TWIST_LEFT` - Twists the camera to the left, accepts a numeric parameter named `amount` that controls\n * the twist amount\n * + `KeyboardAction.CAMERA_ROTATE_RIGHT` - Rotates the camera to the right, accepts a numeric parameter named `angle` that controls\n * the rotation angle\n * + `KeyboardAction.CAMERA_ROTATE_LEFT` - Rotates the camera to the left, accepts a numeric parameter named `angle` that controls\n * the rotation angle\n * + `KeyboardAction.CAMERA_ROTATE_UP` - Rotates the camera upwards, accepts a numeric parameter named `angle` that controls\n * the rotation angle\n * + `KeyboardAction.CAMERA_ROTATE_DOWN` - Rotates the camera downwards, accepts a numeric parameter named `angle` that controls\n * the rotation angle\n * + `KeyboardAction.CAMERA_ZOOM_IN` - Zoom in into the current camera center position, accepts a numeric parameter named\n * `amount` that controls the amount of zoom in meters.\n * + `KeyboardAction.CAMERA_ZOOM_OUT` -  Zoom out from the current camera center position, accepts a numeric parameter named\n * `amount` that controls the amount of zoom in meters.\n */\n@Injectable()\nexport class KeyboardControlService {\n  private _currentDefinitions: KeyboardControlDefinition = null;\n  private _activeDefinitions: { [definitionKey: string]: ActiveDefinition } = {};\n  private _keyMappingFn: Function = this.defaultKeyMappingFn;\n\n  /**\n   * Creats the keyboard control service.\n   */\n  constructor(private ngZone: NgZone, private cesiumService: CesiumService, @Inject(DOCUMENT) private document: any) {\n  }\n\n  /**\n   * Initializes the keyboard control service.\n   */\n  init() {\n    const canvas = this.cesiumService.getCanvas();\n    canvas.addEventListener('click', () => {\n      canvas.focus();\n    });\n\n    this.handleKeydown = this.handleKeydown.bind(this);\n    this.handleKeyup = this.handleKeyup.bind(this);\n    this.handleTick = this.handleTick.bind(this);\n  }\n\n  /**\n   * Sets the current map keyboard control definitions.\n   * The definitions is a key mapping between a key string and a KeyboardControlDefinition:\n   * - `action` is a predefine action from `KeyboardAction` enum, or a custom method:\n   * `(camera, scene, params, key) => boolean | void` - returning false will cancel the current keydown.\n   * - `validation` is a method that validates if the event should occur or not (`camera, scene, params, key`)\n   * - `params` is an object (or function that returns object) that will be passed into the action executor.\n   * - `done` is a function that will be triggered when `keyup` is triggered.\n   * @param definitions Keyboard Control Definition\n   * @param keyMappingFn - Mapping function for custom keys\n   * @param outsideOfAngularZone - if key down events will run outside of angular zone.\n   */\n  setKeyboardControls(definitions: KeyboardControlDefinition,\n                      keyMappingFn?: (keyEvent: KeyboardEvent) => string,\n                      outsideOfAngularZone = false) {\n    if (!definitions) {\n      return this.removeKeyboardControls();\n    }\n\n    if (!this._currentDefinitions) {\n      this.registerEvents(outsideOfAngularZone);\n    }\n\n    this._currentDefinitions = definitions;\n    this._keyMappingFn = keyMappingFn || this.defaultKeyMappingFn;\n\n    Object.keys(this._currentDefinitions).forEach(key => {\n      this._activeDefinitions[key] = {\n        state: KeyEventState.NOT_PRESSED,\n        action: null,\n        keyboardEvent: null,\n      };\n    });\n  }\n\n  /**\n   * Removes the current set of keyboard control items, and unregister from map events.\n   */\n  removeKeyboardControls() {\n    this.unregisterEvents();\n    this._currentDefinitions = null;\n  }\n\n  /**\n   * Returns the current action that handles `char` key string, or `null` if not exists\n   */\n  private getAction(char: string): KeyboardControlParams {\n    return this._currentDefinitions[char] || null;\n  }\n\n  /**\n   * The default `defaultKeyMappingFn` that maps `KeyboardEvent` into a key string.\n   */\n  private defaultKeyMappingFn(keyEvent: KeyboardEvent): string {\n    return String.fromCharCode(keyEvent.keyCode);\n  }\n\n  /**\n   * document's `keydown` event handler\n   */\n  private handleKeydown(e: KeyboardEvent) {\n    const char = this._keyMappingFn(e);\n    const action = this.getAction(char);\n\n    if (action) {\n      const actionState = this._activeDefinitions[char];\n\n      if (actionState.state !== KeyEventState.IGNORED) {\n        let execute = true;\n\n        const params = this.getParams(action.params, e);\n\n        if (action.validation) {\n          execute = action.validation(this.cesiumService, params, e);\n        }\n\n        if (execute === true) {\n          this._activeDefinitions[char] = {\n            state: KeyEventState.PRESSED,\n            action,\n            keyboardEvent: e,\n          };\n        }\n      }\n    }\n  }\n\n  /**\n   * document's `keyup` event handler\n   */\n  private handleKeyup(e: KeyboardEvent) {\n    const char = this._keyMappingFn(e);\n    const action = this.getAction(char);\n\n    if (action) {\n      this._activeDefinitions[char] = {\n        state: KeyEventState.NOT_PRESSED,\n        action: null,\n        keyboardEvent: e,\n      };\n\n      if (action.done && typeof action.done === 'function') {\n        action.done(this.cesiumService, e);\n      }\n    }\n  }\n\n  /**\n   * `tick` event handler that triggered by Cesium render loop\n   */\n  private handleTick() {\n    const activeKeys = Object.keys(this._activeDefinitions);\n\n    activeKeys.forEach(key => {\n      const actionState = this._activeDefinitions[key];\n\n      if (actionState !== null && actionState.action !== null && actionState.state === KeyEventState.PRESSED) {\n        this.executeAction(actionState.action, key, actionState.keyboardEvent);\n      }\n    });\n  }\n\n  /**\n   *\n   * Params resolve function, returns object.\n   * In case of params function, executes it and returns it's return value.\n   *\n   */\n  private getParams(paramsDef: any, keyboardEvent: KeyboardEvent): { [paramName: string]: any } {\n    if (!paramsDef) {\n      return {};\n    }\n\n    if (typeof paramsDef === 'function') {\n      return paramsDef(this.cesiumService, keyboardEvent);\n    }\n\n    return paramsDef;\n  }\n\n  /**\n   *\n   * Executes a given `KeyboardControlParams` object.\n   *\n   */\n  private executeAction(execution: KeyboardControlParams, key: string, keyboardEvent: KeyboardEvent) {\n    if (!this._currentDefinitions) {\n      return;\n    }\n\n    const params = this.getParams(execution.params, keyboardEvent);\n\n    if (isNumber(execution.action)) {\n      const predefinedAction = PREDEFINED_KEYBOARD_ACTIONS[execution.action as number];\n\n      if (predefinedAction) {\n        predefinedAction(this.cesiumService, params, keyboardEvent);\n      }\n    } else if (typeof execution.action === 'function') {\n      const shouldCancelEvent = execution.action(this.cesiumService, params, keyboardEvent);\n\n      if (shouldCancelEvent === false) {\n        this._activeDefinitions[key] = {\n          state: KeyEventState.IGNORED,\n          action: null,\n          keyboardEvent: null,\n        };\n      }\n    }\n  }\n\n  /**\n   * Registers to keydown, keyup of `document`, and `tick` of Cesium.\n   */\n  private registerEvents(outsideOfAngularZone: boolean) {\n    const registerToEvents = () => {\n      this.document.addEventListener('keydown', this.handleKeydown);\n      this.document.addEventListener('keyup', this.handleKeyup);\n      this.cesiumService.getViewer().clock.onTick.addEventListener(this.handleTick);\n    };\n\n    if (outsideOfAngularZone) {\n      this.ngZone.runOutsideAngular(registerToEvents);\n    } else {\n      registerToEvents();\n    }\n  }\n\n  /**\n   * Unregisters to keydown, keyup of `document`, and `tick` of Cesium.\n   */\n  private unregisterEvents() {\n    this.document.removeEventListener('keydown', this.handleKeydown);\n    this.document.removeEventListener('keyup', this.handleKeyup);\n    this.cesiumService.getViewer().clock.onTick.removeEventListener(this.handleTick);\n  }\n}\n","import { Observable, Subscriber } from 'rxjs';\nimport { CesiumEvent } from '../consts/cesium-event.enum';\nimport { CesiumEventModifier } from '../consts/cesium-event-modifier.enum';\n\nexport class CesiumPureEventObserver {\n  public observer: Observable<any>;\n\n  constructor(protected event: CesiumEvent, protected modifier: CesiumEventModifier) {\n  }\n\n  init(eventsHandler: any): Observable<any> {\n    this.observer = Observable.create((observer: Subscriber<any>) => {\n        eventsHandler.setInputAction((movement: any) => {\n          if (movement.position) {\n            movement.startPosition = movement.position;\n            movement.endPosition = movement.position;\n          }\n          observer.next(movement);\n        }, this.event, this.modifier);\n      }\n    );\n    return this.observer;\n  }\n}\n","import { ConnectableObservable, merge, of as observableOf } from 'rxjs';\nimport { delay, mergeMap, publish, takeUntil } from 'rxjs/operators';\nimport { CesiumPureEventObserver } from './cesium-pure-event-observer';\nimport { CesiumEvent } from '../consts/cesium-event.enum';\nimport { CesiumEventModifier } from '../consts/cesium-event-modifier.enum';\nimport { CesiumEventBuilder } from '../cesium-event-builder';\n\nexport class CesiumLongPressObserver extends CesiumPureEventObserver {\n  public static LONG_PRESS_EVENTS_DURATION = 250;\n\n  constructor(protected event: CesiumEvent,\n              protected modifier: CesiumEventModifier,\n              private eventFactory: CesiumEventBuilder) {\n    super(event, modifier);\n  }\n\n  init(): ConnectableObservable<any> {\n    let startEvent: CesiumEvent;\n    let stopEvent: CesiumEvent;\n\n    if (this.event === CesiumEvent.LONG_LEFT_PRESS) {\n      startEvent = CesiumEvent.LEFT_DOWN;\n      stopEvent = CesiumEvent.LEFT_UP;\n    } else if (this.event === CesiumEvent.LONG_RIGHT_PRESS) {\n      startEvent = CesiumEvent.RIGHT_DOWN;\n      stopEvent = CesiumEvent.RIGHT_UP;\n    } else if (this.event === CesiumEvent.LONG_MIDDLE_PRESS) {\n      startEvent = CesiumEvent.MIDDLE_DOWN;\n      stopEvent = CesiumEvent.MIDDLE_UP;\n    }\n\n    const startEventObservable = this.eventFactory.get(startEvent, this.modifier);\n    const stopEventObservable = merge(\n      this.eventFactory.get(stopEvent, this.modifier),\n      this.eventFactory.get(CesiumEvent.MOUSE_MOVE, this.modifier) // Prevent drag mistaken for long press\n    );\n\n    // publish for preventing side effect\n    const longPressObservable = publish()(startEventObservable.pipe(\n      mergeMap((e) => observableOf(e).pipe(\n        delay(CesiumLongPressObserver.LONG_PRESS_EVENTS_DURATION),\n        takeUntil(stopEventObservable))),\n    ));\n    return longPressObservable;\n  }\n}\n","import { publish } from 'rxjs/operators';\nimport { CesiumService } from '../cesium/cesium.service';\nimport { CesiumEvent } from './consts/cesium-event.enum';\nimport { CesiumEventModifier } from './consts/cesium-event-modifier.enum';\nimport { Injectable } from '@angular/core';\nimport { CesiumPureEventObserver } from './event-observers/cesium-pure-event-observer';\nimport { CesiumLongPressObserver } from './event-observers/cesium-long-press-observer';\nimport { ConnectableObservable } from 'rxjs';\n\n@Injectable()\nexport class CesiumEventBuilder {\n\n  constructor(private cesiumService: CesiumService) {\n  }\n\n  public static longPressEvents: Set<CesiumEvent> = new Set([\n    CesiumEvent.LONG_LEFT_PRESS,\n    CesiumEvent.LONG_RIGHT_PRESS,\n    CesiumEvent.LONG_MIDDLE_PRESS\n  ]);\n\n  private eventsHandler: any;\n  private cesiumEventsObservables = new Map<string, ConnectableObservable<any>>();\n\n  public static getEventFullName(event: CesiumEvent, modifier?: CesiumEventModifier): string {\n    if (modifier) {\n      return `${event}_${modifier}`;\n    } else {\n      return event.toString();\n    }\n  }\n\n  init() {\n    this.eventsHandler = this.cesiumService.getViewer().screenSpaceEventHandler;\n  }\n\n  get(event: CesiumEvent, modifier?: CesiumEventModifier): ConnectableObservable<any> {\n    const eventName = CesiumEventBuilder.getEventFullName(event, modifier);\n    if (this.cesiumEventsObservables.has(eventName)) {\n      return this.cesiumEventsObservables.get(eventName);\n    } else {\n      const eventObserver = this.createCesiumEventObservable(event, modifier);\n      this.cesiumEventsObservables.set(eventName, eventObserver);\n      return eventObserver;\n    }\n  }\n\n  private createCesiumEventObservable(event: CesiumEvent, modifier?: CesiumEventModifier): ConnectableObservable<any> {\n    let cesiumEventObservable: ConnectableObservable<any>;\n    if (CesiumEventBuilder.longPressEvents.has(event)) {\n      cesiumEventObservable = this.createSpecialCesiumEventObservable(event, modifier);\n    } else {\n      cesiumEventObservable = publish()(new CesiumPureEventObserver(event, modifier).init(this.eventsHandler));\n    }\n    cesiumEventObservable.connect();\n    return cesiumEventObservable;\n  }\n\n  private createSpecialCesiumEventObservable(event: CesiumEvent, modifier: CesiumEventModifier): ConnectableObservable<any> {\n    // could support more events if needed\n    return new CesiumLongPressObserver(event, modifier, this).init();\n  }\n}\n\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { AcEntity } from '../../models/ac-entity';\nimport { Subject } from 'rxjs';\nimport { EventResult, Movement } from '../map-events-mananger/map-events-manager';\n\n/**\n * Service for solving plonter.\n * Used by map-event-manager and plonter context component\n */\n@Injectable()\nexport class PlonterService {\n  private _plonterShown: boolean;\n  private _entitesToPlonter: AcEntity[] = [];\n  private _plonterObserver: Subject<EventResult>;\n  private _eventResult: EventResult;\n  private _plonterChangeNotifier: EventEmitter<any> = new EventEmitter();\n\n  constructor() {\n    this._plonterObserver = new Subject<EventResult>();\n  }\n\n  get plonterChangeNotifier(): EventEmitter<any> {\n    return this._plonterChangeNotifier;\n  }\n\n  get plonterShown(): boolean {\n    return this._plonterShown;\n  }\n\n  get entitesToPlonter(): AcEntity[] {\n    return this._entitesToPlonter;\n  }\n\n  get plonterClickPosition(): Movement {\n    return this._eventResult.movement;\n  }\n\n  plonterIt(eventResult: EventResult) {\n    this._eventResult = eventResult;\n    this._entitesToPlonter = eventResult.entities;\n    this._plonterShown = true;\n\n    this._plonterChangeNotifier.emit();\n    return this._plonterObserver;\n  }\n\n  resolvePlonter(entity: AcEntity) {\n    this._plonterShown = false;\n    this._eventResult.entities = [entity];\n\n    this._plonterChangeNotifier.emit();\n    this._plonterObserver.next(this._eventResult);\n  }\n}\n","export const UtilsService = {\n  unique: (array: any[]): any[] => {\n    return array.reduce((accumulator, currentValue) => {\n      if (accumulator.indexOf(currentValue) < 0) {\n        accumulator.push(currentValue);\n      }\n      return accumulator;\n    }, []);\n  }\n};\n\n","import { CesiumEvent } from '../consts/cesium-event.enum';\n\nexport class CesiumDragDropHelper {\n\n  public static dragEvents: Set<CesiumEvent> = new Set([\n    CesiumEvent.LEFT_CLICK_DRAG,\n    CesiumEvent.RIGHT_CLICK_DRAG,\n    CesiumEvent.MIDDLE_CLICK_DRAG\n  ]);\n\n\n  public static getDragEventTypes(dragEvent: CesiumEvent) {\n    let mouseDownEvent;\n    let mouseUpEvent;\n    if (dragEvent === CesiumEvent.LEFT_CLICK_DRAG) {\n      mouseDownEvent = CesiumEvent.LEFT_DOWN;\n      mouseUpEvent = CesiumEvent.LEFT_UP;\n    } else if (dragEvent === CesiumEvent.RIGHT_CLICK_DRAG) {\n      mouseDownEvent = CesiumEvent.RIGHT_DOWN;\n      mouseUpEvent = CesiumEvent.RIGHT_UP;\n    } else if (dragEvent === CesiumEvent.MIDDLE_CLICK_DRAG) {\n      mouseDownEvent = CesiumEvent.MIDDLE_DOWN;\n      mouseUpEvent = CesiumEvent.MIDDLE_UP;\n    }\n\n    return {mouseDownEvent, mouseUpEvent};\n  }\n}\n","import { merge, Observable, of as observableOf, Subject } from 'rxjs';\n\nimport { filter, map, mergeMap, switchMap, takeUntil, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { CesiumService } from '../cesium/cesium.service';\nimport { CesiumEventBuilder } from './cesium-event-builder';\nimport { EventRegistrationInput, PickConfiguration } from './event-registration-input';\nimport { DisposableObservable } from './disposable-observable';\nimport { PickOptions } from './consts/pickOptions.enum';\nimport { CesiumEvent } from './consts/cesium-event.enum';\nimport { PlonterService } from '../plonter/plonter.service';\nimport { UtilsService } from '../../utils/utils.service';\nimport { CesiumDragDropHelper } from './event-observers/cesium-drag-drop-helper';\n\nclass Registration {\n  constructor(public observable: Observable<EventResult>,\n              public  stopper: Subject<any>,\n              public  priority: number,\n              public  isPaused: boolean) {\n  }\n}\n\n/**\n * Returns screen position, drag boolean for drag events only\n */\nexport interface Movement {\n  startPosition: { x: number, y: number };\n  endPosition: { x: number, y: number };\n  drop?: boolean;\n}\n\nexport interface EventResult {\n  movement: Movement;\n  cesiumEntities: any[];\n  entities: any[];\n}\n\n/**\n * Manages all map events. Notice events will run outside of Angular zone.\n * Provided by `<ac-map/>` component there for could be injected at any component under `<ac-map/>` hierarchy\n * or from the `<ac-map/>` component reference `acMapComponent.getMapEventsManager()`\n *\n * __usage:__\n * ```\n * MapEventsManagerService.register({event, modifier, priority, entityType, pickOption}).subscribe()\n * ```\n * __param:__ {CesiumEvent} event\n * __param:__ {CesiumEventModifier} modifier\n * __param:__ priority - the bigger the number the bigger the priority. default : 0.\n * __param:__ entityType - entity type class that you are interested like (Track). the class must extends AcEntity\n * __param:__ pickOption - self explained\n */\n@Injectable()\nexport class MapEventsManagerService {\n\n  private scene: any;\n  private eventRegistrations = new Map<string, Registration[]>();\n\n  constructor(private cesiumService: CesiumService,\n              private eventBuilder: CesiumEventBuilder,\n              private plonterService: PlonterService) {\n  }\n\n  init() {\n    this.eventBuilder.init();\n    this.scene = this.cesiumService.getScene();\n  }\n\n  /**\n   * Register to map event\n   * @param input Event Registration Input\n   *\n   * @returns DisposableObservable<EventResult>\n   */\n  register(input: EventRegistrationInput): DisposableObservable<EventResult> {\n    if (this.scene === undefined) {\n      throw new Error('CesiumService has not been initialized yet - MapEventsManagerService must be injected  under ac-map');\n    }\n\n    input.pick = input.pick || PickOptions.NO_PICK;\n    input.priority = input.priority || 0;\n    input.pickConfig = input.pickConfig || {};\n\n    if (input.entityType && input.pick === PickOptions.NO_PICK) {\n      throw new Error('MapEventsManagerService: can\\'t register an event ' +\n        'with entityType and PickOptions.NO_PICK - It doesn\\'t make sense ');\n    }\n\n    const eventName = CesiumEventBuilder.getEventFullName(input.event, input.modifier);\n\n    if (!this.eventRegistrations.has(eventName)) {\n      this.eventRegistrations.set(eventName, []);\n    }\n\n    const eventRegistration = this.createEventRegistration(input);\n    const registrationObservable: any = eventRegistration.observable;\n    registrationObservable.dispose = () => this.disposeObservable(eventRegistration, eventName);\n    this.eventRegistrations.get(eventName).push(eventRegistration);\n\n    this.sortRegistrationsByPriority(eventName);\n    return <DisposableObservable<EventResult>>registrationObservable;\n  }\n\n  private disposeObservable(eventRegistration: Registration, eventName: string) {\n    eventRegistration.stopper.next(1);\n    const registrations = this.eventRegistrations.get(eventName);\n    const index = registrations.indexOf(eventRegistration);\n    if (index !== -1) {\n      registrations.splice(index, 1);\n    }\n    this.sortRegistrationsByPriority(eventName);\n  }\n\n  private sortRegistrationsByPriority(eventName: string) {\n    const registrations = this.eventRegistrations.get(eventName);\n    registrations.sort((a, b) => b.priority - a.priority);\n    if (registrations.length === 0) {\n      return;\n    }\n\n    // Active registrations by priority\n    const currentPriority = registrations[0].priority;\n    registrations.forEach((registration) => {\n      registration.isPaused = registration.priority < currentPriority;\n    });\n\n  }\n\n  private createEventRegistration({\n                                    event,\n                                    modifier,\n                                    entityType,\n                                    pick: pickOption,\n                                    priority,\n                                    pickFilter,\n                                    pickConfig,\n                                  }: EventRegistrationInput): Registration {\n    const cesiumEventObservable = this.eventBuilder.get(event, modifier);\n    const stopper = new Subject<any>();\n\n    const registration = new Registration(undefined, stopper, priority, false);\n    let observable: Observable<EventResult>;\n\n    if (!CesiumDragDropHelper.dragEvents.has(event)) {\n      observable = cesiumEventObservable.pipe(\n        filter(() => !registration.isPaused),\n        map((movement) => this.triggerPick(movement, pickOption, pickConfig)),\n        filter((result) => result.cesiumEntities !== null || entityType === undefined),\n        map((picksAndMovement) => this.addEntities(picksAndMovement, entityType, pickOption, pickFilter)),\n        filter((result) => result.entities !== null || (entityType === undefined && !pickFilter)),\n        switchMap((entitiesAndMovement) => this.plonter(entitiesAndMovement, pickOption)),\n        takeUntil(stopper));\n    } else {\n      observable = this.createDragEvent({\n        event,\n        modifier,\n        entityType,\n        pick: pickOption,\n        priority,\n        pickFilter,\n        pickConfig\n      }).pipe(takeUntil(stopper));\n    }\n\n    registration.observable = observable;\n    return registration;\n  }\n\n  private createDragEvent({\n                            event,\n                            modifier,\n                            entityType,\n                            pick: pickOption,\n                            priority,\n                            pickFilter,\n                            pickConfig,\n                          }: EventRegistrationInput): Observable<EventResult> {\n    const { mouseDownEvent, mouseUpEvent } = CesiumDragDropHelper.getDragEventTypes(event);\n\n    const mouseUpObservable = this.eventBuilder.get(mouseUpEvent);\n    const mouseMoveObservable = this.eventBuilder.get(CesiumEvent.MOUSE_MOVE);\n\n    const mouseDownRegistration = this.createEventRegistration({\n      event: mouseDownEvent,\n      modifier,\n      entityType,\n      pick: pickOption,\n      priority,\n      pickFilter,\n      pickConfig,\n    });\n\n    const dropSubject = new Subject<EventResult>();\n    const dragObserver = mouseDownRegistration.observable.pipe(mergeMap(e => {\n      let lastMove: any = null;\n      const dragStartPositionX = e.movement.startPosition.x;\n      const dragStartPositionY = e.movement.startPosition.y;\n      return mouseMoveObservable.pipe(map((movement) => {\n        lastMove = {\n          movement: {\n            drop: false,\n            startPosition: {\n              x: dragStartPositionX,\n              y: dragStartPositionY,\n            },\n            endPosition: movement.endPosition,\n          },\n          entities: e.entities,\n          cesiumEntities: e.cesiumEntities\n        };\n        return lastMove;\n      }), takeUntil(mouseUpObservable), tap({\n        complete: () => {\n          // On complete\n          if (lastMove) {\n            const dropEvent = Object.assign({}, lastMove);\n            dropEvent.movement.drop = true;\n            dropSubject.next(dropEvent);\n          }\n        }\n      }));\n    }));\n\n    return merge(dragObserver, dropSubject);\n\n  }\n\n  private triggerPick(movement: any, pickOptions: PickOptions, pickConfig: PickConfiguration) {\n    let picks: any = [];\n    switch (pickOptions) {\n      case PickOptions.PICK_ONE:\n      case PickOptions.PICK_ALL:\n        picks = this.scene.drillPick(movement.endPosition, pickConfig.drillPickLimit, pickConfig.pickWidth, pickConfig.pickHeight);\n        picks = picks.length === 0 ? null : picks;\n        break;\n      case PickOptions.PICK_FIRST:\n        const pick = this.scene.pick(movement.endPosition, pickConfig.pickWidth, pickConfig.pickHeight);\n        picks = pick === undefined ? null : [pick];\n        break;\n      case PickOptions.NO_PICK:\n        break;\n      default:\n        break;\n    }\n\n    // Picks can be cesium entity or cesium primitive\n    if (picks) {\n      picks = picks.map((pick: any) => pick.id && pick.id instanceof Cesium.Entity ? pick.id : pick.primitive);\n    }\n\n    return { movement: movement, cesiumEntities: picks };\n  }\n\n  private addEntities(picksAndMovement: any, entityType: any, pickOption: PickOptions, pickFilter?: (any) => boolean): EventResult {\n\n    if (picksAndMovement.cesiumEntities === null) {\n      picksAndMovement.entities = null;\n      return picksAndMovement;\n    }\n    let entities = [];\n    if (pickOption !== PickOptions.NO_PICK) {\n      if (entityType) {\n        entities = picksAndMovement.cesiumEntities.map((pick: any) => pick.acEntity).filter((acEntity: any) => {\n          return acEntity && acEntity instanceof entityType;\n        });\n      } else {\n        entities = picksAndMovement.cesiumEntities.map((pick: any) => pick.acEntity);\n      }\n\n      entities = UtilsService.unique(entities);\n      entities = (pickFilter && entities) ? entities.filter(pickFilter) : entities;\n      if (entities.length === 0) {\n        entities = null;\n      }\n    }\n\n    picksAndMovement.entities = entities;\n\n    return picksAndMovement;\n  }\n\n  private plonter(entitiesAndMovement: EventResult, pickOption: PickOptions): Observable<EventResult> {\n    if (pickOption === PickOptions.PICK_ONE && entitiesAndMovement.entities !== null && entitiesAndMovement.entities.length > 1) {\n      return this.plonterService.plonterIt(entitiesAndMovement);\n    } else {\n      return observableOf(entitiesAndMovement);\n    }\n  }\n}\n","import { CesiumService } from '../cesium/cesium.service';\nimport { Injectable } from '@angular/core';\n\n@Injectable()\nexport class MapLayersService {\n\n  private layersDataSources: any[] = [];\n\n  constructor(private cesiumService: CesiumService) {\n\n  }\n\n  registerLayerDataSources(dataSources: any[], zIndex: number) {\n    dataSources.forEach(ds => {\n      ds.zIndex = zIndex;\n      this.layersDataSources.push(ds);\n    });\n  }\n\n  drawAllLayers() {\n    this.layersDataSources.sort((a, b) => a.zIndex - b.zIndex);\n\n    this.layersDataSources.forEach((dataSource) => {\n      this.cesiumService.getViewer().dataSources.add(dataSource);\n    });\n  }\n\n  updateAndRefresh(dataSources: any[], newZIndex: number) {\n    if (dataSources && dataSources.length) {\n      dataSources.forEach((ds) => {\n        const index = this.layersDataSources.indexOf(ds);\n        if (index !== -1) {\n          this.layersDataSources[index].zIndex = newZIndex;\n        }\n      });\n\n      this.cesiumService.getViewer().dataSources.removeAll();\n      this.drawAllLayers();\n    }\n  }\n\n  removeDataSources(dataSources: any[]) {\n    dataSources.forEach(ds => {\n      const index = this.layersDataSources.indexOf(ds);\n      if (index !== -1) {\n        this.layersDataSources.splice(index, 1);\n        this.cesiumService.getViewer().dataSources.remove(ds, true);\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { AcMapComponent } from '../../components/ac-map/ac-map.component';\n\n/**\n *  The service manages `ac-map` instances. `ac-map` register itself to this service.\n *  This allows retrieval of maps provided services outside of `ac-map` scope.\n */\n@Injectable()\nexport class MapsManagerService {\n  private defaultIdCounter = 0;\n  private _Maps = new Map<string, AcMapComponent>();\n  private firstMap: any;\n  private eventRemoveCallbacks: Function[] = [];\n\n  constructor() {\n  }\n\n  getMap(id?: string): AcMapComponent | undefined {\n    if (!id) {\n      return this.firstMap;\n    }\n    return this._Maps.get(id);\n  }\n\n  _registerMap(id: string, acMap: AcMapComponent): string {\n    if (!this.firstMap) {\n      this.firstMap = acMap;\n    }\n\n    const mapId = id ? id : this.generateDefaultId();\n    if (this._Maps.has(mapId)) {\n      throw new Error(`Map with id: ${mapId} already exist`);\n    }\n    this._Maps.set(mapId, acMap);\n    return mapId;\n  }\n\n  _removeMapById(id: string) {\n    if (this._Maps.has(id) && this._Maps.get(id) === this.firstMap) {\n      const iter = this._Maps.values();\n      iter.next(); // skip firstMap\n      this.firstMap = iter.next().value;\n    }\n    return this._Maps.delete(id);\n  }\n\n  private generateDefaultId(): string {\n    this.defaultIdCounter++;\n    return 'default-map-id-' + this.defaultIdCounter;\n  }\n\n  /**\n   * Binds multiple 2D map's cameras together.\n   * @param mapsConfiguration - binding options.\n   * mapId - the id of the maps to bind.\n   * sensitivity - the amount the camera position should change in order to sync other maps.\n   * bindZoom - should bind zoom level\n   */\n  sync2DMapsCameras(mapsConfiguration: { id: string; sensitivity?: number; bindZoom?: boolean }[]) {\n    const DEFAULT_SENSITIVITY = 0.01;\n    this.unsyncMapsCameras();\n    const maps: { map: AcMapComponent; options?: { sensitivity?: number; bindZoom?: boolean } }[] = mapsConfiguration.map(config => {\n      const map = this.getMap(config.id);\n      if (!map) {\n        throw new Error(`Couldn't find map with id: ${config.id}`);\n      }\n\n      return {map, options: {sensitivity: config.sensitivity, bindZoom: config.bindZoom}};\n    });\n\n    maps.forEach(masterMapConfig => {\n      const masterMap = masterMapConfig.map;\n      const options = masterMapConfig.options;\n      const masterCamera = masterMap.getCameraService().getCamera();\n      const masterCameraCartographic = masterCamera.positionCartographic;\n      masterCamera.percentageChanged = options.sensitivity || DEFAULT_SENSITIVITY;\n      const removeCallback = masterCamera.changed.addEventListener(() => {\n        maps.forEach(slaveMapConfig => {\n          const slaveMap = slaveMapConfig.map;\n          const slaveMapOptions = slaveMapConfig.options;\n          if (slaveMap === masterMap) {\n            return;\n          }\n\n          const slaveCamera = slaveMap.getCameraService().getCamera();\n          const slaveCameraCartographic = slaveCamera.positionCartographic;\n          const position = Cesium.Ellipsoid.WGS84.cartographicToCartesian({\n            longitude: masterCameraCartographic.longitude,\n            latitude: masterCameraCartographic.latitude,\n            height: slaveMapOptions.bindZoom ? masterCameraCartographic.height : slaveCameraCartographic.height,\n          });\n\n          if (slaveMap.getCesiumViewer().scene.mode !== Cesium.SceneMode.MORPHING) {\n            slaveCamera.setView({\n              destination: position,\n              orientation: {\n                heading: slaveCamera.heading,\n                pitch: slaveCamera.pitch,\n              },\n            });\n          }\n        });\n      });\n      this.eventRemoveCallbacks.push(removeCallback);\n    });\n  }\n\n  /**\n   * Unsyncs maps cameras\n   */\n  unsyncMapsCameras() {\n    this.eventRemoveCallbacks.forEach(removeCallback => removeCallback());\n    this.eventRemoveCallbacks = [];\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../cesium/cesium.service';\n\n/**\n * Take screenshot of your cesium globe.\n *\n * usage:\n * ```typescript\n * // get base 64 data url\n * const dataUrl = screenshotService.getMapScreenshotDataUrl();\n *\n * // or download as png\n * screenshotService.downloadMapScreenshot('my-map.png');\n *\n * ```\n *\n */\n@Injectable()\nexport class ScreenshotService {\n  constructor(private cesiumService: CesiumService) {\n  }\n\n  getMapScreenshotDataUrlBase64() {\n    const canvas = this.cesiumService.getCanvas();\n    return canvas.toDataURL();\n  }\n\n\n  downloadMapScreenshot(filename = 'map.png') {\n    const dataUrl = this.getMapScreenshotDataUrlBase64();\n    this.downloadURI(dataUrl, filename);\n  }\n\n  private downloadURI(uri: string, name: string) {\n    const link = document.createElement('a');\n    link.download = name;\n    link.href = uri;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n}\n","import { DOCUMENT } from '@angular/common';\nimport { AfterViewInit, Component, ElementRef, Inject, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { CesiumService } from '../../services/cesium/cesium.service';\nimport { ConfigurationService } from '../../cesium-enhancements/ConfigurationService';\nimport { SceneMode } from '../../models/scene-mode.enum';\nimport { CameraService } from '../../services/camera/camera.service';\nimport { ContextMenuService } from '../../services/context-menu/context-menu.service';\nimport { CoordinateConverter } from '../../services/coordinate-converter/coordinate-converter.service';\nimport { ArcDrawerService } from '../../services/drawers/arc-drawer/arc-drawer.service';\nimport { BillboardDrawerService } from '../../services/drawers/billboard-drawer/billboard-drawer.service';\nimport { CzmlDrawerService } from '../../services/drawers/czml-drawer/czml-drawer.service';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\nimport { LabelDrawerService } from '../../services/drawers/label-drawer/label-drawer.service';\nimport { PointDrawerService } from '../../services/drawers/point-drawer/point-drawer.service';\nimport { PolygonDrawerService } from '../../services/drawers/polygon-drawer/polygon-drawer.service';\nimport { PolylineDrawerService } from '../../services/drawers/polyline-drawer/polyline-drawer.service';\nimport { PolylinePrimitiveDrawerService } from '../../services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service';\nimport { KeyboardControlService } from '../../services/keyboard-control/keyboard-control.service';\nimport { CesiumEventBuilder } from '../../services/map-events-mananger/cesium-event-builder';\nimport { MapEventsManagerService } from '../../services/map-events-mananger/map-events-manager';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\nimport { MapsManagerService } from '../../services/maps-manager/maps-manager.service';\nimport { PlonterService } from '../../services/plonter/plonter.service';\nimport { ScreenshotService } from '../../services/screenshot/screenshot.service';\n\n/**\n * This is a map implementation, creates the cesium map.\n * Every layer should be tag inside ac-map tag\n *\n * Accessing cesium viewer:\n * 1. acMapComponent.getCesiumViewer()\n * 2. Use MapManagerService.getMap().getCesiumViewer() or if more then one map: MapManagerService.getMap(mapId).getCesiumViewer()\n *\n *\n * @example\n * <ac-map>\n *     <ac-map-layer-provider></ac-map-layer-provider>\n *     <dynamic-ellipse-layer #layer></dynamic-ellipse-layer>\n * </ac-map>\n */\n@Component({\n  selector: 'ac-map',\n  template: `\n    <ac-default-plonter *ngIf=\"!disableDefaultPlonter\"></ac-default-plonter>\n    <ac-context-menu-wrapper></ac-context-menu-wrapper>\n    <ng-content></ng-content>\n  `,\n  providers: [\n    CesiumService,\n    BillboardDrawerService,\n    CesiumEventBuilder,\n    KeyboardControlService,\n    MapEventsManagerService,\n    PlonterService,\n    LabelDrawerService,\n    PolylineDrawerService,\n    PolylinePrimitiveDrawerService,\n    EllipseDrawerService,\n    PointDrawerService,\n    ArcDrawerService,\n    CzmlDrawerService,\n    PolygonDrawerService,\n    MapLayersService,\n    CameraService,\n    ScreenshotService,\n    ContextMenuService,\n    CoordinateConverter,\n  ],\n})\nexport class AcMapComponent implements OnChanges, OnInit, AfterViewInit, OnDestroy {\n  /**\n   * Disable default plonter context menu\n   */\n  @Input()\n  disableDefaultPlonter = false;\n\n  /**\n   * Set the id name of the map\n   * default: 'default-map-id-[index]'\n   */\n  @Input()\n  mapId: string;\n\n  /**\n   * flyTo options according to https://cesiumjs.org/Cesium/Build/Documentation/Camera.html?classFilter=cam#flyTo\n   */\n  @Input()\n  flyTo: any;\n\n  /**\n   * Sets the map's SceneMode\n   */\n  @Input()\n  sceneMode: SceneMode;\n\n  /**\n   * Optional - the container element's id in which the map's canvas will be appended to.\n   * If not supplied - the container element will be the parent element of ac-map;\n   */\n  @Input()\n  containerId: string;\n\n  private mapContainer: HTMLElement;\n\n  constructor(\n    private _cesiumService: CesiumService,\n    private _cameraService: CameraService,\n    private _elemRef: ElementRef,\n    @Inject(DOCUMENT) private document,\n    private mapsManagerService: MapsManagerService,\n    private billboardDrawerService: BillboardDrawerService,\n    private labelDrawerService: LabelDrawerService,\n    private ellipseDrawerService: EllipseDrawerService,\n    private polylineDrawerService: PolylineDrawerService,\n    private polygonDrawerService: PolygonDrawerService,\n    private arcDrawerService: ArcDrawerService,\n    private pointDrawerService: PointDrawerService,\n    private czmlDrawerService: CzmlDrawerService,\n    private mapEventsManager: MapEventsManagerService,\n    private keyboardControlService: KeyboardControlService,\n    private mapLayersService: MapLayersService,\n    private configurationService: ConfigurationService,\n    private screenshotService: ScreenshotService,\n    public contextMenuService: ContextMenuService,\n    private coordinateConverter: CoordinateConverter,\n  ) {\n    this.mapContainer = this.document.createElement('div');\n    this.mapContainer.style.width = '100%';\n    this.mapContainer.style.height = '100%';\n    this.mapContainer.className = 'map-container';\n    this._cesiumService.init(this.mapContainer, this);\n    this._cameraService.init(this._cesiumService);\n    this.mapEventsManager.init();\n    this.billboardDrawerService.init();\n    this.labelDrawerService.init();\n    this.ellipseDrawerService.init();\n    this.polylineDrawerService.init();\n    this.polygonDrawerService.init();\n    this.arcDrawerService.init();\n    this.pointDrawerService.init();\n    this.czmlDrawerService.init();\n    this.keyboardControlService.init();\n    this.contextMenuService.init(this.mapEventsManager);\n  }\n\n  ngOnInit() {\n    this.mapId = this.mapsManagerService._registerMap(this.mapId, this);\n    if (!this.containerId) {\n      this._elemRef.nativeElement.appendChild(this.mapContainer);\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['sceneMode']) {\n      this._cameraService.setSceneMode(changes['sceneMode'].currentValue);\n    }\n    if (changes['flyTo']) {\n      this._cameraService.cameraFlyTo(changes['flyTo'].currentValue);\n    }\n    if (changes['containerId'] && !changes['containerId'].firstChange) {\n      const element = this.document.getElementById(changes['containerId'].currentValue);\n      if (element) {\n        element.appendChild(this.mapContainer);\n      } else {\n        throw new Error(`No element found with id: ${changes['containerId'].currentValue}`);\n      }\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this.mapLayersService.drawAllLayers();\n    if (this.containerId) {\n      setTimeout(() => {\n        const element = this.document.getElementById(this.containerId);\n        if (element) {\n          element.appendChild(this.mapContainer);\n        } else {\n          throw new Error(`No element found with id: ${this.containerId}`);\n        }\n      }, 0);\n    }\n  }\n\n  ngOnDestroy(): void {\n    const viewer = this.getCesiumViewer();\n    viewer.destroy();\n    this.mapContainer.remove();\n    this.mapsManagerService._removeMapById(this.mapId);\n  }\n\n  /**\n   * @returns ac-map's cesium service\n   */\n  getCesiumService() {\n    return this._cesiumService;\n  }\n\n  /**\n   * @returns map's cesium viewer\n   */\n  getCesiumViewer() {\n    return this._cesiumService.getViewer();\n  }\n\n\n  getCameraService(): CameraService {\n    return this._cameraService;\n  }\n\n  getId() {\n    return this.mapId;\n  }\n\n\n  getMapContainer() {\n    return this.mapContainer;\n  }\n\n\n  getMapEventsManager(): MapEventsManagerService {\n    return this.mapEventsManager;\n  }\n\n  getContextMenuService(): ContextMenuService {\n    return this.contextMenuService;\n  }\n\n  getScreenshotService() {\n    return this.screenshotService;\n  }\n\n  getKeyboardControlService() {\n    return this.keyboardControlService;\n  }\n\n  getCoordinateConverter() {\n    return this.coordinateConverter;\n  }\n}\n","import { EventEmitter, Injectable } from '@angular/core';\nimport { IDescription } from '../../models/description';\nimport { LayerOptions } from '../../models/layer-options';\n\n@Injectable()\nexport class LayerService {\n  private _context: any;\n  private _options: LayerOptions;\n  private _show: boolean;\n  private _zIndex: number;\n  private _entityName: string;\n  private _cache = true;\n  private descriptions: IDescription[] = [];\n  private layerUpdate = new EventEmitter();\n\n  get cache(): boolean {\n    return this._cache;\n  }\n\n  set cache(value: boolean) {\n    this._cache = value;\n  }\n\n  get zIndex(): number {\n    return this._zIndex;\n  }\n\n  set zIndex(value: number) {\n    if (value !== this._zIndex) {\n      this.layerUpdate.emit();\n    }\n    this._zIndex = value;\n  }\n\n  get show(): boolean {\n    return this._show;\n  }\n\n  set show(value: boolean) {\n    if (value !== this._show) {\n      this.layerUpdate.emit();\n    }\n    this._show = value;\n  }\n\n  get options(): LayerOptions {\n    return this._options;\n  }\n\n  set options(value: LayerOptions) {\n    this._options = value;\n    this.layerUpdate.emit();\n  }\n\n  get context(): any {\n    return this._context;\n  }\n\n  set context(context) {\n    this._context = context;\n    this.layerUpdate.emit();\n  }\n\n  setEntityName(name: string) {\n    this._entityName = name;\n  }\n\n  getEntityName(): string {\n    return this._entityName;\n  }\n\n  registerDescription(descriptionComponent: IDescription) {\n    if (this.descriptions.indexOf(descriptionComponent) < 0) {\n      this.descriptions.push(descriptionComponent);\n    }\n  }\n\n  unregisterDescription(descriptionComponent: IDescription) {\n    const index = this.descriptions.indexOf(descriptionComponent);\n    if (index > -1) {\n      this.descriptions.splice(index, 1);\n    }\n  }\n\n  getDescriptions(): IDescription[] {\n    return this.descriptions;\n  }\n\n  layerUpdates(): EventEmitter<any> {\n    return this.layerUpdate;\n  }\n}\n","/**\n * Action to do on entity\n */\nexport enum ActionType {\n  ADD_UPDATE,\n  DELETE\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class ComputationCache {\n  private _cache = new Map<string, any>();\n\n  get(expression: string, insertFn: (() => any)): any {\n    if (this._cache.has(expression)) {\n      return this._cache.get(expression);\n    }\n\n    const value = insertFn();\n    this._cache.set(expression, value);\n    return value;\n  }\n\n  clear() {\n    this._cache.clear();\n  }\n}\n","export class Checker {\n  static throwIfAnyNotPresent(values: Object, propertyNames: string[]) {\n    propertyNames.forEach(propertyName => Checker.throwIfNotPresent(values, propertyName));\n  }\n\n  static throwIfNotPresent(value: any, name: string) {\n    if (!Checker.present(value[name])) {\n      throw new Error(`Error: ${name} was not given.`);\n    }\n  }\n\n  static present(value: any) {\n    return value !== undefined && value !== null;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../cesium/cesium.service';\nimport { Checker } from '../../../../utils/checker';\nimport { EllipsePrimitive } from 'primitive-primitives';\nimport { PrimitivesDrawerService } from '../../primitives-drawer/primitives-drawer.service';\n\n\n/**\n *  This drawer is responsible for creating the dynamic version of the ellipse component.\n *  We are using the primitive-primitives implementation of an ellipse. see: https://github.com/gotenxds/Primitive-primitives\n *  This allows us to change the position of the ellipses without creating a new primitive object\n *  as Cesium does not allow updating an ellipse.\n */\n@Injectable()\nexport class DynamicEllipseDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PrimitiveCollection, cesiumService);\n  }\n\n  add(cesiumProps: any): any {\n    Checker.throwIfAnyNotPresent(cesiumProps, ['center', 'semiMajorAxis', 'semiMinorAxis']);\n\n    return super.add(new EllipsePrimitive(cesiumProps));\n  }\n\n  update(ellipse: any, cesiumProps: any): any {\n    ellipse.updateLocationData(cesiumProps);\n\n    return ellipse;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../../primitives-drawer/primitives-drawer.service';\n\n/**\n *  This drawer is responsible for creating the dynamic version of the polyline component.\n */\n@Injectable()\nexport class DynamicPolylineDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PolylineCollection, cesiumService);\n  }\n}\n","import { PrimitivesDrawerService } from '../../primitives-drawer/primitives-drawer.service';\nimport { CesiumService } from '../../../cesium/cesium.service';\n\n/**\n *\n * This drawer is deprecated.\n * General static primitives drawer responsible of drawing static Cesium primitives with material.\n */\nexport abstract class StaticPrimitiveDrawer extends PrimitivesDrawerService {\n  constructor(private geometryType: any, cesiumService: CesiumService) {\n    super(Cesium.PrimitiveCollection, cesiumService);\n  }\n\n  add(geometryProps: any, instanceProps: any, primitiveProps: any): any {\n    if (Object.keys(instanceProps).length === 0) {\n      throw(new Error('instanceProps object is empty'));\n    }\n    instanceProps.geometry = new this.geometryType(geometryProps);\n    primitiveProps.geometryInstances = new Cesium.GeometryInstance(instanceProps);\n    primitiveProps.asynchronous = false;\n    const primitive = new Cesium.Primitive(primitiveProps);\n    return super.add(primitive);\n  }\n\n  update(primitive: any, geometryProps: any, instanceProps: any, primitiveProps: any) {\n    instanceProps.geometry = new this.geometryType(geometryProps);\n    primitiveProps.geometryInstances = new Cesium.GeometryInstance(instanceProps);\n    this._cesiumCollection.remove(primitive);\n    return super.add(new Cesium.Primitive(primitiveProps));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../cesium/cesium.service';\nimport { StaticPrimitiveDrawer } from '../static-primitive-drawer/static-primitive-drawer.service';\n\n/**\n *  This drawer is responsible for creating the static version of the circle component.\n */\n@Injectable()\nexport class StaticCircleDrawerService extends StaticPrimitiveDrawer {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.CircleGeometry, cesiumService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../cesium/cesium.service';\nimport { StaticPrimitiveDrawer } from '../static-primitive-drawer/static-primitive-drawer.service';\n\n/**\n *  This drawer is responsible for creating the static version of the polyline component.\n *  This also allows us to change the color of the polylines.\n */\n@Injectable()\nexport class StaticPolylineDrawerService extends StaticPrimitiveDrawer {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PolylineGeometry, cesiumService);\n  }\n\n  /**\n   * Update function can only change the primitive color.\n   */\n  update(primitive: any, geometryProps: any, instanceProps: any, primitiveProps: any) {\n    const color = instanceProps.attributes.color.value;\n\n    if (primitive.ready) {\n      primitive.getGeometryInstanceAttributes().color = color;\n    } else {\n      Cesium.when(primitive.readyPromise).then((readyPrimitive: any) => {\n        readyPrimitive.getGeometryInstanceAttributes().color.value = color;\n      });\n    }\n\n    return primitive;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { StaticPrimitiveDrawer } from '../static-primitive-drawer/static-primitive-drawer.service';\nimport { CesiumService } from '../../../cesium/cesium.service';\n\n/**\n + This drawer is responsible for drawing a polygon over the Cesium map.\n + This implementation uses simple PolygonGeometry and Primitive parameters.\n + This doesn't allow us to change the position, color, etc.. of the polygons. For that you may use the dynamic polygon component.\n */\n@Injectable()\nexport class StaticPolygonDrawerService extends StaticPrimitiveDrawer {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PolygonGeometry, cesiumService);\n  }\n}\n","import { CesiumService } from '../../../cesium/cesium.service';\nimport { Injectable } from '@angular/core';\nimport { StaticPrimitiveDrawer } from '../static-primitive-drawer/static-primitive-drawer.service';\n\n\n/**\n + *  This drawer is responsible for drawing an ellipse over the Cesium map.\n + *  This implementation uses simple EllipseGeometry and Primitive parameters.\n + *  This doesn't allow us to change the position, color, etc.. of the ellipses. For that you may use the dynamic ellipse component.\n + */\n@Injectable()\nexport class StaticEllipseDrawerService extends StaticPrimitiveDrawer {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.EllipseGeometry, cesiumService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing models.\n */\n@Injectable()\nexport class ModelDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.model);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing box.\n */\n@Injectable()\nexport class BoxDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.box);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing corridors .\n */\n@Injectable()\nexport class CorridorDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.corridor);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing cylinders.\n */\n@Injectable()\nexport class CylinderDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.cylinder);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing ellipsoid.\n */\n@Injectable()\nexport class EllipsoidDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.ellipsoid);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing polylines.\n */\n@Injectable()\nexport class PolylineVolumeDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.polylineVolume);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing polygons.\n */\n@Injectable()\nexport class WallDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.wall);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EntitiesDrawerService } from '../entities-drawer/entities-drawer.service';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { GraphicsType } from '../entities-drawer/enums/graphics-type.enum';\n\n/**\n *  This drawer is responsible for drawing rectangles.\n */\n@Injectable()\nexport class RectangleDrawerService extends EntitiesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(cesiumService, GraphicsType.rectangle);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\n\n/**\n *  This drawer is responsible for drawing labels as primitives.\n *  This drawer is more efficient than LabelDrawerService when drawing dynamic labels.\n */\n@Injectable()\nexport class LabelPrimitiveDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.LabelCollection, cesiumService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\n\n/**\n *  This drawer is responsible for drawing billboards as primitives.\n *  This drawer is more efficient than BillboardDrawerService when drawing dynamic billboards.\n */\n@Injectable()\nexport class BillboardPrimitiveDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.BillboardCollection, cesiumService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\n\n/**\n *  This drawer is responsible of drawing points as primitives.\n *  This drawer is more efficient than PointDrawerService when drawing dynamic points.\n */\n@Injectable()\nexport class PointPrimitiveDrawerService extends PrimitivesDrawerService {\n  constructor(cesiumService: CesiumService) {\n    super(Cesium.PointPrimitiveCollection, cesiumService);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CesiumService } from '../../cesium/cesium.service';\nimport { PrimitivesDrawerService } from '../primitives-drawer/primitives-drawer.service';\n\n@Injectable()\nexport class HtmlDrawerService extends PrimitivesDrawerService {\n  constructor(private _cesiumService: CesiumService) {\n    super(Cesium.HtmlCollection, _cesiumService);\n  }\n\n  add(cesiumProps: any): any {\n    cesiumProps.scene = this._cesiumService.getScene();\n    cesiumProps.mapContainer = this._cesiumService.getMap().getMapContainer();\n    return super.add(cesiumProps);\n  }\n}\n","import { from as observableFrom, merge as observableMerge, Observable, Subject } from 'rxjs';\n\nimport { takeUntil } from 'rxjs/operators';\n// tslint:disable\nimport { BillboardDrawerService } from '../../services/drawers/billboard-drawer/billboard-drawer.service';\nimport { AfterContentInit, ChangeDetectionStrategy, Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { AcNotification } from '../../models/ac-notification';\nimport { ActionType } from '../../models/action-type.enum';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LabelDrawerService } from '../../services/drawers/label-drawer/label-drawer.service';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\nimport { PolylineDrawerService } from '../../services/drawers/polyline-drawer/polyline-drawer.service';\nimport { ArcDrawerService } from '../../services/drawers/arc-drawer/arc-drawer.service';\nimport { PointDrawerService } from '../../services/drawers/point-drawer/point-drawer.service';\nimport { AcEntity } from '../../models/ac-entity';\nimport { BasicDrawerService } from '../../services/drawers/basic-drawer/basic-drawer.service';\nimport { PolygonDrawerService } from '../../services/drawers/polygon-drawer/polygon-drawer.service';\nimport { LayerOptions } from '../../models/layer-options';\nimport { DynamicEllipseDrawerService } from '../../services/drawers/static-dynamic/ellipse-drawer/dynamic-ellipse-drawer.service';\nimport { DynamicPolylineDrawerService } from '../../services/drawers/static-dynamic/dynamic-polyline-drawer/dynamic-polyline-drawer.service';\nimport { StaticCircleDrawerService } from '../../services/drawers/static-dynamic/static-circle-drawer/static-circle-drawer.service';\nimport { StaticPolylineDrawerService } from '../../services/drawers/static-dynamic/static-polyline-drawer/static-polyline-drawer.service';\nimport { StaticPolygonDrawerService } from '../../services/drawers/static-dynamic/static-polygon-drawer/polygon-drawer.service';\nimport { StaticEllipseDrawerService } from '../../services/drawers/static-dynamic/ellipse-drawer/ellipse-drawer.service';\nimport { ModelDrawerService } from '../../services/drawers/model-drawer/model-drawer.service';\nimport { BoxDrawerService } from '../../services/drawers/box-dawer/box-drawer.service';\nimport { CorridorDrawerService } from '../../services/drawers/corridor-dawer/corridor-drawer.service';\nimport { CylinderDrawerService } from '../../services/drawers/cylinder-dawer/cylinder-drawer.service';\nimport { EllipsoidDrawerService } from '../../services/drawers/ellipoid-drawer/ellipsoid-drawer.service';\nimport { PolylineVolumeDrawerService } from '../../services/drawers/polyline-volume-dawer/polyline-volume-drawer.service';\nimport { WallDrawerService } from '../../services/drawers/wall-dawer/wall-drawer.service';\nimport { RectangleDrawerService } from '../../services/drawers/rectangle-dawer/rectangle-drawer.service';\nimport { PolylinePrimitiveDrawerService } from '../../services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service';\nimport { LabelPrimitiveDrawerService } from '../../services/drawers/label-primitive-drawer/label-primitive-drawer.service';\nimport { BillboardPrimitiveDrawerService } from '../../services/drawers/billboard-primitive-drawer/billboard-primitive-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\nimport { PointPrimitiveDrawerService } from '../../services/drawers/point-primitive-drawer/point-primitive-drawer.service';\nimport { HtmlDrawerService } from '../../services/drawers/html-drawer/html-drawer.service';\nimport { CzmlDrawerService } from '../../services/drawers/czml-drawer/czml-drawer.service';\n\n// tslint:enable\n/**\n *  This is a ac-layer implementation.\n *  The ac-layer element must be a child of ac-map element.\n *  + acFor `{string}` - get the tracked observable and entityName (see the example).\n *  + show `{boolean}` - show/hide layer's entities.\n *  + context `{any}` - get the context layer that will use the componnet (most of the time equal to \"this\").\n *  + options `{LayerOptions}` - sets the layer options for each drawer.\n *  + zIndex `{number}` - controls the zIndex (order) of the layer, layers with greater zIndex will be in front of layers with lower zIndex\n *    (Exception For `Billboard` and `Label`, should use `[eyeOffset]` prop instead)</br>\n *    zIndex won't work for pritimitve descs (like ac-primitive-polyline...)\n *  + debug `{boolean}` - prints every acNotification\n *\n *\n *  __Usage :__\n *  ```\n *  <ac-map>\n *    <ac-layer acFor=\"let track of tracks$\" [show]=\"show\" [context]=\"this\" [options]=\"options\" [zIndex]=\"1\">\n *      <ac-billboard-desc props=\"{\n *        image: track.image,\n *        position: track.position,\n *        scale: track.scale,\n *        color: track.color,\n *        name: track.name\n *      }\">\n *      </ac-billboard-desc>\n *        <ac-label-desc props=\"{\n *          position: track.position,\n *          pixelOffset : [-15,20] | pixelOffset,\n *          text: track.name,\n *          font: '15px sans-serif'\n *        }\">\n *      </ac-label-desc>\n *    </ac-layer>\n *  </ac-map>\n *  ```\n */\n@Component({\n  selector: 'ac-layer',\n  template: '<ng-content></ng-content>',\n  providers: [\n    LayerService,\n    ComputationCache,\n    BillboardDrawerService,\n    LabelDrawerService,\n    EllipseDrawerService,\n    PolylineDrawerService,\n    ArcDrawerService,\n    PointDrawerService,\n    PolygonDrawerService,\n    ModelDrawerService,\n    BoxDrawerService,\n    CorridorDrawerService,\n    CylinderDrawerService,\n    EllipsoidDrawerService,\n    PolylineVolumeDrawerService,\n    WallDrawerService,\n    RectangleDrawerService,\n    PolylinePrimitiveDrawerService,\n    LabelPrimitiveDrawerService,\n    BillboardPrimitiveDrawerService,\n    PointPrimitiveDrawerService,\n    HtmlDrawerService,\n    CzmlDrawerService,\n\n    DynamicEllipseDrawerService,\n    DynamicPolylineDrawerService,\n    StaticCircleDrawerService,\n    StaticPolylineDrawerService,\n    StaticPolygonDrawerService,\n    StaticEllipseDrawerService,\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AcLayerComponent implements OnInit, OnChanges, AfterContentInit, OnDestroy {\n  @Input()\n  show = true;\n  @Input()\n  acFor: string;\n  @Input()\n  context: any;\n  @Input()\n  store = false;\n  @Input()\n  options: LayerOptions;\n  @Input()\n  zIndex = 0;\n  @Input()\n  debug = false;\n\n  private readonly acForRgx = /^let\\s+.+\\s+of\\s+.+$/;\n  private entityName: string;\n  private stopObservable = new Subject<any>();\n  private observable: Observable<AcNotification>;\n  private _drawerList: Map<string, BasicDrawerService>;\n  private _updateStream: Subject<AcNotification> = new Subject<AcNotification>();\n  private entitiesStore = new Map<string, any>();\n  private layerDrawerDataSources: any[] = [];\n\n  constructor(private layerService: LayerService,\n              private _computationCache: ComputationCache,\n              private mapLayersService: MapLayersService,\n              billboardDrawerService: BillboardDrawerService,\n              labelDrawerService: LabelDrawerService,\n              ellipseDrawerService: EllipseDrawerService,\n              polylineDrawerService: PolylineDrawerService,\n              polygonDrawerService: PolygonDrawerService,\n              arcDrawerService: ArcDrawerService,\n              pointDrawerService: PointDrawerService,\n              modelDrawerService: ModelDrawerService,\n              boxDrawerService: BoxDrawerService,\n              corridorDrawerService: CorridorDrawerService,\n              cylinderDrawerService: CylinderDrawerService,\n              ellipsoidDrawerSerice: EllipsoidDrawerService,\n              polylineVolumeDrawerService: PolylineVolumeDrawerService,\n              wallDrawerService: WallDrawerService,\n              rectangleDrawerService: RectangleDrawerService,\n              dynamicEllipseDrawerService: DynamicEllipseDrawerService,\n              dynamicPolylineDrawerService: DynamicPolylineDrawerService,\n              staticCircleDrawerService: StaticCircleDrawerService,\n              staticPolylineDrawerService: StaticPolylineDrawerService,\n              staticPolygonDrawerService: StaticPolygonDrawerService,\n              staticEllipseDrawerService: StaticEllipseDrawerService,\n              polylinePrimitiveDrawerService: PolylinePrimitiveDrawerService,\n              labelPrimitiveDrawerService: LabelPrimitiveDrawerService,\n              billboardPrimitiveDrawerService: BillboardPrimitiveDrawerService,\n              pointPrimitiveDrawerService: PointPrimitiveDrawerService,\n              htmlDrawerService: HtmlDrawerService,\n              czmlDrawerService: CzmlDrawerService\n  ) {\n    this._drawerList = new Map([\n      ['billboard', billboardDrawerService],\n      ['label', labelDrawerService],\n      ['ellipse', ellipseDrawerService],\n      ['polyline', polylineDrawerService],\n      ['polygon', polygonDrawerService as BasicDrawerService],\n      ['arc', arcDrawerService],\n      ['point', pointDrawerService],\n      ['model', modelDrawerService],\n      ['box', boxDrawerService],\n      ['corridor', corridorDrawerService],\n      ['cylinder', cylinderDrawerService],\n      ['ellipsoid', ellipsoidDrawerSerice],\n      ['polylineVolume', polylineVolumeDrawerService],\n      ['rectangle', rectangleDrawerService],\n      ['wall', wallDrawerService],\n      ['polylinePrimitive', polylinePrimitiveDrawerService],\n      ['labelPrimitive', labelPrimitiveDrawerService],\n      ['billboardPrimitive', billboardPrimitiveDrawerService],\n      ['pointPrimitive', pointPrimitiveDrawerService],\n      ['html', htmlDrawerService],\n      ['czml', czmlDrawerService],\n\n      ['dynamicEllipse', dynamicEllipseDrawerService],\n      ['dynamicPolyline', dynamicPolylineDrawerService],\n      ['staticCircle', staticCircleDrawerService],\n      ['staticPolyline', staticPolylineDrawerService],\n      ['staticPolygon', staticPolygonDrawerService],\n      ['staticEllipse', staticEllipseDrawerService],\n    ]);\n  }\n\n  init() {\n    this.initValidParams();\n\n    observableMerge(this._updateStream, this.observable).pipe<AcNotification>(takeUntil(this.stopObservable)).subscribe((notification) => {\n      this._computationCache.clear();\n\n      if (this.debug) {\n        console.log('AcLayer received notification:', notification);\n      }\n\n      let contextEntity = notification.entity;\n      if (this.store) {\n        contextEntity = this.updateStore(notification);\n      }\n\n      this.context[this.entityName] = contextEntity;\n      this.layerService.getDescriptions().forEach((descriptionComponent) => {\n        switch (notification.actionType) {\n          case ActionType.ADD_UPDATE:\n            descriptionComponent.draw(this.context, notification.id, contextEntity);\n            break;\n          case ActionType.DELETE:\n            descriptionComponent.remove(notification.id);\n            break;\n          default:\n            console.error('[ac-layer] unknown AcNotification.actionType for notification: ' + notification);\n        }\n      });\n    });\n  }\n\n  private updateStore(notification: AcNotification): any {\n    if (notification.actionType === ActionType.DELETE) {\n      this.entitiesStore.delete(notification.id);\n      return undefined;\n    } else {\n      if (this.entitiesStore.has(notification.id)) {\n        const entity = this.entitiesStore.get(notification.id);\n        Object.assign(entity, notification.entity);\n        return entity;\n      } else {\n        this.entitiesStore.set(notification.id, notification.entity);\n        return notification.entity;\n      }\n    }\n  }\n\n  private initValidParams() {\n    if (!this.context) {\n      throw new Error('ac-layer: must initialize [context] ');\n    }\n\n    if (!this.acForRgx.test(this.acFor)) {\n      throw new Error(`ac-layer: Invalid [acFor] syntax. Expected: [acFor]=\"let item of observable\" .Instead received: ${this.acFor}`);\n    }\n    const acForArr = this.acFor.split(' ');\n    this.observable = this.context[acForArr[3]];\n    this.entityName = acForArr[1];\n    if (!this.isObservable(this.observable)) {\n      throw new Error('ac-layer: must initailize [acFor] with rx observable, instead received: ' + this.observable);\n    }\n\n    this.layerService.context = this.context;\n    this.layerService.setEntityName(this.entityName);\n  }\n\n  /** Test for a rxjs Observable */\n  private isObservable(obj: any): boolean {\n    /* check via duck-typing rather than instance of\n     * to allow passing between window contexts */\n    return obj && typeof obj.subscribe === 'function';\n  }\n\n  ngAfterContentInit(): void {\n    this.init();\n  }\n\n  ngOnInit(): void {\n    this.layerService.context = this.context;\n    this.layerService.options = this.options;\n    this.layerService.show = this.show;\n    this.layerService.zIndex = this.zIndex;\n    this._drawerList.forEach((drawer, drawerName) => {\n      const initOptions = this.options ? this.options[drawerName] : undefined;\n      const drawerDataSources = drawer.init(initOptions);\n      // only entities drawers create data sources\n      if (drawerDataSources) {\n        // this.mapLayersService.registerLayerDataSources(drawerDataSources, this.zIndex);\n        // TODO: Check if the following line causes Bad Performance\n        this.layerDrawerDataSources.push(...drawerDataSources);\n      }\n      drawer.setShow(this.show);\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.show && !changes.show.firstChange) {\n      const showValue = changes['show'].currentValue;\n      this.layerService.show = showValue;\n      this._drawerList.forEach((drawer) => drawer.setShow(showValue));\n    }\n\n    if (changes.zIndex && !changes.zIndex.firstChange) {\n      const zIndexValue = changes['zIndex'].currentValue;\n      this.layerService.zIndex = zIndexValue;\n      this.mapLayersService.updateAndRefresh(this.layerDrawerDataSources, zIndexValue);\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.mapLayersService.removeDataSources(this.layerDrawerDataSources);\n    this.stopObservable.next(true);\n    this.removeAll();\n  }\n\n  getLayerService(): LayerService {\n    return this.layerService;\n  }\n\n  /**\n   * Returns an array of DataSources registered by a drawer of this layer\n   * @return Array of Cesium.DataSources\n   */\n  getLayerDrawerDataSources(): any[] {\n    return this.layerDrawerDataSources;\n  }\n\n  /**\n   * Returns an Array of DataSources of the drawer with the provided DataSource.name\n   * Example: getDataSourceOfDrawer('polyline') returns the dataSource of polyline drawer\n   * @return Array of Cesium.DataSources\n   */\n  getDrawerDataSourcesByName(name: string): any[] {\n    return this.layerDrawerDataSources.filter(d => d.name === name);\n  }\n\n  /**\n   * Returns the store.\n   */\n  getStore(): Map<string, any> {\n    return this.entitiesStore;\n  }\n\n  /**\n   * Remove all the entities from the layer.\n   */\n  removeAll(): void {\n    this.layerService.getDescriptions().forEach((description) => description.removeAll());\n    this.entitiesStore.clear();\n  }\n\n  /**\n   * remove entity from the layer\n   */\n  remove(entityId: string) {\n    this._updateStream.next({id: entityId, actionType: ActionType.DELETE});\n    this.entitiesStore.delete(entityId);\n  }\n\n  /**\n   * add/update entity to/from the layer\n   */\n  updateNotification(notification: AcNotification): void {\n    this._updateStream.next(notification);\n  }\n\n  /**\n   * add/update entity to/from the layer\n   */\n  update(entity: AcEntity, id: string): void {\n    this._updateStream.next({entity, id, actionType: ActionType.ADD_UPDATE});\n  }\n\n  refreshAll(collection: AcNotification[]): void {\n    // TODO make entity interface: collection of type entity not notification\n    observableFrom(collection).subscribe((entity) => this._updateStream.next(entity));\n  }\n}\n","import { Input, OnChanges, OnDestroy, OnInit, SimpleChanges, Directive } from '@angular/core';\nimport { BasicDrawerService } from '../drawers/basic-drawer/basic-drawer.service';\nimport { MapLayersService } from '../map-layers/map-layers.service';\n\n/**\n *  Extend this class to create drawing on map components.\n */\n@Directive()\nexport class EntityOnMapComponent implements OnInit, OnChanges, OnDestroy {\n  @Input()\n  props: any;\n\n  protected selfPrimitive: any;\n  protected selfPrimitiveIsDraw: boolean;\n  protected dataSources: any;\n\n  constructor(protected _drawer: BasicDrawerService, private mapLayers: MapLayersService) {\n  }\n\n  ngOnInit(): void {\n    this.selfPrimitiveIsDraw = false;\n    const dataSources = this._drawer.init();\n    if (dataSources) {\n      this.dataSources = dataSources;\n      // this.mapLayers.registerLayerDataSources(dataSources, 0);\n    }\n    this.drawOnMap();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    const props = changes['props'];\n    if (props.currentValue !== props.previousValue) {\n      this.updateOnMap();\n    }\n  }\n\n  drawOnMap() {\n    this.selfPrimitiveIsDraw = true;\n    return this.selfPrimitive = this._drawer.add(this.props);\n  }\n\n  removeFromMap() {\n    this.selfPrimitiveIsDraw = false;\n    return this._drawer.remove(this.selfPrimitive);\n  }\n\n  updateOnMap() {\n    if (this.selfPrimitiveIsDraw) {\n      return this._drawer.update(this.selfPrimitive, this.props);\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.mapLayers.removeDataSources(this.dataSources);\n    this.removeFromMap();\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { BillboardDrawerService } from '../../services/drawers/billboard-drawer/billboard-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a billboard implementation.\n *  The element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and BillboardGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/BillboardGraphics.html\n *\n *  __Usage :__\n *  ```\n *    <ac-billboard [props]=\"{\n *      image: image,\n *      position: position,\n *      scale: scale,\n *      color: color,\n *      name: name\n *    }\">;\n *    </ac-billboard>\n *  ```\n */\n\n@Component({\n  selector: 'ac-billboard',\n  template: '',\n})\nexport class AcBillboardComponent extends EntityOnMapComponent {\n\n  constructor(billboardDrawer: BillboardDrawerService, mapLayers: MapLayersService) {\n    super(billboardDrawer, mapLayers);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { JsonStringMapper } from 'json-string-mapper';\n\n@Injectable()\nexport class JsonMapper {\n  private _mapper: JsonStringMapper;\n\n  constructor() {\n    this._mapper = new JsonStringMapper();\n  }\n\n  map(expression: string): Map<string, string> {\n    return this._mapper.map(expression);\n  }\n}\n","/**\n * Service for effective assignment.\n */\nexport class SmartAssigner {\n\n  static create(props: string[] = [], allowUndefined: boolean = true): (obj1: Object, obj2: Object) => Object {\n    let fnBody = ``;\n\n    props.forEach(prop => {\n      if (!allowUndefined) {\n        // tslint:disable-next-line:max-line-length\n        fnBody += `if (!(obj1['${prop}'] instanceof Cesium.CallbackProperty) && obj2['${prop}'] !== undefined) { obj1['${prop}'] = obj2['${prop}']; } `;\n      } else {\n        fnBody += `if(!(obj1['${prop}'] instanceof Cesium.CallbackProperty))obj1['${prop}'] = obj2['${prop}']; `;\n      }\n    });\n\n    fnBody += `return obj1`;\n    const assignFn = new Function('obj1', 'obj2', fnBody);\n\n    return function smartAssigner(obj1: Object, obj2: Object) {\n      return assignFn(obj1, obj2);\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { JsonMapper } from '../json-mapper/json-mapper.service';\nimport { Parse } from 'angular2parse';\nimport { SmartAssigner } from '../smart-assigner/smart-assigner.service';\nimport { ComputationCache } from '../computation-cache/computation-cache.service';\n\n@Injectable()\nexport class CesiumProperties {\n  private _assignersCache = new Map<string, (oldVal: Object, newVal: Object) => Object>();\n  private _evaluatorsCache = new Map<string, (cache: ComputationCache, context: Object) => Object>();\n\n  constructor(private _parser: Parse,\n              private _jsonMapper: JsonMapper) {\n  }\n\n  _compile(expression: string, withCache = true): (cache: ComputationCache, context: Object) => Object {\n    const cesiumDesc = {};\n    const propsMap = new Map<string, { expression: string, get: Function }>();\n\n    const resultMap = this._jsonMapper.map(expression);\n\n    resultMap.forEach((resultExpression, prop) => propsMap.set(prop, {\n      expression: resultExpression,\n      get: this._parser.eval(resultExpression)\n    }));\n\n    propsMap.forEach((value, prop) => {\n      if (withCache) {\n        cesiumDesc[prop || 'undefined'] = `cache.get(\\`${value.expression}\\`, () => propsMap.get('${prop}').get(context))`;\n      } else {\n        cesiumDesc[prop || 'undefined'] = `propsMap.get('${prop}').get(context)`;\n      }\n    });\n\n    const fnBody = `return ${JSON.stringify(cesiumDesc).replace(/\"/g, '')};`;\n    const getFn = new Function('propsMap', 'cache', 'context', fnBody);\n\n    return function evaluateCesiumProps(cache: ComputationCache, context: Object): Object {\n      return getFn(propsMap, cache, context);\n    };\n  }\n\n  _build(expression: string): (oldVal: Object, newVal: Object) => Object {\n    const props = Array.from(this._jsonMapper.map(expression).keys());\n    const smartAssigner = SmartAssigner.create(props);\n\n    return function assignCesiumProps(oldVal: Object, newVal: Object) {\n      return smartAssigner(oldVal, newVal);\n    };\n  }\n\n  createEvaluator(expression: string, withCache = true, newEvaluator = false): (cache: ComputationCache, context: Object) => Object {\n    if (!newEvaluator && this._evaluatorsCache.has(expression)) {\n      return this._evaluatorsCache.get(expression);\n    }\n\n    const evaluatorFn = this._compile(expression, withCache);\n    this._evaluatorsCache.set(expression, evaluatorFn);\n\n    return evaluatorFn;\n  }\n\n  createAssigner(expression: string): (oldVal: Object, newVal: Object) => Object {\n    if (this._assignersCache.has(expression)) {\n      return this._assignersCache.get(expression);\n    }\n\n    const assignFn = this._build(expression);\n    this._assignersCache.set(expression, assignFn);\n\n    return assignFn;\n  }\n}\n","import { EventEmitter, Input, OnDestroy, OnInit, Output, Directive } from '@angular/core';\nimport { LayerService } from '../layer-service/layer-service.service';\nimport { ComputationCache } from '../computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../cesium-properties/cesium-properties.service';\nimport { AcEntity } from '../../models/ac-entity';\nimport { BasicDrawerService } from '../drawers/basic-drawer/basic-drawer.service';\nimport { IDescription } from '../../models/description';\n\nexport interface OnDrawParams {\n  acEntity: AcEntity;\n  entityId: string;\n  cesiumEntity: any;\n}\n\n/**\n *  the ancestor class for creating components.\n *  extend this class to create desc component.\n */\n@Directive()\nexport class BasicDesc implements OnInit, OnDestroy, IDescription {\n  @Input()\n  props: any;\n\n  @Output()\n  onDraw: EventEmitter<OnDrawParams> = new EventEmitter<OnDrawParams>();\n\n  @Output()\n  onRemove: EventEmitter<OnDrawParams> = new EventEmitter<OnDrawParams>();\n\n  protected _cesiumObjectsMap: Map<string, any> = new Map<string, any>();\n  private _propsEvaluateFn: Function;\n  private _propsAssignerFn: Function;\n\n  constructor(protected _drawer: BasicDrawerService,\n              protected _layerService: LayerService,\n              protected _computationCache: ComputationCache,\n              protected _cesiumProperties: CesiumProperties) {\n  }\n\n  protected _propsEvaluator(context: Object): any {\n    return this._propsEvaluateFn(this._computationCache, context);\n  }\n\n  protected _getPropsAssigner(): (cesiumObject: Object, desc: Object) => Object {\n    return (cesiumObject: Object, desc: Object) => this._propsAssignerFn(cesiumObject, desc);\n  }\n\n  getLayerService(): LayerService {\n    return this._layerService;\n  }\n\n  setLayerService(layerService: LayerService) {\n    this._layerService.unregisterDescription(this);\n    this._layerService = layerService;\n    this._layerService.registerDescription(this);\n    this._propsEvaluateFn = this._cesiumProperties.createEvaluator(this.props, this._layerService.cache, true);\n    this._propsAssignerFn = this._cesiumProperties.createAssigner(this.props);\n  }\n\n  ngOnInit(): void {\n    if (!this.props) {\n      console.error('ac-desc components error: [props] input is mandatory');\n    }\n\n    this._layerService.registerDescription(this);\n    this._propsEvaluateFn = this._cesiumProperties.createEvaluator(this.props, this._layerService.cache);\n    this._propsAssignerFn = this._cesiumProperties.createAssigner(this.props);\n  }\n\n  public getCesiumObjectsMap(): Map<string, any> {\n    return this._cesiumObjectsMap;\n  }\n\n  draw(context: any, id: string, entity: AcEntity): void {\n    const cesiumProps = this._propsEvaluator(context);\n\n    if (!this._cesiumObjectsMap.has(id)) {\n      const cesiumObject = this._drawer.add(cesiumProps);\n      this.onDraw.emit({\n        acEntity: entity,\n        cesiumEntity: cesiumObject,\n        entityId: id,\n      });\n      cesiumObject.acEntity = entity; // set the entity on the cesiumObject for later usage\n      this._cesiumObjectsMap.set(id, cesiumObject);\n    } else {\n      const cesiumObject = this._cesiumObjectsMap.get(id);\n      this.onDraw.emit({\n        acEntity: entity,\n        cesiumEntity: cesiumObject,\n        entityId: id,\n      });\n      cesiumObject.acEntity = entity; // set the entity on the cesiumObject for later usage\n      this._drawer.setPropsAssigner(this._getPropsAssigner());\n      this._drawer.update(cesiumObject, cesiumProps);\n    }\n  }\n\n  remove(id: string) {\n    const cesiumObject = this._cesiumObjectsMap.get(id);\n    if (cesiumObject) {\n      this.onRemove.emit({\n        acEntity: cesiumObject.acEntity,\n        cesiumEntity: cesiumObject,\n        entityId: id,\n      });\n      this._drawer.remove(cesiumObject);\n      this._cesiumObjectsMap.delete(id);\n    }\n  }\n\n  removeAll() {\n    this._cesiumObjectsMap.clear();\n    this._drawer.removeAll();\n  }\n\n  ngOnDestroy() {\n    this._layerService.unregisterDescription(this);\n    this.removeAll();\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { BillboardDrawerService } from '../../services/drawers/billboard-drawer/billboard-drawer.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\n\n/**\n *  This is a billboard implementation.\n *  The element must be a child of ac-layer element.\n *  The properties of props are the same as the properties of Entity and BillboardGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/BillboardGraphics.html\n *\n *  __Usage :__\n *  ```\n *    <ac-billboard-desc props=\"{\n *      image: track.image,\n *      position: track.position,\n *      scale: track.scale,\n *      color: track.color,\n *      name: track.name\n *    }\">\n *    </ac-billboard-desc>\n *  ```\n */\n\n@Component({\n  selector: 'ac-billboard-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcBillboardDescComponent)}],\n})\nexport class AcBillboardDescComponent extends BasicDesc {\n\n  constructor(billboardDrawer: BillboardDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(billboardDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\n\n/**\n *  This is an ellipse implementation.\n *  The element must be a child of ac-layer element.\n *  _Set `height` prop for performance enhancement_\n *  The properties of props are the same as the properties of Entity and EllipseGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/EllipseGraphics.html\n *\n *  __Usage :__\n *  ```\n *    <ac-ellipse-desc props=\"{\n *      position: data.position,\n *      semiMajorAxis:250000.0,\n *      semiMinorAxis:400000.0,\n *      height: 0\n *    }\">\n *    </ac-ellipse-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-ellipse-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcEllipseDescComponent)}],\n})\nexport class AcEllipseDescComponent extends BasicDesc {\n  constructor(ellipseDrawer: EllipseDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(ellipseDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { PolylineDrawerService } from '../../services/drawers/polyline-drawer/polyline-drawer.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\n\n/**\n *  This is a polyline implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and PolylineGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PolylineGraphics.html\n *\n *  __Usage:__\n *  ```\n *    <ac-polyline-desc props=\"{\n *      width : polyline.width,\n *      positions: polyline.positions,\n *      material: polyline.material\n *    }\">\n *    </ac-polyline-desc>\n * ```\n */\n@Component({\n  selector: 'ac-polyline-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcPolylineDescComponent)}],\n})\nexport class AcPolylineDescComponent extends BasicDesc {\n\n  constructor(dynamicPolylineDrawerService: PolylineDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(dynamicPolylineDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n/**\n * @example\n * <ac-label-desc props=\"{\n *            position: track.position,\n *            pixelOffset : [-15,20] | pixelOffset,\n *            text: track.name,\n *            font: '15px sans-serif'\n *    }\">\n * </ac-label-desc>\n */\n@Pipe({\n  name: 'pixelOffset'\n})\nexport class PixelOffsetPipe implements PipeTransform {\n\n  transform(value: any, args?: any): any {\n    return new Cesium.Cartesian2(value[0], value[1]);\n  }\n\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'radiansToDegrees'\n})\nexport class RadiansToDegreesPipe implements PipeTransform {\n\n  transform(value: any, args?: any): number {\n    return (360 - Math.round(180 * value / Math.PI)) % 360;\n  }\n\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { LabelDrawerService } from '../../services/drawers/label-drawer/label-drawer.service';\n\n/**\n *  This is a label implementation.\n *  The ac-label element must be a child of ac-layer element.\n *  The properties of props are the same as the properties of Entity and LabelGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html\n *\n *  __Usage :__\n *  ```\n *    <ac-label-desc props=\"{\n *      position: track.position,\n *      pixelOffset : [-15,20] | pixelOffset,\n *      text: track.name,\n *      font: '15px sans-serif'\n *    }\">\n *    </ac-label-desc>\n *  ```\n */\n\n@Component({\n  selector: 'ac-label-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcLabelDescComponent)}],\n})\nexport class AcLabelDescComponent extends BasicDesc {\n\n  constructor(labelDrawer: LabelDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(labelDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [CommonModule],\n  providers: []\n})\nexport class UtilsModule {\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\n\n/**\n *  This is a circle implementation.\n *  The element must be a child of ac-layer element.\n *  semiMajorAxis ans semiMinorAxis are replaced with radius property.\n *  All other properties of props are the same as the properties of Entity and EllipseGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/EllipseGraphics.html\n *\n *__Usage :__\n *  ```\n *    <ac-circle-desc props=\"{\n *      position: data.position,\n *      radius: 5\n *      granularity:0.08 // Optional\n *    }\">\n *    </ac-circle-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-circle-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcCircleDescComponent)}],\n})\nexport class AcCircleDescComponent extends BasicDesc {\n  constructor(ellipseDrawer: EllipseDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(ellipseDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n  protected _propsEvaluator(context: Object): any {\n    const cesiumProps = super._propsEvaluator(context);\n\n    cesiumProps.semiMajorAxis = cesiumProps.radius;\n    cesiumProps.semiMinorAxis = cesiumProps.radius;\n    delete cesiumProps.radius;\n\n    return cesiumProps;\n  }\n\n  protected _getPropsAssigner(): (cesiumObject: Object, desc: Object) => Object {\n    return (cesiumObject: Object, desc: Object) => Object.assign(cesiumObject, desc);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { ArcDrawerService } from '../../services/drawers/arc-drawer/arc-drawer.service';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\n\n/**\n *  This is an implementation of an arc.\n *  The element must be a child of ac-layer element.\n *  An arc is not cesium natively implemented and therefore it's API doesn't appear anywhere\n *\n *  __Usage :__\n *  ```\n *    <ac-arc-desc props=\"{\n *          center: arc.center,\n *          angle: arc.angle,\n *          delta: arc.delta,\n *          radius: arc.radius,\n *          color : arc.color - The color should be Cesium.Color type\n *    }\">\n *    </ac-arc-desc>\n *    ```\n *\n *    description of the props :\n *    center - The arc is a section of an outline of a circle, This is the center of the circle\n *    angle - the initial angle of the arc in radians\n *    delta - the spreading of the arc,\n *    radius - the distance from the center to the arc\n *\n *    for example :\n *    angle - 0\n *    delta - Ï€\n *\n *    will draw an half circle\n */\n\n@Component({\n  selector: 'ac-arc-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcArcDescComponent)}],\n})\nexport class AcArcDescComponent extends BasicDesc {\n\n  constructor(arcDrawer: ArcDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(arcDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n}\n","/**\n * Angular Cesium parent entity, all entities should inherit from it.\n * ```typescript\n * entity= new AcEntity({\n *  \tid: 0,\n *  \tname: 'click me',\n *  \tposition: Cesium.Cartesian3.fromRadians(0.5, 0.5),\n * });\n * ```\n */\nexport class AcEntity {\n\n  /**\n   * Creates entity from a json\n   * @param json entity object\n   * @returns entity as AcEntity\n   */\n  static create(json?: any) {\n    if (json) {\n      return Object.assign(new AcEntity(), json);\n    }\n    return new AcEntity();\n  }\n\n  /**\n   * Creates entity from a json\n   * @param json (Optional) entity object\n   */\n  constructor(json?: any) {\n    Object.assign(this, json);\n  }\n}\n","import { ActionType } from './action-type.enum';\nimport { AcEntity } from './ac-entity';\n\n/**\n * Interface of  Angular2Cesium notification.\n * ac-layer receives an observer of AcNotifications\n */\nexport interface AcNotification {\n  id: string;\n  entity?: AcEntity;\n  actionType: ActionType;\n}\n\nexport class AcNotification {\n  id: string;\n  entity?: AcEntity;\n  actionType: ActionType;\n}\n","export enum MapLayerProviderOptions {\n  ArcGisMapServer = Cesium.ArcGisMapServerImageryProvider,\n  WebMapTileService = Cesium.WebMapTileServiceImageryProvider,\n  MapTileService = Cesium.TileMapServiceImageryProvider,\n  WebMapService = Cesium.WebMapServiceImageryProvider,\n  SingleTileImagery = Cesium.SingleTileImageryProvider,\n  OpenStreetMap = Cesium.OpenStreetMapImageryProvider,\n  BingMaps = Cesium.BingMapsImageryProvider,\n  GoogleEarthEnterpriseMaps = Cesium.GoogleEarthEnterpriseMapsProvider,\n  MapBox = Cesium.MapboxImageryProvider,\n  MapboxStyleImageryProvider = Cesium.MapboxStyleImageryProvider,\n  UrlTemplateImagery = Cesium.UrlTemplateImageryProvider,\n  OFFLINE = null,\n}\n","export enum MapTerrainProviderOptions {\n  CesiumTerrain = Cesium.CesiumTerrainProvider,\n  ArcGISTiledElevation = Cesium.ArcGISTiledElevationTerrainProvider,\n  GoogleEarthEnterprise = Cesium.GoogleEarthEnterpriseTerrainProvider,\n  VRTheWorld = Cesium.VRTheWorldTerrainProvider,\n  Ellipsoid = Cesium.EllipsoidTerrainProvider,\n  WorldTerrain = Cesium.createWorldTerrain\n}\n","import { Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { CesiumService } from '../../services/cesium/cesium.service';\nimport { Checker } from '../../utils/checker';\nimport { MapLayerProviderOptions } from '../../models';\n\n/**\n *  This component is used for adding a map provider service to the map (ac-map)\n *  options according to selected map provider MapLayerProviderOptions enum.\n *  additional setting can be done with cesium imageryLayer (exposed as class member)\n *  check out: https://cesiumjs.org/Cesium/Build/Documentation/ImageryLayer.html\n *  and: https://cesiumjs.org/Cesium/Build/Documentation/ImageryLayerCollection.html\n *\n *\n *  __Usage :__\n *  ```\n *    <ac-map-layer-provider [options]=\"optionsObject\" [provider]=\"myProvider\">\n *    </ac-map-layer-provider>\n *  ```\n */\n@Component({\n  selector: 'ac-map-layer-provider',\n  template: '',\n})\nexport class AcMapLayerProviderComponent implements OnInit, OnChanges, OnDestroy {\n\n  /**\n   * refer to cesium docs for details https://cesiumjs.org/Cesium/Build/Documentation/ImageryProvider.html\n   */\n  @Input()\n  options: { url?: string } = {};\n\n  /**\n   * the provider\n   */\n  @Input()\n  provider: any = MapLayerProviderOptions.OFFLINE;\n\n  /**\n   * index (optional) - The index to add the layer at. If omitted, the layer will added on top of all existing layers.\n   */\n  @Input()\n  index: Number;\n\n  /**\n   * show (optional) - Determines if the map layer is shown.\n   */\n  @Input()\n  show = true;\n\n  /**\n   * The alpha blending value of this layer: 0.0 to 1.0\n   */\n  @Input()\n  alpha = 1.0;\n\n  /**\n   * The brightness of this layer: 0.0 to 1.0\n   */\n  @Input()\n  brightness = 1.0;\n\n  /**\n   * The contrast of this layer: 0.0 to 1.0\n   */\n  @Input()\n  contrast = 1.0;\n\n  public imageryLayer: any;\n  public imageryLayersCollection: any;\n  public layerProvider: any;\n\n  constructor(private cesiumService: CesiumService) {\n    this.imageryLayersCollection = this.cesiumService.getScene().imageryLayers;\n  }\n\n  private createOfflineMapProvider() {\n    return Cesium.createTileMapServiceImageryProvider({\n      url: Cesium.buildModuleUrl('Assets/Textures/NaturalEarthII')\n    });\n  }\n\n  ngOnInit() {\n    if (!Checker.present(this.options.url) && this.provider !== MapLayerProviderOptions.OFFLINE) {\n      throw new Error('options must have a url');\n    }\n    switch (this.provider) {\n      case MapLayerProviderOptions.WebMapService:\n      case MapLayerProviderOptions.WebMapTileService:\n      case MapLayerProviderOptions.ArcGisMapServer:\n      case MapLayerProviderOptions.SingleTileImagery:\n      case MapLayerProviderOptions.BingMaps:\n      case MapLayerProviderOptions.GoogleEarthEnterpriseMaps:\n      case MapLayerProviderOptions.MapBox:\n      case MapLayerProviderOptions.MapboxStyleImageryProvider:\n      case MapLayerProviderOptions.UrlTemplateImagery:\n      case MapLayerProviderOptions.MapTileService:\n      case MapLayerProviderOptions.OpenStreetMap:\n        this.layerProvider = new this.provider(this.options);\n        break;\n      case MapLayerProviderOptions.OFFLINE:\n        this.layerProvider = this.createOfflineMapProvider();\n        break;\n      default:\n        console.log('ac-map-layer-provider: [provider] wasn\\'t found. setting OFFLINE provider as default');\n        this.layerProvider = this.createOfflineMapProvider();\n        break;\n    }\n    if (this.show) {\n      this.imageryLayer = this.imageryLayersCollection.addImageryProvider(this.layerProvider, this.index);\n      this.imageryLayer.alpha = this.alpha;\n      this.imageryLayer.contrast = this.contrast;\n      this.imageryLayer.brightness = this.brightness;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['show'] && !changes['show'].isFirstChange()) {\n      const showValue = changes['show'].currentValue;\n      if (showValue) {\n        if (this.imageryLayer) {\n          this.imageryLayersCollection.add(this.imageryLayer, this.index);\n        } else {\n          this.imageryLayer = this.imageryLayersCollection.addImageryProvider(this.layerProvider, this.index);\n          this.imageryLayer.alpha = this.alpha;\n          this.imageryLayer.contrast = this.contrast;\n          this.imageryLayer.brightness = this.brightness;\n        }\n      } else if (this.imageryLayer) {\n        this.imageryLayersCollection.remove(this.imageryLayer, false);\n      }\n    }\n\n    if (changes['alpha'] && !changes['alpha'].isFirstChange() && this.imageryLayer) {\n      this.imageryLayer.alpha = this.alpha;\n    }\n    if (changes['contrast'] && !changes['contrast'].isFirstChange() && this.imageryLayer) {\n      this.imageryLayer.contrast = this.contrast;\n    }\n    if (changes['brightness'] && !changes['brightness'].isFirstChange() && this.imageryLayer) {\n      this.imageryLayer.brightness = this.brightness;\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.imageryLayer) {\n      this.imageryLayersCollection.remove(this.imageryLayer, true);\n    }\n  }\n}\n","import { Component, OnInit, Input, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\nimport { CesiumService } from '../../services/cesium/cesium.service';\nimport { Checker } from '../../utils/checker';\nimport { MapTerrainProviderOptions } from '../../models/map-terrain-provider-options.enum';\n\n/**\n *  This component is used for adding a terrain provider service to the map (ac-map)\n *  options according to selected terrain provider MapTerrainProviderOptions enum.\n *\n *\n *  __Usage :__\n *  ```\n *    <ac-map-terrain-provider [options]=\"optionsObject\" [provider]=\"myProvider\">\n *    </ac-map-terrain-provider>\n *  ```\n */\n@Component({\n  selector: 'ac-map-terrain-provider',\n  template: '',\n})\nexport class AcMapTerrainProviderComponent implements OnInit, OnChanges, OnDestroy {\n\n  /**\n   * refer to cesium docs for details https://cesiumjs.org/Cesium/Build/Documentation/TerrainProvider.html\n   */\n  @Input()\n  options: { url?: string } = {};\n\n  /**\n   * the provider\n   */\n  @Input()\n  provider: any;\n\n  /**\n   * show (optional) - Determines if the map layer is shown.\n   */\n  @Input()\n  show = true;\n\n  private terrainProvider: any;\n  private defaultTerrainProvider: any;\n\n  constructor(private cesiumService: CesiumService) {\n  }\n\n  ngOnInit(): void {\n    if (!Checker.present(this.options.url)\n      && this.provider !== MapTerrainProviderOptions.Ellipsoid\n      && this.provider !== MapTerrainProviderOptions.WorldTerrain) {\n      throw new Error('options must have a url');\n    }\n    this.defaultTerrainProvider = this.cesiumService.getViewer().terrainProvider;\n    switch (this.provider) {\n      case MapTerrainProviderOptions.CesiumTerrain:\n      case MapTerrainProviderOptions.ArcGISTiledElevation:\n      case MapTerrainProviderOptions.GoogleEarthEnterprise:\n      case MapTerrainProviderOptions.VRTheWorld:\n      case MapTerrainProviderOptions.Ellipsoid:\n        this.terrainProvider = new this.provider(this.options);\n        break;\n      case MapTerrainProviderOptions.WorldTerrain:\n        this.terrainProvider = this.provider(this.options);\n        break;\n      default:\n        console.log('ac-map-terrain-provider: [provider] wasn\\'t found. setting OFFLINE provider as default');\n        this.terrainProvider = this.defaultTerrainProvider;\n        break;\n    }\n    if (this.show) {\n      this.cesiumService.getViewer().terrainProvider = this.terrainProvider;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['show'] && !changes['show'].isFirstChange()) {\n      const showValue = changes['show'].currentValue;\n      if (showValue) {\n        if (this.terrainProvider) {\n          this.cesiumService.getViewer().terrainProvider = this.terrainProvider;\n        }\n      } else {\n        this.cesiumService.getViewer().terrainProvider = this.defaultTerrainProvider;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.cesiumService.getViewer().terrainProvider = this.defaultTerrainProvider;\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { PointDrawerService } from '../../services/drawers/point-drawer/point-drawer.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\n\n/**\n *  This is a point implementation.\n *  The ac-label element must be a child of ac-layer element.\n *  The properties of props are the same as the properties of Entity and PointGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PointGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-point-desc props=\"{\n *     pixelSize : point.pixelSize, //optional\n *     position : point.positions,\n *     color : point.color  //optional\n *   }\">\n *   </ac-point-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-point-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcPointDescComponent)}],\n})\nexport class AcPointDescComponent extends BasicDesc {\n\n  constructor(pointDrawerService: PointDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(pointDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { LabelDrawerService } from '../../services/drawers/label-drawer/label-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a label implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and LabelGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/LabelGraphics.html\n *\n *  __Usage:__\n *  ```\n *  <ac-label [props]=\"{\n *    position: position,\n *    text: 'labelText',\n *    font: '30px sans-serif',\n *    fillColor : aquamarine\n *  }\">\n *  </ac-label>;\n *  ```\n */\n\n@Component({\n  selector: 'ac-label',\n  template: '',\n})\nexport class AcLabelComponent extends EntityOnMapComponent {\n\n  constructor(labelDrawer: LabelDrawerService, mapLayers: MapLayersService) {\n    super(labelDrawer, mapLayers);\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\nimport { PolylineDrawerService } from '../../services/drawers/polyline-drawer/polyline-drawer.service';\n\n/**\n *  This is a polyline implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Polyline Primitive:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Polyline.html\n *\n *  __Usage:__\n *  ```\n *  <ac-polyline [props]=\"{\n *    position: position,\n *    text: 'labelText',\n *    font: '30px sans-serif'\n *    color: Cesium.Color.GREEN\n *  }\">;\n *  </ac-polyline>\n *  ```\n */\n\n@Component({\n  selector: 'ac-polyline',\n  template: '',\n})\nexport class AcPolylineComponent extends EntityOnMapComponent {\n\n  constructor(polylineDrawer: PolylineDrawerService, mapLayers: MapLayersService) {\n    super(polylineDrawer, mapLayers);\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is an ellipse implementation.\n *  The element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and EllipseGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/EllipseGraphics.html\n *\n *  __Usage:__\n *  ```\n *  <ac-ellipse [props]=\"{\n *    position: position,\n *    semiMajorAxis:40000.0,\n *    semiMinorAxis:25000.0,\n *    rotation : 0.785398\n *  }\">\n *  </ac-ellipse>\n *  ```\n */\n\n@Component({\n  selector: 'ac-ellipse',\n  template: '',\n})\nexport class AcEllipseComponent extends EntityOnMapComponent {\n\n  constructor(ellipseDrawer: EllipseDrawerService, mapLayers: MapLayersService) {\n    super(ellipseDrawer, mapLayers);\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { PointDrawerService } from '../../services/drawers/point-drawer/point-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a point implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and PointGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PointGraphics.html\n *\n *  __Usage:__\n *  ```\n *  <ac-point [props]=\"{\n *    position: position,\n *    width: 3\n *  }\">\n *  </ac-point>\n *  ```\n */\n\n@Component({\n  selector: 'ac-point',\n  template: '',\n})\nexport class AcPointComponent extends EntityOnMapComponent {\n\n  constructor(pointDrawer: PointDrawerService, mapLayers: MapLayersService) {\n    super(pointDrawer, mapLayers);\n  }\n}\n","import { Component, DoCheck, ElementRef, Input, OnDestroy, OnInit, Renderer2 } from '@angular/core';\nimport { CesiumService } from '../../services/cesium/cesium.service';\n\n/**\n *  This is an html implementation.\n *  The ac-html element must be a child of ac-map element.\n *  __Usage:__\n *  ```\n *  <ac-html [props]=\"{position: position, show: true}\">;\n *    <p>html element</p>\n *  </ac-html>\n *  ```\n */\n\n@Component({\n  selector: 'ac-html',\n  template: `<ng-content></ng-content>`,\n  styles: [`:host {\n                position: absolute;\n                z-index: 100;\n\t\t\t\t}`]\n})\nexport class AcHtmlComponent implements DoCheck, OnDestroy, OnInit {\n\n\n  @Input() props: any;\n  private isDraw = false;\n  preRenderEventListener: () => void;\n\n  constructor(private cesiumService: CesiumService, private elementRef: ElementRef, private renderer: Renderer2) {\n  }\n\n  setScreenPosition(screenPosition: any) {\n    if (screenPosition) {\n      this.renderer.setStyle(this.elementRef.nativeElement, 'top', `${screenPosition.y}px`);\n      this.renderer.setStyle(this.elementRef.nativeElement, 'left', `${screenPosition.x}px`);\n    }\n  }\n\n  ngOnInit(): void {\n    this.cesiumService.getMap().getMapContainer().appendChild(this.elementRef.nativeElement);\n    if (this.props.show === false) {\n      this.hideElement();\n    }\n  }\n\n  remove() {\n    if (this.isDraw) {\n      this.isDraw = false;\n      this.cesiumService.getScene().preRender.removeEventListener(this.preRenderEventListener);\n      this.hideElement();\n    }\n  }\n\n  hideElement() {\n    this.renderer.setStyle(this.elementRef.nativeElement, 'display', `none`);\n  }\n\n  add() {\n    if (!this.isDraw) {\n      this.isDraw = true;\n      this.preRenderEventListener = () => {\n        const screenPosition = Cesium.SceneTransforms.wgs84ToWindowCoordinates(this.cesiumService.getScene(),\n          this.props.position);\n        this.setScreenPosition(screenPosition);\n      };\n      this.renderer.setStyle(this.elementRef.nativeElement, 'display', `block`);\n      this.cesiumService.getScene().preRender.addEventListener(this.preRenderEventListener);\n    }\n  }\n\n  ngDoCheck() {\n    if (this.props.show === undefined || this.props.show) {\n      this.add();\n    } else {\n      this.remove();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.remove();\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a circle implementation.\n *  The element must be a child of ac-map element.\n *  semiMajorAxis ans semiMinorAxis are replaced with radius property.\n *  All other properties of props are the same as the properties of Entity and EllipseGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/EllipseGraphics.html\n *\n *  __Usage:__\n *  ```\n *  <ac-circle [props]=\"{\n *    position: position,\n *    radius:40000.0,\n *    granularity:0.03,\n *  }\">\n *  </ac-circle>\n *  ```\n */\n\n@Component({\n  selector: 'ac-circle',\n  template: '',\n})\nexport class AcCircleComponent extends EntityOnMapComponent {\n\n  constructor(ellipseDrawerService: EllipseDrawerService, mapLayers: MapLayersService) {\n    super(ellipseDrawerService, mapLayers);\n  }\n\n  private updateEllipseProps() {\n    this.props.semiMajorAxis = this.props.radius;\n    this.props.semiMinorAxis = this.props.radius;\n    this.props.rotation = 0.0;\n  }\n\n  drawOnMap() {\n    this.updateEllipseProps();\n    super.drawOnMap();\n  }\n\n  updateOnMap() {\n    this.updateEllipseProps();\n    super.updateOnMap();\n  }\n}\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { ArcDrawerService } from '../../services/drawers/arc-drawer/arc-drawer.service';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is an implementation of an arc.\n *  The element must be a child of ac-map element.\n *  An arc is not natively implemented in cesium.\n *\n *  __Usage :__\n *  ```\n *    <ac-arc-desc geometryProps=\"{\n *          center: arc.center,\n *          angle: arc.angle,\n *          delta: arc.delta,\n *          radius: arc.radius\n *       }\"\n *       instanceProps=\"{\n *          attributes: arc.attributes\n *       }\"\n *       primitiveProps=\"{\n *          appearance: arc.appearance\n *       }\">\n *    </ac-arc-desc>\n *    ```\n */\n\n@Component({\n  selector: 'ac-arc',\n  template: '',\n})\nexport class AcArcComponent extends EntityOnMapComponent implements OnChanges {\n\n  @Input()\n  geometryProps: any;\n  @Input()\n  instanceProps: any;\n  @Input()\n  primitiveProps: any;\n\n  constructor(arcDrawer: ArcDrawerService, mapLayers: MapLayersService) {\n    super(arcDrawer, mapLayers);\n  }\n\n  updateOnMap() {\n    if (this.selfPrimitiveIsDraw) {\n      this.removeFromMap();\n      this.drawOnMap();\n    }\n  }\n\n  drawOnMap() {\n    this.selfPrimitiveIsDraw = true;\n    return this.selfPrimitive = this._drawer.add(this.geometryProps, this.instanceProps, this.primitiveProps);\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    const geometryProps = changes['geometryProps'];\n    const instanceProps = changes['instanceProps'];\n    const primitiveProps = changes['primitiveProps'];\n    if (geometryProps.currentValue !== geometryProps.previousValue ||\n      instanceProps.currentValue !== instanceProps.previousValue ||\n      primitiveProps.currentValue !== primitiveProps.previousValue) {\n      this.updateOnMap();\n    }\n  }\n}\n","import { Component, forwardRef, OnInit } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { PolygonDrawerService } from '../../services/drawers/polygon-drawer/polygon-drawer.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\n\n/**\n *  This is a polygon implementation.\n *  The properties of props are the same as the properties of Entity and PolygonGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PolygonGraphics.html\n *\n *  __Usage:__\n *  ```\n *    <ac-polygon-desc props=\"{\n *      hierarchy: polygon.hierarchy,\n *      material: polygon.material,\n *      height: polygon.height\n *    }\">\n *    </ac-polygon-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-polygon-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcPolygonDescComponent)}],\n})\nexport class AcPolygonDescComponent extends BasicDesc implements OnInit {\n\n  constructor(polygonDrawer: PolygonDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(polygonDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { PlonterService } from '../../services/plonter/plonter.service';\nimport { CoordinateConverter } from '../../services/coordinate-converter/coordinate-converter.service';\n\n@Component(\n  {\n    selector: 'ac-default-plonter',\n    template: `\n      <ac-html *ngIf=\"plonterService.plonterShown\" [props]=\"{\n        position: plonterPosition\n      }\">\n        <div class=\"plonter-context-menu\">\n          <div *ngFor=\"let entity of plonterService.entitesToPlonter\">\n            <div class=\"plonter-item\" (click)=\"chooseEntity(entity)\">{{ entity?.name || entity?.id }}\n            </div>\n          </div>\n        </div>\n      </ac-html>\n    `,\n    styles: [`\n        .plonter-context-menu {\n            background-color: rgba(250, 250, 250, 0.8);\n            box-shadow: 1px 1px 5px 0px rgba(0, 0, 0, 0.15);\n        }\n\n        .plonter-item {\n            cursor: pointer;\n            padding: 2px 15px;\n            text-align: start;\n        }\n\n        .plonter-item:hover {\n            background-color: rgba(0, 0, 0, 0.15);\n        }\n\n    `],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [CoordinateConverter],\n  }\n)\nexport class AcDefaultPlonterComponent implements OnInit {\n\n  constructor(public plonterService: PlonterService,\n              private cd: ChangeDetectorRef,\n              private geoConverter: CoordinateConverter) {\n  }\n\n  ngOnInit() {\n    this.plonterService.plonterChangeNotifier.subscribe(() => this.cd.detectChanges());\n  }\n\n  get plonterPosition() {\n    if (this.plonterService.plonterShown) {\n      const screenPos = this.plonterService.plonterClickPosition.endPosition;\n      return this.geoConverter.screenToCartesian3(screenPos);\n    }\n  }\n\n  chooseEntity(entity: any) {\n    this.plonterService.resolvePlonter(entity);\n  }\n}\n","import { Component } from '@angular/core';\nimport { PolygonDrawerService } from '../../services/drawers/polygon-drawer/polygon-drawer.service';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a polygon implementation.\n *  The ac-label element must be a child of ac-map element.\n *  _Set `height` prop for performance enhancement_\n *  The properties of props are the same as the properties of Entity and PolygonGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PolygonGraphics.html\n *\n *  __Usage:__\n *  ```\n *    <ac-polygon props=\"{\n *      hierarchy: polygon.hierarchy,\n *      material: polygon.material,\n *      height: polygon.height\n *    }\">\n *    </ac-polygon>\n *  ```\n */\n@Component({\n  selector: 'ac-polygon',\n  template: '',\n})\nexport class AcPolygonComponent extends EntityOnMapComponent {\n  constructor(polygonDrawer: PolygonDrawerService, mapLayers: MapLayersService) {\n    super(polygonDrawer, mapLayers);\n  }\n}\n","import { Input, OnInit, Directive } from '@angular/core';\nimport { BasicDesc } from '../basic-desc/basic-desc.service';\nimport { LayerService } from '../layer-service/layer-service.service';\nimport { ComputationCache } from '../computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../cesium-properties/cesium-properties.service';\nimport { StaticPrimitiveDrawer } from '../drawers/static-dynamic/static-primitive-drawer/static-primitive-drawer.service';\nimport { AcEntity } from '../../models/ac-entity';\n\n@Directive()\nexport class BasicStaticPrimitiveDesc extends BasicDesc implements OnInit {\n  @Input()\n  geometryProps: any;\n  @Input()\n  instanceProps: any;\n  @Input()\n  primitiveProps: any;\n\n  private _geometryPropsEvaluator: Function;\n  private _instancePropsEvaluator: Function;\n  private _primitivePropsEvaluator: Function;\n\n  constructor(protected _staticPrimitiveDrawer: StaticPrimitiveDrawer, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(_staticPrimitiveDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n  ngOnInit(): void {\n    this._layerService.registerDescription(this);\n\n    this._geometryPropsEvaluator = this._cesiumProperties.createEvaluator(this.geometryProps);\n    this._instancePropsEvaluator = this._cesiumProperties.createEvaluator(this.instanceProps);\n    this._primitivePropsEvaluator = this._cesiumProperties.createEvaluator(this.primitiveProps);\n  }\n\n  draw(context: any, id: string, entity: AcEntity): any {\n    const geometryProps = this._geometryPropsEvaluator(this._computationCache, context);\n    const instanceProps = this._instancePropsEvaluator(this._computationCache, context);\n    const primitiveProps = this._primitivePropsEvaluator(this._computationCache, context);\n\n    if (!this._cesiumObjectsMap.has(id)) {\n      const primitive = this._staticPrimitiveDrawer.add(geometryProps, instanceProps, primitiveProps);\n      primitive.acEntity = entity; // set the entity on the primitive for later usage\n      this._cesiumObjectsMap.set(id, primitive);\n    } else {\n      const primitive = this._cesiumObjectsMap.get(id);\n      this._staticPrimitiveDrawer.update(primitive, geometryProps, instanceProps, primitiveProps);\n    }\n  }\n}\n","import { Component } from '@angular/core';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { BasicStaticPrimitiveDesc } from '../../../services/basic-primitive-desc/basic-static-primitive-desc.service';\nimport { StaticEllipseDrawerService } from '../../../services/drawers/static-dynamic/ellipse-drawer/ellipse-drawer.service';\n\n/**\n *\n * @deprecated use ac-ellipse-desc instead\n *\n *  This is a static (position, color, etc.. are not updated) implementation of an ellipse.\n *  __usage:__\n *  ```\n *  &lt;ac-static-ellipse-desc-desc\n *      geometryProps=\"{\n *          center: ellipse.geometry.center,\n *          semiMajorAxis: ellipse.geometry.semiMajorAxis,\n *          semiMinorAxis: ellipse.geometry.semiMinorAxis,\n *          height: ellipse.geometry.height,\n *          rotation: ellipse.geometry.rotation\n *      }\"\n *      instanceProps=\"{\n *          attributes: ellipse.attributes //Optional\n *      }\"\n *      primitiveProps=\"{\n *          appearance: ellipse.appearance //Optional\n *      }\"&gt;\n *  &lt;/ac-static-ellipse-desc-desc&gt;\n *  ```\n */\n@Component({\n  selector: 'ac-static-ellipse-desc',\n  template: ''\n})\nexport class AcStaticEllipseDescComponent extends BasicStaticPrimitiveDesc {\n  constructor(ellipseDrawer: StaticEllipseDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(ellipseDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { BasicDesc } from '../../../services/basic-desc/basic-desc.service';\nimport { DynamicEllipseDrawerService } from '../../../services/drawers/static-dynamic/ellipse-drawer/dynamic-ellipse-drawer.service';\n\n/**\n *\n *\n *  This is a dynamic(position is updatable) implementation of an ellipse.\n *\n *  __Usage :__\n *  ```\n *    &lt;ac-dynamic-ellipse-desc props=\"{\n *      center: data.position,\n *      semiMajorAxis:250000.0,\n *      semiMinorAxis:400000.0,\n *      rotation : 0.785398,\n *      width:3, // Optional\n *      granularity:0.08 // Optional\n *      }\"&gt;\n *    \">\n *    &lt;/ac-dynamic-ellipse-desc&gt;\n *  ```\n *  __param:__ {Cesium.Cartesian3} center\n *  __param:__ {number} semiMajorAxis\n *  __param:__ {number} semiMinorAxis\n *  __param:__ {number} rotation\n *   __param__: {number} [1] width\n *   __param__: {number} [0.003] granularity\n */\n@Component({\n  selector: 'ac-dynamic-ellipse-desc',\n  template: '',\n})\nexport class AcDynamicEllipseDescComponent extends BasicDesc {\n  constructor(ellipseDrawer: DynamicEllipseDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(ellipseDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","// tslint:disable\nimport { Component } from '@angular/core';\nimport { BasicDesc } from '../../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { DynamicPolylineDrawerService } from '../../../services/drawers/static-dynamic/dynamic-polyline-drawer/dynamic-polyline-drawer.service';\n\n// tslint:enable\n/**\n * @deprecated use ac-polylinc-desc instead\n *\n *  This is a dynamic(position is updatable) implementation of an polyline.\n *  The ac-dynamic-polyline-desc element must be a child of ac-layer element.\n *  __Usage:__\n *  ```\n *    &lt;ac-dynamic-polyline-desc props=\"{width : polyline.width, //optional\n *                                      positions: polyline.positions,\n *                                      material: polyline.material //optional\n *                                      }\"\n *    &gt;\n *    &lt;/ac-dynamic-polyline-desc&gt;\n * ```\n */\n@Component({\n  selector: 'ac-dynamic-polyline-desc',\n  template: ''\n})\nexport class AcDynamicPolylineDescComponent extends BasicDesc {\n\n  constructor(dynamicPolylineDrawerService: DynamicPolylineDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(dynamicPolylineDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","// tslint:disable\nimport { Component } from '@angular/core';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { BasicStaticPrimitiveDesc } from '../../../services/basic-primitive-desc/basic-static-primitive-desc.service';\nimport { StaticPolygonDrawerService } from '../../../services/drawers/static-dynamic/static-polygon-drawer/polygon-drawer.service';\n\n// tslint:enable\n/**\n * @deprecated use ac-ploygon-desc instead\n *\n *  This is a static (position, color, etc.. are not updated) implementation of a polygon.\n *  __Usage:__\n *  ```\n *    &lt;ac-static-polygon-desc\n *          geometryProps=\"{\n *                     polygonHierarchy: polygon.geometry.polygonHierarchy,\n *                     height: polygon.geometry.height,\n *                     granularity: polygon.geometry.granularity\n *                 }\"\n *          instanceProps=\"{\n *                     attributes: polygon.attributes\n *                 }\"\n *          primitiveProps=\"{\n *                     appearance: polygon.appearance\n *                 }\"\n *    &gt;&lt;/ac-static-polygon-desc&gt;\n *    ```\n */\n@Component({\n  selector: 'ac-static-polygon-desc',\n  template: '',\n})\nexport class AcStaticPolygonDescComponent extends BasicStaticPrimitiveDesc {\n  constructor(polygonDrawer: StaticPolygonDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(polygonDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { BasicStaticPrimitiveDesc } from '../../../services/basic-primitive-desc/basic-static-primitive-desc.service';\nimport { StaticCircleDrawerService } from '../../../services/drawers/static-dynamic/static-circle-drawer/static-circle-drawer.service';\n\n/**\n * @deprecated use ac-circle-desc\n *\n *  This is a static (position, color, etc.. are not updated) implementation of an circle.\n *  __usage:__\n *  ```\n *    &lt;ac-static-circle-desc\n *      geometryProps=\"{\n *          center: circle.geometry.center,\n *          radius: circle.geometry.radius,\n *      }\"\n *      instanceProps=\"{\n *          attributes: circle.attributes //Optional\n *      }\"\n *      primitiveProps=\"{\n *          appearance: circle.appearance //Optional\n *      }\"&gt;\n *    &lt;/ac-static-circle-desc&gt;\n *    ```\n */\n@Component({\n  selector: 'ac-static-circle',\n  template: ''\n})\nexport class AcStaticCircleDescComponent extends BasicStaticPrimitiveDesc {\n  constructor(staticCircleDrawer: StaticCircleDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(staticCircleDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { BasicDesc } from '../../../services/basic-desc/basic-desc.service';\nimport { DynamicEllipseDrawerService } from '../../../services/drawers/static-dynamic/ellipse-drawer/dynamic-ellipse-drawer.service';\n\n/**\n * @deprecated use ac-circle-desc instead\n *\n *  This is a dynamic(position is updatable) implementation of an circle.\n __Usage :__\n *  ```\n *    &lt;ac-dynamic-circle-desc props=\"{\n *      center: data.position,\n *      radius: 5\n *      rotation : 0.785398,\n *      width:3, // Optional\n *      granularity:0.08 // Optional\n *      }\"&gt;\n *    &lt;/ac-dynamic-circle-desc&gt;\n *  ```\n *\n *  __param__: {Cesium.Cartesian3} center\n *   __param__: {number} rotation\n *   __param__: {number} radius in meters\n *   __param__: {number} [1] width\n *   __param__: {number} [0.003] granularity\n */\n@Component({\n  selector: 'ac-dynamic-circle-desc',\n  template: ''\n})\nexport class AcDynamicCircleDescComponent extends BasicDesc {\n  constructor(ellipseDrawer: DynamicEllipseDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(ellipseDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n  protected _propsEvaluator(context: Object): any {\n    const cesiumProps = super._propsEvaluator(context);\n\n    cesiumProps.semiMajorAxis = cesiumProps.radius;\n    cesiumProps.semiMinorAxis = cesiumProps.radius;\n\n    return cesiumProps;\n  }\n}\n","// tslint:disable\nimport { Component } from '@angular/core';\nimport { StaticPolylineDrawerService } from '../../../services/drawers/static-dynamic/static-polyline-drawer/static-polyline-drawer.service';\nimport { LayerService } from '../../../services/layer-service/layer-service.service';\nimport { CesiumProperties } from '../../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../../services/computation-cache/computation-cache.service';\nimport { BasicStaticPrimitiveDesc } from '../../../services/basic-primitive-desc/basic-static-primitive-desc.service';\n\n// tslint:enable\n\n/**\n * @deprecated use ac-ployline-desc instead\n *\n *  This is a static implementation of an polyline.\n *  __usage:__\n *  ```\n *    &ltac-static-polyline-desc\n *            geometryProps=\"{\n *            \twidth: poly.geometry.width,\n *            \tpositions: poly.geometry.positions\n *            }\"\n *            instanceProps=\"{\n *              attributes: {\n *                  Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromRandom())\n *              }\n *            }\"\n *            primitiveProps=\"{\n *              appearance: new Cesium.PolylineColorAppearance()\n *    }\"&gt&lt/ac-static-polyline-desc&gt\n *  ```\n */\n@Component({\n  selector: 'ac-static-polyline-desc',\n  template: ''\n})\nexport class AcStaticPolylineDescComponent extends BasicStaticPrimitiveDesc {\n  constructor(polylineDrawerService: StaticPolylineDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(polylineDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef, OnInit } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ModelDrawerService } from '../../services/drawers/model-drawer/model-drawer.service';\n\n/**\n *  This is a model implementation.\n *  The ac-model element must be a child of ac-layer element.\n *  The properties of props are the same as the properties of Entity and ModelGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/ModelGraphics.html\n *\n *  __Usage:__\n *  ```\n *    <ac-model-desc props=\"{\n *       position : Cesium.Cartesian3.fromDegrees(-123.0744619, 44.0503706),\n *       uri : '../../SampleData/models/CesiumGround/Cesium_Ground.gltf'\n *   }\n *    }\">\n *    </ac-model-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-model-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcModelDescComponent)}],\n})\nexport class AcModelDescComponent extends BasicDesc implements OnInit {\n\n  constructor(modelDrawer: ModelDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(modelDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { CesiumService } from '../../services/cesium/cesium.service';\nimport { Checker } from '../../utils/checker';\n\n/**\n *  This component is used for adding a 3d tileset layer to the map (ac-map).\n *  options according to `Cesium3DTileset` definition.\n *  check out: https://cesiumjs.org/Cesium/Build/Documentation/Cesium3DTileset.html\n *\n *\n *  __Usage :__\n *  ```\n *    <ac-3d-tile-layer [options]=\"optionsObject\">\n *    </ac-3d-tile-layer>\n *  ```\n */\n@Component({\n  selector: 'ac-3d-tile-layer',\n  template: '',\n})\nexport class AcTileset3dComponent implements OnInit, OnChanges, OnDestroy {\n  /**\n   * refer to cesium docs for details https://cesiumjs.org/Cesium/Build/Documentation/Cesium3DTileset.html\n   */\n  @Input()\n  options: { url?: string } = {};\n\n  /**\n   * index (optional) - The index to add the layer at. If omitted, the layer will added on top of all existing layers.\n   */\n  @Input()\n  index: Number;\n\n  /**\n   * show (optional) - Determines if the map layer is shown.\n   */\n  @Input()\n  show = true;\n\n  /**\n   * show (optional) - Sets 3Dtiles style.\n   */\n  @Input()\n  style: any;\n\n  public tilesetInstance: any = null;\n  private _3dtilesCollection: any;\n\n  constructor(private cesiumService: CesiumService) {\n  }\n\n  ngOnInit() {\n    if (!Checker.present(this.options.url)) {\n      throw new Error('Options must have a url');\n    }\n\n    this._3dtilesCollection = new Cesium.PrimitiveCollection();\n    this.cesiumService.getScene().primitives.add(this._3dtilesCollection);\n\n    if (this.show) {\n      this.tilesetInstance = this._3dtilesCollection.add(new Cesium.Cesium3DTileset(this.options), this.index);\n      if (this.style) {\n        this.tilesetInstance.style = new Cesium.Cesium3DTileStyle(this.style);\n      }\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['show'] && !changes['show'].isFirstChange()) {\n      const showValue = changes['show'].currentValue;\n\n      if (showValue) {\n        if (this.tilesetInstance) {\n          this._3dtilesCollection.add(this.tilesetInstance, this.index);\n        } else {\n          this.tilesetInstance = this._3dtilesCollection.add(new Cesium.Cesium3DTileset(this.options), this.index);\n          if (this.style) {\n            this.tilesetInstance.style = new Cesium.Cesium3DTileStyle(this.style);\n          }\n        }\n      } else if (this.tilesetInstance) {\n        this._3dtilesCollection.remove(this.tilesetInstance, false);\n      }\n    }\n    if (changes['style'] && !changes['style'].isFirstChange()) {\n      const styleValue = changes['style'].currentValue;\n      if (this.tilesetInstance) {\n        this.tilesetInstance.style = new Cesium.Cesium3DTileStyle(this.style);\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.tilesetInstance) {\n      this._3dtilesCollection.remove(this.tilesetInstance, false);\n    }\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { BoxDrawerService } from '../../services/drawers/box-dawer/box-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-box-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity (like `position`)\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/BoxGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-box-desc props=\"{\n *     show : point.show, //optional\n *     position : point.positions,\n *     material : point.color  //optional\n *   }\">\n *   </ac-box-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-box-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcBoxDescComponent)}],\n})\nexport class AcBoxDescComponent extends BasicDesc {\n\n  constructor(drawerService: BoxDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { CylinderDrawerService } from '../../services/drawers/cylinder-dawer/cylinder-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-box-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity (like `position`)\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/CylinderGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-cylinder-desc props=\"{\n *     show : cylinder.show, //optional\n *     position : cylinder.position,\n *     material : cylinder.color  //optional\n *   }\">\n *   </ac-cylinder-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-cylinder-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcCylinderDescComponent)}],\n})\nexport class AcCylinderDescComponent extends BasicDesc {\n\n  constructor(drawerService: CylinderDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { CorridorDrawerService } from '../../services/drawers/corridor-dawer/corridor-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-box-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/CorridorGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-corridor-desc props=\"{\n *     show : point.show, //optional\n *     positions : point.positions,\n *     material : point.color  //optional\n *   }\">\n *   </ac-corridor-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-corridor-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcCorridorDescComponent)}],\n})\nexport class AcCorridorDescComponent extends BasicDesc {\n\n  constructor(drawerService: CorridorDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { EllipsoidDrawerService } from '../../services/drawers/ellipoid-drawer/ellipsoid-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-box-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/EllipsoidGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-ellipsoid-desc props=\"{\n *     show : ellipsoid.show, //optional\n *     radii : ellipsoid.radii,\n *     material : ellipsoid.color  //optional\n *   }\">\n *   </ac-ellipsoid-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-ellipsoid-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcEllipsoidDescComponent)}],\n})\nexport class AcEllipsoidDescComponent extends BasicDesc {\n\n  constructor(drawerService: EllipsoidDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { PolylineVolumeDrawerService } from '../../services/drawers/polyline-volume-dawer/polyline-volume-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/PolylineVolumeGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-polyline-volume-desc props=\"{\n *     show : line.show, //optional\n *     positions : line.positions,\n *     material : line.color  //optional\n *   }\">\n *   </ac-polyline-volume-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-polyline-volume-desc',\n  template: ''\n})\nexport class AcPolylineVolumeDescComponent extends BasicDesc {\n\n  constructor(drawerService: PolylineVolumeDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { WallDrawerService } from '../../services/drawers/wall-dawer/wall-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-box-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties PointGraphics and the general properties\n *  of Entity\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/WallGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-wall-desc props=\"{\n *     show : wall.show, //optional\n *     positions : wall.positions,\n *     material : wall.color  //optional\n *   }\">\n *   </ac-wall-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-wall-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcWallDescComponent)}],\n})\nexport class AcWallDescComponent extends BasicDesc {\n\n  constructor(drawerService: WallDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { RectangleDrawerService } from '../../services/drawers/rectangle-dawer/rectangle-drawer.service';\n\n/**\n *  This is a point implementation.\n *  The ac-rectangle-desc element must be a child of ac-layer element.\n *  The properties of props are the same as the properties RectangleGraphics and the general properties\n *  of Entity\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/RectangleGraphics.html\n *\n *  __Usage:__\n *  ```\n *   <ac-rectangle-desc props=\"{\n *     show : rectangle.show, //optional\n *     coordinates : rectangle.positions,\n *     material : rectangle.color  //optional\n *   }\">\n *   </ac-rectangle-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-rectangle-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcRectangleDescComponent)}],\n})\nexport class AcRectangleDescComponent extends BasicDesc {\n\n  constructor(drawerService: RectangleDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(drawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { BillboardPrimitiveDrawerService } from '../../services/drawers/billboard-primitive-drawer/billboard-primitive-drawer.service';\n\n/**\n *  This is a billboard primitive implementation.\n *  The element must be a child of ac-layer element.\n *  The properties of props are:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Billboard.html\n *\n *  __Usage :__\n *  ```\n *    <ac-billboard-primitive-desc props=\"{\n *      image: track.image,\n *      position: track.position,\n *      scale: track.scale,\n *      color: track.color,\n *      name: track.name\n *    }\">\n *    </ac-billboard-primitive-desc>\n *  ```\n */\n\n@Component({\n  selector: 'ac-billboard-primitive-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcBillboardPrimitiveDescComponent)}],\n})\nexport class AcBillboardPrimitiveDescComponent extends BasicDesc {\n\n  constructor(billboardPrimitiveDrawer: BillboardPrimitiveDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(billboardPrimitiveDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { LabelPrimitiveDrawerService } from '../../services/drawers/label-primitive-drawer/label-primitive-drawer.service';\n\n/**\n *  This is a label primitive implementation.\n *  The ac-label element must be a child of ac-layer element.\n *  The properties of props are:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Label.html\n *\n *  __Usage :__\n *  ```\n *    <ac-label-primitive-desc props=\"{\n *      position: track.position,\n *      pixelOffset : [-15,20] | pixelOffset,\n *      text: track.name,\n *      font: '15px sans-serif'\n *    }\">\n *    </ac-label-primitive-desc>\n *  ```\n */\n\n@Component({\n  selector: 'ac-label-primitive-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcLabelPrimitiveDescComponent)}],\n})\nexport class AcLabelPrimitiveDescComponent extends BasicDesc {\n\n  constructor(labelPrimitiveDrawer: LabelPrimitiveDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(labelPrimitiveDrawer, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component, forwardRef } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { PolylinePrimitiveDrawerService } from '../../services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service';\n\n/**\n *  This is a polyline primitive implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Polyline Primitive:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Polyline.html\n *\n *  __Usage:__\n *  ```\n *    <ac-polyline-primitive-desc props=\"{\n *      width : polyline.width,\n *      positions: polyline.positions,\n *      material: polyline.material\n *    }\">\n *    </ac-polyline-primitive-desc>\n * ```\n */\n@Component({\n  selector: 'ac-polyline-primitive-desc',\n  template: '',\n  providers: [{provide: BasicDesc, useExisting: forwardRef(() => AcPolylinePrimitiveDescComponent)}],\n})\nexport class AcPolylinePrimitiveDescComponent extends BasicDesc {\n\n  constructor(polylinePrimitiveDrawerService: PolylinePrimitiveDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(polylinePrimitiveDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { HtmlCollection } from '../collections';\nimport { Cartesian2 } from '../../angular-cesium/models/cartesian2';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\n\nexport class HtmlPrimitive {\n\n  private _scene: any;\n  private _show: boolean;\n  private _position: Cartesian3;\n  private _lastPosition: Cartesian2;\n  private _pixelOffset: Cartesian2;\n  private _element: HTMLElement;\n  private _collection: HtmlCollection;\n  private _mapContainer;\n\n  constructor(options: any, collection: HtmlCollection = null) {\n    if (typeof options !== 'object') {\n      throw new Error('HtmlPrimitive ERROR: invalid html options!');\n    }\n\n    this.scene = options.scene;\n    this._mapContainer = options.mapContainer;\n    this.show = options.show || true;\n    this.position = options.position;\n    this.pixelOffset = options.pixelOffset;\n    this.element = options.element;\n    this.collection = collection;\n  }\n\n  set scene(scene: any) {\n    this._scene = scene;\n  }\n\n  set show(show: boolean) {\n    this._show = show;\n\n    if (Cesium.defined(this.element)) {\n      if (show) {\n        this._element.style.display = 'block';\n      } else {\n        this._element.style.display = 'none';\n      }\n    }\n  }\n\n  get show(): boolean {\n    return this._show;\n  }\n\n  set position(position: Cartesian3) {\n    this._position = position;\n  }\n\n  get position(): Cartesian3 {\n    return this._position;\n  }\n\n  set pixelOffset(pixelOffset: Cartesian2) {\n    this._pixelOffset = pixelOffset;\n  }\n\n  get pixelOffset(): Cartesian2 {\n    return this._pixelOffset;\n  }\n\n  set element(element: HTMLElement) {\n    this._element = element;\n\n    if (Cesium.defined(element)) {\n      this._mapContainer.appendChild(element);\n      this._element.style.position = 'absolute';\n      this._element.style.zIndex = Number.MAX_VALUE.toString();\n    }\n  }\n\n  get element(): HTMLElement {\n    return this._element;\n  }\n\n  set collection(collection: HtmlCollection) {\n    this._collection = collection;\n  }\n\n  get collection() {\n    return this._collection;\n  }\n\n  update() {\n    if (!Cesium.defined(this._show) || !Cesium.defined(this._element)) {\n      return;\n    }\n\n    let screenPosition = Cesium.SceneTransforms.wgs84ToWindowCoordinates(this._scene, this._position);\n\n    if (!Cesium.defined(screenPosition)) {\n      screenPosition = new Cesium.Cartesian2((-1000), (-1000));\n    } else if (Cesium.defined(this._pixelOffset) && Cesium.defined(this._pixelOffset.x) && Cesium.defined(this._pixelOffset.y)) {\n      screenPosition.y += this._pixelOffset.y;\n      screenPosition.x += this._pixelOffset.x;\n    }\n\n    if (this._lastPosition && this._lastPosition.equals(screenPosition)) {\n      return;\n    }\n\n    this._element.style.top = `${screenPosition.y}px`;\n    this._element.style.left = `${screenPosition.x}px`;\n    this._lastPosition = screenPosition;\n  }\n\n  remove() {\n    if (this._element) {\n      this._element.remove();\n    }\n  }\n}\n","import { HtmlPrimitive } from '../primitives';\n\nexport class HtmlCollection {\n  private _collection: HtmlPrimitive[] = [];\n\n  get length() {\n    return this._collection.length;\n  }\n\n  get(index: number) {\n    return this._collection[index];\n  }\n\n  add(options: any): HtmlPrimitive {\n    const html = new HtmlPrimitive(options, this);\n    this._collection.push(html);\n\n    return html;\n  }\n\n  remove(html: HtmlPrimitive): boolean {\n    const index = this._collection.indexOf(html);\n    if (index === (-1)) {\n      return false;\n    }\n\n    this._collection[index].remove();\n    this._collection.splice(index, 1);\n    return true;\n  }\n\n  update() {\n    for (let i = 0, len = this._collection.length; i < len; i++) {\n      this._collection[i].update();\n    }\n  }\n\n  removeAll() {\n    while (this._collection.length > 0) {\n      const html = this._collection.pop();\n      html.remove();\n    }\n  }\n\n  contains(html: HtmlPrimitive): boolean {\n    return Cesium.defined(html) && html.collection === this;\n  }\n\n  destroy() {\n    this.removeAll();\n  }\n}\n","import { HtmlPrimitive } from './primitives';\nimport { HtmlCollection } from './collections';\n\nexport class CesiumExtender {\n  static extend() {\n    Cesium.HtmlPrimitive = HtmlPrimitive;\n    Cesium.HtmlCollection = HtmlCollection;\n  }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class AcHtmlManager {\n  private _entities: Map<any, any>;\n\n  constructor() {\n    this._entities = new Map<any, any>();\n  }\n\n  has(id: string): boolean {\n    return this._entities.has(id);\n  }\n\n  get(id: string): { entity: any, primitive: any } {\n    return this._entities.get(id);\n  }\n\n  addOrUpdate(id: any, info: { entity: any, primitive: any }) {\n    this._entities.set(id, info);\n  }\n\n  remove(id: string) {\n    this._entities.delete(id);\n  }\n\n  forEach(callback: any) {\n    this._entities.forEach(callback);\n  }\n}\n","import { ChangeDetectorRef, Directive, OnInit, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { AcHtmlManager } from '../../services/ac-html-manager/ac-html-manager.service';\n\nexport class AcHtmlContext {\n  constructor(\n    public id: any,\n    public context: any\n  ) {\n  }\n}\n\n@Directive({\n  selector: '[acHtml]',\n})\nexport class AcHtmlDirective implements OnInit {\n\n  private _views = new Map<any, { viewRef: any, context: any }>();\n\n  constructor(\n    private _templateRef: TemplateRef<AcHtmlContext>,\n    private _viewContainerRef: ViewContainerRef,\n    private _changeDetector: ChangeDetectorRef,\n    private _layerService: LayerService,\n    private _acHtmlManager: AcHtmlManager\n  ) {\n  }\n\n  ngOnInit() {\n\n  }\n\n  private _handleView(id: any, primitive: any, entity: any) {\n    if (!this._views.has(id) && primitive.show) {\n      const context = new AcHtmlContext(id, {$implicit: entity});\n      const viewRef = this._viewContainerRef.createEmbeddedView(this._templateRef, context);\n      this._views.set(id, {viewRef, context});\n      this._changeDetector.detectChanges();\n    }  else if (this._views.has(id) && primitive.show) {\n      this._changeDetector.detectChanges();\n    }\n  }\n\n  addOrUpdate(id: any, primitive: any) {\n    const context = this._layerService.context;\n    const entity = context[this._layerService.getEntityName()];\n\n    if (this._views.has(id)) {\n      this._views.get(id).context.context.$implicit = entity;\n    }\n\n    this._acHtmlManager.addOrUpdate(id, {entity, primitive});\n    this._handleView(id, primitive, entity);\n  }\n\n  remove(id: any, primitive: any) {\n    if (!this._views.has(id)) {\n      return;\n    }\n\n    const {viewRef} = this._views.get(id);\n    this._viewContainerRef.remove(this._viewContainerRef.indexOf(viewRef));\n    this._views.delete(id);\n    this._acHtmlManager.remove(id);\n    primitive.element = null;\n  }\n}\n","import { Component, ContentChild, OnInit, TemplateRef, ViewChild } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { HtmlDrawerService } from '../../services/drawers/html-drawer/html-drawer.service';\nimport { AcHtmlDirective } from '../../directives/ac-html/ac-html.directive';\nimport { AcHtmlManager } from '../../services/ac-html-manager/ac-html-manager.service';\n\n/**\n *  This is an html implementation.\n *  The ac-html element must be a child of ac-layer element.\n *  <br>\n *  [props] accepts position(Cartesian3) and show(boolean).\n *\n *  __Usage:__\n *  ```\n *  <ac-layer acFor=\"let html of htmls$\" [context]=\"this\">\n <ac-html-desc props=\"{position: html.position, show: html.show}\">\n <ng-template let-html>\n <div>\n <h1>This is ac-html {{html.name}}</h1>\n <button (click)=\"changeText(html, 'Test')\">change text</button>\n </div>\n </ng-template>\n </ac-html-desc>\n *  <ac-html [props]=\"{position: position, show: true}\">;\n *    <p>html element</p>\n *  </ac-html>\n *  ```\n */\n@Component({\n  selector: 'ac-html-desc',\n  providers: [AcHtmlManager],\n  template: `\n      <div *acHtml=\"let acHtmlEntityId = id; let acHtmlContext = context\">\n          <div [acHtmlContainer]=\"acHtmlEntityId\">\n              <ng-template [ngTemplateOutlet]=\"acHtmlTemplate\"\n                           [ngTemplateOutletContext]=\"acHtmlContext\"></ng-template>\n          </div>\n      </div>`\n})\nexport class AcHtmlDescComponent extends BasicDesc implements OnInit {\n\n  @ViewChild(AcHtmlDirective, {static: true}) acHtmlCreator: AcHtmlDirective;\n  @ContentChild(TemplateRef, {static: true}) acHtmlTemplate: TemplateRef<any>;\n\n  constructor(htmlDrawer: HtmlDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(htmlDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n  ngOnInit() {\n    super.ngOnInit();\n\n    if (!this.acHtmlCreator) {\n      throw new Error(`AcHtml desc ERROR: ac html directive not found.`);\n    }\n\n    if (!this.acHtmlTemplate) {\n      throw new Error(`AcHtml desc ERROR: html template not found.`);\n    }\n  }\n\n  draw(context: any, id: any): any {\n    const cesiumProps = this._propsEvaluator(context);\n    if (!this._cesiumObjectsMap.has(id)) {\n      const primitive = this._drawer.add(cesiumProps);\n      this._cesiumObjectsMap.set(id, primitive);\n      this.acHtmlCreator.addOrUpdate(id, primitive);\n    } else {\n      const primitive = this._cesiumObjectsMap.get(id);\n      this._drawer.update(primitive, cesiumProps);\n      this.acHtmlCreator.addOrUpdate(id, primitive);\n    }\n  }\n\n  remove(id: string): void {\n    const primitive = this._cesiumObjectsMap.get(id);\n    this._drawer.remove(primitive);\n    this._cesiumObjectsMap.delete(id);\n    this.acHtmlCreator.remove(id, primitive);\n  }\n\n  removeAll(): void {\n    this._cesiumObjectsMap.forEach(((primitive, id) => {\n      this.acHtmlCreator.remove(id, primitive);\n    }));\n    this._cesiumObjectsMap.clear();\n    this._drawer.removeAll();\n  }\n}\n","import { Directive, ElementRef, Input, OnInit } from '@angular/core';\nimport { AcHtmlManager } from '../../services/ac-html-manager/ac-html-manager.service';\n\n@Directive({\n  selector: '[acHtmlContainer]'\n})\nexport class AcHtmlContainerDirective implements OnInit {\n\n  private _id: any;\n\n  constructor(\n    private _element: ElementRef,\n    private _acHtmlManager: AcHtmlManager\n  ) {\n  }\n\n  @Input()\n  set acHtmlContainer(id: string) {\n    this._id = id;\n  }\n\n  ngOnInit() {\n    if (this._id === undefined) {\n      throw new Error(`AcHtml container ERROR: entity id not defined`);\n    }\n\n    const entity = this._acHtmlManager.get(this._id);\n    entity.primitive.element = this._element.nativeElement;\n  }\n}\n","import {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ComponentFactoryResolver,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n  ViewContainerRef\n} from '@angular/core';\nimport { ContextMenuService } from '../../services/context-menu/context-menu.service';\nimport { Subscription } from 'rxjs';\nimport { BasicContextMenu } from '../../models/basic-context-menu';\n\n/**\n * This component is used to inject the component that is passed to the ContextMenuService when opening a context menu.\n * It shouldn't be used directly.\n *\n * usage:\n * ```typescript\n * // We want to open the context menu on mouse right click.\n * // Register to mouse right click with the MapEventsManager\n * this.mapEventsManager.register({ event: CesiumEvent.RIGHT_CLICK, pick: PickOptions.NO_PICK })\n *    .subscribe(event => {\n *       const position = this.coordinateConverter.screenToCartesian3(event.movement.endPosition, true);\n *       if (!position) {\n *         return;\n *       }\n *       // Open the context menu on the position that was clicked and pass some data to MyCustomContextMenuComponent.\n *       this.contextMenuService.open(\n *         MyCustomContextMenuComponent,\n *         position,\n *         { data: { items: ['New Track', 'Change Map', 'Context Menu', 'Do Something'] } }\n *       )\n *    });\n *\n * ```\n */\n\n@Component({\n  selector: 'ac-context-menu-wrapper',\n  template: `\n    <ac-html *ngIf=\"contextMenuService.showContextMenu\" [props]=\"{position: contextMenuService.position}\">\n      <ng-template #contextMenuContainer></ng-template>\n    </ac-html>\n  `,\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AcContextMenuWrapperComponent implements OnInit, OnDestroy {\n\n  private contextMenuChangeSubscription: Subscription;\n  private contextMenuOpenSubscription: Subscription;\n\n  @ViewChild('contextMenuContainer', { read: ViewContainerRef }) viewContainerRef: ViewContainerRef;\n\n  constructor(public contextMenuService: ContextMenuService,\n              private cd: ChangeDetectorRef,\n              private componentFactoryResolver: ComponentFactoryResolver) {\n  }\n\n  ngOnInit() {\n    this.contextMenuChangeSubscription =\n      this.contextMenuService.contextMenuChangeNotifier.subscribe(() => this.cd.detectChanges());\n    this.contextMenuOpenSubscription =\n      this.contextMenuService.onOpen.subscribe(() => {\n        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(this.contextMenuService.content as any);\n        this.viewContainerRef.clear();\n        const componentRef = this.viewContainerRef.createComponent(componentFactory);\n        (componentRef.instance as BasicContextMenu).data = this.contextMenuService.options.data;\n        this.cd.detectChanges();\n      });\n  }\n\n  ngOnDestroy(): void {\n    if (this.contextMenuChangeSubscription) {\n      this.contextMenuChangeSubscription.unsubscribe();\n    }\n\n    if (this.contextMenuOpenSubscription) {\n      this.contextMenuOpenSubscription.unsubscribe();\n    }\n  }\n}\n","import {\n  AfterContentInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport { AcNotification } from '../../models/ac-notification';\nimport { Subject, Subscription } from 'rxjs';\nimport { IDescription } from '../../models/description';\nimport * as _get from 'lodash.get';\nimport { AcLayerComponent } from '../ac-layer/ac-layer.component';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\n\n/**\n *  This is component represents an array under `ac-layer`.\n *  The element must be a child of ac-layer element.\n *  + acFor `{string}` - get the tracked array and entityName (see the example).\n *  + idGetter `{Function}` - a function that gets the id for a given element in the array -should be defined for maximum performance.\n *  + show `{boolean}` - show/hide array's entities.\n *\n *  __Usage :__\n *  ```\n *<ac-layer acFor=\"let track of tracks$\" [show]=\"show\" [context]=\"this\" [store]=\"true\">\n *  <ac-array-desc acFor=\"let arrayItem of track.array\" [idGetter]=\"trackArrayIdGetter\">\n *    <ac-array-desc acFor=\"let innerArrayItem of arrayItem.innerArray\" [idGetter]=\"trackArrayIdGetter\">\n *      <ac-point-desc props=\"{\n *        position: innerArrayItem.pos,\n *        pixelSize: 10,\n *        color: getTrackColor(track),\n *        outlineColor: Cesium.Color.BLUE,\n *        outlineWidth: 1\n *      }\">\n *      </ac-point-desc>\n *    </ac-array-desc>\n *  </ac-array-desc>\n *</ac-layer>\n *  ```\n */\n\n@Component({\n  selector: 'ac-array-desc',\n  template: `\n    <ac-layer #layer [acFor]=\"getAcForString()\"\n              [context]=\"layerService.context\"\n              [options]=\"layerService.options\"\n              [show]=\"layerService.show && show\"\n              [zIndex]=\"layerService.zIndex\">\n      <ng-content #content></ng-content>\n    </ac-layer>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AcArrayDescComponent implements OnChanges, OnInit, AfterContentInit, OnDestroy, IDescription {\n\n  @Input() acFor: string;\n\n  @Input() idGetter: (item: any, index: number) => string;\n\n  @Input() show = true;\n  @ViewChild('layer', {static: true}) private layer: AcLayerComponent;\n  @ContentChildren(BasicDesc, {descendants: false}) private basicDescs: any;\n  @ContentChildren(AcArrayDescComponent, {descendants: false}) private arrayDescs: any;\n  private entitiesMap = new Map<string, string[]>();\n  private layerServiceSubscription: Subscription;\n  private id = 0;\n  private readonly acForRgx = /^let\\s+.+\\s+of\\s+.+$/;\n  entityName: string;\n  arrayPath: string;\n  arrayObservable$ = new Subject<AcNotification>();\n\n  constructor(public layerService: LayerService, private cd: ChangeDetectorRef) {\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['acFor'].firstChange) {\n      const acForString = changes['acFor'].currentValue;\n      if (!this.acForRgx.test(acForString)) {\n        throw new Error(`ac-layer: Invalid [acFor] syntax. Expected: [acFor]=\"let item of observable\" .Instead received: ${acForString}`);\n      }\n      const acForArr = changes['acFor'].currentValue.split(' ');\n      this.arrayPath = acForArr[3];\n      this.entityName = acForArr[1];\n    }\n  }\n\n  ngOnInit(): void {\n    if (this.layer) {\n      this.layer.getLayerService().cache = false;\n    }\n\n    this.layerServiceSubscription = this.layerService.layerUpdates().subscribe(() => {\n      this.cd.detectChanges();\n    });\n  }\n\n  ngAfterContentInit(): void {\n    this.layerService.context['arrayObservable$'] = this.arrayObservable$;\n    this.layerService.registerDescription(this);\n    this.basicDescs._results.forEach((component: BasicDesc) => {\n      component.setLayerService(this.layer.getLayerService());\n    });\n    this.arrayDescs._results.splice(0, 1);\n    this.arrayDescs._results.forEach((component: AcArrayDescComponent) => {\n      this.layerService.unregisterDescription(component);\n      this.layer.getLayerService().registerDescription(component);\n      component.layerService = this.layer.getLayerService();\n      component.setLayerService(this.layer.getLayerService());\n    });\n  }\n\n  ngOnDestroy(): void {\n    if (this.layerServiceSubscription) {\n      this.layerServiceSubscription.unsubscribe();\n    }\n  }\n\n  setLayerService(layerService: LayerService) {\n    this.layerService = layerService;\n  }\n\n  draw(context: any, id: string, contextEntity: any) {\n    const get = _get;\n    const entitiesArray: any[] = get(context, this.arrayPath);\n    if (!entitiesArray) {\n      return;\n    }\n    const previousEntitiesIdArray = this.entitiesMap.get(id);\n    const entitiesIdArray: any[] = [];\n    this.entitiesMap.set(id, entitiesIdArray);\n\n    entitiesArray.forEach((item, index) => {\n      this.layerService.context[this.entityName] = item;\n      const arrayItemId = this.generateCombinedId(id, item, index);\n      entitiesIdArray.push(arrayItemId);\n      this.layer.update(contextEntity, arrayItemId);\n    });\n\n    if (previousEntitiesIdArray) {\n      const entitiesToRemove = this.idGetter ?\n        previousEntitiesIdArray.filter((entityId) => entitiesIdArray.indexOf(entityId) < 0) :\n        previousEntitiesIdArray;\n      if (entitiesToRemove) {\n        entitiesToRemove.forEach((entityId) => this.layer.remove(entityId));\n      }\n    }\n  }\n\n  remove(id: string) {\n    const entitiesIdArray = this.entitiesMap.get(id);\n    if (entitiesIdArray) {\n      entitiesIdArray.forEach((entityId) => this.layer.remove(entityId));\n    }\n    this.entitiesMap.delete(id);\n  }\n\n  removeAll() {\n    this.layer.removeAll();\n    this.entitiesMap.clear();\n  }\n\n  getAcForString() {\n    return `let ${this.entityName + '___temp'} of arrayObservable$`;\n  }\n\n  private generateCombinedId(entityId: string, arrayItem: any, index: number): string {\n    let arrayItemId;\n    if (this.idGetter) {\n      arrayItemId = this.idGetter(arrayItem, index);\n    } else {\n      arrayItemId = (this.id++) % Number.MAX_SAFE_INTEGER;\n    }\n    return entityId + arrayItemId;\n  }\n}\n","import { Component } from '@angular/core';\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\nimport { PointPrimitiveDrawerService } from '../../services/drawers/point-primitive-drawer/point-primitive-drawer.service';\n\n/**\n *  This is a label primitive implementation.\n *  The ac-label element must be a child of ac-layer element.\n *  The properties of props are:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Point.html\n *\n *  __Usage :__\n *  ```\n *    <ac-point-primitive-desc props=\"{\n *      position: track.position,\n *      color: Cesium.Color.RED\n *    }\">\n *    </ac-point-primitive-desc>\n *  ```\n */\n\n@Component({\n  selector: 'ac-point-primitive-desc',\n  template: '',\n})\nexport class AcPointPrimitiveDescComponent extends BasicDesc {\n\n  constructor(pointPrimitiveDrawerService: PointPrimitiveDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(pointPrimitiveDrawerService, layerService, computationCache, cesiumProperties);\n  }\n}\n","import { Component } from '@angular/core';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\nimport { PolylinePrimitiveDrawerService } from '../../services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service';\n\n/**\n *  This is a polyline implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Polyline Primitive:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Polyline.html\n *\n *  __Usage:__\n *  ```\n *  <ac-polyline [props]=\"{\n *    position: position,\n *    text: 'labelText',\n *    font: '30px sans-serif'\n *    color: Cesium.Color.GREEN\n *  }\">;\n *  </ac-polyline>\n *  ```\n */\n\n@Component({\n  selector: 'ac-primitive-polyline',\n  template: '',\n})\nexport class AcPrimitivePolylineComponent extends EntityOnMapComponent {\n\n  constructor(polylineDrawer: PolylinePrimitiveDrawerService, mapLayers: MapLayersService) {\n    super(polylineDrawer, mapLayers);\n  }\n}\n","import { PixelOffsetPipe } from './pixel-offset/pixel-offset.pipe';\nimport { RadiansToDegreesPipe } from './radians-to-degrees/radians-to-degrees.pipe';\n\n// For angular parse usage\nexport default [\n  {pipeName: 'pixelOffset', pipeInstance: new PixelOffsetPipe()},\n  {pipeName: 'radiansToDegrees', pipeInstance: new RadiansToDegreesPipe()},\n];\n","import { Component, OnInit } from '@angular/core';\n\nimport { BasicDesc } from '../../services/basic-desc/basic-desc.service';\nimport { CesiumProperties } from '../../services/cesium-properties/cesium-properties.service';\nimport { ComputationCache } from '../../services/computation-cache/computation-cache.service';\nimport { CzmlDrawerService } from '../../services/drawers/czml-drawer/czml-drawer.service';\nimport { LayerService } from '../../services/layer-service/layer-service.service';\n\n/**\n *  This is a czml implementation.\n *  The ac-czml-desc element must be a child of ac-layer element.\n *\n *  See CZML Guide for the structure of props.czmlPacket:\n *  + https://github.com/AnalyticalGraphicsInc/czml-writer/wiki/CZML-Structure\n *\n *  Attention: the first czmlPacket in the stream needs to be a document\n *  with an id and a name attribute. See this example\n *  + https://cesiumjs.org/Cesium/Apps/Sandcastle/index.html?src=CZML%20Point%20-%20Time%20Dynamic.html&label=CZML\n *\n *  To see a working example, use the demo app and\n *  + uncomment <czml-layer></czml-layer> in demo-map.component.html\n *  + set the properties 'timeline', 'animation' and 'shouldAnimate' true in viewerOptions of demo-map.component.ts\n *\n *\n *  __Usage:__\n *  ```\n *    <ac-czml-desc props=\"{\n *      czmlPacket: czmlPacket\n *    }\">\n *    </ac-czml-desc>\n *  ```\n */\n@Component({\n  selector: 'ac-czml-desc',\n  template: '',\n})\nexport class AcCzmlDescComponent extends BasicDesc implements OnInit {\n  constructor(czmlDrawer: CzmlDrawerService, layerService: LayerService,\n              computationCache: ComputationCache, cesiumProperties: CesiumProperties) {\n    super(czmlDrawer, layerService, computationCache, cesiumProperties);\n  }\n\n\n}\n","import { Component } from '@angular/core';\nimport { RectangleDrawerService } from '../../services/drawers/rectangle-dawer/rectangle-drawer.service';\nimport { EntityOnMapComponent } from '../../services/entity-on-map/entity-on-map.component';\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\n\n/**\n *  This is a rectangle implementation.\n *  The ac-label element must be a child of ac-map element.\n *  The properties of props are the same as the properties of Entity and RectangleGraphics:\n *  + https://cesiumjs.org/Cesium/Build/Documentation/Entity.html\n *  + https://cesiumjs.org/Cesium/Build/Documentation/RectangleGraphics.html\n *\n *  __Usage:__\n *  ```\n *    <ac-rectangle props=\"{\n *      coordinates: rectangle.coordinates,\n *      material: rectangle.material,\n *      height: rectangle.height\n *    }\">\n *    </ac-rectangle>\n *  ```\n */\n@Component({\n  selector: 'ac-rectangle',\n  template: ''\n})\nexport class AcRectangleComponent extends EntityOnMapComponent {\n  constructor(rectangleDrawer: RectangleDrawerService, mapLayers: MapLayersService) {\n    super(rectangleDrawer, mapLayers);\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { AcMapComponent } from './components/ac-map/ac-map.component';\nimport { AcLayerComponent } from './components/ac-layer/ac-layer.component';\nimport { AcBillboardComponent } from './components/ac-billboard/ac-billboard.component';\nimport { AcBillboardDescComponent } from './components/ac-billborad-desc/ac-billborad-desc.component';\nimport { AcEllipseDescComponent } from './components/ac-ellipse-desc/ac-ellipse-desc.component';\nimport { AcPolylineDescComponent } from './components/ac-polyline-desc/ac-polyline-desc.component';\nimport { Angular2ParseModule, PIPES_CONFIG } from 'angular2parse';\nimport { PixelOffsetPipe } from './pipes/pixel-offset/pixel-offset.pipe';\nimport { RadiansToDegreesPipe } from './pipes/radians-to-degrees/radians-to-degrees.pipe';\nimport { JsonMapper } from './services/json-mapper/json-mapper.service';\nimport { CesiumProperties } from './services/cesium-properties/cesium-properties.service';\nimport { AcLabelDescComponent } from './components/ac-label-desc/ac-label-desc.component';\nimport { UtilsModule } from './utils/utils.module';\nimport { ViewerFactory } from './services/viewer-factory/viewer-factory.service';\nimport { GeoUtilsService } from './services/geo-utils/geo-utils.service';\nimport { AcCircleDescComponent } from './components/ac-circle-desc/ac-circle-desc.component';\nimport { AcArcDescComponent } from './components/ac-arc-desc/ac-arc-desc.component';\nimport { AcMapLayerProviderComponent } from './components/ac-map-layer-provider/ac-map-layer-provider.component';\nimport { AcMapTerrainProviderComponent } from './components/ac-map-terrain-provider/ac-map-terrain-provider.component';\nimport { AcPointDescComponent } from './components/ac-point-desc/ac-point-desc.component';\nimport { AcLabelComponent } from './components/ac-label/ac-label.component';\nimport { AcPolylineComponent } from './components/ac-polyline/ac-polyline.component';\nimport { AcEllipseComponent } from './components/ac-ellipse/ac-ellipse.component';\nimport { AcPointComponent } from './components/ac-point/ac-point.component';\nimport { AcHtmlComponent } from './components/ac-html/ac-html.component';\nimport { AcCircleComponent } from './components/ac-circle/ac-circle.component';\nimport { AcArcComponent } from './components/ac-arc/ac-arc.component';\nimport { AcPolygonDescComponent } from './components/ac-polygon-desc/ac-polygon-desc.component';\nimport { AcDefaultPlonterComponent } from './components/ac-default-plonter/ac-default-plonter.component';\nimport { AcPolygonComponent } from './components/ac-polygon/ac-polygon.component';\nimport { MapsManagerService } from './services/maps-manager/maps-manager.service';\nimport { AcStaticEllipseDescComponent } from './components/static-dynamic/ac-static-ellipse-desc/ac-static-ellipse-desc.component';\nimport { AcDynamicEllipseDescComponent } from './components/static-dynamic/ac-dynamic-ellipse-desc/ac-dynamic-ellipse-desc.component';\nimport { AcDynamicPolylineDescComponent } from './components/static-dynamic/ac-dynamic-polyline-desc/ac-dynamic-polyline-desc.component';\nimport { AcStaticPolygonDescComponent } from './components/static-dynamic/ac-static-polygon-desc/ac-static-polygon-desc.component';\nimport { AcStaticCircleDescComponent } from './components/static-dynamic/ac-static-circle-desc/ac-static-circle-desc.component';\nimport { AcDynamicCircleDescComponent } from './components/static-dynamic/ac-dynamic-circle-desc/ac-dynamic-circle-desc.component';\nimport { AcStaticPolylineDescComponent } from './components/static-dynamic/ac-static-polyline-desc/ac-static-polyline-desc.component';\nimport { AcModelDescComponent } from './components/ac-model-desc/ac-model-desc.component';\nimport { AcTileset3dComponent } from './components/ac-3d-tileset/ac-tileset-3d.component';\nimport { AcBoxDescComponent } from './components/ac-box-desc/ac-box-desc.component';\nimport { AcCylinderDescComponent } from './components/ac-cylinder-desc/ac-cylinder-desc.component';\nimport { AcCorridorDescComponent } from './components/ac-corridor-desc/ac-corridor-desc.component';\nimport { AcEllipsoidDescComponent } from './components/ac-ellipsoid-desc/ac-ellipsoid-desc.component';\nimport { AcPolylineVolumeDescComponent } from './components/ac-polyline-volume-desc/ac-polyline-volume-desc.component';\nimport { AcWallDescComponent } from './components/ac-wall-desc/ac-wall-desc.component';\nimport { AcRectangleDescComponent } from './components/ac-rectangle-desc/ac-rectangle-desc.component';\nimport { AcBillboardPrimitiveDescComponent } from './components/ac-billboard-primitive-desc/ac-billboard-primitive-desc.component';\nimport { AcLabelPrimitiveDescComponent } from './components/ac-label-primitive-desc/ac-label-primitive-desc.component';\nimport { AcPolylinePrimitiveDescComponent } from './components/ac-polyline-primitive-desc/ac-polyline-primitive-desc.component';\nimport { ModuleConfiguration } from './models/module-options';\nimport { ANGULAR_CESIUM_CONFIG, ConfigurationService } from './cesium-enhancements/ConfigurationService';\nimport { CesiumExtender } from '../cesium-extender/extender';\nimport { AcHtmlDescComponent } from './components/ac-html-desc/ac-html-desc.component';\nimport { AcHtmlDirective } from './directives/ac-html/ac-html.directive';\nimport { AcHtmlContainerDirective } from './directives/ac-html-container/ac-html-container.directive';\nimport { AcContextMenuWrapperComponent } from './components/ac-context-menu-wrapper/ac-context-menu-wrapper.component';\nimport { AcArrayDescComponent } from './components/ac-array-desc/ac-array-desc.component';\nimport { AcPointPrimitiveDescComponent } from './components/ac-point-primitive-desc/ac-point-primitive-desc.component';\nimport { AcPrimitivePolylineComponent } from './components/ac-primitive-polyline/ac-primitive-polyline.component';\nimport PARSE_PIPES_CONFIG_MAP from './pipes/pipe-config-map';\n\nimport { AcCzmlDescComponent } from './components/ac-czml-desc/ac-czml-desc.component';\nimport { AcRectangleComponent } from './components/ac-rectangle/ac-rectangle.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    Angular2ParseModule,\n    UtilsModule,\n  ],\n  declarations: [\n    AcMapComponent,\n    AcLayerComponent,\n    AcBillboardComponent,\n    AcBillboardDescComponent,\n    AcBillboardPrimitiveDescComponent,\n    AcLabelDescComponent,\n    AcLabelPrimitiveDescComponent,\n    AcEllipseDescComponent,\n    AcPolylineDescComponent,\n    AcPolylinePrimitiveDescComponent,\n    PixelOffsetPipe,\n    RadiansToDegreesPipe,\n    AcCircleDescComponent,\n    AcArcDescComponent,\n    AcMapLayerProviderComponent,\n    AcMapTerrainProviderComponent,\n    AcPointDescComponent,\n    AcLabelComponent,\n    AcPolylineComponent,\n    AcPrimitivePolylineComponent,\n    AcEllipseComponent,\n    AcPointComponent,\n    AcBillboardComponent,\n    AcHtmlComponent,\n    AcCircleComponent,\n    AcArcComponent,\n    AcPolygonDescComponent,\n    AcPolygonComponent,\n    AcDefaultPlonterComponent,\n    AcModelDescComponent,\n    AcTileset3dComponent,\n    AcBoxDescComponent,\n    AcCylinderDescComponent,\n    AcCorridorDescComponent,\n    AcEllipsoidDescComponent,\n    AcPolylineVolumeDescComponent,\n    AcWallDescComponent,\n    AcRectangleDescComponent,\n    AcContextMenuWrapperComponent,\n    AcPointPrimitiveDescComponent,\n    AcHtmlDescComponent,\n    AcHtmlDirective,\n    AcHtmlContainerDirective,\n    AcArrayDescComponent,\n    AcCzmlDescComponent,\n\n    AcStaticEllipseDescComponent,\n    AcDynamicEllipseDescComponent,\n    AcDynamicPolylineDescComponent,\n    AcStaticPolylineDescComponent,\n    AcDynamicCircleDescComponent,\n    AcStaticCircleDescComponent,\n    AcStaticPolygonDescComponent,\n    AcRectangleComponent\n  ],\n  exports: [\n    AcMapComponent,\n    AcBillboardComponent,\n    AcBillboardDescComponent,\n    AcBillboardPrimitiveDescComponent,\n    AcLabelDescComponent,\n    AcLabelPrimitiveDescComponent,\n    AcEllipseDescComponent,\n    AcPolylineDescComponent,\n    AcPolylinePrimitiveDescComponent,\n    AcLayerComponent,\n    AcCircleDescComponent,\n    AcArcDescComponent,\n    AcMapLayerProviderComponent,\n    AcMapTerrainProviderComponent,\n    AcPointDescComponent,\n    AcLabelComponent,\n    AcPolylineComponent,\n    AcPrimitivePolylineComponent,\n    AcEllipseComponent,\n    AcPointComponent,\n    AcBillboardComponent,\n    AcHtmlComponent,\n    AcCircleComponent,\n    AcArcComponent,\n    AcPolygonDescComponent,\n    AcPolygonComponent,\n    AcDefaultPlonterComponent,\n    AcModelDescComponent,\n    AcTileset3dComponent,\n    AcBoxDescComponent,\n    AcCylinderDescComponent,\n    AcCorridorDescComponent,\n    AcEllipsoidDescComponent,\n    AcPolylineVolumeDescComponent,\n    AcWallDescComponent,\n    AcRectangleDescComponent,\n    AcPointPrimitiveDescComponent,\n    AcHtmlDescComponent,\n    AcArrayDescComponent,\n    AcCzmlDescComponent,\n    AcRectangleComponent,\n    AcStaticEllipseDescComponent,\n    AcDynamicEllipseDescComponent,\n    AcDynamicPolylineDescComponent,\n    AcStaticPolylineDescComponent,\n    AcDynamicCircleDescComponent,\n    AcStaticCircleDescComponent,\n    AcStaticPolygonDescComponent,\n  ],\n})\nexport class AngularCesiumModule {\n  static forRoot(config?: ModuleConfiguration): ModuleWithProviders<AngularCesiumModule> {\n    return {\n      ngModule: AngularCesiumModule,\n      providers: [\n        JsonMapper, CesiumProperties, GeoUtilsService, ViewerFactory, MapsManagerService, ConfigurationService,\n        {provide: ANGULAR_CESIUM_CONFIG, useValue: config},\n        {provide: PIPES_CONFIG, multi: true, useValue: config && config.customPipes || []},\n        {provide: PIPES_CONFIG, multi: true, useValue: PARSE_PIPES_CONFIG_MAP},\n      ],\n    };\n  }\n\n  constructor() {\n    CesiumExtender.extend();\n  }\n}\n","import { Observable } from 'rxjs';\n\nexport class DisposableObservable<T> extends Observable<T> {\n  dispose: Function;\n}\n","/**\n * EventModifier options for registration on map-event-manager.\n */\nexport enum CesiumEventModifier {\n  ALT = Cesium.KeyboardEventModifier.ALT,\n  CTRL = Cesium.KeyboardEventModifier.CTRL,\n  SHIFT = Cesium.KeyboardEventModifier.SHIFT,\n}\n","import { filter, map } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { AcEntity } from '../../models/ac-entity';\nimport { CesiumEvent } from '../map-events-mananger/consts/cesium-event.enum';\nimport { MapEventsManagerService } from '../map-events-mananger/map-events-manager';\nimport { PickOptions } from '../map-events-mananger/consts/pickOptions.enum';\nimport { CesiumEventModifier } from '../map-events-mananger/consts/cesium-event-modifier.enum';\nimport { MapsManagerService } from '../maps-manager/maps-manager.service';\n\n\nexport interface SelectionOptions {\n  event?: CesiumEvent;\n  modifier?: CesiumEventModifier;\n  entityType?: any;\n}\n\n/**\n * Manages entity selection service for any given mouse event and modifier\n * the service will manage the list of selected items.\n * check out the example\n * you must provide the service yourself\n *\n *  __Usage :__\n * ```\n * // provide the service in some component\n * @Component({\n * //...\n *  providers: [SelectionManagerService]\n * }\n *\n * // Usage example:\n * // init selection\n * const selectedIndicator = ture; // optional default true, if true a boolean \"selected\" property will be added to the selected entity\n * selectionManagerService.initSelection({ event: CesiumEvent.LEFT_CLICK,\n * \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodifier: CesiumEventModifier.CTRL\n * \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},selectedIndicator);\n * // Get selected\n * const selected = selectionManagerService.selected();\n *\n * // Or as observer\n * const selected$ = selectionManagerService.selected$();\n *\n * ```\n *\n */\n@Injectable()\nexport class SelectionManagerService {\n  selectedEntitiesItems$: BehaviorSubject<AcEntity[]> = new BehaviorSubject<AcEntity[]>([]);\n  selectedEntitySubject$: Subject<AcEntity> = new Subject<AcEntity>();\n  private mapEventsManagerService: MapEventsManagerService;\n\n  constructor(private mapsManager: MapsManagerService) {\n  }\n\n  selectedEntities$(): Observable<AcEntity[]> {\n    return this.selectedEntitiesItems$.asObservable();\n  }\n\n  selectedEntities(): AcEntity[] {\n    return this.selectedEntitiesItems$.getValue();\n  }\n\n  selectedEntity$() {\n    return this.selectedEntitySubject$;\n  }\n\n  toggleSelection(entity: AcEntity, addSelectedIndicator: boolean) {\n    const current = this.selectedEntities();\n    if (current.indexOf(entity) === -1) {\n      this.addToSelected(entity, addSelectedIndicator);\n    } else {\n      this.removeSelected(entity, addSelectedIndicator);\n    }\n  }\n\n  private addToSelected(entity: AcEntity, addSelectedIndicator: boolean) {\n    if (addSelectedIndicator) {\n      entity['selected'] = true;\n    }\n\n    const current = this.selectedEntities();\n    this.selectedEntitySubject$.next(entity);\n    this.selectedEntitiesItems$.next([...current, entity]);\n  }\n\n  private removeSelected(entity: AcEntity, addSelectedIndicator: boolean) {\n    if (addSelectedIndicator) {\n      entity['selected'] = false;\n    }\n\n    const current = this.selectedEntities();\n    const entityIndex = current.indexOf(entity);\n    if (entityIndex !== -1) {\n      current.splice(entityIndex, 1);\n      this.selectedEntitiesItems$.next(current);\n      this.selectedEntitySubject$.next(entity);\n    }\n  }\n\n  initSelection(selectionOptions?: SelectionOptions, addSelectedIndicator = true, eventPriority?: number, mapId?: string) {\n    const mapComponent = this.mapsManager.getMap(mapId);\n    if (!mapComponent) {\n      return;\n    }\n\n    this.mapEventsManagerService = mapComponent.getMapEventsManager();\n\n    if (!selectionOptions) {\n      Object.assign(selectionOptions, {event: CesiumEvent.LEFT_CLICK});\n    }\n\n    const eventSubscription = this.mapEventsManagerService.register({\n      event: selectionOptions.event,\n      pick: PickOptions.PICK_ONE,\n      modifier: selectionOptions.modifier,\n      entityType: selectionOptions.entityType,\n      priority: eventPriority,\n    });\n\n    eventSubscription.pipe(\n      map(result => result.entities),\n      filter(entities => entities && entities.length > 0))\n      .subscribe(entities => {\n        const entity = entities[0];\n        this.toggleSelection(entity, addSelectedIndicator);\n      });\n  }\n}\n","// import './src/angular-cesium/operators';\n\nexport * from './angular-cesium.module';\nexport * from './services';\nexport * from './models';\nexport * from './components';\nexport * from './pipes';\n","export enum EditModes {\n  CREATE,\n  EDIT,\n  CREATE_OR_EDIT\n}\n","export enum EditActions {\n  INIT,\n  MOUSE_MOVE,\n  ADD_POINT,\n  ADD_LAST_POINT,\n  CHANGE_TO_EDIT,\n  REMOVE_POINT,\n  DRAG_POINT,\n  DRAG_POINT_FINISH,\n  DRAG_SHAPE,\n  DRAG_SHAPE_FINISH,\n  DONE,\n  DISABLE,\n  ENABLE,\n  DISPOSE,\n  SET_EDIT_LABELS_RENDER_CALLBACK,\n  UPDATE_EDIT_LABELS,\n  SET_MANUALLY,\n  TRANSFORM,\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { PointProps } from './point-edit-options';\n\nexport class EditPoint extends AcEntity {\n  static counter = 0;\n  private id: string;\n  private editedEntityId: string;\n  private position: Cartesian3;\n  private _virtualEditPoint: boolean;\n  private pointProps: PointProps;\n  private _show = true;\n\n  constructor(entityId: string, position: Cartesian3, pointProps?: PointProps, virtualPoint = false) {\n    super();\n    this.editedEntityId = entityId;\n    this.position = position;\n    this.id = this.generateId();\n    this.pointProps = {...pointProps};\n    this._virtualEditPoint = virtualPoint;\n  }\n\n  get show() {\n    return this._show;\n  }\n\n  set show(value) {\n    this._show = value;\n  }\n\n  get props(): PointProps {\n    return this.pointProps;\n  }\n\n  set props(value: PointProps) {\n    this.pointProps = value;\n  }\n\n  isVirtualEditPoint(): boolean {\n    return this._virtualEditPoint;\n  }\n\n  setVirtualEditPoint(value: boolean) {\n    this._virtualEditPoint = value;\n  }\n\n  getEditedEntityId(): string {\n    return this.editedEntityId;\n  }\n\n  getPosition(): Cartesian3 {\n    return this.position.clone();\n  }\n\n  getPositionCallbackProperty(): Cartesian3 {\n    return new Cesium.CallbackProperty(this.getPosition.bind(this), false);\n  }\n\n\n  setPosition(position: Cartesian3) {\n    this.position.x = position.x;\n    this.position.y = position.y;\n    this.position.z = position.z;\n  }\n\n  getId(): string {\n    return this.id;\n  }\n\n  private generateId(): string {\n    return 'edit-point-' + EditPoint.counter++;\n  }\n}\n","export function generateKey(length = 12): string {\n  let id = '';\n  const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (let i = 0; i < length; i++) {\n    id += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return id;\n}\n\nexport function debounce(func, wait) {\n  let timeout;\n  return function (...args) {\n    const context = this;\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func.apply(context, args), wait);\n  };\n}\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PointsManagerService } from './points-manager.service';\nimport { LabelProps } from '../../../models/label-props';\nimport { generateKey } from '../../utils';\nimport { CesiumService } from '../../../../angular-cesium';\nimport { PointEditOptions, PointProps } from '../../../models/point-edit-options';\nimport { PointEditUpdate } from '../../../models/point-edit-update';\nimport { PointEditorObservable } from '../../../models/point-editor-observable';\n\nexport const DEFAULT_POINT_OPTIONS: PointEditOptions = {\n  addLastPointEvent: CesiumEvent.LEFT_CLICK,\n  removePointEvent: CesiumEvent.RIGHT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  pointProps: {\n    color: Cesium.Color.WHITE.withAlpha(0.95),\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.5),\n    outlineWidth: 1,\n    pixelSize: 10,\n    show: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n};\n\n/**\n * Service for creating editable point\n *\n *  * You must provide `PointsEditorService` yourself.\n * PolygonsEditorService works together with `<points-editor>` component. Therefor you need to create `<points-editor>`\n * for each `PointsEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `PointEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `PointEditorObservable`.\n * + To stop editing call `dsipose()` from the `PointEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `PointEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating point\n *  const editing$ = pointEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit point from existing point cartesian3 positions\n *  const editing$ = this.pointEditor.edit(initialPos);\n *\n * ```\n */\n@Injectable()\nexport class PointsEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<PointEditUpdate>();\n  private updatePublisher = publish<PointEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private pointManager: PointsManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n  private cesiumScene;\n\n  init(mapEventsManager: MapEventsManagerService,\n       coordinateConverter: CoordinateConverter,\n       cameraService: CameraService,\n       pointManager: PointsManagerService,\n       cesiumViewer: CesiumService) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.pointManager = pointManager;\n    this.updatePublisher.connect();\n\n    this.cesiumScene = cesiumViewer.getScene();\n  }\n\n  onUpdate(): Observable<PointEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  private screenToPosition(cartesian2) {\n    const cartesian3 = this.coordinateConverter.screenToCartesian3(cartesian2);\n\n    // If cartesian3 is undefined then the point inst on the globe\n    if (cartesian3) {\n      const ray = this.cameraService.getCamera().getPickRay(cartesian2);\n      return this.cesiumScene.globe.pick(ray, this.cesiumScene);\n    }\n    return cartesian3;\n  }\n\n  create(options = DEFAULT_POINT_OPTIONS, eventPriority = 100): PointEditorObservable {\n    const id = generateKey();\n    const pointOptions = this.setOptions(options);\n\n    const clientEditSubject = new BehaviorSubject<PointEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      pointOptions: pointOptions,\n    });\n\n    const finishCreation = (position: Cartesian3) => {\n      return this.switchToEditMode(\n        id,\n        clientEditSubject,\n        position,\n        eventPriority,\n        pointOptions,\n        editorObservable,\n        true\n      );\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n      pickConfig: options.pickConfiguration,\n    });\n    const addLastPointRegistration = this.mapEventsManager.register({\n      event: pointOptions.addLastPointEvent,\n      modifier: pointOptions.addLastPointModifier,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n      pickConfig: options.pickConfiguration,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addLastPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition);\n      if (position) {\n\n        this.updateSubject.next({\n          id,\n          position,\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.MOUSE_MOVE,\n        });\n      }\n    });\n    addLastPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition);\n      finishedCreate = finishCreation(position);\n    });\n    return editorObservable;\n  }\n\n  private switchToEditMode(id,\n                           clientEditSubject,\n                           position: Cartesian3,\n                           eventPriority,\n                           pointOptions,\n                           editorObservable,\n                           finishedCreate: boolean) {\n    const update = {\n      id,\n      position: position,\n      editMode: EditModes.CREATE_OR_EDIT,\n      updatedPosition: position,\n      editAction: EditActions.ADD_LAST_POINT,\n    };\n    this.updateSubject.next(update);\n    clientEditSubject.next({\n      ...update,\n      position: position,\n      point: this.getPoint(id),\n    });\n\n    const changeMode = {\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.CHANGE_TO_EDIT,\n    };\n    this.updateSubject.next(changeMode);\n    clientEditSubject.next(changeMode);\n    if (this.observablesMap.has(id)) {\n      this.observablesMap.get(id).forEach(registration => registration.dispose());\n    }\n    this.observablesMap.delete(id);\n    this.editPoint(id, position, eventPriority, clientEditSubject, pointOptions, editorObservable);\n    finishedCreate = true;\n    return finishedCreate;\n  }\n\n  edit(position: Cartesian3, options = DEFAULT_POINT_OPTIONS, priority = 100): PointEditorObservable {\n    const id = generateKey();\n    const pointOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<PointEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT\n    });\n    const update = {\n      id,\n      position: position,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      pointOptions: pointOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      position: position,\n      point: this.getPoint(id),\n    });\n    return this.editPoint(\n      id,\n      position,\n      priority,\n      editSubject,\n      pointOptions\n    );\n  }\n\n  private editPoint(id: string,\n                       position: Cartesian3,\n                       priority: number,\n                       editSubject: Subject<PointEditUpdate>,\n                       options: PointEditOptions,\n                       editObservable?: PointEditorObservable) {\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    const pointRemoveRegistration = this.mapEventsManager.register({\n      event: options.removePointEvent,\n      modifier: options.removePointModifier,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    pointDragRegistration.pipe(\n      tap(({ movement: { drop } }) => this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, drop }, entities }) => {\n        const updatedPosition = this.screenToPosition(endPosition);\n        if (!updatedPosition) {\n          return;\n        }\n        const update = {\n          id,\n          editMode: EditModes.EDIT,\n          updatedPosition,\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          position: updatedPosition,\n          point: this.getPoint(id),\n        });\n\n      });\n\n    const observables = [pointDragRegistration, pointRemoveRegistration];\n    this.observablesMap.set(id, observables);\n    return this.createEditorObservable(editSubject, id);\n  }\n\n  private setOptions(options: PointEditOptions) {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_POINT_OPTIONS));\n    const pointOptions: PointEditOptions = Object.assign(defaultClone, options);\n    pointOptions.pointProps = {...DEFAULT_POINT_OPTIONS.pointProps, ...options.pointProps};\n    pointOptions.pointProps = {...DEFAULT_POINT_OPTIONS.pointProps, ...options.pointProps};\n    return pointOptions;\n  }\n\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: (position: Cartesian3) => boolean)\n                                                                                                    : PointEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        position: this.getPosition(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        position: this.getPosition(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n\n    observableToExtend.setManually = (point: {\n      position: Cartesian3,\n      pointProp?: PointProps\n    } | Cartesian3, pointProps?: PointProps) => {\n      const newPoint = this.pointManager.get(id);\n      newPoint.setManually(point, pointProps);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Points editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation(null);\n    };\n\n    observableToExtend.getCurrentPoint = () => this.getPoint(id);\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.pointManager.get(id).labels;\n\n    return observableToExtend as PointEditorObservable;\n  }\n\n  private getPosition(id: string) {\n    const point = this.pointManager.get(id);\n    return point.getPosition();\n  }\n\n  private getPoint(id: string) {\n    const point = this.pointManager.get(id);\n    if (point) {\n      return point.getCurrentPoint();\n    }\n  }\n}\n","import { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { Cartesian2 } from '../../angular-cesium/models/cartesian2';\n\nexport interface LabelStyle {\n  show?: boolean;\n  font?: string;\n  style?: any;\n  fillColor?: any;\n  outlineColor?: any;\n  backgroundColor?: any;\n  backgroundPadding?: any;\n  showBackground?: boolean;\n  scale?: number;\n  distanceDisplayCondition?: any;\n  heightReference?: any;\n  horizontalOrigin?: any;\n  eyeOffset?: Cartesian3;\n  position?: Cartesian3;\n  pixelOffset?: Cartesian2;\n  pixelOffsetScaleByDistance?: any;\n  outlineWidth?: any;\n  scaleByDistance?: any;\n  translucencyByDistance?: any;\n  verticalOrigin?: any;\n  disableDepthTestDistance?: number;\n}\n\nexport interface LabelProps {\n  text: string;\n  show?: boolean;\n  font?: string;\n  style?: any;\n  fillColor?: any;\n  outlineColor?: any;\n  backgroundColor?: any;\n  backgroundPadding?: any;\n  showBackground?: boolean;\n  scale?: number;\n  distanceDisplayCondition?: any;\n  heightReference?: any;\n  horizontalOrigin?: any;\n  eyeOffset?: Cartesian3;\n  position?: Cartesian3;\n  pixelOffset?: Cartesian2;\n  pixelOffsetScaleByDistance?: any;\n  outlineWidth?: any;\n  scaleByDistance?: any;\n  translucencyByDistance?: any;\n  verticalOrigin?: any;\n  disableDepthTestDistance?: number;\n}\n\nexport const defaultLabelProps: LabelProps = {\n  backgroundColor: new Cesium.Color(0.165, 0.165, 0.165, 0.7),\n  backgroundPadding: new Cesium.Cartesian2(25, 20),\n  distanceDisplayCondition: undefined,\n  fillColor: Cesium.Color.WHITE,\n  font: '30px sans-serif',\n  heightReference: Cesium.HeightReference.NONE,\n  horizontalOrigin: Cesium.HorizontalOrigin.LEFT,\n  outlineColor: Cesium.Color.BLACK,\n  outlineWidth: 1.0,\n  pixelOffset: Cesium.Cartesian2.ZERO,\n  pixelOffsetScaleByDistance: undefined,\n  scale: 1.0,\n  scaleByDistance: undefined,\n  show: true,\n  showBackground: false,\n  style: Cesium.LabelStyle.FILL,\n  text: '',\n  translucencyByDistance: undefined,\n  verticalOrigin: Cesium.VerticalOrigin.BASELINE,\n  eyeOffset: Cesium.Cartesian3.ZERO,\n  disableDepthTestDistance: 0,\n};\n","import { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from './edit-point';\nimport { defaultLabelProps, LabelProps } from './label-props';\nimport { PointEditOptions, PointProps } from './point-edit-options';\n\ninterface PositionWithPointProps {\n  position: Cartesian3;\n  pointProp?: PointProps;\n}\n\nexport class EditablePoint extends AcEntity {\n  private point: EditPoint;\n  private _enableEdit = true;\n  private _props: PointProps;\n  private _labels: LabelProps[] = [];\n\n  constructor(private id: string,\n              private pointLayer: AcLayerComponent,\n              private coordinateConverter: CoordinateConverter,\n              private editOptions: PointEditOptions,\n              position?: Cartesian3) {\n    super();\n    this._props = {...editOptions.pointProps};\n    if (position) {\n      this.createFromExisting(position);\n    }\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels) {\n      return;\n    }\n    const position = this.point.getPosition();\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        label.position = position;\n      }\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get props(): PointProps {\n    return this._props;\n  }\n\n  set props(value: PointProps) {\n    this._props = value;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    if (value) {\n      this.point.props.color = Cesium.Color.WHITE;\n    } else {\n      this.point.props.color = Cesium.Color.DIMGREY;\n      this.point.props.pixelSize = 10;\n    }\n    this.updatePointLayer();\n  }\n\n  private createFromExisting(position: Cartesian3) {\n    this.point = new EditPoint(this.id, position, this._props);\n    this.updatePointLayer();\n  }\n\n  private hasPosition(point: PositionWithPointProps | Cartesian3): point is PositionWithPointProps {\n    if ((point as PositionWithPointProps).position) {\n      return true;\n    }\n    return false;\n  }\n\n  setManually(point: PositionWithPointProps | Cartesian3, props?: PointProps) {\n    if (!this.enableEdit) {\n      throw new Error('Update manually only in edit mode, after point is created');\n    }\n    let newProps = props;\n    if (this.hasPosition(point)) {\n      newProps = point.pointProp ? point.pointProp : props;\n      this.point.setPosition(point.position);\n    } else {\n      this.point.setPosition(point);\n    }\n    this.point.props = newProps;\n    this.updatePointLayer();\n  }\n\n  addLastPoint(position: Cartesian3) {\n    this.point.setPosition(position);\n    this.updatePointLayer();\n  }\n\n  movePoint(toPosition: Cartesian3) {\n    if (!this.point) {\n      this.point = new EditPoint(this.id, toPosition, this._props);\n    } else {\n      this.point.setPosition(toPosition);\n    }\n    this.updatePointLayer();\n  }\n\n  getCurrentPoint(): EditPoint {\n    return this.point;\n  }\n\n  getPosition(): Cartesian3 {\n    return this.point.getPosition();\n  }\n\n  getPositionCallbackProperty(): Cartesian3 {\n    return new Cesium.CallbackProperty(this.getPosition.bind(this), false);\n  }\n\n  private updatePointLayer() {\n    this.pointLayer.update(this.point, this.point.getId());\n  }\n\n  update() {\n    this.updatePointLayer();\n  }\n\n  dispose() {\n    this.pointLayer.remove(this.point.getId());\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n","import { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Injectable } from '@angular/core';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PointEditOptions } from '../../../models/point-edit-options';\nimport { EditablePoint } from '../../../models/editable-point';\n\n@Injectable()\nexport class PointsManagerService {\n  points: Map<string, EditablePoint> = new Map<string, EditablePoint>();\n\n  createEditablePoint(id: string,\n                      editPointLayer: AcLayerComponent,\n                      coordinateConverter: CoordinateConverter,\n                      editOptions?: PointEditOptions,\n                      position?: Cartesian3) {\n    const editablePoint = new EditablePoint(\n      id,\n      editPointLayer,\n      coordinateConverter,\n      editOptions,\n      position);\n    this.points.set(id, editablePoint\n    );\n  }\n\n  enableAll() {\n    this.points.forEach(point => point.enableEdit = true);\n  }\n\n  disableAll() {\n    this.points.forEach(point => point.enableEdit = false);\n  }\n\n  dispose(id: string) {\n    const point = this.points.get(id);\n    if (point.getCurrentPoint()) {\n      point.dispose();\n    }\n    this.points.delete(id);\n  }\n\n  get(id: string): EditablePoint {\n    return this.points.get(id);\n  }\n\n  clear() {\n    this.points.forEach(point => point.dispose());\n    this.points.clear();\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { CesiumService } from '../../../angular-cesium/services/cesium/cesium.service';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { PointsEditorService } from '../../services/entity-editors/points-editor/points-editor.service';\nimport { PointsManagerService } from '../../services/entity-editors/points-editor/points-manager.service';\nimport { PointEditUpdate } from '../../models/point-edit-update';\nimport { EditablePoint } from '../../models/editable-point';\nimport { LabelProps } from '../../models/label-props';\n\n@Component({\n  selector: 'points-editor',\n  template: /*html*/ `\n    <ac-layer #editPointLayer acFor=\"let point of editPoint$\" [context]=\"this\">\n      <ac-point-desc\n        props=\"{\n        position: point.getPositionCallbackProperty(),\n        pixelSize: getPointSize(point),\n        color: point.props.color,\n        outlineColor: point.props.outlineColor,\n        outlineWidth: point.props.outlineWidth,\n        show: getPointShow(point),\n        disableDepthTestDistance: point.props.disableDepthTestDistance,\n        heightReference: point.props.heightReference,\n    }\"\n      ></ac-point-desc>\n    </ac-layer>\n\n    <ac-layer #pointLabelsLayer acFor=\"let pointLabels of pointLabels$\" [context]=\"this\">\n      <ac-array-desc acFor=\"let label of pointLabels.labels\" [idGetter]=\"getLabelId\">\n        <ac-label-primitive-desc\n          props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n        >\n        </ac-label-primitive-desc>\n      </ac-array-desc>\n    </ac-layer>\n  `,\n  providers: [CoordinateConverter, PointsManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PointsEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: PointEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoint$ = new Subject<AcNotification>();\n  public pointLabels$ = new Subject<AcNotification>();\n\n  @ViewChild('editPointLayer') private editPointLayer: AcLayerComponent;\n  @ViewChild('pointLabelsLayer') private pointLabelsLayer: AcLayerComponent;\n\n  constructor(\n    private pointsEditor: PointsEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private pointsManager: PointsManagerService,\n    private cesiumService: CesiumService,\n  ) {\n    this.pointsEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, pointsManager, this.cesiumService);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.pointsEditor.onUpdate().subscribe((update: PointEditUpdate) => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(point: EditablePoint, update: PointEditUpdate, labels?: LabelProps[]) {\n    if (labels) {\n      point.labels = labels;\n      this.pointLabelsLayer.update(point, point.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    update.position = point.getPosition();\n    update.point = point.getCurrentPoint();\n    point.labels = this.editLabelsRenderFn(update, point.labels);\n    this.pointLabelsLayer.update(point, point.getId());\n  }\n\n  removeEditLabels(point: EditablePoint) {\n    point.labels = [];\n    this.pointLabelsLayer.remove(point.getId());\n  }\n\n  handleCreateUpdates(update: PointEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.pointsManager.createEditablePoint(\n          update.id,\n          this.editPointLayer,\n          this.coordinateConverter,\n          update.pointOptions,\n          update.position\n        );\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const point = this.pointsManager.get(update.id);\n        if (update.updatedPosition) {\n          point.addLastPoint(update.updatedPosition);\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const point = this.pointsManager.get(update.id);\n        if (update.updatedPosition) {\n          point.movePoint(update.updatedPosition);\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const point = this.pointsManager.get(update.id);\n        if (point && point.getCurrentPoint()) {\n          this.removeEditLabels(point);\n        }\n        this.pointsManager.dispose(update.id);\n        this.editLabelsRenderFn = undefined;\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const point = this.pointsManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(point, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const point = this.pointsManager.get(update.id);\n        this.renderEditLabels(point, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const point = this.pointsManager.get(update.id);\n        this.renderEditLabels(point, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: PointEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.pointsManager.createEditablePoint(\n          update.id,\n          this.editPointLayer,\n          this.coordinateConverter,\n          update.pointOptions,\n          update.position,\n        );\n        break;\n      }\n      case EditActions.DRAG_POINT: {\n        const point = this.pointsManager.get(update.id);\n        if (point && point.enableEdit) {\n          point.movePoint(update.updatedPosition);\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH: {\n        const point = this.pointsManager.get(update.id);\n        if (point && point.enableEdit) {\n          point.movePoint(update.updatedPosition);\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const point = this.pointsManager.get(update.id);\n        if (point) {\n          point.enableEdit = false;\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const point = this.pointsManager.get(update.id);\n        if (point) {\n          point.enableEdit = true;\n          this.renderEditLabels(point, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.pointsManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { PolylineProps } from './polyline-edit-options';\n\nexport class EditPolyline extends AcEntity {\n  static counter = 0;\n  private editedEntityId: string;\n  private id: string;\n  private positions: Cartesian3[];\n  private _polylineProps: PolylineProps;\n\n  constructor(entityId: string, startPosition: Cartesian3, endPosition: Cartesian3, polylineProps?: PolylineProps) {\n    super();\n    this.editedEntityId = entityId;\n    this.id = this.generateId();\n    this.positions = [startPosition, endPosition];\n    this._polylineProps = {...polylineProps};\n  }\n\n  get props(): PolylineProps {\n    return this._polylineProps;\n  }\n\n  set props(value: PolylineProps) {\n    this._polylineProps = value;\n  }\n\n  getEditedEntityId(): string {\n    return this.editedEntityId;\n  }\n\n  getPositions(): any[] {\n    return this.positions.map(p => p.clone());\n  }\n\n\n  getPositionsCallbackProperty(): Cartesian3[] {\n    return new Cesium.CallbackProperty(this.getPositions.bind(this), false);\n  }\n\n  validatePositions(): boolean {\n    return this.positions[0] !== undefined && this.positions[1] !== undefined;\n  }\n\n  getStartPosition() {\n    return this.positions[0];\n  }\n\n  getEndPosition() {\n    return this.positions[1];\n  }\n\n  setStartPosition(position: Cartesian3) {\n    this.positions[0] = position;\n  }\n\n  setEndPosition(position: Cartesian3) {\n    this.positions[1] = position;\n  }\n\n  getId(): string {\n    return this.id;\n  }\n\n  private generateId(): string {\n    return 'edit-polyline-' + EditPolyline.counter++;\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { EditPolyline } from './edit-polyline';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { PolygonEditOptions, PolygonProps } from './polygon-edit-options';\nimport { PointProps } from './point-edit-options';\nimport { PolylineProps } from './polyline-edit-options';\nimport { defaultLabelProps, LabelProps } from './label-props';\n\nexport class EditablePolygon extends AcEntity {\n  private positions: EditPoint[] = [];\n  private polylines: EditPolyline[] = [];\n  private movingPoint: EditPoint;\n  private doneCreation = false;\n  private _enableEdit = true;\n  private _polygonProps: PolygonProps;\n  private _defaultPointProps: PointProps;\n  private _defaultPolylineProps: PolylineProps;\n  private lastDraggedToPosition: Cartesian3;\n  private _labels: LabelProps[] = [];\n\n  constructor(private id: string,\n              private polygonsLayer: AcLayerComponent,\n              private pointsLayer: AcLayerComponent,\n              private polylinesLayer: AcLayerComponent,\n              private coordinateConverter: CoordinateConverter,\n              private polygonOptions: PolygonEditOptions,\n              positions?: Cartesian3[]) {\n    super();\n    this.polygonProps = {...polygonOptions.polygonProps};\n    this.defaultPointProps = {...polygonOptions.pointProps};\n    this.defaultPolylineProps = {...polygonOptions.polylineProps};\n    if (positions && positions.length >= 3) {\n      this.createFromExisting(positions);\n    }\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels) {\n      return;\n    }\n    const positions = this.getRealPositions();\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        label.position = positions[index];\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get defaultPolylineProps(): PolylineProps {\n    return this._defaultPolylineProps;\n  }\n\n  set defaultPolylineProps(value: PolylineProps) {\n    this._defaultPolylineProps = value;\n  }\n\n  get defaultPointProps(): PointProps {\n    return this._defaultPointProps;\n  }\n\n  get polygonProps(): PolygonProps {\n    return this._polygonProps;\n  }\n\n  set polygonProps(value: PolygonProps) {\n    this._polygonProps = value;\n  }\n\n  set defaultPointProps(value: PointProps) {\n    this._defaultPointProps = value;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this.positions.forEach(point => {\n      point.show = value;\n      this.updatePointsLayer(false, point);\n    });\n  }\n\n  private createFromExisting(positions: Cartesian3[]) {\n    positions.forEach((position) => {\n      this.addPointFromExisting(position);\n    });\n    this.addAllVirtualEditPoints();\n    this.updatePolygonsLayer();\n    this.doneCreation = true;\n  }\n\n  setPointsManually(points: { position: Cartesian3, pointProps: PointProps }[] | Cartesian3[], polygonProps?: PolygonProps) {\n    if (!this.doneCreation) {\n      throw new Error('Update manually only in edit mode, after polygon is created');\n    }\n\n    this.positions.forEach(p => this.pointsLayer.remove(p.getId()));\n    const newPoints: EditPoint[] = [];\n    for (let i = 0; i < points.length; i++) {\n      const pointOrCartesian: any = points[i];\n      let newPoint = null;\n      if (pointOrCartesian.pointProps) {\n        newPoint = new EditPoint(this.id, pointOrCartesian.position, pointOrCartesian.pointProps);\n      } else {\n        newPoint = new EditPoint(this.id, pointOrCartesian, this.defaultPointProps);\n      }\n      newPoints.push(newPoint);\n    }\n    this.positions = newPoints;\n    this.polygonProps = polygonProps ? polygonProps : this.polygonProps;\n    this.updatePointsLayer(true, ...this.positions);\n    this.addAllVirtualEditPoints();\n    this.updatePolygonsLayer();\n  }\n\n  private addAllVirtualEditPoints() {\n    const currentPoints = [...this.positions];\n    currentPoints.forEach((pos, index) => {\n      const currentPoint = pos;\n      const nextIndex = (index + 1) % (currentPoints.length);\n      const nextPoint = currentPoints[nextIndex];\n      const midPoint = this.setMiddleVirtualPoint(currentPoint, nextPoint);\n      this.updatePointsLayer(false, midPoint);\n    });\n  }\n\n  private setMiddleVirtualPoint(firstP: EditPoint, secondP: EditPoint): EditPoint {\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(firstP.getPosition(), secondP.getPosition(), 0.5, new Cesium.Cartesian3());\n    const midPoint = new EditPoint(this.id, midPointCartesian3, this.defaultPointProps);\n    midPoint.setVirtualEditPoint(true);\n\n    const firstIndex = this.positions.indexOf(firstP);\n    this.positions.splice(firstIndex + 1, 0, midPoint);\n    return midPoint;\n  }\n\n  private updateMiddleVirtualPoint(virtualEditPoint: EditPoint, prevPoint: EditPoint, nextPoint: EditPoint) {\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(prevPoint.getPosition(), nextPoint.getPosition(), 0.5, new Cesium.Cartesian3());\n    virtualEditPoint.setPosition(midPointCartesian3);\n  }\n\n  changeVirtualPointToRealPoint(point: EditPoint) {\n    point.setVirtualEditPoint(false); // virtual point becomes a real point\n    const pointsCount = this.positions.length;\n    const pointIndex = this.positions.indexOf(point);\n    const nextIndex = (pointIndex + 1) % (pointsCount);\n    const preIndex = ((pointIndex - 1) + pointsCount) % pointsCount;\n\n    const nextPoint = this.positions[nextIndex];\n    const prePoint = this.positions[preIndex];\n\n    const firstMidPoint = this.setMiddleVirtualPoint(prePoint, point);\n    const secMidPoint = this.setMiddleVirtualPoint(point, nextPoint);\n    this.updatePointsLayer(true, firstMidPoint, secMidPoint, point);\n    this.updatePolygonsLayer();\n\n  }\n\n  private renderPolylines() {\n    this.polylines.forEach(polyline => this.polylinesLayer.remove(polyline.getId()));\n    this.polylines = [];\n    const realPoints = this.positions.filter(pos => !pos.isVirtualEditPoint());\n    realPoints.forEach((point, index) => {\n      const nextIndex = (index + 1) % (realPoints.length);\n      const nextPoint = realPoints[nextIndex];\n      const polyline = new EditPolyline(this.id, point.getPosition(), nextPoint.getPosition(), this.defaultPolylineProps);\n      this.polylines.push(polyline);\n      this.polylinesLayer.update(polyline, polyline.getId());\n    });\n  }\n\n  addPointFromExisting(position: Cartesian3) {\n    const newPoint = new EditPoint(this.id, position, this.defaultPointProps);\n    this.positions.push(newPoint);\n    this.updatePointsLayer(true, newPoint);\n  }\n\n\n  addPoint(position: Cartesian3) {\n    if (this.doneCreation) {\n      return;\n    }\n    const isFirstPoint = !this.positions.length;\n    if (isFirstPoint) {\n      const firstPoint = new EditPoint(this.id, position, this.defaultPointProps);\n      this.positions.push(firstPoint);\n      this.updatePointsLayer(true, firstPoint);\n    }\n\n    this.movingPoint = new EditPoint(this.id, position.clone(), this.defaultPointProps);\n    this.positions.push(this.movingPoint);\n\n    this.updatePointsLayer(true, this.movingPoint);\n    this.updatePolygonsLayer();\n  }\n\n  movePointFinish(editPoint: EditPoint) {\n    if (this.polygonOptions.clampHeightTo3D) {\n      editPoint.props.disableDepthTestDistance = Number.POSITIVE_INFINITY;\n      this.updatePointsLayer(false, editPoint);\n    }\n  }\n\n  movePoint(toPosition: Cartesian3, editPoint: EditPoint) {\n    editPoint.setPosition(toPosition);\n    if (this.doneCreation) {\n      if (editPoint.props.disableDepthTestDistance && this.polygonOptions.clampHeightTo3D) {\n        // To avoid bug with pickPosition() on point with disableDepthTestDistance\n        editPoint.props.disableDepthTestDistance = undefined;\n        return; // ignore first move because the pickPosition() could be wrong\n      }\n\n      if (editPoint.isVirtualEditPoint()) {\n        this.changeVirtualPointToRealPoint(editPoint);\n      }\n      const pointsCount = this.positions.length;\n      const pointIndex = this.positions.indexOf(editPoint);\n      const nextVirtualPoint = this.positions[(pointIndex + 1) % (pointsCount)];\n      const nextRealPoint = this.positions[(pointIndex + 2) % (pointsCount)];\n      const prevVirtualPoint = this.positions[((pointIndex - 1) + pointsCount) % pointsCount];\n      const prevRealPoint = this.positions[((pointIndex - 2) + pointsCount) % pointsCount];\n      this.updateMiddleVirtualPoint(nextVirtualPoint, editPoint, nextRealPoint);\n      this.updateMiddleVirtualPoint(prevVirtualPoint, editPoint, prevRealPoint);\n    }\n    this.updatePolygonsLayer();\n    this.updatePointsLayer(true, editPoint);\n  }\n\n  moveTempMovingPoint(toPosition: Cartesian3) {\n    if (this.movingPoint) {\n      this.movePoint(toPosition, this.movingPoint);\n    }\n  }\n\n  movePolygon(startMovingPosition: Cartesian3, draggedToPosition: Cartesian3) {\n    if (!this.doneCreation) {\n      return;\n    }\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = startMovingPosition;\n    }\n\n    const delta = GeoUtilsService.getPositionsDelta(this.lastDraggedToPosition, draggedToPosition);\n    this.positions.forEach(point => {\n      const newPos = GeoUtilsService.addDeltaToPosition(point.getPosition(), delta, true);\n      point.setPosition(newPos);\n    });\n    this.updatePointsLayer();\n    this.lastDraggedToPosition = draggedToPosition;\n    this.positions.forEach(point => this.updatePointsLayer(true, point));\n  }\n\n  endMovePolygon() {\n    this.lastDraggedToPosition = undefined;\n  }\n\n  removePoint(pointToRemove: EditPoint) {\n    this.removePosition(pointToRemove);\n    this.positions\n      .filter(p => p.isVirtualEditPoint())\n      .forEach(p => this.removePosition(p));\n    this.addAllVirtualEditPoints();\n\n    this.renderPolylines();\n    if (this.getPointsCount() >= 3) {\n      this.polygonsLayer.update(this, this.id);\n    }\n  }\n\n  addLastPoint(position: Cartesian3) {\n    this.doneCreation = true;\n    this.removePosition(this.movingPoint); // remove movingPoint\n    this.movingPoint = null;\n    this.updatePolygonsLayer();\n\n    this.addAllVirtualEditPoints();\n  }\n\n  getRealPositions(): Cartesian3[] {\n    return this.getRealPoints().map(position => position.getPosition());\n  }\n\n  getRealPoints(): EditPoint[] {\n    return this.positions.filter(position => !position.isVirtualEditPoint() && position !== this.movingPoint);\n  }\n\n  getPoints(): EditPoint[] {\n    return this.positions.filter(position => position !== this.movingPoint);\n  }\n\n  getPositionsHierarchy(): Cartesian3[] {\n    const positions = this.positions.filter(position => !position.isVirtualEditPoint()).map(position => position.getPosition().clone());\n    return new Cesium.PolygonHierarchy(positions);\n  }\n\n  getPositionsHierarchyCallbackProperty(): Cartesian3[] {\n    return new Cesium.CallbackProperty(this.getPositionsHierarchy.bind(this), false);\n  }\n\n  private removePosition(point: EditPoint) {\n    const index = this.positions.findIndex((p) => p === point);\n    if (index < 0) {\n      return;\n    }\n    this.positions.splice(index, 1);\n    this.pointsLayer.remove(point.getId());\n  }\n\n  private updatePolygonsLayer() {\n    if (this.getPointsCount() >= 3) {\n      this.polygonsLayer.update(this, this.id);\n    }\n  }\n\n  private updatePointsLayer(renderPolylines = true, ...points: EditPoint[]) {\n    if (renderPolylines) {\n      this.renderPolylines();\n    }\n    points.forEach(p => this.pointsLayer.update(p, p.getId()));\n  }\n\n  dispose() {\n    this.polygonsLayer.remove(this.id);\n\n    this.positions.forEach(editPoint => {\n      this.pointsLayer.remove(editPoint.getId());\n    });\n    this.polylines.forEach(line => this.polylinesLayer.remove(line.getId()));\n    if (this.movingPoint) {\n      this.pointsLayer.remove(this.movingPoint.getId());\n      this.movingPoint = undefined;\n    }\n    this.positions.length = 0;\n  }\n\n  getPointsCount(): number {\n    return this.positions.length;\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EditablePolygon } from '../../../models/editable-polygon';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PolygonEditOptions } from '../../../models/polygon-edit-options';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\n\n@Injectable()\nexport class PolygonsManagerService {\n  polygons: Map<string, EditablePolygon> = new Map<string, EditablePolygon>();\n\n  createEditablePolygon(id: string, editPolygonsLayer: AcLayerComponent, editPointsLayer: AcLayerComponent,\n                        editPolylinesLayer: AcLayerComponent, coordinateConverter: CoordinateConverter,\n                        polygonOptions?: PolygonEditOptions, positions?: Cartesian3[]) {\n    const editablePolygon = new EditablePolygon(\n      id,\n      editPolygonsLayer,\n      editPointsLayer,\n      editPolylinesLayer,\n      coordinateConverter,\n      polygonOptions,\n      positions);\n    this.polygons.set(id, editablePolygon\n    );\n  }\n\n  dispose(id: string) {\n    this.polygons.get(id).dispose();\n    this.polygons.delete(id);\n  }\n\n  get(id: string): EditablePolygon {\n    return this.polygons.get(id);\n  }\n\n  clear() {\n    this.polygons.forEach(polygon => polygon.dispose());\n    this.polygons.clear();\n  }\n}\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../../angular-cesium/services/cesium/cesium.service';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { PolygonEditUpdate } from '../../../models/polygon-edit-update';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PolygonsManagerService } from './polygons-manager.service';\nimport { PolygonEditorObservable } from '../../../models/polygon-editor-observable';\nimport { EditablePolygon } from '../../../models/editable-polygon';\nimport { PolygonEditOptions, PolygonProps } from '../../../models/polygon-edit-options';\nimport { ClampTo3DOptions } from '../../../models/polyline-edit-options';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { LabelProps } from '../../../models/label-props';\nimport { debounce, generateKey } from '../../utils';\n\nexport const DEFAULT_POLYGON_OPTIONS: PolygonEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  addLastPointEvent: CesiumEvent.LEFT_DOUBLE_CLICK,\n  removePointEvent: CesiumEvent.RIGHT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  pointProps: {\n    color: Cesium.Color.WHITE.withAlpha(0.95),\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.2),\n    outlineWidth: 1,\n    pixelSize: 13,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n  polygonProps: {\n    material: Cesium.Color.CORNFLOWERBLUE.withAlpha(0.4),\n    fill: true,\n    classificationType: Cesium.ClassificationType.BOTH,\n    zIndex: 0,\n  },\n  polylineProps: {\n    material: () => Cesium.Color.WHITE,\n    width: 3,\n    clampToGround: false,\n    zIndex: 0,\n    classificationType: Cesium.ClassificationType.BOTH,\n  },\n  clampHeightTo3D: false,\n  clampHeightTo3DOptions: {\n    clampToTerrain: false,\n    clampMostDetailed: true,\n    clampToHeightPickWidth: 2,\n  },\n};\n\n/**\n * Service for creating editable polygons\n *\n * You must provide `PolygonsEditorService` yourself.\n * PolygonsEditorService works together with `<polygons-editor>` component. Therefor you need to create `<polygons-editor>`\n * for each `PolygonsEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `PolygonEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `PolygonEditorObservable`.\n * + To stop editing call `dsipose()` from the `PolygonEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `PolygonEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating polygon\n *  const editing$ = polygonsEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit polygon from existing polygon positions\n *  const editing$ = this.polygonsEditorService.edit(initialPos);\n *\n * ```\n */\n@Injectable()\nexport class PolygonsEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<PolygonEditUpdate>();\n  private updatePublisher = publish<PolygonEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private polygonsManager: PolygonsManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n  private cesiumScene: any;\n\n  private clampPointsDebounced = debounce((id, clampHeightTo3D: boolean, clampHeightTo3DOptions) => {\n    this.clampPoints(id, clampHeightTo3D, clampHeightTo3DOptions);\n  }, 300);\n\n  init(mapEventsManager: MapEventsManagerService,\n       coordinateConverter: CoordinateConverter,\n       cameraService: CameraService,\n       polygonsManager: PolygonsManagerService,\n       cesiumViewer: CesiumService,\n  ) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.polygonsManager = polygonsManager;\n    this.updatePublisher.connect();\n\n    this.cesiumScene = cesiumViewer.getScene();\n  }\n\n  onUpdate(): Observable<PolygonEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  private clampPoints(id, clampHeightTo3D: boolean, { clampToTerrain, clampMostDetailed, clampToHeightPickWidth }: ClampTo3DOptions) {\n    if (clampHeightTo3D && clampMostDetailed) {\n      const polygon = this.polygonsManager.get(id);\n      const points = polygon.getPoints();\n\n      if (!clampToTerrain) {\n        // 3dTiles\n        points.forEach(point => {\n          point.setPosition(this.cesiumScene.clampToHeight(point.getPosition(), undefined, clampToHeightPickWidth));\n        });\n        // const cartesians = points.map(point => point.getPosition());\n        // const promise = this.cesiumScene.clampToHeightMostDetailed(cartesians, undefined, clampToHeightPickWidth);\n        // promise.then((updatedCartesians) => {\n        //   points.forEach((point, index) => {\n        //     point.setPosition(updatedCartesians[index]);\n        //   });\n        // });\n      } else {\n        const cartographics = points.map(point => this.coordinateConverter.cartesian3ToCartographic(point.getPosition()));\n        const promise = Cesium.sampleTerrain(this.cesiumScene.terrainProvider, 11, cartographics);\n        Cesium.when(promise, (updatedPositions) => {\n          points.forEach((point, index) => {\n            point.setPosition(Cesium.Cartographic.toCartesian(updatedPositions[index]));\n          });\n        });\n      }\n    }\n  }\n\n  private screenToPosition(cartesian2, clampHeightTo3D: boolean, { clampToHeightPickWidth, clampToTerrain }: ClampTo3DOptions) {\n    const cartesian3 = this.coordinateConverter.screenToCartesian3(cartesian2);\n\n    // If cartesian3 is undefined then the point inst on the globe\n    if (clampHeightTo3D && cartesian3) {\n      const globePositionPick = () => {\n        const ray = this.cameraService.getCamera().getPickRay(cartesian2);\n        return this.cesiumScene.globe.pick(ray, this.cesiumScene);\n      };\n\n      // is terrain?\n      if (clampToTerrain) {\n        return globePositionPick();\n      } else {\n        const cartesian3PickPosition = this.cesiumScene.pickPosition(cartesian2);\n        const latLon = CoordinateConverter.cartesian3ToLatLon(cartesian3PickPosition);\n        if (latLon.height < 0) {// means nothing picked -> Validate it\n          return globePositionPick();\n        }\n        return this.cesiumScene.clampToHeight(cartesian3PickPosition, undefined, clampToHeightPickWidth);\n      }\n    }\n\n    return cartesian3;\n  }\n\n  create(options = DEFAULT_POLYGON_OPTIONS, priority = 100): PolygonEditorObservable {\n    const positions: Cartesian3[] = [];\n    const id = generateKey();\n    const polygonOptions = this.setOptions(options);\n\n    const clientEditSubject = new BehaviorSubject<PolygonEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      positions,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      polygonOptions: polygonOptions,\n    });\n\n    const finishCreation = (position: Cartesian3) => {\n      return this.switchToEditMode(\n        id,\n        position,\n        clientEditSubject,\n        positions,\n        priority,\n        polygonOptions,\n        editorObservable,\n        finishedCreate);\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: polygonOptions.addPointEvent,\n      modifier: polygonOptions.addPointModifier,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n    const addLastPointRegistration = this.mapEventsManager.register({\n      event: polygonOptions.addLastPointEvent,\n      modifier: polygonOptions.addLastPointModifier,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration, addLastPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition, polygonOptions.clampHeightTo3D, polygonOptions.clampHeightTo3DOptions);\n\n      if (position) {\n        this.updateSubject.next({\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.MOUSE_MOVE,\n        });\n      }\n    });\n\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.screenToPosition(endPosition, polygonOptions.clampHeightTo3D, polygonOptions.clampHeightTo3DOptions);\n      if (!position) {\n        return;\n      }\n      const allPositions = this.getPositions(id);\n      if (allPositions.find((cartesian) => cartesian.equals(position))) {\n        return;\n      }\n\n      const updateValue = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.CREATE,\n        updatedPosition: position,\n        editAction: EditActions.ADD_POINT,\n      };\n      this.updateSubject.next(updateValue);\n      clientEditSubject.next({\n        ...updateValue,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n      });\n\n      if (polygonOptions.maximumNumberOfPoints && allPositions.length + 1 === polygonOptions.maximumNumberOfPoints) {\n        finishedCreate = finishCreation(position);\n      }\n    });\n\n\n    addLastPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition, polygonOptions.clampHeightTo3D, polygonOptions.clampHeightTo3DOptions);\n      if (!position) {\n        return;\n      }\n\n      // Add last point to positions if not already added\n      const allPositions = this.getPositions(id);\n      if (!allPositions.find((cartesian) => cartesian.equals(position))) {\n        const updateValue = {\n          id,\n          positions: allPositions,\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.ADD_POINT,\n        };\n        this.updateSubject.next(updateValue);\n        clientEditSubject.next({\n          ...updateValue,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n        });\n      }\n\n      finishedCreate = finishCreation(position);\n    });\n\n    return editorObservable;\n  }\n\n  private switchToEditMode(id,\n                           position,\n                           clientEditSubject,\n                           positions: Cartesian3[],\n                           priority,\n                           polygonOptions,\n                           editorObservable,\n                           finishedCreate: boolean) {\n    const updateValue = {\n      id,\n      positions: this.getPositions(id),\n      editMode: EditModes.CREATE,\n      updatedPosition: position,\n      editAction: EditActions.ADD_LAST_POINT,\n    };\n    this.updateSubject.next(updateValue);\n    clientEditSubject.next({\n      ...updateValue,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n    });\n\n    const changeMode = {\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.CHANGE_TO_EDIT,\n    };\n    this.updateSubject.next(changeMode);\n    clientEditSubject.next(changeMode);\n    if (this.observablesMap.has(id)) {\n      this.observablesMap.get(id).forEach(registration => registration.dispose());\n    }\n    this.observablesMap.delete(id);\n    this.editPolygon(id, positions, priority, clientEditSubject, polygonOptions, editorObservable);\n    finishedCreate = true;\n    return finishedCreate;\n  }\n\n  edit(positions: Cartesian3[], options = DEFAULT_POLYGON_OPTIONS, priority = 100): PolygonEditorObservable {\n    if (positions.length < 3) {\n      throw new Error('Polygons editor error edit(): polygon should have at least 3 positions');\n    }\n    const id = generateKey();\n    const polygonOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<PolygonEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT\n    });\n    const update = {\n      id,\n      positions: positions,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      polygonOptions: polygonOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n    });\n    return this.editPolygon(\n      id,\n      positions,\n      priority,\n      editSubject,\n      polygonOptions\n    );\n  }\n\n  private editPolygon(id: string,\n                      positions: Cartesian3[],\n                      priority: number,\n                      editSubject: Subject<PolygonEditUpdate>,\n                      options: PolygonEditOptions,\n                      editObservable?: PolygonEditorObservable): PolygonEditorObservable {\n    this.clampPoints(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: options.dragShapeEvent,\n        entityType: EditablePolygon,\n        pick: PickOptions.PICK_FIRST,\n        pickConfig: options.pickConfiguration,\n        priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n    const pointRemoveRegistration = this.mapEventsManager.register({\n      event: options.removePointEvent,\n      entityType: EditPoint,\n      modifier: options.removePointModifier,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    pointDragRegistration.pipe(\n      tap(({ movement: { drop } }) => this.polygonsManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, drop }, entities }) => {\n        const position = this.screenToPosition(endPosition, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n        if (!position) {\n          return;\n        }\n        const point: EditPoint = entities[0];\n\n        const update = {\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.EDIT,\n          updatedPosition: position,\n          updatedPoint: point,\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n        });\n\n        this.clampPointsDebounced(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n      });\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({ movement: { drop } }) => this.polygonsManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n        .subscribe(({ movement: { startPosition, endPosition, drop }, entities }) => {\n          const endDragPosition = this.screenToPosition(endPosition, false, options.clampHeightTo3DOptions);\n          const startDragPosition = this.screenToPosition(startPosition, false, options.clampHeightTo3DOptions);\n          if (!endDragPosition) {\n            return;\n          }\n\n          const update = {\n            id,\n            positions: this.getPositions(id),\n            editMode: EditModes.EDIT,\n            updatedPosition: endDragPosition,\n            draggedPosition: startDragPosition,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n            positions: this.getPositions(id),\n            points: this.getPoints(id),\n          });\n        });\n    }\n\n    pointRemoveRegistration.subscribe(({ entities }) => {\n      const point: EditPoint = entities[0];\n      const allPositions = [...this.getPositions(id)];\n      if (allPositions.length < 4) {\n        return;\n      }\n      const index = allPositions.findIndex(position => point.getPosition().equals(position as Cartesian3));\n      if (index < 0) {\n        return;\n      }\n\n      const update = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.EDIT,\n        updatedPoint: point,\n        editAction: EditActions.REMOVE_POINT,\n      };\n      this.updateSubject.next(update);\n      editSubject.next({\n        ...update,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n      });\n\n      this.clampPoints(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n    });\n\n    const observables = [pointDragRegistration, pointRemoveRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n\n    this.observablesMap.set(id, observables);\n    return editObservable || this.createEditorObservable(editSubject, id);\n  }\n\n  private setOptions(options: PolygonEditOptions) {\n    if (options.maximumNumberOfPoints && options.maximumNumberOfPoints < 3) {\n      console.warn('Warn: PolygonEditor invalid option.' +\n        ' maximumNumberOfPoints smaller then 3, maximumNumberOfPoints changed to 3');\n      options.maximumNumberOfPoints = 3;\n    }\n\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_POLYGON_OPTIONS));\n    const polygonOptions: PolygonEditOptions = Object.assign(defaultClone, options);\n    polygonOptions.pointProps = { ...DEFAULT_POLYGON_OPTIONS.pointProps, ...options.pointProps};\n    polygonOptions.polygonProps = {...DEFAULT_POLYGON_OPTIONS.polygonProps, ...options.polygonProps};\n    polygonOptions.polylineProps = {...DEFAULT_POLYGON_OPTIONS.polylineProps, ...options.polylineProps};\n    polygonOptions.clampHeightTo3DOptions = { ...DEFAULT_POLYGON_OPTIONS.clampHeightTo3DOptions, ...options.clampHeightTo3DOptions};\n\n    if (options.clampHeightTo3D) {\n      if (!this.cesiumScene.pickPositionSupported || !this.cesiumScene.clampToHeightSupported) {\n        throw new Error(`Cesium pickPosition and clampToHeight must be supported to use clampHeightTo3D`);\n      }\n\n      if (this.cesiumScene.pickTranslucentDepth) {\n        console.warn(`Cesium scene.pickTranslucentDepth must be false in order to make the editors work properly on 3D`);\n      }\n\n      if (polygonOptions.pointProps.color.alpha === 1 || polygonOptions.pointProps.outlineColor.alpha === 1) {\n        console.warn('Point color and outline color must have alpha in order to make the editor work properly on 3D');\n      }\n\n      polygonOptions.allowDrag = false;\n      polygonOptions.polylineProps.clampToGround = true;\n      polygonOptions.pointProps.heightReference = polygonOptions.clampHeightTo3DOptions.clampToTerrain ?\n        Cesium.HeightReference.CLAMP_TO_GROUND : Cesium.HeightReference.RELATIVE_TO_GROUND;\n      polygonOptions.pointProps.disableDepthTestDistance = Number.POSITIVE_INFINITY;\n    }\n    return polygonOptions;\n  }\n\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: (position: Cartesian3) => boolean)\n                                                                                                        : PolygonEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n    observableToExtend.setManually = (points: {\n      position: Cartesian3, pointProps: PointProps\n    }[] | Cartesian3[], polygonProps?: PolygonProps) => {\n      const polygon = this.polygonsManager.get(id);\n      polygon.setPointsManually(points, polygonProps);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Polygons editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation(null);\n    };\n\n    observableToExtend.getCurrentPoints = () => this.getPoints(id);\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.polygonsManager.get(id).labels;\n\n    return observableToExtend as PolygonEditorObservable;\n  }\n\n  private getPositions(id: string) {\n    const polygon = this.polygonsManager.get(id);\n    return polygon.getRealPositions();\n  }\n\n  private getPoints(id: string) {\n    const polygon = this.polygonsManager.get(id);\n    return polygon.getRealPoints();\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { CesiumService } from '../../../angular-cesium/services/cesium/cesium.service';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { PolygonEditUpdate } from '../../models/polygon-edit-update';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { PolygonsManagerService } from '../../services/entity-editors/polygons-editor/polygons-manager.service';\nimport { PolygonsEditorService } from '../../services/entity-editors/polygons-editor/polygons-editor.service';\nimport { LabelProps } from '../../models/label-props';\nimport { EditablePolygon } from '../../models/editable-polygon';\n\n@Component({\n  selector: 'polygons-editor',\n  template: /*html*/ `\n    <ac-layer #editPolylinesLayer acFor=\"let polyline of editPolylines$\" [context]=\"this\">\n      <ac-polyline-desc\n        props=\"{\n        positions: polyline.getPositionsCallbackProperty(),\n        width: polyline.props.width,\n        material: polyline.props.material(),\n        clampToGround: polyline.props.clampToGround,\n        zIndex: polyline.props.zIndex,\n        classificationType: polyline.props.classificationType,\n      }\"\n      >\n      </ac-polyline-desc>\n    </ac-layer>\n\n    <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n      <ac-point-desc\n        props=\"{\n        position: point.getPositionCallbackProperty(),\n        pixelSize: getPointSize(point),\n        color: point.props.color,\n        outlineColor: point.props.outlineColor,\n        outlineWidth: point.props.outlineWidth,\n        show: getPointShow(point),\n        disableDepthTestDistance: point.props.disableDepthTestDistance,\n        heightReference: point.props.heightReference,\n    }\"\n      >\n      </ac-point-desc>\n    </ac-layer>\n\n    <ac-layer #editPolygonsLayer acFor=\"let polygon of editPolygons$\" [context]=\"this\">\n      <ac-polygon-desc\n        props=\"{\n          hierarchy: polygon.getPositionsHierarchyCallbackProperty(),\n          material: polygon.polygonProps.material,\n          fill: polygon.polygonProps.fill,\n          classificationType: polygon.polygonProps.classificationType,\n          zIndex: polygon.polygonProps.zIndex,\n        }\"\n      >\n      </ac-polygon-desc>\n      <ac-array-desc acFor=\"let label of polygon.labels\" [idGetter]=\"getLabelId\">\n        <ac-label-primitive-desc\n          props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n        >\n        </ac-label-primitive-desc>\n      </ac-array-desc>\n    </ac-layer>\n  `,\n  providers: [CoordinateConverter, PolygonsManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PolygonsEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: PolygonEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editPolylines$ = new Subject<AcNotification>();\n  public editPolygons$ = new Subject<AcNotification>();\n\n  @ViewChild('editPolygonsLayer') private editPolygonsLayer: AcLayerComponent;\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n  @ViewChild('editPolylinesLayer') private editPolylinesLayer: AcLayerComponent;\n\n  constructor(\n    private polygonsEditor: PolygonsEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private polygonsManager: PolygonsManagerService,\n    private cesiumService: CesiumService\n  ) {\n    this.polygonsEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, this.polygonsManager, this.cesiumService);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.polygonsEditor.onUpdate().subscribe((update: PolygonEditUpdate) => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(polygon: EditablePolygon, update: PolygonEditUpdate, labels?: LabelProps[]) {\n    update.positions = polygon.getRealPositions();\n    update.points = polygon.getRealPoints();\n\n    if (labels) {\n      polygon.labels = labels;\n      this.editPolygonsLayer.update(polygon, polygon.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    polygon.labels = this.editLabelsRenderFn(update, polygon.labels);\n    this.editPolygonsLayer.update(polygon, polygon.getId());\n  }\n\n  removeEditLabels(polygon: EditablePolygon) {\n    polygon.labels = [];\n    this.editPolygonsLayer.update(polygon, polygon.getId());\n  }\n\n  handleCreateUpdates(update: PolygonEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.polygonsManager.createEditablePolygon(\n          update.id,\n          this.editPolygonsLayer,\n          this.editPointsLayer,\n          this.editPolylinesLayer,\n          this.coordinateConverter,\n          update.polygonOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (update.updatedPosition) {\n          polygon.moveTempMovingPoint(update.updatedPosition);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (update.updatedPosition) {\n          polygon.moveTempMovingPoint(update.updatedPosition);\n          polygon.addPoint(update.updatedPosition);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (update.updatedPosition) {\n          polygon.addLastPoint(update.updatedPosition);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon) {\n          polygon.dispose();\n          this.removeEditLabels(polygon);\n          this.editLabelsRenderFn = undefined;\n        }\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const polygon = this.polygonsManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(polygon, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const polygon = this.polygonsManager.get(update.id);\n        this.renderEditLabels(polygon, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const polygon = this.polygonsManager.get(update.id);\n        this.renderEditLabels(polygon, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: PolygonEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.polygonsManager.createEditablePolygon(\n          update.id,\n          this.editPolygonsLayer,\n          this.editPointsLayer,\n          this.editPolylinesLayer,\n          this.coordinateConverter,\n          update.polygonOptions,\n          update.positions,\n        );\n        break;\n      }\n      case EditActions.DRAG_POINT: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon && polygon.enableEdit) {\n          polygon.movePoint(update.updatedPosition, update.updatedPoint);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon && polygon.enableEdit) {\n          polygon.movePointFinish(update.updatedPoint);\n\n          if (update.updatedPoint.isVirtualEditPoint()) {\n            polygon.changeVirtualPointToRealPoint(update.updatedPoint);\n            this.renderEditLabels(polygon, update);\n          }\n        }\n        break;\n      }\n      case EditActions.REMOVE_POINT: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon && polygon.enableEdit) {\n          polygon.removePoint(update.updatedPoint);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon) {\n          polygon.enableEdit = false;\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon && polygon.enableEdit) {\n          polygon.movePolygon(update.draggedPosition, update.updatedPosition);\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon && polygon.enableEdit) {\n          polygon.endMovePolygon();\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const polygon = this.polygonsManager.get(update.id);\n        if (polygon) {\n          polygon.enableEdit = true;\n          this.renderEditLabels(polygon, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.polygonsManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { PolylineProps } from './polyline-edit-options';\n\nexport class EditArc extends AcEntity {\n  static counter = 0;\n  private id: string;\n  private editedEntityId: string;\n  private _center: Cartesian3;\n  private _radius: number;\n  private _delta: number;\n  private _angle: number;\n\n  constructor(entityId: string, center: Cartesian3, radius: number, delta: number, angle: number, private _arcProps: PolylineProps) {\n    super();\n    this.id = this.generateId();\n    this.editedEntityId = entityId;\n    this._center = center;\n    this._radius = radius;\n    this._delta = delta;\n    this._angle = angle;\n  }\n\n  get props() {\n    return this._arcProps;\n  }\n\n  set props(props: PolylineProps) {\n    this._arcProps = props;\n  }\n\n  get angle(): number {\n    return this._angle;\n  }\n\n  set angle(value: number) {\n    this._angle = value;\n  }\n\n  get delta(): number {\n    return this._delta;\n  }\n\n  set delta(value: number) {\n    this._delta = value;\n  }\n\n  get radius(): number {\n    return this._radius;\n  }\n\n  set radius(value: number) {\n    this._radius = value;\n  }\n\n  get center(): Cartesian3 {\n    return this._center;\n  }\n\n  set center(value: Cartesian3) {\n    this._center = value;\n  }\n\n  updateCenter(center: Cartesian3) {\n    this._center.x = center.x;\n    this._center.y = center.y;\n    this._center.z = center.z;\n  }\n\n  getId(): string {\n    return this.id;\n  }\n\n  private generateId(): string {\n    return 'edit-arc-' + EditArc.counter++;\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { EditArc } from './edit-arc';\nimport { CircleEditOptions } from './circle-edit-options';\nimport { PointProps } from './point-edit-options';\nimport { PolylineProps } from './polyline-edit-options';\nimport { defaultLabelProps, LabelProps } from './label-props';\nimport { EllipseProps } from './ellipse-edit-options';\n\nexport class EditableCircle extends AcEntity {\n  private _center: EditPoint;\n  private _radiusPoint: EditPoint;\n  private _outlineArc: EditArc;\n  private doneCreation = false;\n  private _enableEdit = true;\n  private lastDraggedToPosition: any;\n  private _circleProps: EllipseProps;\n  private _pointProps: PointProps;\n  private _polylineProps: PolylineProps;\n  private _labels: LabelProps[] = [];\n\n  constructor(\n    private id: string,\n    private circlesLayer: AcLayerComponent,\n    private pointsLayer: AcLayerComponent,\n    private arcsLayer: AcLayerComponent,\n    private options: CircleEditOptions,\n  ) {\n    super();\n    this._circleProps = {...options.circleProps};\n    this._pointProps = {...options.pointProps};\n    this._polylineProps = {...options.polylineProps};\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels || !this._center || !this._radiusPoint) {\n      return;\n    }\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        if (index !== labels.length - 1) {\n          label.position = this._center.getPosition();\n        } else {\n          label.position = this._radiusPoint.getPosition();\n        }\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get polylineProps(): PolylineProps {\n    return this._polylineProps;\n  }\n\n  set polylineProps(value: PolylineProps) {\n    this._polylineProps = value;\n  }\n\n  get pointProps(): PointProps {\n    return this._pointProps;\n  }\n\n  set pointProps(value: PointProps) {\n    this._pointProps = value;\n  }\n\n  get circleProps(): EllipseProps {\n    return this._circleProps;\n  }\n\n  set circleProps(value: EllipseProps) {\n    this._circleProps = value;\n  }\n\n  get center(): EditPoint {\n    return this._center;\n  }\n\n  get radiusPoint(): EditPoint {\n    return this._radiusPoint;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this._center.show = value;\n    this._radiusPoint.show = value;\n    this.updatePointsLayer();\n  }\n\n  setManually(\n    center: Cartesian3,\n    radiusPoint: Cartesian3,\n    centerPointProp = this.pointProps,\n    radiusPointProp = this.pointProps,\n    circleProp = this.circleProps,\n  ) {\n    if (!this._center) {\n      this._center = new EditPoint(this.id, center, centerPointProp);\n    } else {\n      this._center.setPosition(center);\n    }\n\n    if (!this._radiusPoint) {\n      this._radiusPoint = new EditPoint(this.id, radiusPoint, radiusPointProp);\n    } else {\n      this._radiusPoint.setPosition(radiusPoint);\n    }\n\n    if (!this._outlineArc) {\n      this.createOutlineArc();\n    } else {\n      this._outlineArc.radius = this.getRadius();\n    }\n\n    this.circleProps = circleProp;\n    this.doneCreation = true;\n    this.updateArcsLayer();\n    this.updatePointsLayer();\n    this.updateCirclesLayer();\n  }\n\n  addPoint(position: Cartesian3) {\n    if (this.doneCreation) {\n      return;\n    }\n\n    if (!this._center) {\n      this._center = new EditPoint(this.id, position, this.pointProps);\n      this._radiusPoint = new EditPoint(this.id, position.clone(), this.pointProps);\n      if (!this._outlineArc) {\n        this.createOutlineArc();\n      }\n    }\n\n    this.updateArcsLayer();\n    this.updatePointsLayer();\n    this.updateCirclesLayer();\n  }\n\n  addLastPoint(position: Cartesian3) {\n    if (this.doneCreation || !this._center || !this._radiusPoint) {\n      return;\n    }\n\n    this._radiusPoint.setPosition(position);\n    this.doneCreation = true;\n\n    this.updatePointsLayer();\n    this.updateCirclesLayer();\n  }\n\n  movePoint(toPosition: Cartesian3) {\n    if (!this._center || !this._radiusPoint) {\n      return;\n    }\n\n    this._radiusPoint.setPosition(toPosition);\n    this._outlineArc.radius = this.getRadius();\n\n    this.updateArcsLayer();\n    this.updatePointsLayer();\n    this.updateCirclesLayer();\n  }\n\n  moveCircle(dragStartPosition: Cartesian3, dragEndPosition: Cartesian3) {\n    if (!this.doneCreation) {\n      return;\n    }\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = dragStartPosition;\n    }\n\n    const radius = this.getRadius();\n    const delta = GeoUtilsService.getPositionsDelta(this.lastDraggedToPosition, dragEndPosition);\n    const newCenterPosition = GeoUtilsService.addDeltaToPosition(this.getCenter(), delta, true);\n    this._center.setPosition(newCenterPosition);\n    this.radiusPoint.setPosition(GeoUtilsService.pointByLocationDistanceAndAzimuth(this.getCenter(), radius, Math.PI / 2, true));\n    this._outlineArc.radius = this.getRadius();\n    this._outlineArc.center = this._center.getPosition();\n    this.updateArcsLayer();\n    this.updatePointsLayer();\n    this.updateCirclesLayer();\n    this.lastDraggedToPosition = dragEndPosition;\n  }\n\n  endMovePolygon() {\n    this.lastDraggedToPosition = undefined;\n  }\n\n  getRadius(): number {\n    if (!this._center || !this._radiusPoint) {\n      return 0;\n    }\n    return GeoUtilsService.distance(this._center.getPosition(), this._radiusPoint.getPosition());\n  }\n\n  getRadiusCallbackProperty() {\n    return new Cesium.CallbackProperty(this.getRadius.bind(this), false);\n  }\n\n  getCenter(): Cartesian3 {\n    return this._center ? this._center.getPosition() : undefined;\n  }\n\n  getCenterCallbackProperty() {\n    return new Cesium.CallbackProperty(this.getCenter.bind(this), false);\n  }\n\n  getRadiusPoint(): Cartesian3 {\n    return this._radiusPoint ? this._radiusPoint.getPosition() : undefined;\n  }\n\n  dispose() {\n    if (this._center) {\n      this.pointsLayer.remove(this._center.getId());\n    }\n\n    if (this._radiusPoint) {\n      this.pointsLayer.remove(this._radiusPoint.getId());\n    }\n\n    if (this._outlineArc) {\n      this.arcsLayer.remove(this._outlineArc.getId());\n    }\n\n    this.circlesLayer.remove(this.id);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  private updateCirclesLayer() {\n    this.circlesLayer.update(this, this.id);\n  }\n\n  private updatePointsLayer() {\n    if (this._center) {\n      this.pointsLayer.update(this._center, this._center.getId());\n    }\n    if (this._radiusPoint) {\n      this.pointsLayer.update(this._radiusPoint, this._radiusPoint.getId());\n    }\n  }\n\n  private updateArcsLayer() {\n    if (!this._outlineArc) {\n      return;\n    }\n    this.arcsLayer.update(this._outlineArc, this._outlineArc.getId());\n  }\n\n  private createOutlineArc() {\n    if (!this._center || !this._radiusPoint) {\n      return;\n    }\n    this._outlineArc = new EditArc(this.id, this.getCenter(), this.getRadius(), Math.PI * 2, 0, this.polylineProps);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EditableCircle } from '../../../models/editable-circle';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CircleEditOptions } from '../../../models/circle-edit-options';\n\n@Injectable()\nexport class CirclesManagerService {\n  private circles = new Map<string, EditableCircle>();\n\n  createEditableCircle(id: string,\n                       editCirclesLayer: AcLayerComponent,\n                       editPointsLayer: AcLayerComponent,\n                       editArcsLayer: AcLayerComponent,\n                       circleOptions: CircleEditOptions): EditableCircle {\n    const editableCircle = new EditableCircle(id, editCirclesLayer, editPointsLayer, editArcsLayer, circleOptions);\n    this.circles.set(id, editableCircle);\n    return editableCircle;\n  }\n\n  dispose(id: string) {\n    const circle = this.circles.get(id);\n    if (circle) {\n      circle.dispose();\n    }\n    this.circles.delete(id);\n  }\n\n  get(id: string): EditableCircle {\n    return this.circles.get(id);\n  }\n\n  clear() {\n    this.circles.forEach(circle => circle.dispose());\n    this.circles.clear();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { publish, tap } from 'rxjs/operators';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { GeoUtilsService } from '../../../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BasicEditUpdate } from '../../../models/basic-edit-update';\nimport { CircleEditOptions } from '../../../models/circle-edit-options';\nimport { CircleEditUpdate } from '../../../models/circle-edit-update';\nimport { CircleEditorObservable } from '../../../models/circle-editor-observable';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditPoint } from '../../../models/edit-point';\nimport { EditableCircle } from '../../../models/editable-circle';\nimport { EllipseProps } from '../../../models/ellipse-edit-options';\nimport { LabelProps } from '../../../models/label-props';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { generateKey } from '../../utils';\nimport { CirclesManagerService } from './circles-manager.service';\n\nexport const DEFAULT_CIRCLE_OPTIONS: CircleEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  circleProps: {\n    material: Cesium.Color.CORNFLOWERBLUE.withAlpha(0.4),\n    fill: true,\n    outline: false,\n    outlineWidth: 1,\n    outlineColor: Cesium.Color.WHITE.withAlpha(0.8),\n    classificationType: Cesium.ClassificationType.BOTH,\n    zIndex: 0,\n    shadows: Cesium.ShadowMode.DISABLED,\n  },\n  pointProps: {\n    color: Cesium.Color.WHITE,\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.2),\n    outlineWidth: 1,\n    pixelSize: 13,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n  polylineProps: {\n    width: 1,\n    material: () => Cesium.Color.WHITE.withAlpha(0.8),\n  },\n};\n\n/**\n * Service for creating editable circles\n *\n * You must provide `CircleEditorService` yourself.\n * PolygonsEditorService works together with `<circle-editor>` component. Therefor you need to create `<circle-editor>`\n * for each `CircleEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `CircleEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `CircleEditorObservable`.\n * + To stop editing call `dsipose()` from the `CircleEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `CircleEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating circle\n *  const editing$ = circlesEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit circle from existing center point and radius\n *  const editing$ = this.circlesEditorService.edit(center, radius);\n *\n * ```\n */\n@Injectable()\nexport class CirclesEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<CircleEditUpdate>();\n  private updatePublisher = publish<CircleEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private circlesManager: CirclesManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n\n  init(\n    mapEventsManager: MapEventsManagerService,\n    coordinateConverter: CoordinateConverter,\n    cameraService: CameraService,\n    circlesManager: CirclesManagerService,\n  ) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.circlesManager = circlesManager;\n    this.updatePublisher.connect();\n  }\n\n  onUpdate(): Observable<CircleEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  create(options = DEFAULT_CIRCLE_OPTIONS, priority = 100): CircleEditorObservable {\n    let center: any;\n    const id = generateKey();\n    const circleOptions = this.setOptions(options);\n    const clientEditSubject = new BehaviorSubject<CircleEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE,\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      circleOptions,\n    });\n\n    const finishCreation = (position: Cartesian3) => {\n      const update = {\n        id,\n        center,\n        radiusPoint: position,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.ADD_LAST_POINT,\n      };\n      this.updateSubject.next(update);\n      clientEditSubject.next({\n        ...update,\n        ...this.getCircleProperties(id),\n      });\n\n      const changeMode = {\n        id,\n        center,\n        radiusPoint: position,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.CHANGE_TO_EDIT,\n      };\n\n      this.updateSubject.next(changeMode);\n      clientEditSubject.next({\n        ...update,\n        ...this.getCircleProperties(id),\n      });\n      if (this.observablesMap.has(id)) {\n        this.observablesMap.get(id).forEach(registration => registration.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.editCircle(id, priority, clientEditSubject, circleOptions, editorObservable);\n      finishedCreate = true;\n      return finishedCreate;\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.LEFT_CLICK,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n      if (!position) {\n        return;\n      }\n\n      if (!center) {\n        const update = {\n          id,\n          center: position,\n          editMode: EditModes.CREATE,\n          editAction: EditActions.ADD_POINT,\n        };\n        this.updateSubject.next(update);\n        clientEditSubject.next({\n          ...update,\n          ...this.getCircleProperties(id),\n        });\n        center = position;\n      } else {\n        finishedCreate = finishCreation(position);\n      }\n    });\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (!center) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n\n      if (position) {\n        const update = {\n          id,\n          center,\n          radiusPoint: position,\n          editMode: EditModes.CREATE,\n          editAction: EditActions.MOUSE_MOVE,\n        };\n        this.updateSubject.next(update);\n        clientEditSubject.next({\n          ...update,\n          ...this.getCircleProperties(id),\n        });\n      }\n    });\n\n    return editorObservable;\n  }\n\n  edit(center: Cartesian3, radius: number, options = DEFAULT_CIRCLE_OPTIONS, priority = 100): CircleEditorObservable {\n    const id = generateKey();\n    const circleOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<CircleEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT,\n    });\n\n    const radiusPoint: Cartesian3 = GeoUtilsService.pointByLocationDistanceAndAzimuth(center, radius, Math.PI / 2, true);\n\n    const update = {\n      id,\n      center,\n      radiusPoint,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      circleOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      ...this.getCircleProperties(id),\n    });\n\n    return this.editCircle(id, priority, editSubject, circleOptions);\n  }\n\n  private editCircle(\n    id: string,\n    priority: number,\n    editSubject: Subject<CircleEditUpdate>,\n    options: CircleEditOptions,\n    editObservable?: CircleEditorObservable,\n  ): CircleEditorObservable {\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.LEFT_CLICK_DRAG,\n      entityType: EditPoint,\n      pickConfig: options.pickConfiguration,\n      pick: PickOptions.PICK_FIRST,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: CesiumEvent.LEFT_CLICK_DRAG,\n        entityType: EditableCircle,\n        pickConfig: options.pickConfiguration,\n        pick: PickOptions.PICK_FIRST,\n        priority: priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n\n    pointDragRegistration\n      .pipe(tap(({ movement: { drop } }) => this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, startPosition, drop }, entities }) => {\n        const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n        const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n        if (!endDragPosition) {\n          return;\n        }\n\n        const point: EditPoint = entities[0];\n        const pointIsCenter = point === this.getCenterPoint(id);\n        let editAction;\n        if (drop) {\n          editAction = pointIsCenter ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_POINT_FINISH;\n        } else {\n          editAction = pointIsCenter ? EditActions.DRAG_SHAPE : EditActions.DRAG_POINT;\n        }\n\n        if (!options.allowDrag && (editAction === EditActions.DRAG_SHAPE || editAction === EditActions.DRAG_SHAPE_FINISH)) {\n          this.cameraService.enableInputs(true);\n          return;\n        }\n\n        const update = {\n          id,\n          center: this.getCenterPosition(id),\n          radiusPoint: this.getRadiusPosition(id),\n          startDragPosition,\n          endDragPosition,\n          editMode: EditModes.EDIT,\n          editAction,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          ...this.getCircleProperties(id),\n        });\n      });\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({ movement: { drop } }) => this.cameraService.enableInputs(drop)))\n        .subscribe(({ movement: { startPosition, endPosition, drop } }) => {\n          const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n          const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n          if (!endDragPosition || !startDragPosition) {\n            return;\n          }\n\n          const update = {\n            id,\n            center: this.getCenterPosition(id),\n            radiusPoint: this.getRadiusPosition(id),\n            startDragPosition,\n            endDragPosition,\n            editMode: EditModes.EDIT,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n            ...this.getCircleProperties(id),\n          });\n        });\n    }\n\n    const observables = [pointDragRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n\n    this.observablesMap.set(id, observables);\n    return editObservable || this.createEditorObservable(editSubject, id);\n  }\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: (position: Cartesian3) => boolean)\n                                                                                                        : CircleEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        center: this.getCenterPosition(id),\n        radiusPoint: this.getRadiusPosition(id),\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        center: this.getCenterPosition(id),\n        radiusPoint: this.getRadiusPosition(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        center: this.getCenterPosition(id),\n        radiusPoint: this.getRadiusPosition(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n\n    observableToExtend.setManually = (\n      center: Cartesian3,\n      radius: number,\n      centerPointProp?: PointProps,\n      radiusPointProp?: PointProps,\n      circleProp?: EllipseProps,\n    ) => {\n      const radiusPoint = GeoUtilsService.pointByLocationDistanceAndAzimuth(center, radius, Math.PI / 2, true);\n      const circle = this.circlesManager.get(id);\n      circle.setManually(center, radiusPoint, centerPointProp, radiusPointProp, circleProp);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: (update: BasicEditUpdate<any>, labels: LabelProps[]) => LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Circles editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation(null);\n    };\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.circlesManager.get(id).labels;\n    observableToExtend.getCenter = (): Cartesian3 => this.getCenterPosition(id);\n    observableToExtend.getRadius = (): number => this.getRadius(id);\n\n    return observableToExtend as CircleEditorObservable;\n  }\n\n  private setOptions(options: CircleEditOptions): CircleEditOptions {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_CIRCLE_OPTIONS));\n    const circleOptions = Object.assign(defaultClone, options);\n    circleOptions.pointProps = Object.assign({}, DEFAULT_CIRCLE_OPTIONS.pointProps, options.pointProps);\n    circleOptions.circleProps = Object.assign({}, DEFAULT_CIRCLE_OPTIONS.circleProps, options.circleProps);\n    circleOptions.polylineProps = Object.assign({}, DEFAULT_CIRCLE_OPTIONS.polylineProps, options.polylineProps);\n    return circleOptions;\n  }\n\n  private getCenterPosition(id: string): Cartesian3 {\n    return this.circlesManager.get(id).getCenter();\n  }\n\n  private getCenterPoint(id: string): EditPoint {\n    return this.circlesManager.get(id).center;\n  }\n\n  private getRadiusPosition(id: string): Cartesian3 {\n    return this.circlesManager.get(id).getRadiusPoint();\n  }\n\n  private getRadius(id: string): number {\n    return this.circlesManager.get(id).getRadius();\n  }\n\n  private getCircleProperties(id: string) {\n    const circle = this.circlesManager.get(id);\n    return {\n      center: circle.getCenter(),\n      radiusPoint: circle.getRadiusPoint(),\n      radius: circle.getRadius(),\n    };\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { CirclesManagerService } from '../../services/entity-editors/circles-editor/circles-manager.service';\nimport { CirclesEditorService } from '../../services/entity-editors/circles-editor/circles-editor.service';\nimport { CircleEditUpdate } from '../../models/circle-edit-update';\nimport { LabelProps } from '../../models/label-props';\nimport { EditableCircle } from '../../models/editable-circle';\n\n@Component({\n  selector: 'circles-editor',\n  template: /*html*/ `\n      <ac-layer #editArcsLayer acFor=\"let arc of editArcs$\" [context]=\"this\">\n          <ac-arc-desc\n                  props=\"{\n        angle: arc.angle,\n        delta: arc.delta,\n        center: arc.center,\n        radius: arc.radius,\n        quality: 30,\n        color: arc.props.material()\n    }\"\n          >\n          </ac-arc-desc>\n      </ac-layer>\n\n      <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n          <ac-point-desc\n                  props=\"{\n                    position: point.getPositionCallbackProperty(),\n                    pixelSize: getPointSize(point),\n                    color: point.props.color,\n                    outlineColor: point.props.outlineColor,\n                    outlineWidth: point.props.outlineWidth,\n                    show: getPointShow(point),\n                    disableDepthTestDistance: point.props.disableDepthTestDistance,\n                    heightReference: point.props.heightReference,\n    }\"\n          >\n          </ac-point-desc>\n      </ac-layer>\n\n      <ac-layer #editCirclesLayer acFor=\"let circle of editCircles$\" [context]=\"this\" [zIndex]=\"0\">\n          <ac-ellipse-desc\n                  props=\"{\n                  position: circle.getCenterCallbackProperty(),\n                  semiMajorAxis: circle.getRadiusCallbackProperty(),\n                  semiMinorAxis: circle.getRadiusCallbackProperty(),\n                  material: circle.circleProps.material,\n                  outline: circle.circleProps.outline,\n                  height: 0\n                  outlineWidth: circle.circleProps.outlineWidth,\n                  outlineColor: circle.circleProps.outlineColor,\n                  fill: circle.circleProps.fill,\n                  classificationType: circle.circleProps.classificationType,\n                  zIndex: circle.circleProps.zIndex,\n                  shadows: circle.circleProps.shadows,\n    }\"\n          >\n          </ac-ellipse-desc>\n\n          <ac-array-desc acFor=\"let label of circle.labels\" [idGetter]=\"getLabelId\">\n              <ac-label-primitive-desc\n                      props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n              >\n              </ac-label-primitive-desc>\n          </ac-array-desc>\n      </ac-layer>\n  `,\n  providers: [CoordinateConverter, CirclesManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class CirclesEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: CircleEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editCircles$ = new Subject<AcNotification>();\n  public editArcs$ = new Subject<AcNotification>();\n\n  @ViewChild('editCirclesLayer') private editCirclesLayer: AcLayerComponent;\n  @ViewChild('editArcsLayer') private editArcsLayer: AcLayerComponent;\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n\n  constructor(\n    private circlesEditor: CirclesEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private circlesManager: CirclesManagerService,\n  ) {\n    this.circlesEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, this.circlesManager);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.circlesEditor.onUpdate().subscribe(update => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(circle: EditableCircle, update: CircleEditUpdate, labels?: LabelProps[]) {\n    update.center = circle.getCenter();\n    update.radiusPoint = circle.getRadiusPoint();\n    update.radius = circle.getRadius();\n\n    if (labels) {\n      circle.labels = labels;\n      this.editCirclesLayer.update(circle, circle.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    circle.labels = this.editLabelsRenderFn(update, circle.labels);\n    this.editCirclesLayer.update(circle, circle.getId());\n  }\n\n  removeEditLabels(circle: EditableCircle) {\n    circle.labels = [];\n    this.editCirclesLayer.update(circle, circle.getId());\n  }\n\n  handleCreateUpdates(update: CircleEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.circlesManager.createEditableCircle(\n          update.id,\n          this.editCirclesLayer,\n          this.editPointsLayer,\n          this.editArcsLayer,\n          update.circleOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const circle = this.circlesManager.get(update.id);\n        if (update.radiusPoint) {\n          circle.movePoint(update.radiusPoint);\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const circle = this.circlesManager.get(update.id);\n        if (update.center) {\n          circle.addPoint(update.center);\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const circle = this.circlesManager.get(update.id);\n        if (update.radiusPoint) {\n          circle.addLastPoint(update.radiusPoint);\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle) {\n          this.removeEditLabels(circle);\n          this.circlesManager.dispose(update.id);\n        }\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const circle = this.circlesManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(circle, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const circle = this.circlesManager.get(update.id);\n        this.renderEditLabels(circle, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const circle = this.circlesManager.get(update.id);\n        this.renderEditLabels(circle, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: CircleEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        const circle = this.circlesManager.createEditableCircle(\n          update.id,\n          this.editCirclesLayer,\n          this.editPointsLayer,\n          this.editArcsLayer,\n          update.circleOptions,\n        );\n        circle.setManually(update.center, update.radiusPoint);\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH:\n      case EditActions.DRAG_POINT: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle && circle.enableEdit) {\n          circle.movePoint(update.endDragPosition);\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle && circle.enableEdit) {\n          circle.moveCircle(update.startDragPosition, update.endDragPosition);\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle && circle.enableEdit) {\n          circle.endMovePolygon();\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle) {\n          circle.enableEdit = false;\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const circle = this.circlesManager.get(update.id);\n        if (circle) {\n          circle.enableEdit = true;\n          this.renderEditLabels(circle, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.circlesManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { EllipseEditOptions, EllipseProps } from './ellipse-edit-options';\nimport { PointProps } from './point-edit-options';\nimport { PolylineProps } from './polyline-edit-options';\nimport { defaultLabelProps, LabelProps } from './label-props';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\n\nexport class EditableEllipse extends AcEntity {\n  private _center: EditPoint;\n  private _majorRadiusPoint: EditPoint;\n  private _majorRadius: number;\n  private _minorRadius: number;\n  private _rotation = 0;\n  private doneCreation = false;\n  private _enableEdit = true;\n  private _minorRadiusPoints: EditPoint[] = [];\n  private lastDraggedToPosition: any;\n  private _ellipseProps: EllipseProps;\n  private _pointProps: PointProps;\n  private _polylineProps: PolylineProps;\n  private _labels: LabelProps[] = [];\n\n  constructor(\n    private id: string,\n    private ellipsesLayer: AcLayerComponent,\n    private pointsLayer: AcLayerComponent,\n    private coordinateConverter: CoordinateConverter,\n    private options: EllipseEditOptions,\n  ) {\n    super();\n    this._ellipseProps = {...options.ellipseProps};\n    this._pointProps = {...options.pointProps};\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels || !this._center) {\n      return;\n    }\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        if (index === 0) {\n          label.position = this._center.getPosition();\n        } else if (index === 1) {\n          label.position = this._majorRadiusPoint\n            ? Cesium.Cartesian3.midpoint(this.getCenter(), this._majorRadiusPoint.getPosition(), new Cesium.Cartesian3())\n            : new Cesium.Cartesian3();\n        } else if (index === 2) {\n          label.position =\n            this._minorRadiusPoints.length > 0 && this._minorRadius\n              ? Cesium.Cartesian3.midpoint(this.getCenter(), this.getMinorRadiusPointPosition(), new Cesium.Cartesian3())\n              : new Cesium.Cartesian3();\n        }\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get polylineProps(): PolylineProps {\n    return this._polylineProps;\n  }\n\n  set polylineProps(value: PolylineProps) {\n    this._polylineProps = value;\n  }\n\n  get pointProps(): PointProps {\n    return this._pointProps;\n  }\n\n  set pointProps(value: PointProps) {\n    this._pointProps = value;\n  }\n\n  get ellipseProps(): EllipseProps {\n    return this._ellipseProps;\n  }\n\n  set ellipseProps(value: EllipseProps) {\n    this._ellipseProps = value;\n  }\n\n  get center(): EditPoint {\n    return this._center;\n  }\n\n  get majorRadiusPoint(): EditPoint {\n    return this._majorRadiusPoint;\n  }\n\n  getMajorRadiusPointPosition() {\n    if (!this._majorRadiusPoint) {\n      return undefined;\n    }\n\n    return this._majorRadiusPoint.getPosition();\n  }\n\n  getMinorRadiusPointPosition(): Cartesian3 {\n    if (this._minorRadiusPoints.length < 1) {\n      return undefined;\n    }\n\n    return this._minorRadiusPoints[0].getPosition();\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this._center.show = value;\n    this._majorRadiusPoint.show = value;\n    this.updatePointsLayer();\n  }\n\n  setManually(\n    center: Cartesian3,\n    majorRadius: number,\n    rotation = Math.PI / 2,\n    minorRadius?: number,\n    centerPointProp = this.pointProps,\n    radiusPointProp = this.pointProps,\n    ellipseProp = this.ellipseProps,\n  ) {\n    if (majorRadius < minorRadius) {\n      throw new Error('Major radius muse be equal or greater than minor radius');\n    }\n    this._rotation = rotation;\n    this._majorRadius = majorRadius;\n    if (!this._center) {\n      this._center = new EditPoint(this.id, center, centerPointProp);\n    } else {\n      this._center.setPosition(center);\n    }\n\n    const majorRadiusPosition = GeoUtilsService.pointByLocationDistanceAndAzimuth(this.center.getPosition(), majorRadius, rotation);\n\n    if (!this._majorRadiusPoint) {\n      this._majorRadiusPoint = new EditPoint(this.id, majorRadiusPosition, radiusPointProp);\n    } else {\n      this._majorRadiusPoint.setPosition(majorRadiusPosition);\n    }\n\n    if (minorRadius) {\n      this._minorRadius = minorRadius;\n    }\n\n    this.ellipseProps = ellipseProp;\n    this.doneCreation = true;\n    this.updateMinorRadiusEditPoints();\n    this.updatePointsLayer();\n    this.updateEllipsesLayer();\n  }\n\n  addPoint(position: Cartesian3) {\n    if (this.doneCreation) {\n      return;\n    }\n\n    if (!this._center) {\n      this._center = new EditPoint(this.id, position, this.pointProps);\n      this._majorRadiusPoint = new EditPoint(this.id, position.clone(), this.pointProps);\n      this._majorRadius = 0;\n    }\n\n    this.updateRotation();\n    this.updateMinorRadiusEditPoints();\n    this.updatePointsLayer();\n    this.updateEllipsesLayer();\n  }\n\n  transformToEllipse() {\n    if (this._minorRadius) {\n      return;\n    }\n\n    this._minorRadius = this.getMajorRadius();\n    this.updateMinorRadiusEditPoints();\n    this.updatePointsLayer();\n    this.updateEllipsesLayer();\n  }\n\n  addLastPoint(position: Cartesian3) {\n    if (this.doneCreation || !this._center || !this._majorRadiusPoint) {\n      return;\n    }\n\n    const newRadius = GeoUtilsService.distance(this._center.getPosition(), position);\n    this._majorRadiusPoint.setPosition(position);\n    this._majorRadius = newRadius;\n    this.doneCreation = true;\n\n    if (!this.options.circleToEllipseTransformation) {\n      this._minorRadius = this._majorRadius;\n    }\n\n    this.updateRotation();\n    this.updateMinorRadiusEditPoints();\n    this.updatePointsLayer();\n    this.updateEllipsesLayer();\n  }\n\n  movePoint(toPosition: Cartesian3, editPoint: EditPoint) {\n    if (!this._center || !this._majorRadiusPoint) {\n      return;\n    }\n\n    const newRadius = GeoUtilsService.distance(this._center.getPosition(), toPosition);\n    if (this.majorRadiusPoint === editPoint) {\n      if (newRadius < this._minorRadius) {\n        this._majorRadius = this._minorRadius;\n        this._majorRadiusPoint.setPosition(\n          GeoUtilsService.pointByLocationDistanceAndAzimuth(this.getCenter(), this._minorRadius, this._rotation),\n        );\n      } else {\n        this.majorRadiusPoint.setPosition(toPosition);\n        this._majorRadius = newRadius;\n      }\n    } else {\n      if (newRadius > this._majorRadius) {\n        this._minorRadius = this._majorRadius;\n      } else {\n        this._minorRadius = newRadius;\n      }\n    }\n\n    this.updateRotation();\n    this.updateMinorRadiusEditPoints();\n    this.updatePointsLayer();\n    this.updateEllipsesLayer();\n  }\n\n  moveEllipse(dragStartPosition: Cartesian3, dragEndPosition: Cartesian3) {\n    if (!this.doneCreation) {\n      return;\n    }\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = dragStartPosition;\n    }\n\n    const majorRadius = this.getMajorRadius();\n    const rotation = this.getRotation();\n    const delta = GeoUtilsService.getPositionsDelta(this.lastDraggedToPosition, dragEndPosition);\n    const newCenterPosition = GeoUtilsService.addDeltaToPosition(this.getCenter(), delta, true);\n    this._center.setPosition(newCenterPosition);\n    this.majorRadiusPoint.setPosition(GeoUtilsService.pointByLocationDistanceAndAzimuth(this.getCenter(), majorRadius, rotation));\n    this.updatePointsLayer();\n    this.updateMinorRadiusEditPoints();\n    this.updateEllipsesLayer();\n    this.lastDraggedToPosition = dragEndPosition;\n  }\n\n  endMoveEllipse() {\n    this.lastDraggedToPosition = undefined;\n  }\n\n  private updateMinorRadiusEditPoints() {\n    if (this._minorRadius === undefined) {\n      return;\n    }\n    if (this._minorRadiusPoints.length === 0) {\n      this._minorRadiusPoints.push(new EditPoint(this.id, new Cesium.Cartesian3(), this.pointProps, true));\n      this._minorRadiusPoints.push(new EditPoint(this.id, new Cesium.Cartesian3(), this.pointProps, true));\n    }\n\n    this._minorRadiusPoints[0].setPosition(\n      GeoUtilsService.pointByLocationDistanceAndAzimuth(this._center.getPosition(), this._minorRadius, this.getRotation() - Math.PI / 2),\n    );\n\n    this._minorRadiusPoints[1].setPosition(\n      GeoUtilsService.pointByLocationDistanceAndAzimuth(this._center.getPosition(), this._minorRadius, this.getRotation() + Math.PI / 2),\n    );\n  }\n\n  getMajorRadius(): number {\n    return this._majorRadius || 0;\n  }\n\n  getMinorRadius() {\n    if (this._minorRadius === undefined) {\n      return this.getMajorRadius();\n    } else {\n      return this._minorRadius;\n    }\n  }\n\n  getRotation(): number {\n    return this._rotation || 0;\n  }\n\n  updateRotation(): number {\n    if (!this._majorRadiusPoint) {\n      return 0;\n    }\n\n    const azimuthInDegrees = this.coordinateConverter.bearingToCartesian(this.getCenter(), this._majorRadiusPoint.getPosition());\n    this._rotation = Cesium.Math.toRadians(azimuthInDegrees);\n    return this._rotation;\n  }\n\n  getRotationCallbackProperty() {\n    return new Cesium.CallbackProperty(() => Math.PI / 2 - this.getRotation(), false);\n  }\n\n  getMinorRadiusCallbackProperty() {\n    return new Cesium.CallbackProperty(() => this.getMinorRadius(), false);\n  }\n\n  getMajorRadiusCallbackProperty() {\n    return new Cesium.CallbackProperty(() => this.getMajorRadius(), false);\n  }\n\n  getCenter(): Cartesian3 {\n    return this._center ? this._center.getPosition() : undefined;\n  }\n\n  getCenterCallbackProperty() {\n    return new Cesium.CallbackProperty(() => this.getCenter(), false);\n  }\n\n  dispose() {\n    if (this._center) {\n      this.pointsLayer.remove(this._center.getId());\n    }\n\n    if (this._majorRadiusPoint) {\n      this.pointsLayer.remove(this._majorRadiusPoint.getId());\n    }\n\n    if (this._minorRadiusPoints) {\n      this._minorRadiusPoints.forEach(point => this.pointsLayer.remove(point.getId()));\n    }\n\n    this.ellipsesLayer.remove(this.id);\n  }\n\n  getId() {\n    return this.id;\n  }\n\n  private updateEllipsesLayer() {\n    this.ellipsesLayer.update(this, this.id);\n  }\n\n  private updatePointsLayer() {\n    if (this._center) {\n      this.pointsLayer.update(this._center, this._center.getId());\n    }\n    if (this._majorRadiusPoint) {\n      this.pointsLayer.update(this._majorRadiusPoint, this._majorRadiusPoint.getId());\n    }\n    if (this._minorRadiusPoints.length > 0) {\n      this.pointsLayer.update(this._minorRadiusPoints[0], this._minorRadiusPoints[0].getId());\n      this.pointsLayer.update(this._minorRadiusPoints[1], this._minorRadiusPoints[1].getId());\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EditableEllipse } from '../../../models/editable-ellipse';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { EllipseEditOptions } from '../../../models/ellipse-edit-options';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\n\n@Injectable()\nexport class EllipsesManagerService {\n  private ellipses = new Map<string, EditableEllipse>();\n\n  createEditableEllipse(id: string,\n                        editEllipsesLayer: AcLayerComponent,\n                        editPointsLayer: AcLayerComponent,\n                        coordinateConverter: CoordinateConverter,\n                        ellipseOptions: EllipseEditOptions): EditableEllipse {\n    const editableEllipse = new EditableEllipse(id, editEllipsesLayer, editPointsLayer, coordinateConverter, ellipseOptions);\n    this.ellipses.set(id, editableEllipse);\n    return editableEllipse;\n  }\n\n  dispose(id: string) {\n    this.ellipses.get(id).dispose();\n    this.ellipses.delete(id);\n  }\n\n  get(id: string): EditableEllipse {\n    return this.ellipses.get(id);\n  }\n\n  clear() {\n    this.ellipses.forEach(ellipse => ellipse.dispose());\n    this.ellipses.clear();\n  }\n}\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { EllipseEditUpdate } from '../../../models/ellipse-edit-update';\nimport { EllipsesManagerService } from './ellipses-manager.service';\nimport { EllipseEditorObservable } from '../../../models/ellipse-editor-observable';\nimport { EllipseEditOptions, EllipseProps } from '../../../models/ellipse-edit-options';\nimport { EditableEllipse } from '../../../models/editable-ellipse';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { LabelProps } from '../../../models/label-props';\nimport { BasicEditUpdate } from '../../../models/basic-edit-update';\nimport { generateKey } from '../../utils';\nimport { CesiumEventModifier } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event-modifier.enum';\nimport { CesiumService } from '../../../../angular-cesium';\n\nexport const DEFAULT_ELLIPSE_OPTIONS: EllipseEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  circleToEllipseTransformEvent: CesiumEvent.LEFT_CLICK,\n  circleToEllipseTransformEventModifier: CesiumEventModifier.ALT,\n  allowDrag: true,\n  ellipseProps: {\n    material: Cesium.Color.CORNFLOWERBLUE.withAlpha(0.4),\n    fill: true,\n    outline: true,\n    outlineWidth: 1,\n    outlineColor: Cesium.Color.WHITE.withAlpha(0.8),\n    classificationType: Cesium.ClassificationType.BOTH,\n    zIndex: 0,\n    shadows: Cesium.ShadowMode.DISABLED,\n  },\n  pointProps: {\n    color: Cesium.Color.WHITE,\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.2),\n    outlineWidth: 1,\n    pixelSize: 13,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n  polylineProps: {\n    width: 1,\n    material: () => Cesium.Color.WHITE,\n  },\n  circleToEllipseTransformation: false,\n};\n\n/**\n * Service for creating editable ellipses\n *\n * You must provide `EllipsesEditorService` yourself.\n * EllipsesEditorService works together with `<ellipse-editor>` component. Therefor you need to create `<ellipse-editor>`\n * for each `EllipsesEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `EllipseEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `EllipseEditorObservable`.\n * + To stop editing call `dispose()` from the `EllipseEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over edited shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `EllipseEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating ellipse\n *  const editing$ = ellipsesEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit ellipse from existing center point, two radiuses and rotation\n *  const editing$ = this.ellipsesEditorService.edit(center, majorRadius, rotation, minorRadius);\n *\n * ```\n */\n@Injectable()\nexport class EllipsesEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<EllipseEditUpdate>();\n  private updatePublisher = publish<EllipseEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private ellipsesManager: EllipsesManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n  private cesiumScene: any;\n\n  init(\n    mapEventsManager: MapEventsManagerService,\n    coordinateConverter: CoordinateConverter,\n    cameraService: CameraService,\n    ellipsesManager: EllipsesManagerService,\n    cesiumViewer: CesiumService,\n  ) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.ellipsesManager = ellipsesManager;\n    this.updatePublisher.connect();\n\n    this.cesiumScene = cesiumViewer.getScene();\n  }\n\n  onUpdate(): Observable<EllipseEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  create(options = DEFAULT_ELLIPSE_OPTIONS, priority = 100): EllipseEditorObservable {\n    let center: any;\n    const id = generateKey();\n    const ellipseOptions = this.setOptions(options);\n    const clientEditSubject = new BehaviorSubject<EllipseEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE,\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      ellipseOptions,\n    });\n\n    const finishCreation = (position: Cartesian3) => {\n      const update: EllipseEditUpdate = {\n        id,\n        center,\n        updatedPosition: position,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.ADD_LAST_POINT,\n      };\n      this.updateSubject.next(update);\n      clientEditSubject.next({\n        ...update,\n      });\n\n      const changeMode: EllipseEditUpdate = {\n        id,\n        center,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.CHANGE_TO_EDIT,\n      };\n\n      this.updateSubject.next(changeMode);\n      clientEditSubject.next({\n        ...update,\n      });\n      if (this.observablesMap.has(id)) {\n        this.observablesMap.get(id).forEach(registration => registration.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.editEllipse(id, priority, clientEditSubject, ellipseOptions, editorObservable);\n      finishedCreate = true;\n      return finishedCreate;\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: ellipseOptions.addPointEvent,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n      if (!position) {\n        return;\n      }\n\n      if (!center) {\n        const update: EllipseEditUpdate = {\n          id,\n          center: position,\n          editMode: EditModes.CREATE,\n          editAction: EditActions.ADD_POINT,\n        };\n        this.updateSubject.next(update);\n        clientEditSubject.next({\n          ...update,\n        });\n        center = position;\n      } else {\n        finishedCreate = finishCreation(position);\n      }\n    });\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (!center) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n\n      if (position) {\n        const update: EllipseEditUpdate = {\n          id,\n          center,\n          updatedPosition: position,\n          editMode: EditModes.CREATE,\n          editAction: EditActions.MOUSE_MOVE,\n        };\n        this.updateSubject.next(update);\n        clientEditSubject.next({\n          ...update,\n        });\n      }\n    });\n\n    return editorObservable;\n  }\n\n  edit(\n    center: Cartesian3,\n    majorRadius: number,\n    rotation = Math.PI / 2,\n    minorRadius?: number,\n    options = DEFAULT_ELLIPSE_OPTIONS,\n    priority = 100,\n  ): EllipseEditorObservable {\n    const id = generateKey();\n    const ellipseOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<EllipseEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT,\n    });\n\n    const update: EllipseEditUpdate = {\n      id,\n      center,\n      majorRadius,\n      rotation,\n      minorRadius,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      ellipseOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n    });\n\n    return this.editEllipse(id, priority, editSubject, ellipseOptions);\n  }\n\n  private editEllipse(\n    id: string,\n    priority: number,\n    editSubject: Subject<EllipseEditUpdate>,\n    options: EllipseEditOptions,\n    editObservable?: EllipseEditorObservable,\n  ): EllipseEditorObservable {\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pickConfig: options.pickConfiguration,\n      pick: PickOptions.PICK_FIRST,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    let addSecondRadiusRegistration;\n    if (options.circleToEllipseTransformation) {\n      addSecondRadiusRegistration = this.mapEventsManager.register({\n        event: options.circleToEllipseTransformEvent,\n        modifier: options.circleToEllipseTransformEventModifier,\n        entityType: EditableEllipse,\n        pickConfig: options.pickConfiguration,\n        pick: PickOptions.PICK_FIRST,\n        priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: options.dragShapeEvent,\n        entityType: EditableEllipse,\n        pickConfig: options.pickConfiguration,\n        pick: PickOptions.PICK_FIRST,\n        priority: priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n\n    pointDragRegistration\n      .pipe(tap(({ movement: { drop } }) => this.ellipsesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, startPosition, drop }, entities }) => {\n        const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n        const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n        if (!endDragPosition) {\n          return;\n        }\n\n        const point: EditPoint = entities[0];\n        const pointIsCenter = point === this.getCenterPoint(id);\n        let editAction;\n        if (drop) {\n          editAction = pointIsCenter ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_POINT_FINISH;\n        } else {\n          editAction = pointIsCenter ? EditActions.DRAG_SHAPE : EditActions.DRAG_POINT;\n        }\n\n        if (!options.allowDrag && this.ellipsesManager.get(id).enableEdit &&\n          (editAction === EditActions.DRAG_SHAPE || editAction === EditActions.DRAG_SHAPE_FINISH)) {\n          this.cameraService.enableInputs(true);\n          return;\n        }\n\n        const update: EllipseEditUpdate = {\n          id,\n          updatedPoint: point,\n          startDragPosition,\n          endDragPosition,\n          editMode: EditModes.EDIT,\n          editAction,\n          ...this.getEllipseProperties(id),\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n        });\n      });\n\n    if (addSecondRadiusRegistration) {\n      addSecondRadiusRegistration.subscribe(({ movement: { endPosition, startPosition, drop }, entities }) => {\n        const update: EllipseEditUpdate = {\n          id,\n          editMode: EditModes.EDIT,\n          editAction: EditActions.TRANSFORM,\n          ...this.getEllipseProperties(id),\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n        });\n      });\n    }\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({ movement: { drop } }) => this.ellipsesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n        .subscribe(({ movement: { startPosition, endPosition, drop } }) => {\n          const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n          const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n          if (!endDragPosition || !startDragPosition) {\n            return;\n          }\n\n          const update: EllipseEditUpdate = {\n            id,\n            startDragPosition,\n            endDragPosition,\n            editMode: EditModes.EDIT,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n            ...this.getEllipseProperties(id),\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n          });\n        });\n    }\n\n    const observables = [pointDragRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n    if (addSecondRadiusRegistration) {\n      observables.push(addSecondRadiusRegistration);\n    }\n\n    this.observablesMap.set(id, observables);\n    return editObservable || this.createEditorObservable(editSubject, id);\n  }\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: (position: Cartesian3) => boolean)\n                                                                                                        : EllipseEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      } as EllipseEditUpdate);\n    };\n\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n        ...this.getEllipseProperties(id),\n      } as EllipseEditUpdate);\n    };\n\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n        ...this.getEllipseProperties(id),\n      } as EllipseEditUpdate);\n    };\n\n    observableToExtend.setManually = (\n      center: Cartesian3,\n      majorRadius: number,\n      rotation?: number,\n      minorRadius?: number,\n      centerPointProp?: PointProps,\n      radiusPointProp?: PointProps,\n      ellipseProp?: EllipseProps,\n    ) => {\n      const ellipse = this.ellipsesManager.get(id);\n      ellipse.setManually(center, majorRadius, rotation, minorRadius, centerPointProp, radiusPointProp, ellipseProp);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: (update: BasicEditUpdate<any>, labels: LabelProps[]) => LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      } as EllipseEditUpdate);\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      } as EllipseEditUpdate);\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Ellipses editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation(null);\n    };\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.ellipsesManager.get(id).labels;\n    observableToExtend.getCenter = (): Cartesian3 => this.getCenterPosition(id);\n    observableToExtend.getMajorRadius = (): number => this.getMajorRadius(id);\n    observableToExtend.getMinorRadius = (): number => this.getMinorRadius(id);\n\n    return observableToExtend as EllipseEditorObservable;\n  }\n\n  private setOptions(options: EllipseEditOptions): EllipseEditOptions {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_ELLIPSE_OPTIONS));\n    const ellipseOptions = Object.assign(defaultClone, options);\n    ellipseOptions.pointProps = Object.assign({}, DEFAULT_ELLIPSE_OPTIONS.pointProps, options.pointProps);\n    ellipseOptions.ellipseProps = Object.assign({}, DEFAULT_ELLIPSE_OPTIONS.ellipseProps, options.ellipseProps);\n    ellipseOptions.polylineProps = Object.assign({}, DEFAULT_ELLIPSE_OPTIONS.polylineProps, options.polylineProps);\n    return ellipseOptions;\n  }\n\n  private getCenterPosition(id: string): Cartesian3 {\n    return this.ellipsesManager.get(id).getCenter();\n  }\n\n  private getCenterPoint(id: string): EditPoint {\n    return this.ellipsesManager.get(id).center;\n  }\n\n  private getMajorRadius(id: string): number {\n    return this.ellipsesManager.get(id).getMajorRadius();\n  }\n\n  private getMinorRadius(id: string): number {\n    return this.ellipsesManager.get(id).getMinorRadius();\n  }\n\n  private getEllipseProperties(id: string) {\n    const ellipse = this.ellipsesManager.get(id);\n    return {\n      center: ellipse.getCenter(),\n      rotation: ellipse.getRotation(),\n      minorRadius: ellipse.getMinorRadius(),\n      majorRadius: ellipse.getMajorRadius(),\n      minorRadiusPointPosition: ellipse.getMinorRadiusPointPosition(),\n      majorRadiusPointPosition: ellipse.getMajorRadiusPointPosition(),\n    };\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { CesiumService } from '../../../angular-cesium/services/cesium/cesium.service';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { EllipsesManagerService } from '../../services/entity-editors/ellipses-editor/ellipses-manager.service';\nimport { EllipsesEditorService } from '../../services/entity-editors/ellipses-editor/ellipses-editor.service';\nimport { EllipseEditUpdate } from '../../models/ellipse-edit-update';\nimport { LabelProps } from '../../models/label-props';\nimport { EditableEllipse } from '../../models/editable-ellipse';\n\n@Component({\n  selector: 'ellipses-editor',\n  template: /*html*/ `\n      <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n          <ac-point-desc\n                  props=\"{\n                    position: point.getPositionCallbackProperty(),\n                    pixelSize: getPointSize(point),\n                    color: point.props.color,\n                    outlineColor: point.props.outlineColor,\n                    outlineWidth: point.props.outlineWidth,\n                    show: getPointShow(point),\n                    disableDepthTestDistance: point.props.disableDepthTestDistance,\n                    heightReference: point.props.heightReference,\n    }\"\n          >\n          </ac-point-desc>\n      </ac-layer>\n\n      <ac-layer #editEllipsesLayer acFor=\"let ellipse of editEllipses$\" [context]=\"this\" [zIndex]=\"0\">\n          <ac-ellipse-desc\n                  props=\"{\n                    position: ellipse.getCenterCallbackProperty(),\n                    semiMajorAxis: ellipse.getMajorRadiusCallbackProperty(),\n                    semiMinorAxis: ellipse.getMinorRadiusCallbackProperty(),\n                    rotation: ellipse.getRotationCallbackProperty(),\n                    material: ellipse.ellipseProps.material,\n                    outline: ellipse.ellipseProps.outline,\n                    outlineWidth: ellipse.ellipseProps.outlineWidth,\n                    outlineColor: ellipse.ellipseProps.outlineColor,\n                    height: 0,\n                    fill: ellipse.ellipseProps.fill,\n                    classificationType: ellipse.ellipseProps.classificationType,\n                    zIndex: ellipse.ellipseProps.zIndex,\n                    shadows: ellipse.ellipseProps.shadows,\n    }\"\n          >\n          </ac-ellipse-desc>\n\n          <ac-array-desc acFor=\"let label of ellipse.labels\" [idGetter]=\"getLabelId\">\n              <ac-label-primitive-desc\n                      props=\"{\n                        position: label.position,\n                        text: label.text,\n                        backgroundColor: label.backgroundColor,\n                        backgroundPadding: label.backgroundPadding,\n                        distanceDisplayCondition: label.distanceDisplayCondition,\n                        eyeOffset: label.eyeOffset,\n                        fillColor: label.fillColor,\n                        font: label.font,\n                        heightReference: label.heightReference,\n                        horizontalOrigin: label.horizontalOrigin,\n                        outlineColor: label.outlineColor,\n                        outlineWidth: label.outlineWidth,\n                        pixelOffset: label.pixelOffset,\n                        pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n                        scale: label.scale,\n                        scaleByDistance: label.scaleByDistance,\n                        show: label.show,\n                        showBackground: label.showBackground,\n                        style: label.style,\n                        translucencyByDistance: label.translucencyByDistance,\n                        verticalOrigin: label.verticalOrigin,\n                        disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n              >\n              </ac-label-primitive-desc>\n          </ac-array-desc>\n      </ac-layer>\n  `,\n  providers: [CoordinateConverter, EllipsesManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class EllipsesEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: EllipseEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editEllipses$ = new Subject<AcNotification>();\n\n  @ViewChild('editEllipsesLayer') private editEllipsesLayer: AcLayerComponent;\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n\n  constructor(\n    private ellipsesEditor: EllipsesEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private ellipsesManager: EllipsesManagerService,\n    private cesiumService: CesiumService,\n  ) {\n    this.ellipsesEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, this.ellipsesManager, this.cesiumService);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.ellipsesEditor.onUpdate().subscribe(update => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(ellipse: EditableEllipse, update: EllipseEditUpdate, labels?: LabelProps[]) {\n    update.center = ellipse.getCenter();\n    update.majorRadius = ellipse.getMajorRadius();\n    update.minorRadius = ellipse.getMinorRadius();\n    update.rotation = ellipse.getRotation();\n\n    if (labels) {\n      ellipse.labels = labels;\n      this.editEllipsesLayer.update(ellipse, ellipse.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    ellipse.labels = this.editLabelsRenderFn(update, ellipse.labels);\n    this.editEllipsesLayer.update(ellipse, ellipse.getId());\n  }\n\n  removeEditLabels(ellipse: EditableEllipse) {\n    ellipse.labels = [];\n    this.editEllipsesLayer.update(ellipse, ellipse.getId());\n  }\n\n  handleCreateUpdates(update: EllipseEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.ellipsesManager.createEditableEllipse(\n          update.id,\n          this.editEllipsesLayer,\n          this.editPointsLayer,\n          this.coordinateConverter,\n          update.ellipseOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (update.updatedPosition) {\n          ellipse.movePoint(update.updatedPosition, ellipse.majorRadiusPoint);\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (update.center) {\n          ellipse.addPoint(update.center);\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (update.updatedPosition) {\n          ellipse.addLastPoint(update.updatedPosition);\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse) {\n          this.removeEditLabels(ellipse);\n          this.ellipsesManager.dispose(update.id);\n        }\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(ellipse, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        this.renderEditLabels(ellipse, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        this.renderEditLabels(ellipse, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: EllipseEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        const ellipse = this.ellipsesManager.createEditableEllipse(\n          update.id,\n          this.editEllipsesLayer,\n          this.editPointsLayer,\n          this.coordinateConverter,\n          update.ellipseOptions,\n        );\n        ellipse.setManually(\n          update.center,\n          update.majorRadius,\n          update.rotation,\n          update.minorRadius,\n          (update.ellipseOptions && update.ellipseOptions.pointProps) || undefined,\n          (update.ellipseOptions && update.ellipseOptions.pointProps) || undefined,\n          (update.ellipseOptions && update.ellipseOptions.ellipseProps) || undefined,\n        );\n        this.renderEditLabels(ellipse, update);\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH:\n      case EditActions.DRAG_POINT: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse && ellipse.enableEdit) {\n          ellipse.movePoint(update.endDragPosition, update.updatedPoint);\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse && ellipse.enableEdit) {\n          ellipse.moveEllipse(update.startDragPosition, update.endDragPosition);\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse && ellipse.enableEdit) {\n          ellipse.endMoveEllipse();\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.TRANSFORM: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse && ellipse.enableEdit) {\n          ellipse.transformToEllipse();\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse) {\n          ellipse.enableEdit = false;\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const ellipse = this.ellipsesManager.get(update.id);\n        if (ellipse) {\n          ellipse.enableEdit = true;\n          this.renderEditLabels(ellipse, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.ellipsesManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { EditPolyline } from './edit-polyline';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { PointProps } from './point-edit-options';\nimport { PolylineEditOptions, PolylineProps } from './polyline-edit-options';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { defaultLabelProps, LabelProps } from './label-props';\n\nexport class EditablePolyline extends AcEntity {\n  private positions: EditPoint[] = [];\n\n  private polylines: EditPolyline[] = [];\n  private movingPoint: EditPoint;\n  private doneCreation = false;\n  private _enableEdit = true;\n  private _pointProps: PointProps;\n  private polylineProps: PolylineProps;\n  private lastDraggedToPosition: any;\n  private _labels: LabelProps[] = [];\n\n  constructor(private id: string,\n              private pointsLayer: AcLayerComponent,\n              private polylinesLayer: AcLayerComponent,\n              private coordinateConverter: CoordinateConverter,\n              private editOptions: PolylineEditOptions,\n              positions?: Cartesian3[]) {\n    super();\n    this._pointProps = {...editOptions.pointProps};\n    this.props = {...editOptions.polylineProps};\n    if (positions && positions.length >= 2) {\n      this.createFromExisting(positions);\n    }\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels) {\n      return;\n    }\n    const positions = this.getRealPositions();\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        label.position = positions[index];\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get props(): PolylineProps {\n    return this.polylineProps;\n  }\n\n  set props(value: PolylineProps) {\n    this.polylineProps = value;\n  }\n\n  get pointProps(): PointProps {\n    return this._pointProps;\n  }\n\n  set pointProps(value: PointProps) {\n    this._pointProps = value;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this.positions.forEach(point => {\n      point.show = value;\n      this.updatePointsLayer(false, point);\n    });\n  }\n\n  private createFromExisting(positions: Cartesian3[]) {\n    positions.forEach((position) => {\n      this.addPointFromExisting(position);\n    });\n    this.addAllVirtualEditPoints();\n    this.doneCreation = true;\n  }\n\n  setManually(points: {\n    position: Cartesian3,\n    pointProp?: PointProps\n  }[] | Cartesian3[], polylineProps?: PolylineProps) {\n    if (!this.doneCreation) {\n      throw new Error('Update manually only in edit mode, after polyline is created');\n    }\n    this.positions.forEach(p => this.pointsLayer.remove(p.getId()));\n\n    const newPoints: EditPoint[] = [];\n    for (let i = 0; i < points.length; i++) {\n      const pointOrCartesian: any = points[i];\n      let newPoint = null;\n      if (pointOrCartesian.pointProps) {\n        newPoint = new EditPoint(this.id, pointOrCartesian.position, pointOrCartesian.pointProps);\n      } else {\n        newPoint = new EditPoint(this.id, pointOrCartesian, this._pointProps);\n      }\n      newPoints.push(newPoint);\n    }\n    this.positions = newPoints;\n    this.polylineProps = polylineProps ? polylineProps : this.polylineProps;\n\n    this.updatePointsLayer(true, ...this.positions);\n    this.addAllVirtualEditPoints();\n  }\n\n  private addAllVirtualEditPoints() {\n    const currentPoints = [...this.positions];\n    currentPoints.forEach((pos, index) => {\n      if (index !== currentPoints.length - 1) {\n        const currentPoint = pos;\n        const nextIndex = (index + 1) % (currentPoints.length);\n        const nextPoint = currentPoints[nextIndex];\n\n        const midPoint = this.setMiddleVirtualPoint(currentPoint, nextPoint);\n\n        this.updatePointsLayer(false, midPoint);\n      }\n    });\n  }\n\n  private setMiddleVirtualPoint(firstP: EditPoint, secondP: EditPoint): EditPoint {\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(firstP.getPosition(), secondP.getPosition(), 0.5, new Cesium.Cartesian3());\n    const midPoint = new EditPoint(this.id, midPointCartesian3, this._pointProps);\n    midPoint.setVirtualEditPoint(true);\n\n    const firstIndex = this.positions.indexOf(firstP);\n    this.positions.splice(firstIndex + 1, 0, midPoint);\n    return midPoint;\n  }\n\n  private updateMiddleVirtualPoint(virtualEditPoint: EditPoint, prevPoint: EditPoint, nextPoint: EditPoint) {\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(prevPoint.getPosition(), nextPoint.getPosition(), 0.5, new Cesium.Cartesian3());\n    virtualEditPoint.setPosition(midPointCartesian3);\n  }\n\n  changeVirtualPointToRealPoint(point: EditPoint) {\n    point.setVirtualEditPoint(false); // actual point becomes a real point\n    const pointsCount = this.positions.length;\n    const pointIndex = this.positions.indexOf(point);\n    const nextIndex = (pointIndex + 1) % (pointsCount);\n    const preIndex = ((pointIndex - 1) + pointsCount) % pointsCount;\n\n    const nextPoint = this.positions[nextIndex];\n    const prePoint = this.positions[preIndex];\n\n    const firstMidPoint = this.setMiddleVirtualPoint(prePoint, point);\n    const secMidPoint = this.setMiddleVirtualPoint(point, nextPoint);\n    this.updatePointsLayer(false, firstMidPoint, secMidPoint, point);\n\n  }\n\n  private renderPolylines() {\n    this.polylines.forEach(polyline => this.polylinesLayer.remove(polyline.getId()));\n    this.polylines = [];\n    const realPoints = this.positions.filter(point => !point.isVirtualEditPoint());\n    realPoints.forEach((point, index) => {\n      if (index !== realPoints.length - 1) {\n        const nextIndex = (index + 1);\n        const nextPoint = realPoints[nextIndex];\n        const polyline = new EditPolyline(this.id, point.getPosition(), nextPoint.getPosition(), this.polylineProps);\n        this.polylines.push(polyline);\n        this.polylinesLayer.update(polyline, polyline.getId());\n      }\n    });\n  }\n\n  addPointFromExisting(position: Cartesian3) {\n    const newPoint = new EditPoint(this.id, position, this._pointProps);\n    this.positions.push(newPoint);\n    this.updatePointsLayer(true, newPoint);\n  }\n\n\n  addPoint(position: Cartesian3) {\n    if (this.doneCreation) {\n      return;\n    }\n    const isFirstPoint = !this.positions.length;\n    if (isFirstPoint) {\n      const firstPoint = new EditPoint(this.id, position, this._pointProps);\n      this.positions.push(firstPoint);\n      this.updatePointsLayer(true, firstPoint);\n    }\n\n    this.movingPoint = new EditPoint(this.id, position.clone(), this._pointProps);\n    this.positions.push(this.movingPoint);\n\n    this.updatePointsLayer(true, this.movingPoint);\n  }\n\n  movePointFinish(editPoint: EditPoint) {\n    if (this.editOptions.clampHeightTo3D) {\n      editPoint.props.disableDepthTestDistance = Number.POSITIVE_INFINITY;\n      this.updatePointsLayer(false, editPoint);\n    }\n  }\n\n  movePoint(toPosition: Cartesian3, editPoint: EditPoint) {\n    editPoint.setPosition(toPosition);\n    if (this.doneCreation) {\n      if (editPoint.props.disableDepthTestDistance && this.editOptions.clampHeightTo3D) {\n        // To avoid bug with pickPosition() on point with disableDepthTestDistance\n        editPoint.props.disableDepthTestDistance = undefined;\n        return; // ignore first move because the pickPosition() could be wrong\n      }\n\n      if (editPoint.isVirtualEditPoint()) {\n        this.changeVirtualPointToRealPoint(editPoint);\n      }\n      const pointsCount = this.positions.length;\n      const pointIndex = this.positions.indexOf(editPoint);\n\n      if (pointIndex < this.positions.length - 1) {\n        const nextVirtualPoint = this.positions[(pointIndex + 1) % (pointsCount)];\n        const nextRealPoint = this.positions[(pointIndex + 2) % (pointsCount)];\n        this.updateMiddleVirtualPoint(nextVirtualPoint, editPoint, nextRealPoint);\n      }\n      if (pointIndex > 0) {\n        const prevVirtualPoint = this.positions[((pointIndex - 1) + pointsCount) % pointsCount];\n        const prevRealPoint = this.positions[((pointIndex - 2) + pointsCount) % pointsCount];\n        this.updateMiddleVirtualPoint(prevVirtualPoint, editPoint, prevRealPoint);\n      }\n    }\n    this.updatePointsLayer(true, editPoint);\n  }\n\n  moveTempMovingPoint(toPosition: Cartesian3) {\n    if (this.movingPoint) {\n      this.movePoint(toPosition, this.movingPoint);\n    }\n  }\n\n  moveShape(startMovingPosition: Cartesian3, draggedToPosition: Cartesian3) {\n    if (!this.doneCreation) {\n      return;\n    }\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = startMovingPosition;\n    }\n\n    const delta = GeoUtilsService.getPositionsDelta(this.lastDraggedToPosition, draggedToPosition);\n    this.positions.forEach(point => {\n      const newPos = GeoUtilsService.addDeltaToPosition(point.getPosition(), delta, true);\n      point.setPosition(newPos);\n    });\n    this.updatePointsLayer(true, ...this.positions);\n    this.lastDraggedToPosition = draggedToPosition;\n  }\n\n  endMoveShape() {\n    this.lastDraggedToPosition = undefined;\n    this.updatePointsLayer(true, ...this.positions);\n  }\n\n  removePoint(pointToRemove: EditPoint) {\n    this.removePosition(pointToRemove);\n    this.positions\n      .filter(p => p.isVirtualEditPoint())\n      .forEach(p => this.removePosition(p));\n    this.addAllVirtualEditPoints();\n\n    this.renderPolylines();\n  }\n\n  addLastPoint(position: Cartesian3) {\n    this.doneCreation = true;\n    this.removePosition(this.movingPoint); // remove movingPoint\n    this.movingPoint = null;\n\n    this.addAllVirtualEditPoints();\n  }\n\n  getRealPositions(): Cartesian3[] {\n    return this.getRealPoints()\n      .map(position => position.getPosition());\n  }\n\n  getRealPoints(): EditPoint[] {\n    return this.positions\n      .filter(position => !position.isVirtualEditPoint() && position !== this.movingPoint);\n  }\n\n  getPoints(): EditPoint[] {\n    return this.positions.filter(position => position !== this.movingPoint);\n  }\n\n  getPositions(): Cartesian3[] {\n    return this.positions.map(position => position.getPosition());\n  }\n\n  getPositionsCallbackProperty(): Cartesian3[] {\n    return new Cesium.CallbackProperty(this.getPositions.bind(this), false);\n  }\n\n  private removePosition(point: EditPoint) {\n    const index = this.positions.findIndex((p) => p === point);\n    if (index < 0) {\n      return;\n    }\n    this.positions.splice(index, 1);\n    this.pointsLayer.remove(point.getId());\n  }\n\n  private updatePointsLayer(renderPolylines = true, ...point: EditPoint[]) {\n    if (renderPolylines) {\n      this.renderPolylines();\n    }\n    point.forEach(p => this.pointsLayer.update(p, p.getId()));\n  }\n\n  update() {\n    this.updatePointsLayer();\n  }\n\n  dispose() {\n    this.positions.forEach(editPoint => {\n      this.pointsLayer.remove(editPoint.getId());\n    });\n    this.polylines.forEach(line => this.polylinesLayer.remove(line.getId()));\n    if (this.movingPoint) {\n      this.pointsLayer.remove(this.movingPoint.getId());\n      this.movingPoint = undefined;\n    }\n    this.positions.length = 0;\n  }\n\n  getPointsCount(): number {\n    return this.positions.length;\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { Rectangle } from '../../angular-cesium/models/rectangle';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { RectangleEditOptions, RectangleProps } from './rectangle-edit-options';\nimport { PointProps } from './point-edit-options';\nimport { defaultLabelProps, LabelProps } from './label-props';\n\nexport class EditableRectangle extends AcEntity {\n  private positions: EditPoint[] = [];\n  private movingPoint: EditPoint;\n  private done = false;\n  private _enableEdit = true;\n  private _defaultPointProps: PointProps;\n  private _rectangleProps: RectangleProps;\n  private lastDraggedToPosition: Cartesian3;\n  private _labels: LabelProps[] = [];\n\n  constructor(\n    private id: string,\n    private pointsLayer: AcLayerComponent,\n    private rectangleLayer: AcLayerComponent,\n    private coordinateConverter: CoordinateConverter,\n    editOptions: RectangleEditOptions,\n    positions?: Cartesian3[]\n  ) {\n    super();\n    this.defaultPointProps = {...editOptions.pointProps};\n    this.rectangleProps = {...editOptions.rectangleProps};\n    if (positions && positions.length === 2) {\n      this.createFromExisting(positions);\n    } else if (positions) {\n      throw new Error('Rectangle consist of 2 points but provided ' + positions.length);\n    }\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels) {\n      return;\n    }\n    const positions = this.getRealPositions();\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        label.position = positions[index];\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get rectangleProps(): RectangleProps {\n    return this._rectangleProps;\n  }\n\n  set rectangleProps(value: RectangleProps) {\n    this._rectangleProps = value;\n  }\n\n  get defaultPointProps(): PointProps {\n    return this._defaultPointProps;\n  }\n\n  set defaultPointProps(value: PointProps) {\n    this._defaultPointProps = value;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this.positions.forEach(point => {\n      point.show = value;\n      this.updatePointsLayer(point);\n    });\n  }\n\n  private createFromExisting(positions: Cartesian3[]) {\n    positions.forEach(position => {\n      this.addPointFromExisting(position);\n    });\n    this.updateRectangleLayer();\n    this.updatePointsLayer(...this.positions);\n    this.done = true;\n  }\n\n  setPointsManually(points: EditPoint[], widthMeters?: number) {\n    if (!this.done) {\n      throw new Error('Update manually only in edit mode, after rectangle is created');\n    }\n    this.positions.forEach(p => this.pointsLayer.remove(p.getId()));\n    this.positions = points;\n    this.updatePointsLayer(...points);\n    this.updateRectangleLayer();\n  }\n\n  addPointFromExisting(position: Cartesian3) {\n    const newPoint = new EditPoint(this.id, position, this.defaultPointProps);\n    this.positions.push(newPoint);\n    this.updatePointsLayer(newPoint);\n  }\n\n  addPoint(position: Cartesian3) {\n    if (this.done) {\n      return;\n    }\n    const isFirstPoint = !this.positions.length;\n    if (isFirstPoint) {\n      const firstPoint = new EditPoint(this.id, position, this.defaultPointProps);\n      this.positions.push(firstPoint);\n      this.movingPoint = new EditPoint(this.id, position.clone(), this.defaultPointProps);\n      this.positions.push(this.movingPoint);\n      this.updatePointsLayer(firstPoint);\n    } else {\n\n      this.updatePointsLayer(...this.positions);\n      this.updateRectangleLayer();\n      this.done = true;\n      this.movingPoint = null;\n    }\n  }\n\n  movePoint(toPosition: Cartesian3, editPoint: EditPoint) {\n    if (!editPoint.isVirtualEditPoint()) {\n      editPoint.setPosition(toPosition);\n      this.updatePointsLayer(...this.positions);\n      this.updateRectangleLayer();\n    }\n  }\n\n  moveShape(startMovingPosition: Cartesian3, draggedToPosition: Cartesian3) {\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = startMovingPosition;\n    }\n\n    const lastDraggedCartographic = Cesium.Cartographic.fromCartesian(this.lastDraggedToPosition);\n    const draggedToPositionCartographic = Cesium.Cartographic.fromCartesian(draggedToPosition);\n    this.getRealPoints().forEach(point => {\n      const cartographic = Cesium.Cartographic.fromCartesian(point.getPosition());\n      cartographic.longitude += (draggedToPositionCartographic.longitude - lastDraggedCartographic.longitude);\n      cartographic.latitude += (draggedToPositionCartographic.latitude - lastDraggedCartographic.latitude);\n      point.setPosition(Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, 0));\n    });\n\n    this.updatePointsLayer(...this.positions);\n    this.updateRectangleLayer();\n    this.lastDraggedToPosition = draggedToPosition;\n  }\n\n  endMoveShape() {\n    this.lastDraggedToPosition = undefined;\n    this.positions.forEach(point => this.updatePointsLayer(point));\n    this.updateRectangleLayer();\n  }\n\n  endMovePoint() {\n    this.updatePointsLayer(...this.positions);\n  }\n\n  moveTempMovingPoint(toPosition: Cartesian3) {\n    if (this.movingPoint) {\n      this.movePoint(toPosition, this.movingPoint);\n    }\n  }\n\n  removePoint(pointToRemove: EditPoint) {\n    this.removePosition(pointToRemove);\n    this.positions.filter(p => p.isVirtualEditPoint()).forEach(p => this.removePosition(p));\n  }\n\n  addLastPoint(position: Cartesian3) {\n    this.done = true;\n    this.removePosition(this.movingPoint); // remove movingPoint\n    this.movingPoint = null;\n  }\n\n  getRealPositions(): Cartesian3[] {\n    return this.getRealPoints().map(position => position.getPosition());\n  }\n\n  getRealPositionsCallbackProperty() {\n    return new Cesium.CallbackProperty(this.getRealPositions.bind(this), false);\n  }\n\n  getRealPoints(): EditPoint[] {\n    return this.positions.filter(position => !position.isVirtualEditPoint());\n  }\n\n  getPositions(): Cartesian3[] {\n    return this.positions.map(position => position.getPosition());\n  }\n\n  getRectangle(): Rectangle {\n    const cartographics = this.getPositions().map(cartesian => Cesium.Cartographic.fromCartesian(cartesian));\n    const longitudes = cartographics.map(position => position.longitude);\n    const latitudes = cartographics.map(position =>  position.latitude);\n\n    return new Cesium.Rectangle(\n      Math.min(...longitudes),\n      Math.min(...latitudes),\n      Math.max(...longitudes),\n      Math.max(...latitudes)\n    );\n  }\n\n  getRectangleCallbackProperty(): Rectangle {\n    return new Cesium.CallbackProperty(this.getRectangle.bind(this), false);\n  }\n\n  private removePosition(point: EditPoint) {\n    const index = this.positions.findIndex(p => p === point);\n    if (index < 0) {\n      return;\n    }\n    this.positions.splice(index, 1);\n    this.pointsLayer.remove(point.getId());\n  }\n\n  private updatePointsLayer(...point: EditPoint[]) {\n    point.forEach(p => this.pointsLayer.update(p, p.getId()));\n  }\n\n  private updateRectangleLayer() {\n    this.rectangleLayer.update(this, this.id);\n  }\n\n  dispose() {\n    this.rectangleLayer.remove(this.id);\n\n    this.positions.forEach(editPoint => {\n      this.pointsLayer.remove(editPoint.getId());\n    });\n    if (this.movingPoint) {\n      this.pointsLayer.remove(this.movingPoint.getId());\n      this.movingPoint = undefined;\n    }\n    this.positions.length = 0;\n  }\n\n  getPointsCount(): number {\n    return this.positions.length;\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n\n","import { Observable } from 'rxjs';\nimport { LabelProps } from './label-props';\n\nexport class EditorObservable<T> extends Observable<T> {\n  dispose: Function;\n  enable: Function;\n  disable: Function;\n  getLabels: () => LabelProps[];\n  getEditValue: () => T;\n  setLabelsRenderFn: (func: (update: T, labels: LabelProps[]) => LabelProps[]) => void;\n  updateLabels: (labels: LabelProps[]) => void;\n  finishCreation: () => boolean;\n}\n","import { EditPoint } from './edit-point';\nimport { EditorObservable } from './editor-observable';\nimport { PointProps } from './point-edit-options';\nimport { Cartesian3 } from '../../angular-cesium';\nimport { PointEditUpdate } from './point-edit-update';\n\nexport class PointEditorObservable extends EditorObservable<PointEditUpdate> {\n  setManually: (point: { position: Cartesian3, pointProp?: PointProps } | Cartesian3, pointProps?: PointProps) => void;\n  getCurrentPoint: () => EditPoint;\n}\n","import { EditPoint } from './edit-point';\nimport { EditorObservable } from './editor-observable';\nimport { PolylineEditUpdate } from './polyline-edit-update';\nimport { PointProps } from './point-edit-options';\nimport { PolylineProps } from './polyline-edit-options';\nimport { Cartesian3 } from '../../angular-cesium';\n\nexport class PolylineEditorObservable extends EditorObservable<PolylineEditUpdate> {\n  setManually: (points: { position: Cartesian3, pointProp?: PointProps }[] | Cartesian3[], polylineProps?: PolylineProps) => void;\n  getCurrentPoints: () => EditPoint[];\n}\n","import { EditPoint } from './edit-point';\nimport { EditorObservable } from './editor-observable';\nimport { PolygonEditUpdate } from './polygon-edit-update';\nimport { PointProps } from './point-edit-options';\nimport { PolygonProps } from './polygon-edit-options';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\n\n\nexport class PolygonEditorObservable extends EditorObservable<PolygonEditUpdate> {\n  setManually: (points: { position: Cartesian3, pointProp?: PointProps }[] | Cartesian3[],\n                polygonProps?: PolygonProps) => void;\n  getCurrentPoints: () => EditPoint[];\n}\n","import { EditPoint } from './edit-point';\nimport { EditorObservable } from './editor-observable';\nimport { RectangleEditUpdate } from './rectangle-edit-update';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { PointProps } from './point-edit-options';\n\nexport class RectangleEditorObservable extends EditorObservable<RectangleEditUpdate> {\n  setManually: (\n    firstPosition: Cartesian3,\n    secondPosition: Cartesian3,\n    firstPointProp?: PointProps,\n    secondPointProp?: PointProps\n  ) => void;\n  getCurrentPoints: () => EditPoint[];\n}\n\n","import { EditorObservable } from './editor-observable';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CircleEditUpdate } from './circle-edit-update';\nimport { PointProps } from './point-edit-options';\nimport { EllipseProps } from './ellipse-edit-options';\n\nexport class CircleEditorObservable extends EditorObservable<CircleEditUpdate> {\n  setManually: (center: Cartesian3, radius: number, centerPointProp?: PointProps,\n                radiusPointProp?: PointProps, circleProp?: EllipseProps) => void;\n  getCenter: () => Cartesian3;\n  getRadius: () => number; // meters\n}\n","import { EditorObservable } from './editor-observable';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { EllipseEditUpdate } from './ellipse-edit-update';\nimport { PointProps } from './point-edit-options';\nimport { EllipseProps } from './ellipse-edit-options';\n\nexport class EllipseEditorObservable extends EditorObservable<EllipseEditUpdate> {\n  setManually: (\n    center: Cartesian3,\n    majorRadius: number,\n    rotation?: number,\n    minorRadius?: number,\n    centerPointProp?: PointProps,\n    radiusPointProp?: PointProps,\n    ellipseProp?: EllipseProps,\n  ) => void;\n  getCenter: () => Cartesian3;\n  getMinorRadius: () => number; // meters\n  getMajorRadius: () => number; // meters\n}\n","import { EditPoint } from './edit-point';\nimport { EditorObservable } from './editor-observable';\nimport { HippodromeEditUpdate } from './hippodrome-edit-update';\nimport { PointProps } from './point-edit-options';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\n\nexport class HippodromeEditorObservable extends EditorObservable<HippodromeEditUpdate> {\n  setManually: (firstPosition: Cartesian3,\n                secondPosition: Cartesian3,\n                widthMeters?: number,\n                firstPointProp?: PointProps,\n                secondPointProp?: PointProps) => void;\n  getCurrentPoints: () => EditPoint[];\n  getCurrentWidth: () => number; // meters\n}\n","import { AcEntity } from '../../angular-cesium/models/ac-entity';\nimport { EditPoint } from './edit-point';\nimport { AcLayerComponent } from '../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { PointProps } from './point-edit-options';\nimport { HippodromeEditOptions, HippodromeProps } from './hippodrome-edit-options';\nimport { GeoUtilsService } from '../../angular-cesium/services/geo-utils/geo-utils.service';\nimport { defaultLabelProps, LabelProps } from './label-props';\n\nexport class EditableHippodrome extends AcEntity {\n  private positions: EditPoint[] = [];\n  private movingPoint: EditPoint;\n  private done = false;\n  private _enableEdit = true;\n  private _defaultPointProps: PointProps;\n  private _hippodromeProps: HippodromeProps;\n  private lastDraggedToPosition: Cartesian3;\n  private _labels: LabelProps[] = [];\n\n  constructor(\n    private id: string,\n    private pointsLayer: AcLayerComponent,\n    private hippodromeLayer: AcLayerComponent,\n    private coordinateConverter: CoordinateConverter,\n    editOptions: HippodromeEditOptions,\n    positions?: Cartesian3[],\n  ) {\n    super();\n    this.defaultPointProps = {...editOptions.pointProps};\n    this.hippodromeProps = {...editOptions.hippodromeProps};\n    if (positions && positions.length === 2) {\n      this.createFromExisting(positions);\n    } else if (positions) {\n      throw new Error('Hippodrome consist of 2 points but provided ' + positions.length);\n    }\n  }\n\n  get labels(): LabelProps[] {\n    return this._labels;\n  }\n\n  set labels(labels: LabelProps[]) {\n    if (!labels) {\n      return;\n    }\n    const positions = this.getRealPositions();\n    this._labels = labels.map((label, index) => {\n      if (!label.position) {\n        label.position = positions[index];\n      }\n\n      return Object.assign({}, defaultLabelProps, label);\n    });\n  }\n\n  get hippodromeProps(): HippodromeProps {\n    return this._hippodromeProps;\n  }\n\n  set hippodromeProps(value: HippodromeProps) {\n    this._hippodromeProps = value;\n  }\n\n  get defaultPointProps(): PointProps {\n    return this._defaultPointProps;\n  }\n\n  set defaultPointProps(value: PointProps) {\n    this._defaultPointProps = value;\n  }\n\n  get enableEdit() {\n    return this._enableEdit;\n  }\n\n  set enableEdit(value: boolean) {\n    this._enableEdit = value;\n    this.positions.forEach(point => {\n      point.show = value;\n      this.updatePointsLayer(point);\n    });\n  }\n\n  private createFromExisting(positions: Cartesian3[]) {\n    positions.forEach(position => {\n      this.addPointFromExisting(position);\n    });\n    this.createHeightEditPoints();\n    this.updateHippdromeLayer();\n    this.updatePointsLayer(...this.positions);\n    this.done = true;\n  }\n\n  setPointsManually(points: EditPoint[], widthMeters?: number) {\n    if (!this.done) {\n      throw new Error('Update manually only in edit mode, after polyline is created');\n    }\n    this.hippodromeProps.width = widthMeters ? widthMeters : this.hippodromeProps.width;\n    this.positions.forEach(p => this.pointsLayer.remove(p.getId()));\n    this.positions = points;\n    this.createHeightEditPoints();\n    this.updatePointsLayer(...points);\n    this.updateHippdromeLayer();\n  }\n\n  addPointFromExisting(position: Cartesian3) {\n    const newPoint = new EditPoint(this.id, position, this.defaultPointProps);\n    this.positions.push(newPoint);\n    this.updatePointsLayer(newPoint);\n  }\n\n  addPoint(position: Cartesian3) {\n    if (this.done) {\n      return;\n    }\n    const isFirstPoint = !this.positions.length;\n    if (isFirstPoint) {\n      const firstPoint = new EditPoint(this.id, position, this.defaultPointProps);\n      this.positions.push(firstPoint);\n      this.movingPoint = new EditPoint(this.id, position.clone(), this.defaultPointProps);\n      this.positions.push(this.movingPoint);\n      this.updatePointsLayer(firstPoint);\n    } else {\n      this.createHeightEditPoints();\n\n      this.updatePointsLayer(...this.positions);\n      this.updateHippdromeLayer();\n      this.done = true;\n      this.movingPoint = null;\n    }\n  }\n\n  private createHeightEditPoints() {\n    this.positions.filter(p => p.isVirtualEditPoint()).forEach(p => this.removePosition(p));\n\n    const firstP = this.getRealPoints()[0];\n    const secP = this.getRealPoints()[1];\n\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(firstP.getPosition(), secP.getPosition(), 0.5, new Cesium.Cartesian3());\n    const bearingDeg = this.coordinateConverter.bearingToCartesian(firstP.getPosition(), secP.getPosition());\n\n    const upAzimuth = Cesium.Math.toRadians(bearingDeg) - Math.PI / 2;\n    this.createMiddleEditablePoint(midPointCartesian3, upAzimuth);\n    const downAzimuth = Cesium.Math.toRadians(bearingDeg) + Math.PI / 2;\n    this.createMiddleEditablePoint(midPointCartesian3, downAzimuth);\n  }\n\n  private createMiddleEditablePoint(midPointCartesian3: any, azimuth: number) {\n    const upEditCartesian3 = GeoUtilsService.pointByLocationDistanceAndAzimuth(\n      midPointCartesian3,\n      this.hippodromeProps.width / 2,\n      azimuth,\n      true,\n    );\n    const midPoint = new EditPoint(this.id, upEditCartesian3, this.defaultPointProps);\n    midPoint.setVirtualEditPoint(true);\n    this.positions.push(midPoint);\n  }\n\n  movePoint(toPosition: Cartesian3, editPoint: EditPoint) {\n    if (!editPoint.isVirtualEditPoint()) {\n      editPoint.setPosition(toPosition);\n      this.createHeightEditPoints();\n      this.updatePointsLayer(...this.positions);\n      this.updateHippdromeLayer();\n    } else {\n      this.changeWidthByNewPoint(toPosition);\n    }\n  }\n\n  private changeWidthByNewPoint(toPosition: Cartesian3) {\n    const firstP = this.getRealPoints()[0];\n    const secP = this.getRealPoints()[1];\n    const midPointCartesian3 = Cesium.Cartesian3.lerp(firstP.getPosition(), secP.getPosition(), 0.5, new Cesium.Cartesian3());\n\n    const bearingDeg = this.coordinateConverter.bearingToCartesian(midPointCartesian3, toPosition);\n    let normalizedBearingDeb = bearingDeg;\n    if (bearingDeg > 270) {\n      normalizedBearingDeb = bearingDeg - 270;\n    } else if (bearingDeg > 180) {\n      normalizedBearingDeb = bearingDeg - 180;\n    }\n    let bearingDegHippodromeDots = this.coordinateConverter.bearingToCartesian(firstP.getPosition(), secP.getPosition());\n    if (bearingDegHippodromeDots > 180) {\n      bearingDegHippodromeDots = this.coordinateConverter.bearingToCartesian(secP.getPosition(), firstP.getPosition());\n    }\n    let fixedBearingDeg =\n      bearingDegHippodromeDots > normalizedBearingDeb\n        ? bearingDegHippodromeDots - normalizedBearingDeb\n        : normalizedBearingDeb - bearingDegHippodromeDots;\n\n    if (bearingDeg > 270) {\n      fixedBearingDeg = bearingDeg - bearingDegHippodromeDots;\n    }\n\n    const distanceMeters = Math.abs(GeoUtilsService.distance(midPointCartesian3, toPosition));\n    const radiusWidth = Math.sin(Cesium.Math.toRadians(fixedBearingDeg)) * distanceMeters;\n\n    this.hippodromeProps.width = Math.abs(radiusWidth) * 2;\n    this.createHeightEditPoints();\n    this.updatePointsLayer(...this.positions);\n    this.updateHippdromeLayer();\n  }\n\n  moveShape(startMovingPosition: Cartesian3, draggedToPosition: Cartesian3) {\n    if (!this.lastDraggedToPosition) {\n      this.lastDraggedToPosition = startMovingPosition;\n    }\n\n    const delta = GeoUtilsService.getPositionsDelta(this.lastDraggedToPosition, draggedToPosition);\n    this.getRealPoints().forEach(point => {\n      const newPos = GeoUtilsService.addDeltaToPosition(point.getPosition(), delta, true);\n      point.setPosition(newPos);\n    });\n    this.createHeightEditPoints();\n    this.updatePointsLayer(...this.positions);\n    this.updateHippdromeLayer();\n    this.lastDraggedToPosition = draggedToPosition;\n  }\n\n  endMoveShape() {\n    this.lastDraggedToPosition = undefined;\n    this.createHeightEditPoints();\n    this.positions.forEach(point => this.updatePointsLayer(point));\n    this.updateHippdromeLayer();\n  }\n\n  endMovePoint() {\n    this.createHeightEditPoints();\n    this.updatePointsLayer(...this.positions);\n  }\n\n  moveTempMovingPoint(toPosition: Cartesian3) {\n    if (this.movingPoint) {\n      this.movePoint(toPosition, this.movingPoint);\n    }\n  }\n\n  removePoint(pointToRemove: EditPoint) {\n    this.removePosition(pointToRemove);\n    this.positions.filter(p => p.isVirtualEditPoint()).forEach(p => this.removePosition(p));\n  }\n\n  addLastPoint(position: Cartesian3) {\n    this.done = true;\n    this.removePosition(this.movingPoint); // remove movingPoint\n    this.movingPoint = null;\n  }\n\n  getRealPositions(): Cartesian3[] {\n    return this.getRealPoints().map(position => position.getPosition());\n  }\n\n  getRealPositionsCallbackProperty() {\n    return new Cesium.CallbackProperty(this.getRealPositions.bind(this), false);\n  }\n\n  getRealPoints(): EditPoint[] {\n    return this.positions.filter(position => !position.isVirtualEditPoint());\n  }\n\n  getWidth(): number {\n    return this.hippodromeProps.width;\n  }\n\n  getPositions(): Cartesian3[] {\n    return this.positions.map(position => position.getPosition());\n  }\n\n  private removePosition(point: EditPoint) {\n    const index = this.positions.findIndex(p => p === point);\n    if (index < 0) {\n      return;\n    }\n    this.positions.splice(index, 1);\n    this.pointsLayer.remove(point.getId());\n  }\n\n  private updatePointsLayer(...point: EditPoint[]) {\n    point.forEach(p => this.pointsLayer.update(p, p.getId()));\n  }\n\n  private updateHippdromeLayer() {\n    this.hippodromeLayer.update(this, this.id);\n  }\n\n  dispose() {\n    this.hippodromeLayer.remove(this.id);\n\n    this.positions.forEach(editPoint => {\n      this.pointsLayer.remove(editPoint.getId());\n    });\n    if (this.movingPoint) {\n      this.pointsLayer.remove(this.movingPoint.getId());\n      this.movingPoint = undefined;\n    }\n    this.positions.length = 0;\n  }\n\n  getPointsCount(): number {\n    return this.positions.length;\n  }\n\n  getId() {\n    return this.id;\n  }\n}\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PolylinesManagerService } from './polylines-manager.service';\nimport { ClampTo3DOptions, PolylineEditOptions, PolylineProps } from '../../../models/polyline-edit-options';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { PolylineEditUpdate } from '../../../models/polyline-edit-update';\nimport { PolylineEditorObservable } from '../../../models/polyline-editor-observable';\nimport { EditPolyline } from '../../../models';\nimport { LabelProps } from '../../../models/label-props';\nimport { debounce, generateKey } from '../../utils';\nimport { CesiumService } from '../../../../angular-cesium';\n\nexport const DEFAULT_POLYLINE_OPTIONS: PolylineEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  addLastPointEvent: CesiumEvent.LEFT_DOUBLE_CLICK,\n  removePointEvent: CesiumEvent.RIGHT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  pointProps: {\n    color: Cesium.Color.WHITE.withAlpha(0.95),\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.5),\n    outlineWidth: 1,\n    pixelSize: 15,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n  polylineProps: {\n    material: () => Cesium.Color.BLACK,\n    width: 3,\n    clampToGround: false,\n    zIndex: 0,\n    classificationType: Cesium.ClassificationType.BOTH,\n  },\n  clampHeightTo3D: false,\n  clampHeightTo3DOptions: {\n    clampToTerrain: false,\n    clampMostDetailed: true,\n    clampToHeightPickWidth: 2,\n  },\n};\n\n/**\n * Service for creating editable polylines\n *\n *  * You must provide `PolylineEditorService` yourself.\n * PolygonsEditorService works together with `<polylines-editor>` component. Therefor you need to create `<polylines-editor>`\n * for each `PolylineEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `PolylineEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `PolylineEditorObservable`.\n * + To stop editing call `dsipose()` from the `PolylineEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `PolylineEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating polyline\n *  const editing$ = polylinesEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit polyline from existing polyline cartesian3 positions\n *  const editing$ = this.polylinesEditor.edit(initialPos);\n *\n * ```\n */\n@Injectable()\nexport class PolylinesEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<PolylineEditUpdate>();\n  private updatePublisher = publish<PolylineEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private polylinesManager: PolylinesManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n  private cesiumScene;\n\n  private clampPointsDebounced = debounce((id, clampHeightTo3D: boolean, clampHeightTo3DOptions) => {\n    this.clampPoints(id, clampHeightTo3D, clampHeightTo3DOptions);\n  }, 300);\n\n  init(mapEventsManager: MapEventsManagerService,\n       coordinateConverter: CoordinateConverter,\n       cameraService: CameraService,\n       polylinesManager: PolylinesManagerService,\n       cesiumViewer: CesiumService) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.polylinesManager = polylinesManager;\n    this.updatePublisher.connect();\n\n    this.cesiumScene = cesiumViewer.getScene();\n  }\n\n  onUpdate(): Observable<PolylineEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  private clampPoints(id, clampHeightTo3D: boolean, { clampToTerrain, clampMostDetailed, clampToHeightPickWidth }: ClampTo3DOptions) {\n    if (clampHeightTo3D && clampMostDetailed) {\n      const polyline = this.polylinesManager.get(id);\n      const points = polyline.getPoints();\n\n      if (!clampToTerrain) {\n        // 3dTiles\n        points.forEach(point => {\n          point.setPosition(this.cesiumScene.clampToHeight(point.getPosition(), undefined, clampToHeightPickWidth));\n        });\n      } else {\n        const cartographics = points.map(point => this.coordinateConverter.cartesian3ToCartographic(point.getPosition()));\n        const promise = Cesium.sampleTerrain(this.cesiumScene.terrainProvider, 11, cartographics);\n        Cesium.when(promise, function (updatedPositions) {\n          points.forEach((point, index) => {\n            point.setPosition(Cesium.Cartographic.toCartesian(updatedPositions[index]));\n          });\n        });\n      }\n    }\n  }\n\n\n  private screenToPosition(cartesian2, clampHeightTo3D: boolean, {clampToHeightPickWidth, clampToTerrain}: ClampTo3DOptions) {\n    const cartesian3 = this.coordinateConverter.screenToCartesian3(cartesian2);\n\n    // If cartesian3 is undefined then the point inst on the globe\n    if (clampHeightTo3D && cartesian3) {\n      const globePositionPick = () => {\n        const ray = this.cameraService.getCamera().getPickRay(cartesian2);\n        return this.cesiumScene.globe.pick(ray, this.cesiumScene);\n      };\n\n      // is terrain?\n      if (clampToTerrain) {\n        return globePositionPick();\n      } else {\n        const cartesian3PickPosition = this.cesiumScene.pickPosition(cartesian2);\n        const latLon = CoordinateConverter.cartesian3ToLatLon(cartesian3PickPosition);\n        if (latLon.height < 0) {// means nothing picked -> Validate it\n          return globePositionPick();\n        }\n        return this.cesiumScene.clampToHeight(cartesian3PickPosition, undefined, clampToHeightPickWidth);\n      }\n    }\n\n    return cartesian3;\n  }\n\n  create(options = DEFAULT_POLYLINE_OPTIONS, eventPriority = 100): PolylineEditorObservable {\n    const positions: Cartesian3[] = [];\n    const id = generateKey();\n    const polylineOptions = this.setOptions(options);\n\n    const clientEditSubject = new BehaviorSubject<PolylineEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      positions,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      polylineOptions: polylineOptions,\n    });\n\n    const finishCreation = (position: Cartesian3) => {\n      return this.switchToEditMode(\n        id,\n        position,\n        clientEditSubject,\n        positions,\n        eventPriority,\n        polylineOptions,\n        editorObservable,\n        finishedCreate);\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n      pickConfig: options.pickConfiguration,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: polylineOptions.addPointEvent,\n      modifier: polylineOptions.addPointModifier,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n      pickConfig: options.pickConfiguration,\n    });\n    const addLastPointRegistration = this.mapEventsManager.register({\n      event: polylineOptions.addLastPointEvent,\n      modifier: polylineOptions.addLastPointModifier,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n      pickConfig: options.pickConfiguration,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration, addLastPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition, polylineOptions.clampHeightTo3D, polylineOptions.clampHeightTo3DOptions);\n      if (position) {\n        this.updateSubject.next({\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.MOUSE_MOVE,\n        });\n      }\n    });\n\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.screenToPosition(endPosition, polylineOptions.clampHeightTo3D, polylineOptions.clampHeightTo3DOptions);\n      if (!position) {\n        return;\n      }\n      const allPositions = this.getPositions(id);\n      if (allPositions.find((cartesian) => cartesian.equals(position))) {\n        return;\n      }\n      const updateValue = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.CREATE,\n        updatedPosition: position,\n        editAction: EditActions.ADD_POINT,\n      };\n      this.updateSubject.next(updateValue);\n      clientEditSubject.next({\n        ...updateValue,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n      });\n      if (polylineOptions.maximumNumberOfPoints && allPositions.length + 1 === polylineOptions.maximumNumberOfPoints) {\n        finishedCreate = finishCreation(position);\n      }\n    });\n\n    addLastPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.screenToPosition(endPosition, polylineOptions.clampHeightTo3D, polylineOptions.clampHeightTo3DOptions);\n      if (!position) {\n        return;\n      }\n\n      // Add last point to positions if not already added\n      const allPositions = this.getPositions(id);\n      if (!allPositions.find((cartesian) => cartesian.equals(position))) {\n        const updateValue = {\n          id,\n          positions: allPositions,\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.ADD_POINT,\n        };\n        this.updateSubject.next(updateValue);\n        clientEditSubject.next({\n          ...updateValue,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n        });\n      }\n\n      finishedCreate = finishCreation(position);\n    });\n\n    return editorObservable;\n  }\n\n  private switchToEditMode(id,\n                           position,\n                           clientEditSubject,\n                           positions: Cartesian3[],\n                           eventPriority,\n                           polylineOptions,\n                           editorObservable,\n                           finishedCreate: boolean) {\n    const update = {\n      id,\n      positions: this.getPositions(id),\n      editMode: EditModes.CREATE,\n      updatedPosition: position,\n      editAction: EditActions.ADD_LAST_POINT,\n    };\n    this.updateSubject.next(update);\n    clientEditSubject.next({\n      ...update,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n    });\n\n    const changeMode = {\n      id,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.CHANGE_TO_EDIT,\n    };\n    this.updateSubject.next(changeMode);\n    clientEditSubject.next(changeMode);\n    if (this.observablesMap.has(id)) {\n      this.observablesMap.get(id).forEach(registration => registration.dispose());\n    }\n    this.observablesMap.delete(id);\n    this.editPolyline(id, positions, eventPriority, clientEditSubject, polylineOptions, editorObservable);\n    finishedCreate = true;\n    return finishedCreate;\n  }\n\n  edit(positions: Cartesian3[], options = DEFAULT_POLYLINE_OPTIONS, priority = 100): PolylineEditorObservable {\n    if (positions.length < 2) {\n      throw new Error('Polylines editor error edit(): polyline should have at least 2 positions');\n    }\n    const id = generateKey();\n    const polylineOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<PolylineEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT\n    });\n    const update = {\n      id,\n      positions: positions,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      polylineOptions: polylineOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n    });\n    return this.editPolyline(\n      id,\n      positions,\n      priority,\n      editSubject,\n      polylineOptions\n    );\n  }\n\n  private editPolyline(id: string,\n                       positions: Cartesian3[],\n                       priority: number,\n                       editSubject: Subject<PolylineEditUpdate>,\n                       options: PolylineEditOptions,\n                       editObservable?: PolylineEditorObservable) {\n    this.clampPoints(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    const pointRemoveRegistration = this.mapEventsManager.register({\n      event: options.removePointEvent,\n      modifier: options.removePointModifier,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: options.dragShapeEvent,\n        entityType: EditPolyline,\n        pick: PickOptions.PICK_FIRST,\n        pickConfig: options.pickConfiguration,\n        priority,\n        pickFilter: entity => id === entity.editedEntityId,\n      });\n    }\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({ movement: { drop } }) => this.polylinesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n        .subscribe(({ movement: { startPosition, endPosition, drop }, entities }) => {\n          const endDragPosition = this.screenToPosition(endPosition, false, options.clampHeightTo3DOptions);\n          const startDragPosition = this.screenToPosition(startPosition, false, options.clampHeightTo3DOptions);\n          if (!endDragPosition) {\n            return;\n          }\n\n          const update = {\n            id,\n            positions: this.getPositions(id),\n            editMode: EditModes.EDIT,\n            updatedPosition: endDragPosition,\n            draggedPosition: startDragPosition,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n            positions: this.getPositions(id),\n            points: this.getPoints(id),\n          });\n        });\n    }\n\n    pointDragRegistration.pipe(\n      tap(({ movement: { drop } }) => this.polylinesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, drop }, entities }) => {\n        const position = this.screenToPosition(endPosition, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n        if (!position) {\n          return;\n        }\n        const point: EditPoint = entities[0];\n\n        const update = {\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.EDIT,\n          updatedPosition: position,\n          updatedPoint: point,\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n        });\n\n        this.clampPointsDebounced(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n      });\n\n    pointRemoveRegistration.subscribe(({ entities }) => {\n      const point: EditPoint = entities[0];\n      const allPositions = [...this.getPositions(id)];\n      if (allPositions.length < 3) {\n        return;\n      }\n      const index = allPositions.findIndex(position => point.getPosition().equals(position as Cartesian3));\n      if (index < 0) {\n        return;\n      }\n\n      const update = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.EDIT,\n        updatedPoint: point,\n        editAction: EditActions.REMOVE_POINT,\n      };\n      this.updateSubject.next(update);\n      editSubject.next({\n        ...update,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n      });\n\n      this.clampPoints(id, options.clampHeightTo3D, options.clampHeightTo3DOptions);\n    });\n\n    const observables = [pointDragRegistration, pointRemoveRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n    this.observablesMap.set(id, observables);\n    return this.createEditorObservable(editSubject, id);\n  }\n\n  private setOptions(options: PolylineEditOptions) {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_POLYLINE_OPTIONS));\n    const polylineOptions: PolylineEditOptions = Object.assign(defaultClone, options);\n    polylineOptions.pointProps = {...DEFAULT_POLYLINE_OPTIONS.pointProps, ...options.pointProps};\n    polylineOptions.polylineProps = {...DEFAULT_POLYLINE_OPTIONS.polylineProps, ...options.polylineProps};\n    polylineOptions.clampHeightTo3DOptions = {...DEFAULT_POLYLINE_OPTIONS.clampHeightTo3DOptions, ...options.clampHeightTo3DOptions};\n\n    if (options.clampHeightTo3D) {\n      if (!this.cesiumScene.pickPositionSupported || !this.cesiumScene.clampToHeightSupported) {\n        throw new Error(`Cesium pickPosition and clampToHeight must be supported to use clampHeightTo3D`);\n      }\n\n      if (this.cesiumScene.pickTranslucentDepth) {\n        console.warn(`Cesium scene.pickTranslucentDepth must be false in order to make the editors work properly on 3D`);\n      }\n\n      if (polylineOptions.pointProps.color.alpha === 1 || polylineOptions.pointProps.outlineColor.alpha === 1) {\n        console.warn('Point color and outline color must have alpha in order to make the editor work properly on 3D');\n      }\n\n      polylineOptions.allowDrag = false;\n      polylineOptions.polylineProps.clampToGround = true;\n      polylineOptions.pointProps.heightReference = polylineOptions.clampHeightTo3DOptions.clampToTerrain ?\n        Cesium.HeightReference.CLAMP_TO_GROUND : Cesium.HeightReference.RELATIVE_TO_GROUND;\n      polylineOptions.pointProps.disableDepthTestDistance = Number.POSITIVE_INFINITY;\n    }\n    return polylineOptions;\n  }\n\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: (position: Cartesian3) => boolean)\n                                                                                                      : PolylineEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n\n    observableToExtend.setManually = (points: {\n      position: Cartesian3,\n      pointProp?: PointProps\n    }[] | Cartesian3[], polylineProps?: PolylineProps) => {\n      const polyline = this.polylinesManager.get(id);\n      polyline.setManually(points, polylineProps);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Polylines editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation(null);\n    };\n\n    observableToExtend.getCurrentPoints = () => this.getPoints(id);\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.polylinesManager.get(id).labels;\n\n    return observableToExtend as PolylineEditorObservable;\n  }\n\n  private getPositions(id: string) {\n    const polyline = this.polylinesManager.get(id);\n    return polyline.getRealPositions();\n  }\n\n  private getPoints(id: string) {\n    const polyline = this.polylinesManager.get(id);\n    return polyline.getRealPoints();\n  }\n}\n","import { CoordinateConverter } from './../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { AcLayerComponent } from './../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { Injectable } from '@angular/core';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { PolygonEditOptions } from '../../../models/polygon-edit-options';\nimport { EditablePolyline } from '../../../models/editable-polyline';\n\n@Injectable()\nexport class PolylinesManagerService {\n  polylines: Map<string, EditablePolyline> = new Map<string, EditablePolyline>();\n\n  createEditablePolyline(id: string, editPolylinesLayer: AcLayerComponent, editPointsLayer: AcLayerComponent,\n                         coordinateConverter: CoordinateConverter, polylineOptions?: PolygonEditOptions, positions?: Cartesian3[]) {\n    const editablePolyline = new EditablePolyline(\n      id,\n      editPolylinesLayer,\n      editPointsLayer,\n      coordinateConverter,\n      polylineOptions,\n      positions);\n    this.polylines.set(id, editablePolyline\n    );\n  }\n\n  get(id: string): EditablePolyline {\n    return this.polylines.get(id);\n  }\n\n  clear() {\n    this.polylines.forEach(polyline => polyline.dispose());\n    this.polylines.clear();\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { CesiumService } from '../../../angular-cesium/services/cesium/cesium.service';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { PolylinesEditorService } from '../../services/entity-editors/polyline-editor/polylines-editor.service';\nimport { PolylinesManagerService } from '../../services/entity-editors/polyline-editor/polylines-manager.service';\nimport { PolylineEditUpdate } from '../../models/polyline-edit-update';\nimport { EditablePolyline } from '../../models/editable-polyline';\nimport { LabelProps } from '../../models/label-props';\n\n@Component({\n  selector: 'polylines-editor',\n  template: /*html*/ `\n    <ac-layer #editPolylinesLayer acFor=\"let polyline of editPolylines$\" [context]=\"this\">\n      <ac-polyline-desc\n        props=\"{\n        positions: polyline.getPositionsCallbackProperty(),\n        width: polyline.props.width,\n        material: polyline.props.material(),\n        clampToGround: polyline.props.clampToGround,\n        zIndex: polyline.props.zIndex,\n        classificationType: polyline.props.classificationType,\n      }\"\n      >\n      </ac-polyline-desc>\n    </ac-layer>\n\n    <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n      <ac-point-desc\n        props=\"{\n        position: point.getPositionCallbackProperty(),\n        pixelSize: getPointSize(point),\n        color: point.props.color,\n        outlineColor: point.props.outlineColor,\n        outlineWidth: point.props.outlineWidth,\n        show: getPointShow(point),\n        disableDepthTestDistance: point.props.disableDepthTestDistance,\n        heightReference: point.props.heightReference,\n    }\"\n      ></ac-point-desc>\n    </ac-layer>\n\n    <ac-layer #polylineLabelsLayer acFor=\"let polylineLabels of polylineLabels$\" [context]=\"this\">\n      <ac-array-desc acFor=\"let label of polylineLabels.labels\" [idGetter]=\"getLabelId\">\n        <ac-label-primitive-desc\n          props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n        >\n        </ac-label-primitive-desc>\n      </ac-array-desc>\n    </ac-layer>\n  `,\n  providers: [CoordinateConverter, PolylinesManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class PolylinesEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: PolylineEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editPolylines$ = new Subject<AcNotification>();\n  public polylineLabels$ = new Subject<AcNotification>();\n\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n  @ViewChild('editPolylinesLayer') private editPolylinesLayer: AcLayerComponent;\n  @ViewChild('polylineLabelsLayer') private polylineLabelsLayer: AcLayerComponent;\n\n  constructor(\n    private polylinesEditor: PolylinesEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private polylinesManager: PolylinesManagerService,\n    private cesiumService: CesiumService,\n  ) {\n    this.polylinesEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, polylinesManager, this.cesiumService);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.polylinesEditor.onUpdate().subscribe((update: PolylineEditUpdate) => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(polyline: EditablePolyline, update: PolylineEditUpdate, labels?: LabelProps[]) {\n    update.positions = polyline.getRealPositions();\n    update.points = polyline.getRealPoints();\n\n    if (labels) {\n      polyline.labels = labels;\n      this.polylineLabelsLayer.update(polyline, polyline.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    polyline.labels = this.editLabelsRenderFn(update, polyline.labels);\n    this.polylineLabelsLayer.update(polyline, polyline.getId());\n  }\n\n  removeEditLabels(polyline: EditablePolyline) {\n    polyline.labels = [];\n    this.polylineLabelsLayer.remove(polyline.getId());\n  }\n\n  handleCreateUpdates(update: PolylineEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.polylinesManager.createEditablePolyline(\n          update.id,\n          this.editPointsLayer,\n          this.editPolylinesLayer,\n          this.coordinateConverter,\n          update.polylineOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (update.updatedPosition) {\n          polyline.moveTempMovingPoint(update.updatedPosition);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (update.updatedPosition) {\n          polyline.moveTempMovingPoint(update.updatedPosition);\n          polyline.addPoint(update.updatedPosition);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (update.updatedPosition) {\n          polyline.addLastPoint(update.updatedPosition);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline) {\n          polyline.dispose();\n          this.removeEditLabels(polyline);\n          this.editLabelsRenderFn = undefined;\n        }\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const polyline = this.polylinesManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(polyline, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const polyline = this.polylinesManager.get(update.id);\n        this.renderEditLabels(polyline, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const polyline = this.polylinesManager.get(update.id);\n        this.renderEditLabels(polyline, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: PolylineEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.polylinesManager.createEditablePolyline(\n          update.id,\n          this.editPointsLayer,\n          this.editPolylinesLayer,\n          this.coordinateConverter,\n          update.polylineOptions,\n          update.positions,\n        );\n        break;\n      }\n      case EditActions.DRAG_POINT: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline && polyline.enableEdit) {\n          polyline.movePoint(update.updatedPosition, update.updatedPoint);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline && polyline.enableEdit) {\n          polyline.movePointFinish(update.updatedPoint);\n\n          if (update.updatedPoint.isVirtualEditPoint()) {\n            polyline.changeVirtualPointToRealPoint(update.updatedPoint);\n            this.renderEditLabels(polyline, update);\n          }\n        }\n        break;\n      }\n      case EditActions.REMOVE_POINT: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline && polyline.enableEdit) {\n          polyline.removePoint(update.updatedPoint);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline) {\n          polyline.enableEdit = false;\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline) {\n          polyline.enableEdit = true;\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline && polyline.enableEdit) {\n          polyline.moveShape(update.draggedPosition, update.updatedPosition);\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const polyline = this.polylinesManager.get(update.id);\n        if (polyline && polyline.enableEdit) {\n          polyline.endMoveShape();\n          this.renderEditLabels(polyline, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.polylinesManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { EditableHippodrome } from '../../../models/editable-hippodrome';\nimport { HippodromeEditOptions } from '../../../models/hippodrome-edit-options';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\n\n@Injectable()\nexport class HippodromeManagerService {\n  hippodromes: Map<string, EditableHippodrome> = new Map<string, EditableHippodrome>();\n\n  createEditableHippodrome(id: string, editHippodromeLayer: AcLayerComponent, editPointsLayer: AcLayerComponent,\n                           coordinateConverter: CoordinateConverter, hippodromeEditOptions?: HippodromeEditOptions,\n                           positions?: Cartesian3[]) {\n    const editableHippodrome = new EditableHippodrome(\n      id,\n      editHippodromeLayer,\n      editPointsLayer,\n      coordinateConverter,\n      hippodromeEditOptions,\n      positions);\n    this.hippodromes.set(id, editableHippodrome);\n  }\n\n  get(id: string): EditableHippodrome {\n    return this.hippodromes.get(id);\n  }\n\n  clear() {\n    this.hippodromes.forEach(hippodrome => hippodrome.dispose());\n    this.hippodromes.clear();\n  }\n}\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { HippodromeEditOptions } from '../../../models/hippodrome-edit-options';\nimport { HippodromeManagerService } from './hippodrome-manager.service';\nimport { HippodromeEditorObservable } from '../../../models/hippodrome-editor-oboservable';\nimport { HippodromeEditUpdate } from '../../../models/hippodrome-edit-update';\nimport { EditableHippodrome } from '../../../models/editable-hippodrome';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { LabelProps } from '../../../models/label-props';\nimport { generateKey } from '../../utils';\n\nexport const DEFAULT_HIPPODROME_OPTIONS: HippodromeEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  hippodromeProps: {\n    fill: true,\n    material: Cesium.Color.CORNFLOWERBLUE.withAlpha(0.4),\n    outline: true,\n    width: 200000.0,\n    outlineWidth: 1,\n    outlineColor: Cesium.Color.WHITE.withAlpha(0.8),\n    classificationType: Cesium.ClassificationType.BOTH,\n    zIndex: 0,\n    shadows: Cesium.ShadowMode.DISABLED,\n  },\n  pointProps: {\n    color: Cesium.Color.WHITE,\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.2),\n    outlineWidth: 1,\n    pixelSize: 13,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n};\n\n/**\n * Service for creating editable hippodromes\n *\n * You must provide `HippodromeEditorService` yourself.\n * HippodromeEditorService works together with `<hippodromes-editor>` component. Therefor you need to create `<hippodromes-editor>`\n * for each `PolylineEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `HippodromeEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `HippodromeEditorObservable`.\n * + To stop editing call `dsipose()` from the `HippodromeEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `HippodromeEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n *\n * usage:\n * ```typescript\n *  // Start creating hippodrome\n *  const editing$ = hippodromeEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit hippodromes from existing hippodromes cartesian3 positions\n *  const editing$ = this.hippodromeEditor.edit(initialPos);\n *\n * ```\n */\n@Injectable()\nexport class HippodromeEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<HippodromeEditUpdate>();\n  private updatePublisher = publish<HippodromeEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private hippodromeManager: HippodromeManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n\n  init(mapEventsManager: MapEventsManagerService,\n       coordinateConverter: CoordinateConverter,\n       cameraService: CameraService,\n       managerService: HippodromeManagerService) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.hippodromeManager = managerService;\n    this.updatePublisher.connect();\n  }\n\n  onUpdate(): Observable<HippodromeEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  create(options = DEFAULT_HIPPODROME_OPTIONS, eventPriority = 100): HippodromeEditorObservable {\n    const positions: Cartesian3[] = [];\n    const id = generateKey();\n    const hippodromeOptions = this.setOptions(options);\n\n    const clientEditSubject = new BehaviorSubject<HippodromeEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      positions,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      hippodromeOptions: hippodromeOptions,\n    });\n\n    const finishCreation = () => {\n      const changeMode = {\n        id,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.CHANGE_TO_EDIT,\n      };\n      this.updateSubject.next(changeMode);\n      clientEditSubject.next(changeMode);\n      if (this.observablesMap.has(id)) {\n        this.observablesMap.get(id).forEach(registration => registration.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.editHippodrome(id, eventPriority, clientEditSubject, hippodromeOptions, editorObservable);\n      finishedCreate = true;\n      return finishedCreate;\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pickConfig: options.pickConfiguration,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: hippodromeOptions.addPointEvent,\n      pickConfig: options.pickConfiguration,\n      pick: PickOptions.NO_PICK,\n      priority: eventPriority,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    mouseMoveRegistration.subscribe(({movement: {endPosition}}) => {\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n\n      if (position) {\n        this.updateSubject.next({\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.MOUSE_MOVE,\n        });\n      }\n    });\n\n    addPointRegistration.subscribe(({movement: {endPosition}}) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n      if (!position) {\n        return;\n      }\n\n      const allPositions = this.getPositions(id);\n      const isFirstPoint = this.getPositions(id).length === 0;\n\n      const updateValue = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.CREATE,\n        updatedPosition: position,\n        editAction: EditActions.ADD_POINT,\n      };\n      this.updateSubject.next(updateValue);\n      clientEditSubject.next({\n        ...updateValue,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n        width: this.getWidth(id),\n      });\n\n      if (!isFirstPoint) {\n        finishedCreate = finishCreation();\n      }\n    });\n\n    return editorObservable;\n  }\n\n  edit(positions: Cartesian3[], options = DEFAULT_HIPPODROME_OPTIONS, priority = 100): HippodromeEditorObservable {\n    if (positions.length !== 2) {\n      throw new Error('Hippodrome editor error edit(): polygon should have 2 positions but received ' + positions);\n    }\n    const id = generateKey();\n    const hippodromeEditOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<HippodromeEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT\n    });\n    const update = {\n      id,\n      positions: positions,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      hippodromeOptions: hippodromeEditOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n      width: this.getWidth(id),\n    });\n    return this.editHippodrome(\n      id,\n      priority,\n      editSubject,\n      hippodromeEditOptions\n    );\n  }\n\n  private editHippodrome(id: string,\n                         priority: number,\n                         editSubject: Subject<HippodromeEditUpdate>,\n                         options: HippodromeEditOptions,\n                         editObservable?: HippodromeEditorObservable): HippodromeEditorObservable {\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: options.dragShapeEvent,\n        entityType: EditableHippodrome,\n        pick: PickOptions.PICK_FIRST,\n        pickConfig: options.pickConfiguration,\n        priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    pointDragRegistration.pipe(\n      tap(({movement: {drop}}) => this.hippodromeManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n      .subscribe(({movement: {endPosition, drop}, entities}) => {\n        const position = this.coordinateConverter.screenToCartesian3(endPosition);\n        if (!position) {\n          return;\n        }\n        const point: EditPoint = entities[0];\n\n        const update = {\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.EDIT,\n          updatedPosition: position,\n          updatedPoint: point,\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n          width: this.getWidth(id),\n        });\n      });\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({movement: {drop}}) => this.hippodromeManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n        .subscribe(({movement: {startPosition, endPosition, drop}, entities}) => {\n          const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n          const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n          if (!endDragPosition) {\n            return;\n          }\n\n          const update = {\n            id,\n            positions: this.getPositions(id),\n            editMode: EditModes.EDIT,\n            updatedPosition: endDragPosition,\n            draggedPosition: startDragPosition,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n            positions: this.getPositions(id),\n            points: this.getPoints(id),\n            width: this.getWidth(id),\n          });\n        });\n    }\n\n    const observables = [pointDragRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n\n    this.observablesMap.set(id, observables);\n    return this.createEditorObservable(editSubject, id);\n  }\n\n  private setOptions(options: HippodromeEditOptions): HippodromeEditOptions {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_HIPPODROME_OPTIONS));\n    const hippodromeOptions = Object.assign(defaultClone, options);\n    hippodromeOptions.hippodromeProps = Object.assign({}, DEFAULT_HIPPODROME_OPTIONS.hippodromeProps, options.hippodromeProps);\n    hippodromeOptions.pointProps = Object.assign({}, DEFAULT_HIPPODROME_OPTIONS.pointProps, options.pointProps);\n    return hippodromeOptions;\n  }\n\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: () => boolean): HippodromeEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n\n    observableToExtend.setManually = (firstPosition: Cartesian3,\n                                      secondPosition: Cartesian3,\n                                      widthMeters: number,\n                                      firstPointProp?: PointProps,\n                                      secondPointProp?: PointProps) => {\n      const firstP = new EditPoint(id, firstPosition, firstPointProp ? firstPointProp : DEFAULT_HIPPODROME_OPTIONS.pointProps);\n      const secP = new EditPoint(id, secondPosition, secondPointProp ? secondPointProp : DEFAULT_HIPPODROME_OPTIONS.pointProps);\n\n      const hippodrome = this.hippodromeManager.get(id);\n      hippodrome.setPointsManually([firstP, secP], widthMeters);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Hippodrome editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation();\n    };\n\n    observableToExtend.getCurrentPoints = () => this.getPoints(id);\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n    observableToExtend.getLabels = (): LabelProps[] => this.hippodromeManager.get(id).labels;\n    observableToExtend.getCurrentWidth = (): number => this.getWidth(id);\n\n    return observableToExtend as HippodromeEditorObservable;\n  }\n\n  private getPositions(id: any) {\n    const hippodrome = this.hippodromeManager.get(id);\n    return hippodrome.getRealPositions();\n  }\n\n  private getPoints(id: any) {\n    const hippodrome = this.hippodromeManager.get(id);\n    return hippodrome.getRealPoints();\n  }\n\n  private getWidth(id: string) {\n    const hippodrome = this.hippodromeManager.get(id);\n    return hippodrome.getWidth();\n  }\n}\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { HippodromeManagerService } from '../../services/entity-editors/hippodrome-editor/hippodrome-manager.service';\nimport { HippodromeEditorService } from '../../services/entity-editors/hippodrome-editor/hippodrome-editor.service';\nimport { HippodromeEditUpdate } from '../../models/hippodrome-edit-update';\nimport { LabelProps } from '../../models/label-props';\nimport { EditableHippodrome } from '../../models/editable-hippodrome';\n\n@Component({\n  selector: 'hippodrome-editor',\n  template: /*html*/ `\n      <ac-layer #editHippodromesLayer acFor=\"let hippodrome of editHippodromes$\" [context]=\"this\">\n          <ac-corridor-desc props=\"{\n            positions: hippodrome.getRealPositionsCallbackProperty(),\n            cornerType: Cesium.CornerType.ROUNDED,\n            material: hippodrome.hippodromeProps.material,\n            width : hippodrome.hippodromeProps.width,\n            outline: hippodrome.hippodromeProps.outline,\n            outlineColor: hippodrome.hippodromeProps.outlineColor,\n            outlineWidth: hippodrome.hippodromeProps.outlineWidth,\n            height: 0,\n            classificationType: hippodrome.hippodromeProps.classificationType,\n            zIndex: hippodrome.hippodromeProps.zIndex,\n            shadows: hippodrome.hippodromeProps.shadows,\n    }\">\n          </ac-corridor-desc>\n\n          <ac-array-desc acFor=\"let label of hippodrome.labels\" [idGetter]=\"getLabelId\">\n              <ac-label-primitive-desc props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\">\n              </ac-label-primitive-desc>\n          </ac-array-desc>\n      </ac-layer>\n\n      <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n          <ac-point-desc props=\"{\n         position: point.getPositionCallbackProperty(),\n         pixelSize: getPointSize(point),\n         color: point.props.color,\n         outlineColor: point.props.outlineColor,\n         outlineWidth: point.props.outlineWidth,\n         show: getPointShow(point),\n         disableDepthTestDistance: point.props.disableDepthTestDistance,\n         heightReference: point.props.heightReference,\n    }\">\n          </ac-point-desc>\n      </ac-layer>\n  `,\n  providers: [CoordinateConverter, HippodromeManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class HippodromeEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: HippodromeEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editHippodromes$ = new Subject<AcNotification>();\n\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n  @ViewChild('editHippodromesLayer') private editHippodromesLayer: AcLayerComponent;\n\n  constructor(\n    private hippodromesEditor: HippodromeEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private hippodromesManager: HippodromeManagerService,\n  ) {\n    this.hippodromesEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, hippodromesManager);\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.hippodromesEditor.onUpdate().subscribe((update: HippodromeEditUpdate) => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(hippodrome: EditableHippodrome, update: HippodromeEditUpdate, labels?: LabelProps[]) {\n    update.positions = hippodrome.getRealPositions();\n    update.points = hippodrome.getRealPoints();\n\n    if (labels) {\n      hippodrome.labels = labels;\n      this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    hippodrome.labels = this.editLabelsRenderFn(update, hippodrome.labels);\n    this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\n  }\n\n  removeEditLabels(hippodrome: EditableHippodrome) {\n    hippodrome.labels = [];\n    this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\n  }\n\n  handleCreateUpdates(update: HippodromeEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.hippodromesManager.createEditableHippodrome(\n          update.id,\n          this.editPointsLayer,\n          this.editHippodromesLayer,\n          this.coordinateConverter,\n          update.hippodromeOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (update.updatedPosition) {\n          hippodrome.moveTempMovingPoint(update.updatedPosition);\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (update.updatedPosition) {\n          hippodrome.moveTempMovingPoint(update.updatedPosition);\n          hippodrome.addPoint(update.updatedPosition);\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome) {\n          hippodrome.dispose();\n          this.removeEditLabels(hippodrome);\n        }\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(hippodrome, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        this.renderEditLabels(hippodrome, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        this.renderEditLabels(hippodrome, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: HippodromeEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.hippodromesManager.createEditableHippodrome(\n          update.id,\n          this.editPointsLayer,\n          this.editHippodromesLayer,\n          this.coordinateConverter,\n          update.hippodromeOptions,\n          update.positions,\n        );\n        break;\n      }\n      case EditActions.DRAG_POINT: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome && hippodrome.enableEdit) {\n          hippodrome.movePoint(update.updatedPosition, update.updatedPoint);\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome && hippodrome.enableEdit) {\n          hippodrome.endMovePoint();\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome) {\n          hippodrome.enableEdit = false;\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome) {\n          hippodrome.enableEdit = true;\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome && hippodrome.enableEdit) {\n          hippodrome.moveShape(update.draggedPosition, update.updatedPosition);\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const hippodrome = this.hippodromesManager.get(update.id);\n        if (hippodrome && hippodrome.enableEdit) {\n          hippodrome.endMoveShape();\n          this.renderEditLabels(hippodrome, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.hippodromesManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n","import { fromEvent as observableFromEvent, Observable, Subject } from 'rxjs';\n\nimport { map, merge, takeUntil, tap } from 'rxjs/operators';\nimport { Inject, Injectable } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { Vec2 } from '../../angular-cesium/models/vec2';\nimport { Cartesian3 } from '../../angular-cesium/models/cartesian3';\nimport { CoordinateConverter } from '../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapsManagerService } from '../../angular-cesium/services/maps-manager/maps-manager.service';\n\nexport interface IconDragEvent {\n  initialScreenPosition: Vec2;\n  screenPosition: Vec2;\n  mapPosition: Cartesian3;\n  drop: boolean;\n}\n\n/**\n * The Service is used to preform, handle and subscribe to icon dragging when using the `DraggableToMapDirective`.\n * For more info check `DraggableToMapDirective` docs.\n */\n\n@Injectable()\nexport class DraggableToMapService {\n\n  private coordinateConverter: CoordinateConverter;\n  private dragObservable: Observable<IconDragEvent>;\n  private stopper: Subject<any>;\n  private mainSubject = new Subject<IconDragEvent>();\n\n  constructor(@Inject(DOCUMENT) private document: any, private mapsManager: MapsManagerService) {\n  }\n\n  setCoordinateConverter(coordinateConverter: CoordinateConverter) {\n    this.coordinateConverter = coordinateConverter;\n  }\n\n  drag(imageSrc: string, style?: any) {\n    if (!this.coordinateConverter) {\n      const mapComponent = this.mapsManager.getMap();\n      if (mapComponent) {\n        this.coordinateConverter = mapComponent.getCoordinateConverter();\n      }\n    }\n    this.cancel();\n    const imgElement = document.createElement('img');\n    imgElement.src = imageSrc;\n    imgElement.style.position = 'fixed';\n    imgElement.style.visibility = 'hidden';\n    imgElement.style.width = '30px';\n    imgElement.style.height = '30px';\n    imgElement.style['user-drag'] = 'none';\n    imgElement.style['user-select'] = 'none';\n    imgElement.style['-moz-user-select'] = 'none';\n    imgElement.style['-webkit-user-drag'] = 'none';\n    imgElement.style['-webkit-user-select'] = 'none';\n    imgElement.style['-ms-user-select'] = 'none';\n    Object.assign(imgElement.style, style);\n    document.body.appendChild(imgElement);\n\n    this.createDragObservable();\n    this.dragObservable.subscribe(\n      (e) => {\n        imgElement.style.visibility = 'visible';\n        imgElement.style.left = e.screenPosition.x - imgElement.clientWidth / 2 + 'px';\n        imgElement.style.top = e.screenPosition.y - imgElement.clientHeight / 2 + 'px';\n        this.mainSubject.next(e);\n        if (e.drop) {\n          imgElement.remove();\n        }\n      },\n      (e: any) => {\n        imgElement.remove();\n      },\n      () => {\n        imgElement.remove();\n      }\n    );\n  }\n\n  dragUpdates(): Observable<IconDragEvent> {\n    return this.mainSubject;\n  }\n\n  cancel() {\n    if (this.stopper) {\n      this.stopper.next(true);\n      this.stopper = undefined;\n      this.dragObservable = undefined;\n    }\n  }\n\n  private createDragObservable() {\n    const stopper = new Subject();\n    const dropSubject = new Subject<any>();\n    const pointerUp = observableFromEvent(document, 'pointerup');\n    const pointerMove = observableFromEvent(document, 'pointermove');\n\n    let dragStartPositionX: number;\n    let dragStartPositionY: number;\n    let lastMove: any;\n    const moveObservable = pointerMove.pipe(map((e: any) => {\n        dragStartPositionX = dragStartPositionX ? dragStartPositionX : e.x;\n        dragStartPositionY = dragStartPositionY ? dragStartPositionY : e.y;\n        lastMove = {\n          drop: false,\n          initialScreenPosition: {\n            x: dragStartPositionX,\n            y: dragStartPositionY,\n          },\n          screenPosition: {\n            x: e.x,\n            y: e.y,\n          },\n          mapPosition: this.coordinateConverter ?\n            this.coordinateConverter.screenToCartesian3({x: e.x, y: e.y}) : undefined,\n        };\n        return lastMove;\n      }),\n      takeUntil(pointerUp),\n      tap(undefined, undefined, () => {\n        if (lastMove) {\n          const dropEvent = Object.assign({}, lastMove);\n          dropEvent.drop = true;\n          dropSubject.next(dropEvent);\n        }\n      }), );\n\n    this.dragObservable = moveObservable.pipe(merge(dropSubject), takeUntil(stopper), );\n    this.stopper = stopper;\n  }\n}\n","import { Directive, ElementRef, HostListener, Input, OnInit } from '@angular/core';\nimport { DraggableToMapService } from '../services/draggable-to-map.service';\n\n/**\n * This directive is used to allow dragging of icons from outside the map over the map\n * while being notified of the dragging position and drop position with an observable exposed from `DraggableToMapService`.\n * @Input {src: string, style?: any} | string -\n * the [src: string | string] should be the image src of the dragged image.\n * The style is an optional style object for the image.\n *\n * example:\n * ```\n * <a href=\"...\" class=\"...\" [draggableToMap]=\"{src: '../assets/GitHub-Mark-Light.png', style: {width: '50px', height: '50px'}}\">\n *     <img class=\"github\" src=\"../assets/GitHub-Mark-Light.png\">\n * </a>\n * ```\n *\n * In order the get notified of the dragging location  and drop state subscribe to `DraggableToMapService.dragUpdates()`\n * ```\n *  this.iconDragService.dragUpdates().subscribe(e => console.log(e));\n * ```\n *\n * In order the cancel dragging use `DraggableToMapService.cancel()`\n * ```\n *  this.iconDragService.cancel();\n * ```\n */\n\n@Directive({selector: '[draggableToMap]'})\nexport class DraggableToMapDirective implements OnInit {\n  @Input() draggableToMap: { src: string, style?: any } | string;\n  private src: string;\n  private style: any;\n\n  constructor(el: ElementRef, private iconDragService: DraggableToMapService) {\n    el.nativeElement.style['user-drag'] = 'none';\n    el.nativeElement.style['user-select'] = 'none';\n    el.nativeElement.style['-moz-user-select'] = 'none';\n    el.nativeElement.style['-webkit-user-drag'] = 'none';\n    el.nativeElement.style['-webkit-user-select'] = 'none';\n    el.nativeElement.style['-ms-user-select'] = 'none';\n  }\n\n  ngOnInit(): void {\n    if (typeof this.draggableToMap === 'string') {\n      this.src = this.draggableToMap;\n    } else {\n      this.src = this.draggableToMap.src;\n      this.style = this.draggableToMap.style;\n    }\n  }\n\n  @HostListener('mousedown')\n  onMouseDown() {\n    this.iconDragService.drag(this.src, this.style);\n  }\n}\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Input,\n  OnDestroy,\n  OnInit,\n  OnChanges,\n  SimpleChanges,\n  Output,\n  EventEmitter\n} from '@angular/core';\nimport { fromEvent as observableFromEvent, Subscription, Observable } from 'rxjs';\nimport { switchMap, takeUntil, tap } from 'rxjs/operators';\nimport { CesiumService } from '../../../../angular-cesium/services/cesium/cesium.service';\n\n\n/**\n * Toolbar widget, act as a container for ac-toolbar-button components\n * allowing drag configuration and passing `toolbarClass` as attributes\n *\n * Usage:\n * ```\n * <ac-toolbar [allowDrag]=\"true\" (onDrag)=\"handleDrag($event)\">\n <ac-toolbar-button [iconUrl]=\"'assets/home-icon.svg'\" (onClick)=\"goHome()\">\n </ac-toolbar-button>\n <ac-toolbar-button [iconUrl]=\"'assets/explore-icon.svg'\" (onClick)=\"rangeAndBearing()\">\n </ac-toolbar-button>\n </ac-toolbar>\n * ```\n *\n */\n@Component(\n  {\n    selector: 'ac-toolbar',\n    template: `\n        <div class=\"{{toolbarClass}}\">\n            <div *ngIf=\"allowDrag\">\n                <ac-toolbar-button>\n                    <ac-drag-icon></ac-drag-icon>\n                </ac-toolbar-button>\n            </div>\n\n            <ng-content></ng-content>\n        </div>\n    `,\n    styles: [`\n        :host {\n            position: absolute;\n            top: 20px;\n            left: 20px;\n            width: 20px;\n            height: 20px;\n            z-index: 999;\n            -webkit-user-drag: none;\n        }\n    `],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n  }\n)\nexport class AcToolbarComponent implements OnInit, OnChanges, OnDestroy {\n  @Input()\n  toolbarClass: string;\n  @Input()\n  allowDrag = true;\n  @Output()\n  onDrag = new EventEmitter<MouseEvent>();\n\n  dragStyle = {\n    'height.px': 20,\n    'width.px': 20,\n  };\n\n  private mouseDown$: Observable<MouseEvent>;\n  private mouseMove$: Observable<MouseEvent>;\n  private mouseUp$: Observable<MouseEvent>;\n  private drag$: Observable<MouseEvent>;\n  private dragSubscription: Subscription;\n\n  constructor(private element: ElementRef, private cesiumService: CesiumService) {}\n\n  ngOnInit() {\n    this.cesiumService.getMap().getMapContainer().appendChild(this.element.nativeElement);\n    if (this.allowDrag) {\n      this.listenForDragging();\n    }\n  }\n\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.allowDrag && changes.allowDrag.currentValue && !changes.allowDrag.previousValue) {\n      this.listenForDragging();\n    }\n\n    if (changes.allowDrag && !changes.allowDrag.currentValue && changes.allowDrag.previousValue) {\n      this.dragSubscription.unsubscribe();\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.dragSubscription) {\n      this.dragSubscription.unsubscribe();\n    }\n  }\n\n  private listenForDragging() {\n    this.mouseDown$ = this.mouseDown$ || observableFromEvent(this.element.nativeElement, 'mousedown');\n    this.mouseMove$ = this.mouseMove$ || observableFromEvent(document, 'mousemove') as Observable<MouseEvent>;\n    this.mouseUp$ = this.mouseUp$ || observableFromEvent(document, 'mouseup') as Observable<MouseEvent>;\n\n    this.drag$ = this.drag$ ||\n                 this.mouseDown$.pipe(\n                    switchMap(() => this.mouseMove$.pipe(\n                      tap(this.onDrag.emit),\n                      takeUntil(this.mouseUp$)\n                    ))\n                 );\n\n    this.dragSubscription = this.drag$.subscribe((event: MouseEvent) => {\n      this.element.nativeElement.style.left = `${event.x}px`;\n      this.element.nativeElement.style.top = `${event.y}px`;\n    });\n  }\n}\n","import { Component } from '@angular/core';\n\n@Component(\n  {\n    selector: 'ac-drag-icon',\n    template: `\n        <svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\"  x=\"0px\" y=\"0px\"  height=\"25\"  width=\"25\"\n\t viewBox=\"0 0 476.737 476.737\" style=\"enable-background:new 0 0 476.737 476.737;\" xml:space=\"preserve\">\n<g>\n\t<g>\n\t\t<path style=\"fill:#010002;\" d=\"M475.498,232.298l-3.401-5.149l-63.565-63.565c-6.198-6.198-16.304-6.198-22.47,0\n\t\t\tc-6.198,6.198-6.198,16.273,0,22.47l36.423,36.423H254.26V54.253l36.423,36.423c6.166,6.198,16.273,6.198,22.47,0\n\t\t\tc6.166-6.198,6.166-16.273,0-22.47L249.588,4.64l-0.159-0.095l-4.99-3.305L238.369,0h-0.064l-6.007,1.24l-4.99,3.305l-0.191,0.095\n\t\t\tl-63.565,63.565c-6.198,6.198-6.198,16.273,0,22.47s16.273,6.198,22.47,0l36.455-36.423v168.225H54.253l36.423-36.423\n\t\t\tc6.198-6.198,6.198-16.273,0-22.47s-16.273-6.198-22.47,0L4.64,227.149l-0.095,0.159l-3.305,4.99L0,238.369v0.064l1.24,6.007\n\t\t\tl3.305,4.958l0.095,0.191l63.565,63.565c6.198,6.198,16.273,6.198,22.47,0c6.198-6.166,6.198-16.273,0-22.47L54.253,254.26\n\t\t\th168.225v168.225l-36.423-36.423c-6.198-6.166-16.273-6.166-22.47,0c-6.198,6.198-6.198,16.304,0,22.47l63.565,63.565l5.149,3.432\n\t\t\tl6.007,1.208h0.064l6.07-1.24l5.149-3.401l63.565-63.565c6.166-6.198,6.166-16.304,0-22.47c-6.198-6.198-16.304-6.198-22.47,0\n\t\t\tl-36.423,36.423V254.26h168.225l-36.423,36.423c-6.166,6.166-6.166,16.273,0,22.47c6.198,6.166,16.304,6.166,22.47,0\n\t\t\tl63.565-63.565l3.432-5.149l1.208-6.007v-0.064L475.498,232.298z\"/>\n\t</g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n<g>\n</g>\n</svg>\n    `,\n  }\n)\nexport class DragIconComponent {\n  constructor() {\n  }\n}\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n\n/**\n * Toolbar button widget, act as a single button inside ac-toolbar component\n * Can accepts content components or passing [iconUrl]\n * configure with: `[iconUrl]`,`[buttonClass]`,`[iconClass]`,`(onClick)`\n *\n * Usage:\n * ```\n * <ac-toolbar [allowDrag]=\"true\">\n <ac-toolbar-button [iconUrl]=\"'assets/home-icon.svg'\" (onClick)=\"goHome()\">\n </ac-toolbar-button>\n <ac-toolbar-button [iconUrl]=\"'assets/explore-icon.svg'\" (onClick)=\"rangeAndBearing()\">\n </ac-toolbar-button>\n </ac-toolbar>\n * ```\n *\n */\n@Component(\n  {\n    selector: 'ac-toolbar-button',\n    template: `\n        <div (click)=\"onClick.emit()\" class=\"button-container {{buttonClass}}\">\n            <img *ngIf=\"iconUrl\" [src]=\"iconUrl\" class=\"icon {{iconClass}}\"/>\n            <ng-content></ng-content>\n        </div>\n    `,\n    styles: [`\n        .button-container {\n            border-radius: 1px;\n            background-color: rgba(255, 255, 255, 0.8);\n            height: 30px;\n            width: 30px;\n            padding: 5px;\n            transition: all 0.2s;\n            cursor: pointer;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex-direction: column;\n        }\n\n        .button-container:hover {\n            background-color: rgba(255, 255, 255, 0.95);\n        }\n\n        .icon {\n            height: 30px;\n            width: 30px;\n        }\n    `],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n  }\n)\nexport class AcToolbarButtonComponent implements OnInit {\n\n  @Input()\n  iconUrl: string;\n\n  @Input()\n  buttonClass: string;\n\n  @Input()\n  iconClass: string;\n\n  @Output()\n  onClick = new EventEmitter();\n\n  constructor() {\n  }\n\n  ngOnInit() {\n\n  }\n}\n","import { ChangeDetectionStrategy, Component, Input } from '@angular/core';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { PolylineEditorObservable } from '../../models/polyline-editor-observable';\nimport { PolylineEditOptions } from '../../models/polyline-edit-options';\nimport { LabelProps, LabelStyle } from '../../models/label-props';\nimport { PolylineEditUpdate } from '../../models/polyline-edit-update';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { PolylinesEditorService } from '../../services/entity-editors/polyline-editor/polylines-editor.service';\n\n/**\n *\n * Range and bearing component that is used to draw range and bearing on the map.\n * The inputs are used to customize the range and bearing style and behavior.\n * Create component reference and use the `create()` function to start creating R&B on the map.\n * The function receives an optional RangeAndBearingOptions object that defines the created range and bearing style and behavior\n * (on top of the default and global definitions).\n *\n * Usage:\n *\n * my-component.ts:\n *\n * ```\n * \\@ViewChild('rangeAndBearing', {static: false}) private rangeAndBearing: RangeAndBearingComponent; // Get R&B reference\n *  // ...\n * this.rangeAndBearing.create({style: { pointProps: { pixelSize: 12 } }, bearingLabelsStyle: { fillColor: Cesium.Color.GREEN } });\n * ```\n *\n * my-component.html\n * ```\n * <range-and-bearing #rangeAndBearing></range-and-bearing> // Optional inputs defines global style and behavior.\n * ```\n *\n */\n@Component({\n  selector: 'range-and-bearing',\n  template: `\n    <polylines-editor></polylines-editor>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [PolylinesEditorService],\n})\nexport class RangeAndBearingComponent {\n  @Input() lineEditOptions?: PolylineEditOptions = {};\n  @Input() labelsStyle?: LabelStyle = {};\n  @Input() distanceLabelsStyle?: LabelStyle = {};\n  @Input() bearingLabelsStyle?: LabelStyle = {};\n  @Input() bearingStringFn?: (value: number) => string;\n  @Input() distanceStringFn?: (value: number) => string;\n  @Input() labelsRenderFn?: (update: PolylineEditUpdate, labels: LabelProps[]) => LabelProps[];\n\n  constructor(private polylineEditor: PolylinesEditorService, private coordinateConverter: CoordinateConverter) {\n  }\n\n  create(\n    {\n      lineEditOptions = {},\n      labelsStyle = {},\n      distanceLabelsStyle = {},\n      bearingLabelsStyle = {},\n      bearingStringFn,\n      distanceStringFn,\n      labelsRenderFn,\n    }: RangeAndBearingOptions = {lineEditOptions: {}, labelsStyle: {}, distanceLabelsStyle: {}, bearingLabelsStyle: {}},\n  ): PolylineEditorObservable {\n    const rnb = this.polylineEditor.create({\n      allowDrag: false,\n      pointProps: {\n        showVirtual: false,\n        pixelSize: 8,\n      },\n      polylineProps: {\n        width: 2,\n      },\n      ...this.lineEditOptions,\n      ...lineEditOptions,\n    });\n\n    if (labelsRenderFn) {\n      rnb.setLabelsRenderFn(labelsRenderFn);\n    } else if (this.labelsRenderFn) {\n      rnb.setLabelsRenderFn(this.labelsRenderFn);\n    } else {\n      rnb.setLabelsRenderFn(update => {\n        const positions = update.positions;\n        let totalDistance = 0;\n        if (!positions || positions.length === 0) {\n          return [];\n        }\n        return (update.editMode === EditModes.CREATE && update.editAction !== EditActions.ADD_LAST_POINT\n            ? [...positions, update.updatedPosition]\n            : positions\n        ).reduce(\n          (labels, position, index, array) => {\n            if (index !== 0) {\n              const previousPosition = array[index - 1];\n              const bearing = this.coordinateConverter.bearingToCartesian(previousPosition, position);\n              const distance = Cesium.Cartesian3.distance(previousPosition, position) / 1000;\n              labels.push(\n                {\n                  text:\n                    (bearingStringFn && bearingStringFn(bearing)) ||\n                    (this.bearingStringFn && this.bearingStringFn(bearing)) ||\n                    `${bearing.toFixed(2)}Â°`,\n                  scale: 0.2,\n                  font: '80px Helvetica',\n                  pixelOffset: new Cesium.Cartesian2(-20, -8),\n                  position: new Cesium.Cartesian3(\n                    (position.x + previousPosition.x) / 2,\n                    (position.y + previousPosition.y) / 2,\n                    (position.z + previousPosition.z) / 2,\n                  ),\n                  fillColor: Cesium.Color.WHITE,\n                  outlineColor: Cesium.Color.WHITE,\n                  showBackground: true,\n                  ...(this.labelsStyle as any),\n                  ...(labelsStyle as any),\n                  ...(this.bearingLabelsStyle as any),\n                  ...(bearingLabelsStyle as any),\n                },\n                {\n                  text:\n                    (distanceStringFn && distanceStringFn(totalDistance + distance)) ||\n                    (this.distanceStringFn && this.distanceStringFn(totalDistance + distance)) ||\n                    `${(totalDistance + distance).toFixed(2)} Km`,\n                  scale: 0.2,\n                  font: '80px Helvetica',\n                  pixelOffset: new Cesium.Cartesian2(-35, -8),\n                  position: position,\n                  fillColor: Cesium.Color.WHITE,\n                  outlineColor: Cesium.Color.WHITE,\n                  showBackground: true,\n                  ...(this.labelsStyle as any),\n                  ...(labelsStyle as any),\n                  ...(this.distanceLabelsStyle as any),\n                  ...(distanceLabelsStyle as any),\n                },\n              );\n\n              totalDistance += distance;\n            }\n\n            return labels;\n          },\n          [\n            {\n              text: (distanceStringFn && distanceStringFn(0)) || (this.distanceStringFn && this.distanceStringFn(0)) || `0 Km`,\n              scale: 0.2,\n              font: '80px Helvetica',\n              pixelOffset: new Cesium.Cartesian2(-20, -8),\n              position: positions[0],\n              fillColor: Cesium.Color.WHITE,\n              outlineColor: Cesium.Color.WHITE,\n              showBackground: true,\n              ...(this.labelsStyle as any),\n              ...(labelsStyle as any),\n              ...(this.distanceLabelsStyle as any),\n              ...(distanceLabelsStyle as any),\n            },\n          ],\n        );\n      });\n    }\n\n    return rnb;\n  }\n}\n\nexport interface RangeAndBearingOptions {\n  lineEditOptions?: PolylineEditOptions;\n  labelsStyle?: LabelStyle;\n  distanceLabelsStyle?: LabelStyle;\n  bearingLabelsStyle?: LabelStyle;\n  bearingStringFn?: (value: number) => string;\n  distanceStringFn?: (value: number) => string;\n  labelsRenderFn?: (update: PolylineEditUpdate, labels: LabelProps[]) => LabelProps[];\n}\n","import { Injectable, Optional } from '@angular/core';\nimport { MapsManagerService } from '../../angular-cesium/services/maps-manager/maps-manager.service';\nimport { CameraService } from '../../angular-cesium/services/camera/camera.service';\nimport { CesiumService } from '../../angular-cesium/services/cesium/cesium.service';\nimport { AcMapComponent } from '../../angular-cesium/components/ac-map/ac-map.component';\n\ninterface ZoomData {\n  container: HTMLElement;\n  borderElement?: HTMLElement;\n  resetOnEscapePressFunc?: EventListenerOrEventListenerObject;\n}\n\n/**\n * The Service is as a \"zoom to rectangle\" tool\n *\n * example:\n * ```\n * constructor(\n *   private cameraService: CameraService,\n *   private cesiumService: CesiumService,\n *   private zoomToRectangleService: ZoomToRectangleService,\n * ) {\n *   this.zoomToRectangleService.init(cesiumService, cameraService);\n * }\n * ...\n * this.zoomToRectangleService.activate({onComplete: () => this.zoomToRectangleService.disable()});\n * ```\n *\n * `init()` - initialize the service with CameraService and CesiumService.\n * If no mapId is provided to activate() - must be called before calling `activate()`.\n *\n * `disable()` - disables the tool.\n *\n * `activate()` -\n * @param options\n * {\n *  onStart - optional - a callback that will be called when the user start drawing the rectangle\n *  onComplete - optional - a callback that will be called when the tool zoom in\n *  autoDisableOnZoom - optional - determines if the tool should auto disable after zoom - default: true\n *  animationDurationInSeconds - optional - zoom animation duration in seconds - default: 0.5\n *  borderStyle - optional - the style of the rectangle element border - default: '3px dashed #FFFFFF'\n *  backgroundColor - optional - the background color of the rectangle element - default: 'transparent'\n *  resetKeyCode - optional - the key code of the key that is used to reset the drawing of the rectangle - default: 27 (ESC key)\n *  threshold - optional - the minimum area of the screen rectangle (in pixels) that is required to perform zoom - default: 9\n *  keepRotation - optional - whether or not to keep the rotation when zooming in - default: true\n *  mouseButton - optional - sets the mouse button for drawing the rectangle - default: left mouse button (0)\n * }\n * @param mapId - optional - the mapId of the map that the tool will be used in.\n *\n */\n\nexport enum MouseButtons {\n  LEFT = 0,\n  MIDDLE = 1,\n  RIGHT = 2,\n}\n\n@Injectable()\nexport class ZoomToRectangleService {\n  constructor(\n    private mapsManager: MapsManagerService,\n    @Optional() cameraService: CameraService,\n    @Optional() cesiumService: CesiumService,\n  ) {}\n\n  private cameraService: CameraService;\n  private cesiumService: CesiumService;\n\n  private mapsZoomElements = new Map<string, ZoomData>();\n  private defaultOptions = {\n    animationDurationInSeconds: 0.5,\n    resetKeyCode: 27,\n    borderStyle: '2px solid rgba(0,0,0,0.5)',\n    backgroundColor: 'rgba(0,0,0,0.2)',\n    autoDisableOnZoom: true,\n    threshold: 9,\n    keepRotation: true,\n    mouseButton: MouseButtons.LEFT,\n  };\n\n  init(cesiumService: CesiumService, cameraService: CameraService) {\n    this.cameraService = cameraService;\n    this.cesiumService = cesiumService;\n  }\n\n  activate(\n    options: {\n      onStart?: (acMap?: AcMapComponent) => any;\n      onComplete?: (acMap?: AcMapComponent) => any;\n      mouseButton?: MouseButtons;\n      autoDisableOnZoom?: boolean;\n      animationDurationInSeconds?: number;\n      threshold?: number;\n      keepRotation?: boolean;\n      borderStyle?: string;\n      backgroundColor?: string;\n      resetKeyCode?: number;\n    } = {},\n    mapId?: string,\n  ) {\n    if ((!this.cameraService || !this.cesiumService) && !mapId) {\n      throw new Error(`The function must receive a mapId if the service wasn't initialized`);\n    }\n    const finalOptions = Object.assign({}, this.defaultOptions, options);\n    let cameraService = this.cameraService;\n    let mapContainer;\n    let map;\n    if (this.cesiumService) {\n      mapContainer = this.cesiumService.getViewer().container;\n      map = this.cesiumService.getMap();\n    }\n    if (mapId) {\n      map = this.mapsManager.getMap(mapId);\n      if (!map) {\n        throw new Error(`Map not found with id: ${mapId}`);\n      }\n      cameraService = map.getCameraService();\n      mapContainer = map.getCesiumViewer().container;\n    }\n\n    if (!cameraService || !mapContainer) {\n      throw new Error(`The function must receive a mapId if the service wasn't initialized`);\n    }\n    this.disable(mapId);\n    const container = document.createElement('div');\n    mapContainer.style.position = 'relative';\n    container.style.position = 'absolute';\n    container.style.width = '100%';\n    container.style.height = '100%';\n    container.style.top = '0';\n    container.style.left = '0';\n    mapContainer.appendChild(container);\n    const mapZoomData: ZoomData = { container };\n    this.mapsZoomElements.set(mapId || this.cesiumService.getMap().getId(), mapZoomData);\n    let mouse = {\n      endX: 0,\n      endY: 0,\n      startX: 0,\n      startY: 0,\n    };\n    let borderElement: HTMLElement | undefined;\n\n    container.onmousedown = e => {\n      if (e.button !== finalOptions.mouseButton) {\n        return;\n      }\n      if (!borderElement) {\n        if (options && options.onStart) {\n          options.onStart(map);\n        }\n\n        const rect = (e.currentTarget as any).getBoundingClientRect();\n        const offsetX = e.clientX - rect.left;\n        const offsetY = e.clientY - rect.top;\n        mouse.startX = offsetX;\n        mouse.startY = offsetY;\n        borderElement = document.createElement('div');\n        borderElement.className = 'zoom-to-rectangle-border';\n        borderElement.style.position = 'absolute';\n        borderElement.style.border = finalOptions.borderStyle;\n        borderElement.style.backgroundColor = finalOptions.backgroundColor;\n        borderElement.style.left = mouse.startX + 'px';\n        borderElement.style.top = mouse.startY + 'px';\n        container.appendChild(borderElement);\n        mapZoomData.borderElement = borderElement;\n      }\n    };\n\n    container.onmouseup = e => {\n      if (borderElement) {\n        let zoomApplied;\n        if (mouse && Math.abs(mouse.endX - mouse.startX) * Math.abs(mouse.endY - mouse.startY) > finalOptions.threshold) {\n          zoomApplied = this.zoomCameraToRectangle(\n            cameraService,\n            mouse,\n            finalOptions.animationDurationInSeconds,\n            finalOptions,\n          );\n        }\n        borderElement.remove();\n        borderElement = undefined;\n        mapZoomData.borderElement = undefined;\n        mouse = {\n          endX: 0,\n          endY: 0,\n          startX: 0,\n          startY: 0,\n        };\n        if (!!finalOptions.onComplete) {\n          finalOptions.onComplete(map);\n        }\n        if (finalOptions.autoDisableOnZoom && zoomApplied) {\n          this.disable(mapId);\n        }\n      }\n    };\n\n    container.onmousemove = e => {\n      if (borderElement) {\n        const rect = (e.currentTarget as any).getBoundingClientRect();\n        const offsetX = e.clientX - rect.left;\n        const offsetY = e.clientY - rect.top;\n        mouse.endX = offsetX;\n        mouse.endY = offsetY;\n        borderElement.style.width = Math.abs(mouse.endX - mouse.startX) + 'px';\n        borderElement.style.height = Math.abs(mouse.endY - mouse.startY) + 'px';\n        borderElement.style.left = Math.min(mouse.startX, mouse.endX) + 'px';\n        borderElement.style.top = Math.min(mouse.startY, mouse.endY) + 'px';\n      }\n    };\n\n    const resetOnEscapePress = e => {\n      if (e.keyCode === finalOptions.resetKeyCode && borderElement) {\n        borderElement.remove();\n        borderElement = undefined;\n        mapZoomData.borderElement = undefined;\n        mouse = {\n          endX: 0,\n          endY: 0,\n          startX: 0,\n          startY: 0,\n        };\n      }\n    };\n    document.addEventListener('keydown', resetOnEscapePress);\n    mapZoomData.resetOnEscapePressFunc = resetOnEscapePress;\n  }\n\n  disable(mapId?: string) {\n    if (!this.cesiumService && !mapId) {\n      throw new Error('If the service was not initialized with CesiumService, mapId must be provided');\n    }\n    const data = this.mapsZoomElements.get(mapId || this.cesiumService.getMap().getId());\n    if (data) {\n      data.container.remove();\n      if (data.borderElement) {\n        data.borderElement.remove();\n      }\n      if (data.resetOnEscapePressFunc) {\n        document.removeEventListener('keydown', data.resetOnEscapePressFunc);\n      }\n    }\n    this.mapsZoomElements.delete(mapId);\n  }\n\n  private zoomCameraToRectangle(\n    cameraService: CameraService,\n    positions: { endX: number; endY: number; startX: number; startY: number },\n    animationDuration,\n    options,\n  ): boolean {\n    const camera = cameraService.getCamera();\n    const cartesian1 = camera.pickEllipsoid({ x: positions.startX, y: positions.startY });\n    const cartesian2 = camera.pickEllipsoid({ x: positions.endX, y: positions.endY });\n    if (!cartesian1 || !cartesian2) {\n      return false;\n    }\n    const cartographic1 = Cesium.Cartographic.fromCartesian(cartesian1);\n    const cartographic2 = Cesium.Cartographic.fromCartesian(cartesian2);\n    cameraService.cameraFlyTo({\n      destination: new Cesium.Rectangle(\n        Math.min(cartographic1.longitude, cartographic2.longitude),\n        Math.min(cartographic1.latitude, cartographic2.latitude),\n        Math.max(cartographic1.longitude, cartographic2.longitude),\n        Math.max(cartographic1.latitude, cartographic2.latitude),\n      ),\n      orientation: options.keepRotation ? { heading: camera.heading } : undefined,\n      duration: animationDuration,\n    });\n    return true;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { EditableRectangle } from '../../../models/editable-rectangle';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { RectangleEditOptions } from '../../../models/rectangle-edit-options';\nimport { AcLayerComponent } from '../../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\n\n@Injectable()\nexport class RectanglesManagerService {\n  rectangles: Map<string, EditableRectangle> = new Map<string, EditableRectangle>();\n\n  createEditableRectangle(\n    id: string,\n    editRectanglesLayer: AcLayerComponent,\n    editPointsLayer: AcLayerComponent,\n    coordinateConverter: CoordinateConverter,\n    rectangleOptions?: RectangleEditOptions,\n    positions?: Cartesian3[]\n  ) {\n    const editableRectangle = new EditableRectangle(\n      id,\n      editPointsLayer,\n      editRectanglesLayer,\n      coordinateConverter,\n      rectangleOptions,\n      positions\n    );\n\n    this.rectangles.set(id, editableRectangle);\n  }\n\n  dispose(id: string) {\n    this.rectangles.get(id).dispose();\n    this.rectangles.delete(id);\n  }\n\n  get(id: string): EditableRectangle {\n    return this.rectangles.get(id);\n  }\n\n  clear() {\n    this.rectangles.forEach(rectangle => rectangle.dispose());\n    this.rectangles.clear();\n  }\n}\n\n","import { publish, tap } from 'rxjs/operators';\nimport { Injectable } from '@angular/core';\nimport { CesiumService } from '../../../../angular-cesium/services/cesium/cesium.service';\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\nimport { RectangleEditUpdate } from '../../../models/rectangle-edit-update';\nimport { EditModes } from '../../../models/edit-mode.enum';\nimport { EditActions } from '../../../models/edit-actions.enum';\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { EditPoint } from '../../../models/edit-point';\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\nimport { RectanglesManagerService } from './rectangles-manager.service';\nimport { RectangleEditorObservable } from '../../../models/rectangle-editor-observable';\nimport { EditableRectangle } from '../../../models/editable-rectangle';\nimport { RectangleEditOptions } from '../../../models/rectangle-edit-options';\nimport { PointProps } from '../../../models/point-edit-options';\nimport { LabelProps } from '../../../models/label-props';\nimport { generateKey } from '../../utils';\n\nexport const DEFAULT_RECTANGLE_OPTIONS: RectangleEditOptions = {\n  addPointEvent: CesiumEvent.LEFT_CLICK,\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\n  allowDrag: true,\n  pointProps: {\n    color: Cesium.Color.WHITE,\n    outlineColor: Cesium.Color.BLACK.withAlpha(0.2),\n    outlineWidth: 1,\n    pixelSize: 13,\n    virtualPointPixelSize: 8,\n    show: true,\n    showVirtual: true,\n    disableDepthTestDistance: Number.POSITIVE_INFINITY,\n  },\n  rectangleProps: {\n    height: 0,\n    extrudedHeight: 0,\n    material: Cesium.Color.CORNFLOWERBLUE.withAlpha(0.4),\n    fill: true,\n    classificationType: Cesium.ClassificationType.BOTH,\n    outline: true,\n    outlineColor: Cesium.Color.WHITE,\n    zIndex: 0,\n  },\n  clampHeightTo3D: false,\n  clampHeightTo3DOptions: {\n    clampToTerrain: false,\n  },\n};\n\n/**\n * Service for creating editable rectangles\n *\n * You must provide `RectanglesEditorService` yourself.\n * RectanglesEditorService works together with `<rectangles-editor>` component. Therefor you need to create `<rectangles-editor>`\n * for each `RectanglesEditorService`, And of course somewhere under `<ac-map>`/\n *\n * + `create` for starting a creation of the shape over the map. Returns a extension of `RectangleEditorObservable`.\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `RectangleEditorObservable`.\n * + To stop editing call `dsipose()` from the `RectangleEditorObservable` you get back from `create()` \\ `edit()`.\n *\n * **Labels over editted shapes**\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\n * `RectangleEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\n * The callback should return type `LabelProps[]`.\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\n *\n * usage:\n * ```typescript\n *  // Start creating rectangle\n *  const editing$ = rectanglesEditorService.create();\n *  this.editing$.subscribe(editResult => {\n *\t\t\t\tconsole.log(editResult.positions);\n *\t\t});\n *\n *  // Or edit rectangle from existing rectangle positions\n *  const editing$ = this.rectanglesEditorService.edit(initialPos);\n *\n * ```\n */\n@Injectable()\nexport class RectanglesEditorService {\n  private mapEventsManager: MapEventsManagerService;\n  private updateSubject = new Subject<RectangleEditUpdate>();\n  private updatePublisher = publish<RectangleEditUpdate>()(this.updateSubject); // TODO maybe not needed\n  private coordinateConverter: CoordinateConverter;\n  private cameraService: CameraService;\n  private rectanglesManager: RectanglesManagerService;\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\n  private cesiumScene: any;\n\n  init(mapEventsManager: MapEventsManagerService,\n       coordinateConverter: CoordinateConverter,\n       cameraService: CameraService,\n       rectanglesManager: RectanglesManagerService,\n       cesiumViewer: CesiumService,\n  ) {\n    this.mapEventsManager = mapEventsManager;\n    this.coordinateConverter = coordinateConverter;\n    this.cameraService = cameraService;\n    this.rectanglesManager = rectanglesManager;\n    this.updatePublisher.connect();\n\n    this.cesiumScene = cesiumViewer.getScene();\n  }\n\n  onUpdate(): Observable<RectangleEditUpdate> {\n    return this.updatePublisher;\n  }\n\n  create(options = DEFAULT_RECTANGLE_OPTIONS, priority = 100): RectangleEditorObservable {\n    const positions: Cartesian3[] = [];\n    const id = generateKey();\n    const rectangleOptions = this.setOptions(options);\n\n    const clientEditSubject = new BehaviorSubject<RectangleEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.CREATE\n    });\n    let finishedCreate = false;\n\n    this.updateSubject.next({\n      id,\n      positions,\n      editMode: EditModes.CREATE,\n      editAction: EditActions.INIT,\n      rectangleOptions: rectangleOptions,\n    });\n\n    const finishCreation = () => {\n      const changeMode = {\n        id,\n        editMode: EditModes.CREATE,\n        editAction: EditActions.CHANGE_TO_EDIT,\n      };\n      this.updateSubject.next(changeMode);\n      clientEditSubject.next(changeMode);\n      if (this.observablesMap.has(id)) {\n        this.observablesMap.get(id).forEach(registration => registration.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.editRectangle(id, positions, priority, clientEditSubject, rectangleOptions, editorObservable);\n      finishedCreate = true;\n      return finishedCreate;\n    };\n\n    const mouseMoveRegistration = this.mapEventsManager.register({\n      event: CesiumEvent.MOUSE_MOVE,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n    const addPointRegistration = this.mapEventsManager.register({\n      event: rectangleOptions.addPointEvent,\n      pick: PickOptions.NO_PICK,\n      pickConfig: options.pickConfiguration,\n      priority,\n    });\n\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration ]);\n    const editorObservable = this.createEditorObservable(clientEditSubject, id, finishCreation);\n\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n\n      if (position) {\n        this.updateSubject.next({\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.CREATE,\n          updatedPosition: position,\n          editAction: EditActions.MOUSE_MOVE,\n        });\n      }\n    });\n\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\n      if (finishedCreate) {\n        return;\n      }\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\n      if (!position) {\n        return;\n      }\n      const allPositions = this.getPositions(id);\n      const isFirstPoint = this.getPositions(id).length === 0;\n\n      const updateValue = {\n        id,\n        positions: allPositions,\n        editMode: EditModes.CREATE,\n        updatedPosition: position,\n        editAction: EditActions.ADD_POINT,\n      };\n      this.updateSubject.next(updateValue);\n      clientEditSubject.next({\n        ...updateValue,\n        positions: this.getPositions(id),\n        points: this.getPoints(id),\n      });\n\n      if (!isFirstPoint) {\n        finishedCreate = finishCreation();\n      }\n\n    });\n\n    return editorObservable;\n  }\n\n  edit(positions: Cartesian3[], options = DEFAULT_RECTANGLE_OPTIONS, priority = 100): RectangleEditorObservable {\n    if (positions.length !== 2) {\n      throw new Error('Rectangles editor error edit(): rectangle should have at least 2 positions');\n    }\n    const id = generateKey();\n    const rectangleOptions = this.setOptions(options);\n    const editSubject = new BehaviorSubject<RectangleEditUpdate>({\n      id,\n      editAction: null,\n      editMode: EditModes.EDIT\n    });\n    const update = {\n      id,\n      positions: positions,\n      editMode: EditModes.EDIT,\n      editAction: EditActions.INIT,\n      rectangleOptions: rectangleOptions,\n    };\n    this.updateSubject.next(update);\n    editSubject.next({\n      ...update,\n      positions: this.getPositions(id),\n      points: this.getPoints(id),\n    });\n    return this.editRectangle(\n      id,\n      positions,\n      priority,\n      editSubject,\n      rectangleOptions\n    );\n  }\n\n  private editRectangle(id: string,\n                      positions: Cartesian3[],\n                      priority: number,\n                      editSubject: Subject<RectangleEditUpdate>,\n                      options: RectangleEditOptions,\n                      editObservable?: RectangleEditorObservable): RectangleEditorObservable {\n\n    const pointDragRegistration = this.mapEventsManager.register({\n      event: options.dragPointEvent,\n      entityType: EditPoint,\n      pick: PickOptions.PICK_FIRST,\n      pickConfig: options.pickConfiguration,\n      priority,\n      pickFilter: entity => id === entity.editedEntityId,\n    });\n\n    let shapeDragRegistration;\n    if (options.allowDrag) {\n      shapeDragRegistration = this.mapEventsManager.register({\n        event: options.dragShapeEvent,\n        entityType: EditableRectangle,\n        pick: PickOptions.PICK_FIRST,\n        pickConfig: options.pickConfiguration,\n        priority,\n        pickFilter: entity => id === entity.id,\n      });\n    }\n\n    pointDragRegistration.pipe(\n      tap(({ movement: { drop } }) => this.rectanglesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n      .subscribe(({ movement: { endPosition, drop }, entities }) => {\n        const position = this.coordinateConverter.screenToCartesian3(endPosition);\n        if (!position) {\n          return;\n        }\n        const point: EditPoint = entities[0];\n\n        const update = {\n          id,\n          positions: this.getPositions(id),\n          editMode: EditModes.EDIT,\n          updatedPosition: position,\n          updatedPoint: point,\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\n        };\n        this.updateSubject.next(update);\n        editSubject.next({\n          ...update,\n          positions: this.getPositions(id),\n          points: this.getPoints(id),\n        });\n      });\n\n    if (shapeDragRegistration) {\n      shapeDragRegistration\n        .pipe(tap(({ movement: { drop } }) => this.rectanglesManager.get(id).enableEdit && this.cameraService.enableInputs(drop)))\n        .subscribe(({ movement: { startPosition, endPosition, drop }, entities }) => {\n          const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\n          const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\n          if (!endDragPosition) {\n            return;\n          }\n\n          const update = {\n            id,\n            positions: this.getPositions(id),\n            editMode: EditModes.EDIT,\n            updatedPosition: endDragPosition,\n            draggedPosition: startDragPosition,\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\n          };\n          this.updateSubject.next(update);\n          editSubject.next({\n            ...update,\n            positions: this.getPositions(id),\n            points: this.getPoints(id),\n          });\n        });\n    }\n\n    const observables = [pointDragRegistration];\n    if (shapeDragRegistration) {\n      observables.push(shapeDragRegistration);\n    }\n\n    this.observablesMap.set(id, observables);\n    return editObservable || this.createEditorObservable(editSubject, id);\n  }\n\n  private setOptions(options: RectangleEditOptions) {\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_RECTANGLE_OPTIONS));\n    const rectangleOptions: RectangleEditOptions = Object.assign(defaultClone, options);\n    rectangleOptions.pointProps = Object.assign({}, DEFAULT_RECTANGLE_OPTIONS.pointProps, options.pointProps);\n    rectangleOptions.rectangleProps = Object.assign({}, DEFAULT_RECTANGLE_OPTIONS.rectangleProps, options.rectangleProps);\n\n    if (options.clampHeightTo3D) {\n      if (!this.cesiumScene.pickPositionSupported || !this.cesiumScene.clampToHeightSupported) {\n        throw new Error(`Cesium pickPosition and clampToHeight must be supported to use clampHeightTo3D`);\n      }\n\n      if (this.cesiumScene.pickTranslucentDepth) {\n        console.warn(`Cesium scene.pickTranslucentDepth must be false in order to make the editors work properly on 3D`);\n      }\n\n      if (rectangleOptions.pointProps.color.alpha === 1 || rectangleOptions.pointProps.outlineColor.alpha === 1) {\n        console.warn('Point color and outline color must have alpha in order to make the editor work properly on 3D');\n      }\n\n      rectangleOptions.pointProps.heightReference =  rectangleOptions.clampHeightTo3DOptions.clampToTerrain ?\n        Cesium.HeightReference.CLAMP_TO_GROUND : Cesium.HeightReference.RELATIVE_TO_GROUND;\n      rectangleOptions.pointProps.disableDepthTestDistance = Number.POSITIVE_INFINITY;\n    }\n    return rectangleOptions;\n  }\n\n\n  private createEditorObservable(observableToExtend: any, id: string, finishCreation?: () => boolean): RectangleEditorObservable {\n    observableToExtend.dispose = () => {\n      const observables = this.observablesMap.get(id);\n      if (observables) {\n        observables.forEach(obs => obs.dispose());\n      }\n      this.observablesMap.delete(id);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.DISPOSE,\n      });\n    };\n    observableToExtend.enable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.ENABLE,\n      });\n    };\n    observableToExtend.disable = () => {\n      this.updateSubject.next({\n        id,\n        positions: this.getPositions(id),\n        editMode: EditModes.EDIT,\n        editAction: EditActions.DISABLE,\n      });\n    };\n\n    observableToExtend.setManually = (firstPosition: Cartesian3,\n                                      secondPosition: Cartesian3,\n                                      firstPointProp?: PointProps,\n                                      secondPointProp?: PointProps) => {\n      const firstP = new EditPoint(id, firstPosition, firstPointProp ? firstPointProp : DEFAULT_RECTANGLE_OPTIONS.pointProps);\n      const secP = new EditPoint(id, secondPosition, secondPointProp ? secondPointProp : DEFAULT_RECTANGLE_OPTIONS.pointProps);\n\n      const rectangle = this.rectanglesManager.get(id);\n      rectangle.setPointsManually([firstP, secP]);\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_MANUALLY,\n      });\n    };\n\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\n        labelsRenderFn: callback,\n      });\n    };\n\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\n      this.updateSubject.next({\n        id,\n        editMode: EditModes.CREATE_OR_EDIT,\n        editAction: EditActions.UPDATE_EDIT_LABELS,\n        updateLabels: labels,\n      });\n    };\n\n    observableToExtend.finishCreation = () => {\n      if (!finishCreation) {\n        throw new Error('Rectangles editor error edit(): cannot call finishCreation() on edit');\n      }\n\n      return finishCreation();\n    };\n\n    observableToExtend.getCurrentPoints = () => this.getPoints(id);\n\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\n\n    observableToExtend.getLabels = (): LabelProps[] => this.rectanglesManager.get(id).labels;\n\n    return observableToExtend as RectangleEditorObservable;\n  }\n\n  private getPositions(id: any) {\n    const rectangle = this.rectanglesManager.get(id);\n    return rectangle.getRealPositions();\n  }\n\n  private getPoints(id: any) {\n    const rectangle = this.rectanglesManager.get(id);\n    return rectangle.getRealPoints();\n  }\n}\n\n","import { ChangeDetectionStrategy, Component, OnDestroy, ViewChild } from '@angular/core';\nimport { CesiumService } from '../../../angular-cesium/services/cesium/cesium.service';\nimport { EditModes } from '../../models/edit-mode.enum';\nimport { RectangleEditUpdate } from '../../models/rectangle-edit-update';\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\nimport { EditActions } from '../../models/edit-actions.enum';\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\nimport { Subject } from 'rxjs';\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\nimport { EditPoint } from '../../models/edit-point';\nimport { RectanglesManagerService } from '../../services/entity-editors/rectangles-editor/rectangles-manager.service';\nimport { RectanglesEditorService } from '../../services/entity-editors/rectangles-editor/rectangles-editor.service';\nimport { LabelProps } from '../../models/label-props';\nimport { EditableRectangle } from '../../models/editable-rectangle';\n\n@Component({\n  selector: 'rectangles-editor',\n  template: /*html*/ `\n    <ac-layer #editPointsLayer acFor=\"let point of editPoints$\" [context]=\"this\">\n      <ac-point-desc\n        props=\"{\n        position: point.getPositionCallbackProperty(),\n        pixelSize: getPointSize(point),\n        color: point.props.color,\n        outlineColor: point.props.outlineColor,\n        outlineWidth: point.props.outlineWidth,\n        show: getPointShow(point),\n        disableDepthTestDistance: point.props.disableDepthTestDistance,\n        heightReference: point.props.heightReference,\n    }\"\n      >\n      </ac-point-desc>\n    </ac-layer>\n\n    <ac-layer #editRectanglesLayer acFor=\"let rectangle of editRectangles$\" [context]=\"this\">\n      <ac-rectangle-desc\n        props=\"{\n          coordinates: rectangle.getRectangleCallbackProperty(),\n          material: rectangle.rectangleProps.material,\n          fill: rectangle.rectangleProps.fill,\n          classificationType: rectangle.rectangleProps.classificationType,\n          zIndex: rectangle.rectangleProps.zIndex,\n          outline: rectangle.rectangleProps.outline,\n          outlineColor: rectangle.rectangleProps.outlineColor,\n          height: rectangle.rectangleProps.height,\n          extrudedHeight: rectangle.rectangleProps.extrudedHeight\n        }\"\n      >\n      </ac-rectangle-desc>\n      <ac-array-desc acFor=\"let label of rectangle.labels\" [idGetter]=\"getLabelId\">\n        <ac-label-primitive-desc\n          props=\"{\n            position: label.position,\n            backgroundColor: label.backgroundColor,\n            backgroundPadding: label.backgroundPadding,\n            distanceDisplayCondition: label.distanceDisplayCondition,\n            eyeOffset: label.eyeOffset,\n            fillColor: label.fillColor,\n            font: label.font,\n            heightReference: label.heightReference,\n            horizontalOrigin: label.horizontalOrigin,\n            outlineColor: label.outlineColor,\n            outlineWidth: label.outlineWidth,\n            pixelOffset: label.pixelOffset,\n            pixelOffsetScaleByDistance: label.pixelOffsetScaleByDistance,\n            scale: label.scale,\n            scaleByDistance: label.scaleByDistance,\n            show: label.show,\n            showBackground: label.showBackground,\n            style: label.style,\n            text: label.text,\n            translucencyByDistance: label.translucencyByDistance,\n            verticalOrigin: label.verticalOrigin,\n            disableDepthTestDistance: label.disableDepthTestDistance,\n        }\"\n        >\n        </ac-label-primitive-desc>\n      </ac-array-desc>\n    </ac-layer>\n  `,\n  providers: [CoordinateConverter, RectanglesManagerService],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class RectanglesEditorComponent implements OnDestroy {\n  private editLabelsRenderFn: (update: RectangleEditUpdate, labels: LabelProps[]) => LabelProps[];\n  public Cesium = Cesium;\n  public editPoints$ = new Subject<AcNotification>();\n  public editRectangles$ = new Subject<AcNotification>();\n\n  @ViewChild('editRectanglesLayer') private editRectanglesLayer: AcLayerComponent;\n  @ViewChild('editPointsLayer') private editPointsLayer: AcLayerComponent;\n\n  constructor(\n    private rectanglesEditor: RectanglesEditorService,\n    private coordinateConverter: CoordinateConverter,\n    private mapEventsManager: MapEventsManagerService,\n    private cameraService: CameraService,\n    private rectanglesManager: RectanglesManagerService,\n    private cesiumService: CesiumService\n  ) {\n    this.rectanglesEditor.init(\n      this.mapEventsManager,\n      this.coordinateConverter,\n      this.cameraService,\n      this.rectanglesManager,\n      this.cesiumService\n    );\n    this.startListeningToEditorUpdates();\n  }\n\n  private startListeningToEditorUpdates() {\n    this.rectanglesEditor.onUpdate().subscribe((update: RectangleEditUpdate) => {\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\n        this.handleCreateUpdates(update);\n      } else if (update.editMode === EditModes.EDIT) {\n        this.handleEditUpdates(update);\n      }\n    });\n  }\n\n  getLabelId(element: any, index: number): string {\n    return index.toString();\n  }\n\n  renderEditLabels(rectangle: EditableRectangle, update: RectangleEditUpdate, labels?: LabelProps[]) {\n    update.positions = rectangle.getRealPositions();\n    update.points = rectangle.getRealPoints();\n\n    if (labels) {\n      rectangle.labels = labels;\n      this.editRectanglesLayer.update(rectangle, rectangle.getId());\n      return;\n    }\n\n    if (!this.editLabelsRenderFn) {\n      return;\n    }\n\n    rectangle.labels = this.editLabelsRenderFn(update, rectangle.labels);\n    this.editRectanglesLayer.update(rectangle, rectangle.getId());\n  }\n\n  removeEditLabels(rectangle: EditableRectangle) {\n    rectangle.labels = [];\n    this.editRectanglesLayer.update(rectangle, rectangle.getId());\n  }\n\n  handleCreateUpdates(update: RectangleEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.rectanglesManager.createEditableRectangle(\n          update.id,\n          this.editRectanglesLayer,\n          this.editPointsLayer,\n          this.coordinateConverter,\n          update.rectangleOptions,\n        );\n        break;\n      }\n      case EditActions.MOUSE_MOVE: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (update.updatedPosition) {\n          rectangle.moveTempMovingPoint(update.updatedPosition);\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.ADD_POINT: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (update.updatedPosition) {\n          rectangle.moveTempMovingPoint(update.updatedPosition);\n          rectangle.addPoint(update.updatedPosition);\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.ADD_LAST_POINT: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (update.updatedPosition) {\n          rectangle.addLastPoint(update.updatedPosition);\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.DISPOSE: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle) {\n          rectangle.dispose();\n          this.removeEditLabels(rectangle);\n        }\n        this.editLabelsRenderFn = undefined;\n        break;\n      }\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        this.editLabelsRenderFn = update.labelsRenderFn;\n        this.renderEditLabels(rectangle, update);\n        break;\n      }\n      case EditActions.UPDATE_EDIT_LABELS: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        this.renderEditLabels(rectangle, update, update.updateLabels);\n        break;\n      }\n      case EditActions.SET_MANUALLY: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        this.renderEditLabels(rectangle, update, update.updateLabels);\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleEditUpdates(update: RectangleEditUpdate) {\n    switch (update.editAction) {\n      case EditActions.INIT: {\n        this.rectanglesManager.createEditableRectangle(\n          update.id,\n          this.editRectanglesLayer,\n          this.editPointsLayer,\n          this.coordinateConverter,\n          update.rectangleOptions,\n          update.positions,\n        );\n        break;\n      }\n      case EditActions.DRAG_POINT: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle && rectangle.enableEdit) {\n          rectangle.movePoint(update.updatedPosition, update.updatedPoint);\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_POINT_FINISH: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle && rectangle.enableEdit) {\n          rectangle.endMovePoint();\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.DISABLE: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle) {\n          rectangle.enableEdit = false;\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.ENABLE: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle) {\n          rectangle.enableEdit = true;\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      case EditActions.DRAG_SHAPE: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle && rectangle.enableEdit) {\n          rectangle.moveShape(update.draggedPosition, update.updatedPosition);\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n\n      case EditActions.DRAG_SHAPE_FINISH: {\n        const rectangle = this.rectanglesManager.get(update.id);\n        if (rectangle && rectangle.enableEdit) {\n          rectangle.endMoveShape();\n          this.renderEditLabels(rectangle, update);\n        }\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.rectanglesManager.clear();\n  }\n\n  getPointSize(point: EditPoint) {\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\n  }\n\n  getPointShow(point: EditPoint) {\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\n  }\n}\n\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { AngularCesiumModule } from '../angular-cesium/angular-cesium.module';\nimport { PointsEditorComponent } from './components/points-editor/points-editor.component';\nimport { PolygonsEditorComponent } from './components/polygons-editor/polygons-editor.component';\nimport { CirclesEditorComponent } from './components/circles-editor/circles-editor.component';\nimport { EllipsesEditorComponent } from './components/ellipses-editor/ellipses-editor.component';\nimport { PolylinesEditorComponent } from './components/polylines-editor/polylines-editor.component';\nimport { HippodromeEditorComponent } from './components/hippodrome-editor/hippodrome-editor.component';\nimport { DraggableToMapDirective } from './directives/draggable-to-map.directive';\nimport { DraggableToMapService } from './services/draggable-to-map.service';\nimport { AcToolbarComponent } from './components/toolbar/ac-toolbar/ac-toolbar.component';\nimport { DragIconComponent } from './components/toolbar/ac-toolbar/drag-icon.component';\nimport { AcToolbarButtonComponent } from './components/toolbar/ac-toolbar-button/ac-toolbar-button.component';\nimport { RangeAndBearingComponent } from './components/range-and-bearing/range-and-bearing.component';\nimport { ZoomToRectangleService } from './services/zoom-to-rectangle.service';\nimport { RectanglesEditorComponent } from './components/rectangles-editor/rectangles-editor.component';\n\n@NgModule({\n  imports: [CommonModule, AngularCesiumModule],\n  declarations: [\n    PointsEditorComponent,\n    HippodromeEditorComponent,\n    PolygonsEditorComponent,\n    RectanglesEditorComponent,\n    CirclesEditorComponent,\n    EllipsesEditorComponent,\n    PolylinesEditorComponent,\n    DraggableToMapDirective,\n    DragIconComponent,\n    AcToolbarComponent,\n    AcToolbarButtonComponent,\n    RangeAndBearingComponent,\n  ],\n  exports: [\n    PointsEditorComponent,\n    HippodromeEditorComponent,\n    PolygonsEditorComponent,\n    RectanglesEditorComponent,\n    CirclesEditorComponent,\n    EllipsesEditorComponent,\n    PolylinesEditorComponent,\n    DraggableToMapDirective,\n    AcToolbarComponent,\n    AcToolbarButtonComponent,\n    RangeAndBearingComponent,\n  ],\n  providers: [\n    DraggableToMapService,\n    ZoomToRectangleService,\n  ]\n})\nexport class AngularCesiumWidgetsModule {\n}\n","/*\n * Public API Surface of angular-cesium\n */\n\nexport * from './lib/angular-cesium/index';\n// export * from './lib/heatmap/cesium-heatmap-material-creator';\nexport * from './lib/angular-cesium-widgets/index';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {DragIconComponent as Éµcf} from './lib/angular-cesium-widgets/components/toolbar/ac-toolbar/drag-icon.component';\nexport {CirclesManagerService as Éµcc} from './lib/angular-cesium-widgets/services/entity-editors/circles-editor/circles-manager.service';\nexport {EllipsesManagerService as Éµcd} from './lib/angular-cesium-widgets/services/entity-editors/ellipses-editor/ellipses-manager.service';\nexport {HippodromeManagerService as Éµbz} from './lib/angular-cesium-widgets/services/entity-editors/hippodrome-editor/hippodrome-manager.service';\nexport {PointsManagerService as Éµby} from './lib/angular-cesium-widgets/services/entity-editors/points-editor/points-manager.service';\nexport {PolygonsManagerService as Éµca} from './lib/angular-cesium-widgets/services/entity-editors/polygons-editor/polygons-manager.service';\nexport {PolylinesManagerService as Éµce} from './lib/angular-cesium-widgets/services/entity-editors/polyline-editor/polylines-manager.service';\nexport {RectanglesManagerService as Éµcb} from './lib/angular-cesium-widgets/services/entity-editors/rectangles-editor/rectangles-manager.service';\nexport {ANGULAR_CESIUM_CONFIG as Éµr,ConfigurationService as Éµs} from './lib/angular-cesium/cesium-enhancements/ConfigurationService';\nexport {AcContextMenuWrapperComponent as Éµbs} from './lib/angular-cesium/components/ac-context-menu-wrapper/ac-context-menu-wrapper.component';\nexport {AcHtmlContainerDirective as Éµbw} from './lib/angular-cesium/directives/ac-html-container/ac-html-container.directive';\nexport {AcHtmlContext as Éµbu,AcHtmlDirective as Éµbv} from './lib/angular-cesium/directives/ac-html/ac-html.directive';\nexport {AcHtmlManager as Éµbt} from './lib/angular-cesium/services/ac-html-manager/ac-html-manager.service';\nexport {BasicDesc as Éµbp} from './lib/angular-cesium/services/basic-desc/basic-desc.service';\nexport {BasicStaticPrimitiveDesc as Éµbx} from './lib/angular-cesium/services/basic-primitive-desc/basic-static-primitive-desc.service';\nexport {CesiumProperties as Éµbq} from './lib/angular-cesium/services/cesium-properties/cesium-properties.service';\nexport {ComputationCache as Éµu} from './lib/angular-cesium/services/computation-cache/computation-cache.service';\nexport {ArcDrawerService as Éµn} from './lib/angular-cesium/services/drawers/arc-drawer/arc-drawer.service';\nexport {BasicDrawerService as Éµe} from './lib/angular-cesium/services/drawers/basic-drawer/basic-drawer.service';\nexport {BillboardDrawerService as Éµc} from './lib/angular-cesium/services/drawers/billboard-drawer/billboard-drawer.service';\nexport {BillboardPrimitiveDrawerService as Éµbe} from './lib/angular-cesium/services/drawers/billboard-primitive-drawer/billboard-primitive-drawer.service';\nexport {BoxDrawerService as Éµw} from './lib/angular-cesium/services/drawers/box-dawer/box-drawer.service';\nexport {CorridorDrawerService as Éµx} from './lib/angular-cesium/services/drawers/corridor-dawer/corridor-drawer.service';\nexport {CylinderDrawerService as Éµy} from './lib/angular-cesium/services/drawers/cylinder-dawer/cylinder-drawer.service';\nexport {CzmlDrawerService as Éµo} from './lib/angular-cesium/services/drawers/czml-drawer/czml-drawer.service';\nexport {EllipsoidDrawerService as Éµz} from './lib/angular-cesium/services/drawers/ellipoid-drawer/ellipsoid-drawer.service';\nexport {EllipseDrawerService as Éµl} from './lib/angular-cesium/services/drawers/ellipse-drawer/ellipse-drawer.service';\nexport {EntitiesDrawerService as Éµd} from './lib/angular-cesium/services/drawers/entities-drawer/entities-drawer.service';\nexport {GraphicsType as Éµf} from './lib/angular-cesium/services/drawers/entities-drawer/enums/graphics-type.enum';\nexport {HtmlDrawerService as Éµbg} from './lib/angular-cesium/services/drawers/html-drawer/html-drawer.service';\nexport {LabelDrawerService as Éµh} from './lib/angular-cesium/services/drawers/label-drawer/label-drawer.service';\nexport {LabelPrimitiveDrawerService as Éµbd} from './lib/angular-cesium/services/drawers/label-primitive-drawer/label-primitive-drawer.service';\nexport {ModelDrawerService as Éµv} from './lib/angular-cesium/services/drawers/model-drawer/model-drawer.service';\nexport {PointDrawerService as Éµm} from './lib/angular-cesium/services/drawers/point-drawer/point-drawer.service';\nexport {PointPrimitiveDrawerService as Éµbf} from './lib/angular-cesium/services/drawers/point-primitive-drawer/point-primitive-drawer.service';\nexport {PolygonDrawerService as Éµp} from './lib/angular-cesium/services/drawers/polygon-drawer/polygon-drawer.service';\nexport {PolylineDrawerService as Éµi} from './lib/angular-cesium/services/drawers/polyline-drawer/polyline-drawer.service';\nexport {PolylinePrimitiveDrawerService as Éµj} from './lib/angular-cesium/services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service';\nexport {PolylineVolumeDrawerService as Éµba} from './lib/angular-cesium/services/drawers/polyline-volume-dawer/polyline-volume-drawer.service';\nexport {PrimitivesDrawerService as Éµk} from './lib/angular-cesium/services/drawers/primitives-drawer/primitives-drawer.service';\nexport {RectangleDrawerService as Éµbc} from './lib/angular-cesium/services/drawers/rectangle-dawer/rectangle-drawer.service';\nexport {DynamicPolylineDrawerService as Éµbi} from './lib/angular-cesium/services/drawers/static-dynamic/dynamic-polyline-drawer/dynamic-polyline-drawer.service';\nexport {DynamicEllipseDrawerService as Éµbh} from './lib/angular-cesium/services/drawers/static-dynamic/ellipse-drawer/dynamic-ellipse-drawer.service';\nexport {StaticEllipseDrawerService as Éµbn} from './lib/angular-cesium/services/drawers/static-dynamic/ellipse-drawer/ellipse-drawer.service';\nexport {StaticCircleDrawerService as Éµbj} from './lib/angular-cesium/services/drawers/static-dynamic/static-circle-drawer/static-circle-drawer.service';\nexport {StaticPolygonDrawerService as Éµbm} from './lib/angular-cesium/services/drawers/static-dynamic/static-polygon-drawer/polygon-drawer.service';\nexport {StaticPolylineDrawerService as Éµbl} from './lib/angular-cesium/services/drawers/static-dynamic/static-polyline-drawer/static-polyline-drawer.service';\nexport {StaticPrimitiveDrawer as Éµbk} from './lib/angular-cesium/services/drawers/static-dynamic/static-primitive-drawer/static-primitive-drawer.service';\nexport {WallDrawerService as Éµbb} from './lib/angular-cesium/services/drawers/wall-dawer/wall-drawer.service';\nexport {EntityOnMapComponent as Éµbo} from './lib/angular-cesium/services/entity-on-map/entity-on-map.component';\nexport {JsonMapper as Éµbr} from './lib/angular-cesium/services/json-mapper/json-mapper.service';\nexport {LayerService as Éµt} from './lib/angular-cesium/services/layer-service/layer-service.service';\nexport {CesiumEventBuilder as Éµg} from './lib/angular-cesium/services/map-events-mananger/cesium-event-builder';\nexport {MapLayersService as Éµq} from './lib/angular-cesium/services/map-layers/map-layers.service';\nexport {ViewerFactory as Éµb} from './lib/angular-cesium/services/viewer-factory/viewer-factory.service';\nexport {UtilsModule as Éµa} from './lib/angular-cesium/utils/utils.module';"],"names":["Injectable","NgZone","Optional","InjectionToken","Inject","SceneMode","CesiumEvent","PickOptions","EventEmitter","geodesy['LatLonVectors']","geodesy","LatLonEllipsoidal","Utm","GraphicsType","KeyboardAction","isNumber","DOCUMENT","Observable","merge","publish","mergeMap","observableOf","delay","takeUntil","Subject","filter","map","switchMap","tap","Component","ElementRef","Input","ActionType","EllipsePrimitive","observableMerge","observableFrom","ChangeDetectionStrategy","Directive","JsonStringMapper","Parse","Output","forwardRef","Pipe","NgModule","CommonModule","MapLayerProviderOptions","MapTerrainProviderOptions","Renderer2","ChangeDetectorRef","TemplateRef","ViewContainerRef","ViewChild","ContentChild","ComponentFactoryResolver","_get","ContentChildren","PIPES_CONFIG","Angular2ParseModule","CesiumEventModifier","BehaviorSubject","EditModes","EditActions","observableFromEvent","HostListener","MouseButtons"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAOE;YACE,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;SACtB;;;;;;;;QASD,oCAAY,GAAZ,UAAa,YAAyB,EAAE,OAAa;YACnD,IAAI,MAAM,GAAG,IAAI,CAAC;YAClB,IAAI,OAAO,EAAE;gBACX,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,kBAC1C,cAAc,EAAE;wBACd,KAAK,EAAE,EAAC,qBAAqB,EAAE,IAAI,EAAC;qBACrC,IACE,OAAO,EACV,CAAC;aACJ;iBAAM;gBACL,MAAM,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,EAC1C;oBACE,cAAc,EAAE;wBACd,KAAK,EAAE,EAAC,qBAAqB,EAAE,IAAI,EAAC;qBACrC;iBACF,CAAC,CAAC;aACN;YAED,OAAO,MAAM,CAAC;SACf;;;;gBAnCFA,eAAU;;;;ICAX;;;;;;;;;;;;;QAYA;YAOU,2BAAsB,GAAG,CAAC,CAAC;YAC3B,4BAAuB,GAAG,CAAC,CAAC;SA6CrC;QA3CC,sBAAI,8CAAa;iBAAjB;gBACE,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;;;;;;iBAiBD,UAAkB,KAAwB;gBACxC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;;;WAnBA;QAID,kDAAoB,GAApB;YACE,IAAI,IAAI,CAAC,cAAc,YAAY,KAAK,EAAE;gBACxC,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC;aAC3D;iBAAM;gBACL,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;SACF;QAWD,sBAAI,+CAAc;iBAAlB;gBACE,OAAO,IAAI,CAAC,eAAe,CAAC;aAC7B;;;;;;iBAeD,UAAmB,KAA4B;gBAC7C,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;aAC9B;;;WAjBA;QAED,mDAAqB,GAArB;YACE,IAAI,IAAI,CAAC,eAAe,YAAY,KAAK,EAAE;gBACzC,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,CAAC;aAC7D;iBAAM;gBACL,OAAO,IAAI,CAAC,eAAe,CAAC;aAC7B;SACF;;;;gBA3CFA,eAAU;;;ICTX;;;;QAQE,uBAAoB,MAAc,EAAU,aAA4B,EAAsB,mBAAwC;YAAlH,WAAM,GAAN,MAAM,CAAQ;YAAU,kBAAa,GAAb,aAAa,CAAe;YAAsB,wBAAmB,GAAnB,mBAAmB,CAAqB;SACrI;QAED,4BAAI,GAAJ,UAAK,YAAyB,EAAE,GAAmB;YAAnD,iBAWC;YAVC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;YACf,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC;gBAC5B,IAAM,OAAO,GAAG,KAAI,CAAC,mBAAmB,GAAG,KAAI,CAAC,mBAAmB,CAAC,oBAAoB,EAAE,GAAG,SAAS,CAAC;gBACvG,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;gBAE3E,IAAM,cAAc,GAAG,KAAI,CAAC,mBAAmB,IAAI,KAAI,CAAC,mBAAmB,CAAC,qBAAqB,EAAE,CAAC;gBACpG,IAAI,OAAO,cAAc,KAAK,UAAU,EAAE;oBACxC,cAAc,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;iBACnC;aACF,CAAC,CAAC;SACJ;;;;;QAMD,iCAAS,GAAT;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;;;;;QAMD,gCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC;SAChC;;;;;QAMD,iCAAS,GAAT;YACE,OAAO,IAAI,CAAC,YAAY,CAAC,MAA2B,CAAC;SACtD;QAED,8BAAM,GAAN;YACE,OAAO,IAAI,CAAC,GAAG,CAAC;SACjB;;;;gBA/CFA,eAAU;;;gBARUC,WAAM;gBAClB,aAAa;gBACb,mBAAmB,uBAWiDC,aAAQ;;;ICbrF;;;;IAKA;IACA,IAAM,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,CAAC;IACjD,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;IAC3B,IAAM,8BAA8B,GAAG,MAAM,CAAC,8BAA8B,CAAC;IAC7E,IAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;IAC/B,IAAM,wBAAwB,GAAG,MAAM,CAAC,wBAAwB,CAAC;IACjE,IAAM,iDAAiD,GAAG,MAAM,CAAC,iDAAiD,CAAC;IACnH,IAAM,6BAA6B,GAAG,MAAM,CAAC,6BAA6B,CAAC;IAC3E,IAAM,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;IACnC,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;IACrC,IAAM,mBAAmB,GAAG,MAAM,CAAC,mBAAmB,CAAC;IACvD,IAAM,qBAAqB,GAAG,MAAM,CAAC,qBAAqB,CAAC;IAC3D,IAAM,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,CAAC;IACjD,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;IAEjC,IAAI,YAAY,GAAG,IAAI,KAAK,EAAE,CAAC;IAC/B,IAAI,+BAA+B,GAAG,IAAI,wBAAwB,EAAE,CAAC;IACrE,IAAI,+BAA+B,GAAG,IAAI,wBAAwB,EAAE,CAAC;IAErE,SAAS,KAAK,CAAC,UAAU,EAAE,WAAW,EAAE,cAAc,EAAE,uBAAuB,EAAE,yBAAyB,EAAE,MAAM,EAAE,OAAO;QACzH,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;QACrC,IAAI,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;QACvD,IAAI,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;QAC3D,IAAI,CAAC,iBAAiB,GAAG,SAAS,CAAC;QACnC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;QAC7B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;QAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;QAC9B,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,EAAE,CAAC;QACvC,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,EAAE,CAAC;QACvC,IAAI,CAAC,sBAAsB,GAAG,IAAI,gBAAgB,EAAE,CAAC;QACrD,IAAI,CAAC,UAAU,GAAG,IAAI,gBAAgB,EAAE,CAAC;QACzC,IAAI,CAAC,aAAa,GAAG,IAAI,gBAAgB,EAAE,CAAC;QAC5C,IAAI,CAAC,YAAY,GAAG,IAAI,gBAAgB,EAAE,CAAC;QAC3C,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;QAEzB,IAAI,0BAA0B,CAAC;QAC/B,IAAI,OAAO,CAAC,yBAAyB,CAAC,EAAE;YACtC,0BAA0B,GAAG,yBAAyB,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,KAAK,CAAC,SAAS,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;SACpI;QACD,IAAI,CAAC,0BAA0B,GAAG,0BAA0B,CAAC;IAC/D,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,iBAAiB,GAAG;QAClC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC1B,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,OAAO;QAC5C,IAAI,QAAQ,GAAG,IAAI,CAAC,yBAAyB,CAAC;QAC9C,IAAI,eAAe,GAAG,OAAO,CAAC,yBAAyB,CAAC;QACxD,IAAI,eAAe,KAAK,QAAQ,EAAE;YAChC,OAAO,IAAI,CAAC;SACb;QACD,IAAI,OAAO,CAAC,QAAQ,CAAC,EAAE;YACrB,OAAO,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;SACzC;QACD,OAAO,KAAK,CAAC;IACf,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,OAAO,EAAE,QAAQ;QAC/C,IAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;QACpB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QAChC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;QAC/B,IAAI,CAAC,OAAO,CAAC,eAAe,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,UAAU,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,gCAAgC,CAAC,EAAE;YAC1I,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;SAC9C;aAAM;YACL,IAAI,IAAI,GAAG,IAAI,CAAC;YAChB,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,MAAM,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,UAAU,MAAM,EAAE,YAAY,EAAE,QAAQ,EAAE,QAAQ;gBAC7H,IAAI,YAAY,KAAK,WAAW,EAAE;oBAChC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;iBAC5C;aACF,CAAC,CAAC,CAAC;SACL;IACH,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,OAAO;QACxC,IAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;QACpB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC;QACxE,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;YAC5B,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YACvC,IAAI,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC7C,IAAI,OAAO,CAAC,WAAW,CAAC,EAAE;gBACxB,WAAW,EAAE,CAAC;gBACd,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;aAC/B;SACF;IACH,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,IAAI;QACrC,IAAI,SAAS,GAAG,IAAI,CAAC;QACrB,IAAI,YAAY,GAAG,CAAC,CAAC;QACrB,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QACjC,IAAI,UAAU,CAAC;QACf,IAAI,CAAC,CAAC;QAEN,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,IAAI,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;YACtC,IAAI,gBAAgB,GAAG,UAAU,CAAC,MAAM,CAAC;YACzC,IAAI,gBAAgB,GAAG,CAAC,EAAE;gBACxB,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;oBACtB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;wBAC/B,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;qBAC/B;yBAAM;wBACL,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;qBAC9B;iBACF;gBAED,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,EAAE,CAAC,EAAE,EAAE;oBACrC,IAAI,YAAY,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;oBACjC,IAAI,kBAAkB,GAAG,YAAY,CAAC,UAAU,CAAC;oBACjD,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;oBAErD,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;wBACvB,IAAI,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE;4BACpC,kBAAkB,CAAC,IAAI,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC;yBACjD;wBACD,IAAI,OAAO,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAAE;4BACrC,kBAAkB,CAAC,KAAK,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;yBACnD;wBACD,IAAI,OAAO,CAAC,kBAAkB,CAAC,cAAc,CAAC,EAAE;4BAC9C,kBAAkB,CAAC,cAAc,CAAC,KAAK,GAAG,UAAU,CAAC,cAAc,CAAC;yBACrE;qBACF;iBACF;gBAED,IAAI,mBAAmB,CAAC;gBACxB,IAAI,OAAO,CAAC,IAAI,CAAC,uBAAuB,CAAC,EAAE;oBACzC,IAAI,OAAO,CAAC,IAAI,CAAC,yBAAyB,CAAC,EAAE;wBAC3C,IAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;qBAClH;oBACD,mBAAmB,GAAG,IAAI,IAAI,CAAC,uBAAuB,CAAC;wBACrD,QAAQ,EAAE,IAAI,CAAC,iBAAiB;wBAChC,WAAW,EAAE,IAAI,CAAC,WAAW;wBAC7B,MAAM,EAAE,IAAI,CAAC,MAAM;qBACpB,CAAC,CAAC;iBACJ;gBAED,SAAS,GAAG,IAAI,SAAS,CAAC;oBACxB,IAAI,EAAE,KAAK;oBACX,YAAY,EAAE,IAAI;oBAClB,iBAAiB,EAAE,UAAU;oBAC7B,UAAU,EAAE,IAAI,IAAI,CAAC,cAAc,CAAC;wBAClC,IAAI,EAAE,IAAI,CAAC,OAAO,KAAK,UAAU,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,KAAK,UAAU,CAAC,SAAS;wBACnF,WAAW,EAAE,IAAI,CAAC,WAAW;wBAC7B,MAAM,EAAE,IAAI,CAAC,MAAM;qBACpB,CAAC;oBACF,mBAAmB,EAAE,mBAAmB;oBACxC,OAAO,EAAE,IAAI,CAAC,OAAO;iBACtB,CAAC,CAAC;gBACH,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;gBAC1B,SAAS,GAAG,KAAK,CAAC;aACnB;iBAAM;gBACL,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;oBACtB,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;oBAC7B,SAAS,GAAG,SAAS,CAAC;iBACvB;gBACD,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;gBACrC,IAAI,OAAO,CAAC,YAAY,CAAC,EAAE;oBACzB,UAAU,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;oBAChC,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;iBAC/B;aACF;YAED,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC;YAC5B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC7B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;SAC7B;aAAM,IAAI,OAAO,CAAC,SAAS,CAAC,IAAI,SAAS,CAAC,KAAK,EAAE;YAChD,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;YACtB,IAAI,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE;gBAC9B,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBACrC,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;aAC/B;YAED,IAAI,OAAO,CAAC,IAAI,CAAC,uBAAuB,CAAC,IAAI,EAAE,IAAI,CAAC,yBAAyB,YAAY,qBAAqB,CAAC,EAAE;gBAC/G,IAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBACjH,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;aACtE;YAED,IAAI,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC;YAChE,IAAI,MAAM,GAAG,sBAAsB,CAAC,MAAM,CAAC;YAC3C,IAAI,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;YAC3C,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC3B,IAAI,OAAO,GAAG,sBAAsB,CAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;gBAE7C,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBACjD,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;oBACxB,UAAU,GAAG,SAAS,CAAC,6BAA6B,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;oBAClE,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;iBACjD;gBAED,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,UAAU,IAAI,eAAe,EAAE;oBAC/D,IAAI,aAAa,GAAG,OAAO,CAAC,oBAAoB,CAAC,KAAK,CAAC;oBACvD,IAAI,WAAW,GAAG,QAAQ,CAAC,iBAAiB,CAAC,aAAa,EAAE,IAAI,EAAE,KAAK,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;oBAC7F,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,UAAU,EAAE,WAAW,CAAC,EAAE;wBACrD,UAAU,CAAC,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE,UAAU,CAAC,UAAU,CAAC,CAAC;wBACxE,UAAU,CAAC,KAAK,GAAG,8BAA8B,CAAC,OAAO,CAAC,WAAW,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC;wBACzF,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,IAAI,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,EAAE;4BAC3G,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC,GAAG,OAAO,CAAC;yBAC9C;qBACF;iBACF;gBAED,IAAI,OAAO,CAAC,IAAI,CAAC,uBAAuB,CAAC,IAAI,OAAO,CAAC,yBAAyB,YAAY,qBAAqB,KAAK,CAAC,OAAO,CAAC,yBAAyB,CAAC,UAAU,IAAI,eAAe,CAAC,EAAE;oBACrL,IAAI,sBAAsB,GAAG,OAAO,CAAC,yBAAyB,CAAC,KAAK,CAAC;oBACrE,IAAI,UAAU,GAAG,QAAQ,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,IAAI,EAAE,KAAK,CAAC,KAAK,EAAE,YAAY,CAAC,CAAC;oBACrG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,mBAAmB,EAAE,UAAU,CAAC,EAAE;wBAC7D,UAAU,CAAC,mBAAmB,GAAG,KAAK,CAAC,KAAK,CAAC,UAAU,EAAE,UAAU,CAAC,mBAAmB,CAAC,CAAC;wBACzF,UAAU,CAAC,cAAc,GAAG,8BAA8B,CAAC,OAAO,CAAC,UAAU,EAAE,UAAU,CAAC,cAAc,CAAC,CAAC;qBAC3G;iBACF;gBAED,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,SAAS,KAAK,OAAO,CAAC,eAAe,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;gBAC3F,IAAI,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;gBAC3C,IAAI,IAAI,KAAK,WAAW,EAAE;oBACxB,UAAU,CAAC,IAAI,GAAG,6BAA6B,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;iBAChF;gBAED,IAAI,gCAAgC,GAAG,OAAO,CAAC,gCAAgC,CAAC;gBAChF,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,gCAAgC,CAAC,EAAE;oBAC1D,IAAI,wBAAwB,GAAG,QAAQ,CAAC,iBAAiB,CAAC,gCAAgC,EAAE,IAAI,EAAE,+BAA+B,EAAE,+BAA+B,CAAC,CAAC;oBACpK,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,wBAAwB,EAAE,UAAU,CAAC,6BAA6B,CAAC,EAAE;wBACxG,UAAU,CAAC,6BAA6B,GAAG,wBAAwB,CAAC,KAAK,CAAC,wBAAwB,EAAE,UAAU,CAAC,6BAA6B,CAAC,CAAC;wBAC9I,UAAU,CAAC,wBAAwB,GAAG,iDAAiD,CAAC,OAAO,CAAC,wBAAwB,EAAE,UAAU,CAAC,wBAAwB,CAAC,CAAC;qBAChK;iBACF;aACF;YAED,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YAC5B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;SAC9B;aAAM,IAAI,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;YACjD,SAAS,GAAG,KAAK,CAAC;SACnB;QACD,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,YAAY,CAAC;QACzC,OAAO,SAAS,CAAC;IACnB,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,SAAS;QAC/C,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QAC5C,IAAI,MAAM,GAAG,YAAY,CAAC,MAAM,CAAC;QACjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;YAC/B,IAAI,OAAO,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;YAE7C,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;YACrD,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;gBACxB,UAAU,GAAG,SAAS,CAAC,6BAA6B,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBAClE,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,EAAE,UAAU,CAAC,CAAC;aACjD;YAED,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC;YACpC,IAAI,WAAW,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YAC3C,IAAI,IAAI,KAAK,WAAW,EAAE;gBACxB,UAAU,CAAC,IAAI,GAAG,6BAA6B,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,CAAC;aAChF;SACF;QACD,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC;IAChC,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,OAAO;QAC1C,OAAO,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC5C,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,iBAAiB,GAAG,UAAU,OAAO,EAAE,MAAM;QAC3D,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;YACpB,OAAO,mBAAmB,CAAC,OAAO,CAAC;SACpC;QACD,IAAI,UAAU,GAAG,SAAS,CAAC,6BAA6B,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACzE,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC;aAC5D,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;YACxD,OAAO,mBAAmB,CAAC,MAAM,CAAC;SACnC;QACD,UAAU,CAAC,cAAc,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,mBAAmB,CAAC,IAAI,CAAC;IAClC,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,mBAAmB,GAAG;QACpC,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QAEjC,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;YACtB,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;YAC7B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;YAC1B,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;SAC3B;QAED,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QACrC,IAAI,OAAO,CAAC,YAAY,CAAC,EAAE;YACzB,UAAU,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YAChC,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;SAC/B;IACH,CAAC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG;QACxB,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/B,IAAI,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;QACjC,IAAI,OAAO,CAAC,SAAS,CAAC,EAAE;YACtB,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;SAC9B;QACD,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QACrC,IAAI,OAAO,CAAC,YAAY,CAAC,EAAE;YACzB,UAAU,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;SACjC;QACD,IAAI,OAAO,CAAC,IAAI,CAAC,0BAA0B,CAAC,EAAE;YAC5C,IAAI,CAAC,0BAA0B,EAAE,CAAC;SACnC;IACH,CAAC,CAAC;IAGF,IAAI,QAAQ,GAAG,KAAK,CAAC;aAEL,wBAAwB;QACtC,IAAI,QAAQ,EAAE;YACZ,OAAO;SACR;QACD,MAAM,CAAC,wBAAwB,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,IAAS,EAAE,OAAY;YAC/E,IAAI,KAAK,CAAC;YACV,IAAI,WAAW,CAAC;YAChB,IAAI,QAAQ,GAAG,OAAO,CAAC,0BAA0B,CAAC,IAAI,CAAC,CAAC;YACxD,IAAI,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;gBAC9C,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC;gBACzB,WAAW,GAAG,KAAK,CAAC;aACrB;iBAAM;gBACL,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC;gBAC/B,WAAW,GAAG,IAAI,CAAC;aACpB;YAED,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;YAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC/B,IAAI,IAAI,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBACpB,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;oBAC5B,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;oBAC5B,OAAO;iBACR;aAEF;YAED,IAAI,KAAK,GAAQ,IAAI,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,WAAW,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,wBAAwB,EAAE,OAAO,CAAC,yBAAyB,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC/K,KAAK,CAAC,GAAG,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YAC7B,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACnB,CAAC;QACF,QAAQ,GAAG,IAAI,CAAC;IAClB;;QClWa,qBAAqB,GAAG,IAAIC,mBAAc,CAAC,uBAAuB,EAAE;;QAI/E,8BAA+D,MAAW;YAAX,WAAM,GAAN,MAAM,CAAK;YACxE,IAAM,kBAAkB,GAAG,MAAM,GAAG,MAAM,CAAC,kBAAkB,GAAG,IAAI,CAAC;YACrE,IAAI,kBAAkB,KAAK,KAAK,EAAE;gBAChC,wBAAwB,EAAE,CAAC;aAC5B;SACF;;;;gBAPFH,eAAU;;;gDAEIE,aAAQ,YAAIE,WAAM,SAAC,qBAAqB;;;ICPvD;;;IAGA,WAAY,SAAS;QACnB,+CAAO,CAAA;QACP,2DAAa,CAAA;QACb,+CAAO,CAAA;QACP,uEAAmB,CAAA;IACrB,CAAC,EALWC,iBAAS,KAATA,iBAAS;;ICCrB;;;;;;QAmBE;YAFQ,6BAAwB,GAAG,KAAK,CAAC;SAGxC;QAED,4BAAI,GAAJ,UAAK,aAA4B;YAC/B,IAAI,CAAC,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC;YACxC,IAAI,CAAC,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACtC,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC;YAC1E,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;YAChC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,2BAA2B,CAAC,YAAY,CAAC;YAChE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,CAAC;YAC5D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,CAAC;SAC7D;QAED,+CAAuB,GAAvB,UAAwB,QAAkB;YACxC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,gBAAgB,CACjE,QAAQ,CACT,CAAC;SACH;QAED,+CAAuB,GAAvB;YACE,IAAI,CAAC,wBAAwB,GAAG,KAAK,CAAC;YACtC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACnC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAChC;;;;QAKD,iCAAS,GAAT;YACE,OAAO,IAAI,CAAC,MAAM,CAAC;SACpB;;;;QAKD,sDAA8B,GAA9B;YACE,OAAO,IAAI,CAAC,2BAA2B,CAAC;SACzC;;;;QAKD,sCAAc,GAAd;YACE,OAAO,IAAI,CAAC,2BAA2B,CAAC,mBAAmB,CAAC;SAC7D;;;;;QAMD,sCAAc,GAAd,UAAe,MAAc;YAC3B,IAAI,CAAC,2BAA2B,CAAC,mBAAmB,GAAG,MAAM,CAAC;SAC/D;;;;QAKD,sCAAc,GAAd;YACE,OAAO,IAAI,CAAC,2BAA2B,CAAC,mBAAmB,CAAC;SAC7D;;;;;QAMD,sCAAc,GAAd,UAAe,MAAc;YAC3B,IAAI,CAAC,2BAA2B,CAAC,mBAAmB,GAAG,MAAM,CAAC;SAC/D;;;;QAKD,kCAAU,GAAV,UAAW,IAAa;YACtB,IAAI,CAAC,2BAA2B,CAAC,UAAU,GAAG,IAAI,CAAC;SACpD;;;;QAKD,oCAAY,GAAZ,UAAa,MAAe;YAC1B,IAAI,CAAC,2BAA2B,CAAC,YAAY,GAAG,MAAM,CAAC;SACxD;;;;QAKD,kCAAU,GAAV,UAAW,IAAa;YACtB,IAAI,CAAC,2BAA2B,CAAC,UAAU,GAAG,IAAI,CAAC;SACpD;;;;QAKD,uCAAe,GAAf,UAAgB,SAAkB;YAChC,IAAI,CAAC,2BAA2B,CAAC,eAAe,GAAG,SAAS,CAAC;SAC9D;;;;QAKD,kCAAU,GAAV,UAAW,IAAa;YACtB,IAAI,CAAC,2BAA2B,CAAC,UAAU,GAAG,IAAI,CAAC;SACpD;;;;QAKD,oCAAY,GAAZ,UAAa,MAAe;YAC1B,IAAI,CAAC,2BAA2B,CAAC,YAAY,GAAG,MAAM,CAAC;SACxD;;;;;;QAOD,oCAAY,GAAZ,UAAa,SAAoB,EAAE,QAAiB;YAApD,iBAiEC;YAhEC,QAAQ,SAAS;gBACf,KAAKA,iBAAS,CAAC,OAAO,EAAE;oBACtB,IAAI,IAAI,CAAC,wBAAwB,EAAE;wBACjC,IAAI,CAAC,uBAAuB,EAAE,CAAC;qBAChC;oBAED,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;oBAE/B,MAAM;iBACP;gBACD,KAAKA,iBAAS,CAAC,aAAa,EAAE;oBAC5B,IAAI,IAAI,CAAC,wBAAwB,EAAE;wBACjC,IAAI,CAAC,uBAAuB,EAAE,CAAC;qBAChC;oBAED,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;oBAEzC,MAAM;iBACP;gBACD,KAAKA,iBAAS,CAAC,OAAO,EAAE;oBACtB,IAAI,IAAI,CAAC,wBAAwB,EAAE;wBACjC,IAAI,CAAC,uBAAuB,EAAE,CAAC;qBAChC;oBACD,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;oBAE/B,MAAM;iBACP;gBACD,KAAKA,iBAAS,CAAC,mBAAmB,EAAE;oBAClC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;oBACrC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,CAAC;oBAC5D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,2BAA2B,CAAC,UAAU,CAAC;oBAC5D,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,2BAA2B,CAAC,YAAY,CAAC;oBAChE,IAAI,CAAC,2BAA2B,CAAC,UAAU,GAAG,KAAK,CAAC;oBACpD,IAAI,CAAC,2BAA2B,CAAC,YAAY,GAAG,KAAK,CAAC;oBACtD,IAAI,CAAC,2BAA2B,CAAC,UAAU,GAAG,KAAK,CAAC;oBACpD,IAAI,IAAI,CAAC,qBAAqB,EAAE;wBAC9B,IAAI,CAAC,qBAAqB,EAAE,CAAC;qBAC9B;oBACD,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;oBACzC,IAAM,4BAA0B,GAAG,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,gBAAgB,CAC1E;wBACE,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC;4BAClB,WAAW,EAAE,MAAM,CAAC,UAAU,CAAC,WAAW,CACxC,GAAG,EACH,GAAG,EACH,IAAI,CAAC,GAAG,CACN,aAAa,CAAC,uBAAuB,EACrC,KAAI,CAAC,cAAc,EAAE,CACtB,CACF;4BACD,WAAW,EAAE;gCACX,KAAK,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC;6BAClC;yBACF,CAAC,CAAC;wBACH,4BAA0B,EAAE,CAAC;wBAC7B,KAAI,CAAC,uBAAuB,CAC1B,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,KAAI,CAAC,CACxC,CAAC;qBACH,CACF,CAAC;oBAEF,MAAM;iBACP;aACF;SACF;;;;;QAMD,mCAAW,GAAX,UAAY,OAAY;YACtB,IAAI,OAAO,EAAE;gBACX,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;aACnC;SACF;;;;;;QAOD,6BAAK,GAAL,UAAM,MAAW,EAAE,OAAa;YAC9B,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;SAC3C;;;;;QAMD,8BAAM,GAAN,UAAO,MAAc;YACnB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;SACpE;;;;;QAMD,+BAAO,GAAP,UAAQ,MAAc;YACpB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC;SACrE;;;;;;QAOD,8BAAM,GAAN,UAAO,MAAW,EAAE,MAAY;YAC9B,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;SAC3C;;;;;;QAOD,+BAAO,GAAP,UAAQ,OAAY;YAClB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SAC9B;;;;QAKD,mCAAW,GAAX,UAAY,gBAAwB;YAClC,IAAI,CAAC,OAAO,CAAC,EAAC,WAAW,EAAE,EAAC,OAAO,EAAE,gBAAgB,EAAC,EAAC,CAAC,CAAC;SAC1D;;;;QAKD,oCAAY,GAAZ,UAAa,IAAa;YACxB,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,YAAY,GAAG,CAAC,IAAI,CAAC;SAC7D;;;;;;;QAQD,mCAAW,GAAX,UACE,YAAkB,EAClB,OAAuE;YAFzE,iBA2CC;YAvCC,IAAM,KAAK,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,KAAK,KAAK,KAAK,CAAC;YAElD,IAAI,CAAC,MAAM,CAAC,aAAa,GAAG,SAAS,CAAC;YACtC,OAAO,IAAI,OAAO,CAAO,UAAA,OAAO;gBAC9B,IAAI,KAAK,EAAE;oBACT,IAAM,aAAa,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,aAAa,KAAK,CAAC,CAAC;oBAC9D,IAAM,QAAQ,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,QAAQ,KAAK,KAAK,CAAC;;oBAGxD,IAAM,UAAU,GAAG,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC;oBAC3E,IAAM,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;oBACjE,IAAM,YAAU,GAAG,QAAQ,GAAG,UAAU,CAAC,MAAM,CAAC;oBAChD,UAAU,CAAC,MAAM,GAAG,QAAQ,CAAC;oBAC7B,IAAM,aAAa,GAAG,MAAM,CAAC,UAAU,CAAC,WAAW,CACjD,UAAU,CAAC,SAAS,EACpB,UAAU,CAAC,QAAQ,EACnB,UAAU,CAAC,MAAM,CAClB,CAAC;oBAEF,KAAI,CAAC,WAAW,CAAC;wBACf,QAAQ,EAAE,aAAa;wBACvB,WAAW,EAAE,aAAa;wBAC1B,QAAQ,EAAE;4BACR,KAAI,CAAC,MAAM,CAAC,aAAa,GAAG,YAAY,CAAC;4BACzC,UAAU,CAAC;gCACT,IAAI,YAAU,GAAG,CAAC,EAAE;oCAClB,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,YAAU,CAAC,CAAC;iCACjC;qCAAM;oCACL,KAAI,CAAC,MAAM,CAAC,MAAM,CAAC,YAAU,CAAC,CAAC;iCAChC;6BACF,EAAE,CAAC,CAAC,CAAC;4BACN,OAAO,EAAE,CAAC;yBACX;qBACF,CAAC,CAAC;iBACJ;qBAAM;oBACL,KAAI,CAAC,MAAM,CAAC,aAAa,GAAG,YAAY,CAAC;oBACzC,OAAO,EAAE,CAAC;iBACX;aACF,CAAC,CAAC;SACJ;QAED,qCAAa,GAAb;YACE,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;;;IA5TM,qCAAuB,GAAG,QAAQ,CAAC;;gBAF3CL,eAAU;;;;ICTX;;;IAGA,WAAY,WAAW;QACrB,wCAAa,MAAM,CAAC,oBAAoB,CAAC,UAAU,gBAAA,CAAA;QACnD,wCAAa,MAAM,CAAC,oBAAoB,CAAC,UAAU,gBAAA,CAAA;QACnD,+CAAoB,MAAM,CAAC,oBAAoB,CAAC,iBAAiB,uBAAA,CAAA;QACjE,uCAAY,MAAM,CAAC,oBAAoB,CAAC,SAAS,eAAA,CAAA;QACjD,qCAAU,MAAM,CAAC,oBAAoB,CAAC,OAAO,aAAA,CAAA;QAC7C,0CAAe,MAAM,CAAC,oBAAoB,CAAC,YAAY,kBAAA,CAAA;QACvD,iDAAsB,MAAM,CAAC,oBAAoB,CAAC,mBAAmB,yBAAA,CAAA;QACrE,yCAAc,MAAM,CAAC,oBAAoB,CAAC,WAAW,iBAAA,CAAA;QACrD,uCAAY,MAAM,CAAC,oBAAoB,CAAC,SAAS,eAAA,CAAA;QACjD,yCAAc,MAAM,CAAC,oBAAoB,CAAC,WAAW,iBAAA,CAAA;QACrD,uCAAY,MAAM,CAAC,oBAAoB,CAAC,SAAS,eAAA,CAAA;QACjD,wCAAa,MAAM,CAAC,oBAAoB,CAAC,UAAU,gBAAA,CAAA;QACnD,yCAAc,MAAM,CAAC,oBAAoB,CAAC,WAAW,iBAAA,CAAA;QACrD,gDAAqB,MAAM,CAAC,oBAAoB,CAAC,kBAAkB,wBAAA,CAAA;QACnE,wCAAa,MAAM,CAAC,oBAAoB,CAAC,UAAU,gBAAA,CAAA;QACnD,sCAAW,MAAM,CAAC,oBAAoB,CAAC,QAAQ,cAAA,CAAA;QAC/C,mCAAQ,MAAM,CAAC,oBAAoB,CAAC,KAAK,WAAA,CAAA;QACzC,qEAAqB,CAAA;QACrB,uEAAgB,CAAA;QAChB,yEAAiB,CAAA;QACjB,qEAAe,CAAA;QACf,uEAAgB,CAAA;QAChB,yEAAiB,CAAA;IACnB,CAAC,EAxBWM,mBAAW,KAAXA,mBAAW;;ICHvB;;;;;;IAMA,WAAY,WAAW;QACrB,mDAAO,CAAA;QACP,yDAAU,CAAA;QACV,qDAAQ,CAAA;QACR,qDAAQ,CAAA;IACV,CAAC,EALWC,mBAAW,KAAXA,mBAAW;;ICKvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QA6BA;YAEU,qBAAgB,GAAG,KAAK,CAAC;YAOzB,+BAA0B,GAAG,IAAIC,iBAAY,EAAE,CAAC;YAChD,YAAO,GAAG,IAAIA,iBAAY,EAAE,CAAC;YAC7B,aAAQ,GAAG,IAAIA,iBAAY,EAAE,CAAC;YAC9B,+BAA0B,GAAuB;gBACvD,gBAAgB,EAAE,IAAI;gBACtB,wBAAwB,EAAE,EAAE;aAC7B,CAAC;SA0EH;QAxEC,sBAAI,yDAAyB;iBAA7B;gBACE,OAAO,IAAI,CAAC,0BAA0B,CAAC;aACxC;;;WAAA;QAED,sBAAI,+CAAe;iBAAnB;gBACE,OAAO,IAAI,CAAC,gBAAgB,CAAC;aAC9B;;;WAAA;QAED,sBAAI,uCAAO;iBAAX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;;;WAAA;QAED,sBAAI,wCAAQ;iBAAZ;gBACE,OAAO,IAAI,CAAC,SAAS,CAAC;aACvB;;;WAAA;QAED,sBAAI,uCAAO;iBAAX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;;;WAAA;QAED,sBAAI,sCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;;;WAAA;QAED,sBAAI,uCAAO;iBAAX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;;;WAAA;QAGD,iCAAI,GAAJ,UAAK,gBAAyC;YAC5C,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;SAC1C;QAED,iCAAI,GAAJ,UAAQ,gBAAqB,EAAE,QAAoB,EAAE,OAAmC;YAAxF,iBAoBC;YApBoD,wBAAA,EAAA,YAAmC;YACtF,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,IAAI,CAAC,QAAQ,GAAG,gBAAgB,CAAC;YACjC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;YAC1B,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,0BAA0B,EAAE,OAAO,CAAC,CAAC;YAC5E,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;YAC7B,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,QAAQ,CAAC,gBAAgB,EAAE;gBAC3D,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBAC1D,KAAK,EAAEF,mBAAW,CAAC,UAAU;oBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;oBACzB,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,wBAAwB;iBACjD,CAAC,CAAC;gBACH,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC;oBAChE,KAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;oBACzC,KAAI,CAAC,KAAK,EAAE,CAAC;iBACd,CAAC,CAAC;aACJ;YAED,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC;YACvC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;SACrB;QAED,kCAAK,GAAL;YACE,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;YAC1B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;YAC1B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;YAC9B,IAAI,IAAI,CAAC,qBAAqB,EAAE;gBAC9B,IAAI,CAAC,qBAAqB,CAAC,OAAO,EAAE,CAAC;gBACrC,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;aACxC;YACD,IAAI,IAAI,CAAC,qBAAqB,EAAE;gBAC9B,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;gBACzC,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;aACxC;YAED,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,CAAC;YACvC,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;SACtB;;;;gBAxFFP,eAAU;;;IClCX,IAAM,aAAa,GAAGS,qBAAwB,CAAC;IAE/C,MAAM,CAAC,SAAS,CAAC,GAAGC,kBAAO,CAAC;IAE5B;;;;;;;;;;;;;;;;;;;;;;;;;;QA2BE,6BAAgC,aAA6B;YAA7B,kBAAa,GAAb,aAAa,CAAgB;SAC5D;QAEM,sCAAkB,GAAzB,UAA0B,UAAsB,EAAE,SAAe;YAC/D,IAAM,IAAI,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;YACtE,OAAO;gBACL,GAAG,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC;gBAC1C,GAAG,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC;gBACzC,MAAM,EAAE,IAAI,CAAC,MAAM;aACpB,CAAC;SACH;QAED,gDAAkB,GAAlB,UAAmB,SAAmC,EAAE,uBAAiC;YACvF,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,MAAM,IAAI,KAAK,CAAC,8DAA8D;oBAC5E,qCAAqC,CAAC,CAAC;aAC1C;iBAAM;gBACL,IAAM,cAAc,qBAAQ,SAAS,CAAE,CAAC;gBACxC,IAAI,uBAAuB,EAAE;oBAC3B,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC,qBAAqB,EAAE,CAAC;oBAChF,cAAc,CAAC,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC;oBACnC,cAAc,CAAC,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC;iBACnC;gBAED,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;gBACrD,OAAO,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;aAC7C;SACF;QAED,kDAAoB,GAApB,UAAqB,SAAmC,EAAE,SAAe;YACvE,OAAO,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,EAAE,SAAS,CAAC,CAAC;SACrF;QAED,sDAAwB,GAAxB,UAAyB,SAAqB,EAAE,SAAe;YAC7D,OAAO,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;SAChE;QAED,mDAAqB,GAArB,UAAsB,SAAiB,EAAE,QAAgB,EAAE,MAAe;YACxE,OAAO,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,SAAS,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;SACrE;QAED,mDAAqB,GAArB,UAAsB,SAAiB,EAAE,QAAgB,EAAE,MAAe;YACxE,OAAO,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,SAAS,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;SACrE;QAED,0CAAY,GAAZ,UAAa,SAAiB,EAAE,QAAgB;YAC9C,OAAO,IAAIC,yBAAiB,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,KAAK,EAAE,CAAC;SAC3D;QAED,0CAAY,GAAZ,UAAa,IAAY,EAAE,cAA0B,EAAE,OAAe,EAAE,QAAgB;YACtF,OAAO,IAAI,CAAC,qBAAqB,CAAC,IAAIC,WAAG,CAAC,IAAI,EAAE,cAAc,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC,SAAS,EAAE,CAAC,CAAC;SACjG;QAEO,mDAAqB,GAArB,UAAsB,cAAsB;YAClD,OAAO;gBACL,SAAS,EAAE,cAAc,CAAC,GAAG;gBAC7B,QAAQ,EAAE,cAAc,CAAC,GAAG;gBAC5B,MAAM,EAAE,cAAc,CAAC,QAAQ,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC,GAAG,CAAC;aAChE,CAAC;SACH;;;;;;QAOD,kDAAoB,GAApB,UAAqB,KAA8C,EAAE,MAA+C;YAClH,IAAM,KAAK,GAAG,UAAC,GAAW,IAAK,OAAA,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAA,CAAC;YAC1D,IAAM,UAAU,GAAG,IAAI,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;YACpF,IAAM,WAAW,GAAG,IAAI,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YACvF,IAAM,WAAW,GAAQ,UAAU,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;YAE5D,OAAO,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,WAAW,CAAC,GAAG,EAAE,WAAW,CAAC,GAAG,CAAC,CAAC;SACxE;QAED,iDAAmB,GAAnB,UAAoB,SAAqB,EAAE,SAAqB;YAC9D,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;YAC5C,IAAM,eAAe,GAAG,MAAM,CAAC,eAAe,CAAC,wBAAwB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;YAC1F,IAAM,eAAe,GAAG,MAAM,CAAC,eAAe,CAAC,wBAAwB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;YAC1F,IAAM,iBAAiB,GACrB,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,eAAe,CAAC,CAAC,GAAG,eAAe,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC,eAAe,CAAC,CAAC,GAAG,eAAe,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC;YACtH,OAAO,KAAK,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAC;SAC9C;;;;;;;;QASD,uCAAS,GAAT,UAAU,KAA8C,EAAE,MAA+C;YACvG,IAAM,KAAK,GAAG,UAAC,GAAW,IAAK,OAAA,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAA,CAAC;YAC1D,IAAM,UAAU,GAAG,IAAI,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;YACpF,IAAM,WAAW,GAAG,IAAI,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YACvF,IAAM,OAAO,GAAG,UAAU,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;YAElD,OAAO,OAAO,CAAC;SAChB;;;;;;QAOD,gDAAkB,GAAlB,UAAmB,eAA2B,EAAE,gBAA4B;YAC1E,IAAM,SAAS,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;YACrE,IAAM,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;YAEvE,OAAO,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC;SAC9C;;;;gBAhHFZ,eAAU;;;gBAlCF,aAAa,uBAoCPE,aAAQ;;;ICrCvB;;;;;;;;;;;;;;IAcA;IAEA,IAAI,aAAa,GAAG,UAAS,CAAC,EAAE,CAAC;QAC7B,aAAa,GAAG,MAAM,CAAC,cAAc;aAChC,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,KAAK,IAAI,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC;YAC5E,UAAU,CAAC,EAAE,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC;gBAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;oBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QACtG,OAAO,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAC/B,CAAC,CAAC;aAEc,SAAS,CAAC,CAAC,EAAE,CAAC;QAC1B,IAAI,OAAO,CAAC,KAAK,UAAU,IAAI,CAAC,KAAK,IAAI;YACrC,MAAM,IAAI,SAAS,CAAC,sBAAsB,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,+BAA+B,CAAC,CAAC;QAC9F,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACpB,SAAS,EAAE,KAAK,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;QACvC,CAAC,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;IACzF,CAAC;IAEM,IAAI,QAAQ,GAAG;QAClB,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC;YAC3C,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBACjD,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;gBACjB,KAAK,IAAI,CAAC,IAAI,CAAC;oBAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;wBAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAChF;YACD,OAAO,CAAC,CAAC;SACZ,CAAA;QACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC3C,CAAC,CAAA;aAEe,MAAM,CAAC,CAAC,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,EAAE,CAAC;QACX,KAAK,IAAI,CAAC,IAAI,CAAC;YAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC;gBAC/E,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAChB,IAAI,CAAC,IAAI,IAAI,IAAI,OAAO,MAAM,CAAC,qBAAqB,KAAK,UAAU;YAC/D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACpE,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,SAAS,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC1E,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACzB;QACL,OAAO,CAAC,CAAC;IACb,CAAC;aAEe,UAAU,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI;QACpD,IAAI,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,IAAI,KAAK,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC;QAC7H,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU;YAAE,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,UAAU,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;YAC1H,KAAK,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;gBAAE,IAAI,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC;oBAAE,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC;QAClJ,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;IAClE,CAAC;aAEe,OAAO,CAAC,UAAU,EAAE,SAAS;QACzC,OAAO,UAAU,MAAM,EAAE,GAAG,IAAI,SAAS,CAAC,MAAM,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC,EAAE,CAAA;IACzE,CAAC;aAEe,UAAU,CAAC,WAAW,EAAE,aAAa;QACjD,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,QAAQ,KAAK,UAAU;YAAE,OAAO,OAAO,CAAC,QAAQ,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;IACnI,CAAC;aAEe,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,CAAC,EAAE,SAAS;QACvD,SAAS,KAAK,CAAC,KAAK,IAAI,OAAO,KAAK,YAAY,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,UAAU,OAAO,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;QAC5G,OAAO,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,UAAU,OAAO,EAAE,MAAM;YACrD,SAAS,SAAS,CAAC,KAAK,IAAI,IAAI;gBAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;aAAE;YAAC,OAAO,CAAC,EAAE;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC;aAAE,EAAE;YAC3F,SAAS,QAAQ,CAAC,KAAK,IAAI,IAAI;gBAAE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aAAE;YAAC,OAAO,CAAC,EAAE;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC;aAAE,EAAE;YAC9F,SAAS,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,EAAE;YAC9G,IAAI,CAAC,CAAC,SAAS,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;SACzE,CAAC,CAAC;IACP,CAAC;aAEe,WAAW,CAAC,OAAO,EAAE,IAAI;QACrC,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,cAAa,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;gBAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACjH,OAAO,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,OAAO,MAAM,KAAK,UAAU,KAAK,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,cAAa,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QACzJ,SAAS,IAAI,CAAC,CAAC,IAAI,OAAO,UAAU,CAAC,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE;QAClE,SAAS,IAAI,CAAC,EAAE;YACZ,IAAI,CAAC;gBAAE,MAAM,IAAI,SAAS,CAAC,iCAAiC,CAAC,CAAC;YAC9D,OAAO,CAAC;gBAAE,IAAI;oBACV,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI;wBAAE,OAAO,CAAC,CAAC;oBAC7J,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC;wBAAE,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;oBACxC,QAAQ,EAAE,CAAC,CAAC,CAAC;wBACT,KAAK,CAAC,CAAC;wBAAC,KAAK,CAAC;4BAAE,CAAC,GAAG,EAAE,CAAC;4BAAC,MAAM;wBAC9B,KAAK,CAAC;4BAAE,CAAC,CAAC,KAAK,EAAE,CAAC;4BAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;wBACxD,KAAK,CAAC;4BAAE,CAAC,CAAC,KAAK,EAAE,CAAC;4BAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;4BAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;4BAAC,SAAS;wBACjD,KAAK,CAAC;4BAAE,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;4BAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,SAAS;wBACjD;4BACI,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;gCAAE,CAAC,GAAG,CAAC,CAAC;gCAAC,SAAS;6BAAE;4BAC5G,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;gCAAC,MAAM;6BAAE;4BACtF,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gCAAC,CAAC,GAAG,EAAE,CAAC;gCAAC,MAAM;6BAAE;4BACrE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;gCAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gCAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gCAAC,MAAM;6BAAE;4BACnE,IAAI,CAAC,CAAC,CAAC,CAAC;gCAAE,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;4BACtB,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;4BAAC,SAAS;qBAC9B;oBACD,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;iBAC9B;gBAAC,OAAO,CAAC,EAAE;oBAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAAC,CAAC,GAAG,CAAC,CAAC;iBAAE;wBAAS;oBAAE,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;iBAAE;YAC1D,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;gBAAE,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;YAAC,OAAO,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;SACpF;IACL,CAAC;IAEM,IAAI,eAAe,GAAG,MAAM,CAAC,MAAM,IAAI,UAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;QAC9D,IAAI,EAAE,KAAK,SAAS;YAAE,EAAE,GAAG,CAAC,CAAC;QAC7B,MAAM,CAAC,cAAc,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,cAAa,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IACzF,CAAC,KAAK,UAAS,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE;QACtB,IAAI,EAAE,KAAK,SAAS;YAAE,EAAE,GAAG,CAAC,CAAC;QAC7B,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IACjB,CAAC,CAAC,CAAC;aAEa,YAAY,CAAC,CAAC,EAAE,CAAC;QAC7B,KAAK,IAAI,CAAC,IAAI,CAAC;YAAE,IAAI,CAAC,KAAK,SAAS,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;gBAAE,eAAe,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAClH,CAAC;aAEe,QAAQ,CAAC,CAAC;QACtB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,MAAM,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;QAC9E,IAAI,CAAC;YAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACxB,IAAI,CAAC,IAAI,OAAO,CAAC,CAAC,MAAM,KAAK,QAAQ;YAAE,OAAO;gBAC1C,IAAI,EAAE;oBACF,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM;wBAAE,CAAC,GAAG,KAAK,CAAC,CAAC;oBACnC,OAAO,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC;iBAC3C;aACJ,CAAC;QACF,MAAM,IAAI,SAAS,CAAC,CAAC,GAAG,yBAAyB,GAAG,iCAAiC,CAAC,CAAC;IAC3F,CAAC;aAEe,MAAM,CAAC,CAAC,EAAE,CAAC;QACvB,IAAI,CAAC,GAAG,OAAO,MAAM,KAAK,UAAU,IAAI,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC3D,IAAI,CAAC,CAAC;YAAE,OAAO,CAAC,CAAC;QACjB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;QACjC,IAAI;YACA,OAAO,CAAC,CAAC,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,IAAI;gBAAE,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;SAC9E;QACD,OAAO,KAAK,EAAE;YAAE,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;SAAE;gBAC/B;YACJ,IAAI;gBACA,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,CAAC;oBAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aACpD;oBACO;gBAAE,IAAI,CAAC;oBAAE,MAAM,CAAC,CAAC,KAAK,CAAC;aAAE;SACpC;QACD,OAAO,EAAE,CAAC;IACd,CAAC;IAED;aACgB,QAAQ;QACpB,KAAK,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE;YAC9C,EAAE,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzC,OAAO,EAAE,CAAC;IACd,CAAC;IAED;aACgB,cAAc;QAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE;YAAE,CAAC,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QACpF,KAAK,IAAI,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE;YAC5C,KAAK,IAAI,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,EAAE;gBAC7D,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACpB,OAAO,CAAC,CAAC;IACb,CAAC;aAEe,aAAa,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI;QACxC,IAAI,IAAI,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC;YAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;gBACjF,IAAI,EAAE,IAAI,EAAE,CAAC,IAAI,IAAI,CAAC,EAAE;oBACpB,IAAI,CAAC,EAAE;wBAAE,EAAE,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;oBACrD,EAAE,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;iBACnB;aACJ;QACD,OAAO,EAAE,CAAC,MAAM,CAAC,EAAE,IAAI,IAAI,CAAC,CAAC;IACjC,CAAC;aAEe,OAAO,CAAC,CAAC;QACrB,OAAO,IAAI,YAAY,OAAO,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,IAAI,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC;IACzE,CAAC;aAEe,gBAAgB,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS;QAC3D,IAAI,CAAC,MAAM,CAAC,aAAa;YAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;QACvF,IAAI,CAAC,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;QAC9D,OAAO,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;QACtH,SAAS,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC;YAAE,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;QAC1I,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,IAAI;YAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SAAE;QAAC,OAAO,CAAC,EAAE;YAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAAE,EAAE;QAClF,SAAS,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,YAAY,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;QACxH,SAAS,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC,EAAE;QAClD,SAAS,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,EAAE;QAClD,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,MAAM;YAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACtF,CAAC;aAEe,gBAAgB,CAAC,CAAC;QAC9B,IAAI,CAAC,EAAE,CAAC,CAAC;QACT,OAAO,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;QAC5I,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC,IAAI,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,KAAK,QAAQ,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE;IACnJ,CAAC;aAEe,aAAa,CAAC,CAAC;QAC3B,IAAI,CAAC,MAAM,CAAC,aAAa;YAAE,MAAM,IAAI,SAAS,CAAC,sCAAsC,CAAC,CAAC;QACvF,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACnC,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,OAAO,QAAQ,KAAK,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,GAAG,EAAE,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,cAAc,OAAO,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QACjN,SAAS,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE;QAChK,SAAS,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,UAAS,CAAC,IAAI,OAAO,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,EAAE;IAChI,CAAC;aAEe,oBAAoB,CAAC,MAAM,EAAE,GAAG;QAC5C,IAAI,MAAM,CAAC,cAAc,EAAE;YAAE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC;SAAE;aAAM;YAAE,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC;SAAE;QAC/G,OAAO,MAAM,CAAC;IAClB,CAAC;IAAA,CAAC;IAEF,IAAI,kBAAkB,GAAG,MAAM,CAAC,MAAM,IAAI,UAAS,CAAC,EAAE,CAAC;QACnD,MAAM,CAAC,cAAc,CAAC,CAAC,EAAE,SAAS,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;IACxE,CAAC,IAAI,UAAS,CAAC,EAAE,CAAC;QACd,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC,CAAC;aAEc,YAAY,CAAC,GAAG;QAC5B,IAAI,GAAG,IAAI,GAAG,CAAC,UAAU;YAAE,OAAO,GAAG,CAAC;QACtC,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,GAAG,IAAI,IAAI;YAAE,KAAK,IAAI,CAAC,IAAI,GAAG;gBAAE,IAAI,CAAC,KAAK,SAAS,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;oBAAE,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;QACzI,kBAAkB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QAChC,OAAO,MAAM,CAAC;IAClB,CAAC;aAEe,eAAe,CAAC,GAAG;QAC/B,OAAO,CAAC,GAAG,IAAI,GAAG,CAAC,UAAU,IAAI,GAAG,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC;IAC5D,CAAC;aAEe,sBAAsB,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAC3D,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC;YAAE,MAAM,IAAI,SAAS,CAAC,+CAA+C,CAAC,CAAC;QAC7F,IAAI,OAAO,KAAK,KAAK,UAAU,GAAG,QAAQ,KAAK,KAAK,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC;YAAE,MAAM,IAAI,SAAS,CAAC,0EAA0E,CAAC,CAAC;QACnL,OAAO,IAAI,KAAK,GAAG,GAAG,CAAC,GAAG,IAAI,KAAK,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAClG,CAAC;aAEe,sBAAsB,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;QAClE,IAAI,IAAI,KAAK,GAAG;YAAE,MAAM,IAAI,SAAS,CAAC,gCAAgC,CAAC,CAAC;QACxE,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC;YAAE,MAAM,IAAI,SAAS,CAAC,+CAA+C,CAAC,CAAC;QAC7F,IAAI,OAAO,KAAK,KAAK,UAAU,GAAG,QAAQ,KAAK,KAAK,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC;YAAE,MAAM,IAAI,SAAS,CAAC,yEAAyE,CAAC,CAAC;QAClL,OAAO,CAAC,IAAI,KAAK,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,GAAG,KAAK,CAAC;IAC9G;;IC9OA;;;;QAOE;SACC;QAcD,6CAAgB,GAAhB,UAAiB,QAAkB;YACjC,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;SAChC;iCACF;KAAA;;ICtBD;;;;;QAIsD,2CAAkB;QAMtE,iCAAoB,UAAe,EAAU,aAA4B;YAAzE,YACE,iBAAO,SACR;YAFmB,gBAAU,GAAV,UAAU,CAAK;YAAU,mBAAa,GAAb,aAAa,CAAe;YALjE,WAAK,GAAG,IAAI,CAAC;;SAOpB;QAED,sCAAI,GAAJ;YACE,IAAI,CAAC,iBAAiB,GAAG,IAAI,IAAI,CAAC,UAAU,EAAE,CAAC;YAC/C,IAAI,CAAC,wBAAwB,GAAG,IAAI,MAAM,CAAC,mBAAmB,CAAC,EAAC,iBAAiB,EAAE,KAAK,EAAC,CAAC,CAAC;YAC3F,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC1D,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;SAC7E;QAED,qCAAG,GAAH,UAAI,WAAgB;YAAE,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,6BAAc;;YAClC,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SAChD;QAED,wCAAM,GAAN,UAAO,MAAW,EAAE,WAAgB;YAAE,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,6BAAc;;YAClD,IAAI,IAAI,CAAC,cAAc,EAAE;gBACvB,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;aAC1C;iBAAM;gBACL,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;aACpC;SACF;QAED,wCAAM,GAAN,UAAO,MAAW;YAChB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACvC;QAED,2CAAS,GAAT;YACE,IAAI,CAAC,iBAAiB,CAAC,SAAS,EAAE,CAAC;SACpC;QAED,yCAAO,GAAP,UAAQ,SAAkB;YACxB,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;YACvB,IAAI,CAAC,wBAAwB,CAAC,IAAI,GAAG,SAAS,CAAC;SAChD;QAED,yCAAO,GAAP;YACE,OAAO,IAAI,CAAC,KAAK,CAAC;SACnB;sCACF;KA7CD,CAAsD,kBAAkB;;;QCwFtE,yBAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;SAC/C;QAzFM,iDAAiC,GAAxC,UAAyC,eAAoB,EAAE,aAAqB,EAAE,aAAqB,EAAE,UAAW;YACtH,IAAM,QAAQ,GAAG,aAAa,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,aAAa,CAAC;YACtE,IAAM,oBAAoB,GACxB,eAAe,YAAY,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,eAAe,CAAC,GAAG,eAAe,CAAC;YACtH,IAAM,iBAAiB,GACrB,eAAe,YAAY,MAAM,CAAC,UAAU;kBACxC,eAAe;kBACf,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,eAAe,CAAC,SAAS,EAAE,eAAe,CAAC,QAAQ,EAAE,eAAe,CAAC,MAAM,CAAC,CAAC;YAEjH,IAAI,cAAc,CAAC;YACnB,IAAI,cAAc,CAAC;YACnB,IAAI,OAAO,GAAG,CAAC,CAAC;YAChB,IAAI,sBAAsB,GAAG,GAAG,CAAC;YACjC,IAAI,sBAAsB,GAAG,CAAC,GAAG,CAAC;YAClC,OACE,OAAO,KAAK,CAAC;iBACZ,OAAO,GAAG,EAAE,IAAI,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,aAAa,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,EAC5G;gBACF,IAAM,MAAM,GAAG,sBAAsB,GAAG,CAAC,sBAAsB,GAAG,sBAAsB,IAAI,CAAC,CAAC;gBAC9F,cAAc,GAAG,eAAe,CAAC,kCAAkC,CAAC,oBAAoB,EAAE,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;gBAClI,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,iBAAiB,EAAE,cAAc,CAAC,CAAC;gBAElE,IAAI,cAAc,GAAG,aAAa,EAAE;oBAClC,sBAAsB,GAAG,sBAAsB,GAAG,CAAC,sBAAsB,GAAG,sBAAsB,IAAI,CAAC,CAAC;iBACzG;qBAAM;oBACL,sBAAsB,GAAG,sBAAsB,GAAG,CAAC,sBAAsB,GAAG,sBAAsB,IAAI,CAAC,CAAC;iBACzG;gBACD,OAAO,EAAE,CAAC;aACX;YAED,OAAO,cAAc,CAAC;SACvB;QAEM,kDAAkC,GAAzC,UAA0C,oBAAyB,EAAE,QAAgB,EAAE,aAAqB;YAC1G,IAAM,MAAM,GAAG,oBAAoB,CAAC,QAAQ,CAAC;YAC7C,IAAM,MAAM,GAAG,oBAAoB,CAAC,SAAS,CAAC;YAC9C,IAAM,cAAc,GAAG,IAAI,CAAC,IAAI,CAC9B,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,CACxG,CAAC;YAEF,IAAI,cAAc,GAChB,MAAM;gBACN,IAAI,CAAC,KAAK,CACR,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,EAC/D,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CACjE,CAAC;YAEJ,cAAc,GAAG,CAAC,CAAC,cAAc,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,KAAK,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,EAAE,CAAC;YAE5E,OAAO,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,cAAc,EAAE,cAAc,CAAC,CAAC;SACtE;QAEM,wBAAQ,GAAf,UAAgB,IAAgB,EAAE,IAAgB;YAChD,OAAO,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SAC/C;QAEM,iCAAiB,GAAxB,UAAyB,SAAqB,EAAE,SAAqB;YACnE,OAAO;gBACL,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;gBAC5B,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;gBAC5B,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC;aAC7B,CAAC;SACH;QAEM,kCAAkB,GAAzB,UAA0B,QAAoB,EAAE,KAAW,EAAE,eAAuB;YAAvB,gCAAA,EAAA,uBAAuB;YAClF,IAAI,eAAe,EAAE;gBACnB,QAAQ,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC;gBACtB,QAAQ,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC;gBACtB,QAAQ,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC;gBACtB,IAAM,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBACjE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;gBACxB,IAAM,SAAS,GAAG,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,YAAY,CAAC,QAAQ,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;gBACpH,QAAQ,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;gBACzB,QAAQ,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;gBACzB,QAAQ,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;gBACzB,OAAO,QAAQ,CAAC;aACjB;iBAAM;gBACL,IAAM,SAAS,GAAG,IAAI,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;gBAC1G,IAAM,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;gBAClE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;gBACxB,OAAO,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,YAAY,CAAC,QAAQ,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;aAC1G;SACF;QAEM,qCAAqB,GAA5B,UAA6B,SAAqB,EAAE,SAAqB;YACvE,OAAO,IAAI,MAAM,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;SAC3H;QAKD,oDAA0B,GAA1B,UAA2B,SAAmC;YAC5D,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YACrD,OAAO,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;SACxC;;;;gBAhGFF,eAAU;;;gBAJF,aAAa;;;ICItB;;;;;;QAOsC,oCAAuB;QAC3D,0BAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,kBAAkB,EAAE,aAAa,CAAC;SAChD;QAED,iDAAsB,GAAtB,UAAuB,WAAgB;YACrC,IAAM,OAAO,GAAG,WAAW,CAAC,OAAO,IAAI,EAAE,CAAC;YAC1C,IAAM,KAAK,GAAG,CAAC,WAAW,CAAC,KAAK,IAAI,OAAO,CAAC;YAC5C,IAAM,WAAW,GAAG,EAAE,CAAC;YACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;gBACpC,IAAM,KAAK,GACT,eAAe,CAAC,iCAAiC,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,KAAK,GAAG,KAAK,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;gBACjI,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aACzB;YAED,OAAO,WAAW,CAAC;SACpB;QAED,6CAAkB,GAAlB,UAAmB,WAAgB;YACjC,OAAO;gBACL,WAAW,CAAC,MAAM;gBAClB,eAAe,CAAC,iCAAiC,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,MAAM,EAAE,WAAW,CAAC,KAAK,EAAE,IAAI,CAAC;aACnH,CAAC;SACH;QAED,wCAAa,GAAb,UAAc,WAAgB;YAC5B,IAAM,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,CAAC;YAC3D,OAAO,WAAW,CAAC,SAAS,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC,GAAG,SAAS,CAAC;SACnG;QAED,8BAAG,GAAH,UAAI,WAAgB;YAClB,WAAW,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;YACxD,IAAI,WAAW,CAAC,KAAK,EAAE;gBACrB,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;gBACnD,QAAQ,CAAC,QAAQ,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;gBAC5C,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;aACjC;YAED,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;SAChD;QAED,iCAAM,GAAN,UAAO,SAAc,EAAE,WAAgB;YACrC,IAAI,CAAC,WAAW,CAAC,aAAa,IAAI,WAAW,CAAC,KAAK;gBACjD,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;gBAC9D,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;aACvD;YACD,SAAS,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,KAAK,SAAS,GAAG,WAAW,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;YACxF,SAAS,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,KAAK,SAAS,GAAG,WAAW,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;YACpF,SAAS,CAAC,wBAAwB,GAAG,WAAW,CAAC,wBAAwB,KAAK,SAAS;gBACrF,WAAW,CAAC,wBAAwB,GAAG,SAAS,CAAC,wBAAwB,CAAC;YAC5E,SAAS,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;YAEtD,OAAO,SAAS,CAAC;SAClB;;KArDH,CAAsC,uBAAuB;;gBAD5DA,eAAU;;;gBAVF,aAAa;;;ICDtB,WAAY,YAAY;QACtB,uCAAU,MAAM,CAAC,eAAe,aAAA,CAAA;QAChC,yCAAY,MAAM,CAAC,iBAAiB,eAAA,CAAA;QACpC,uCAAU,MAAM,CAAC,eAAe,aAAA,CAAA;QAChC,wCAAW,MAAM,CAAC,gBAAgB,cAAA,CAAA;QAClC,8CAAiB,MAAM,CAAC,sBAAsB,oBAAA,CAAA;QAC9C,mCAAM,MAAM,CAAC,WAAW,SAAA,CAAA;QACxB,wCAAW,MAAM,CAAC,gBAAgB,cAAA,CAAA;QAClC,wCAAW,MAAM,CAAC,gBAAgB,cAAA,CAAA;QAClC,qCAAQ,MAAM,CAAC,aAAa,WAAA,CAAA;QAC5B,yCAAY,MAAM,CAAC,iBAAiB,eAAA,CAAA;QACpC,qCAAQ,MAAM,CAAC,aAAa,WAAA,CAAA;QAC5B,oCAAO,MAAM,CAAC,YAAY,UAAA,CAAA;QAC1B,qCAAQ,MAAM,CAAC,aAAa,WAAA,CAAA;QAC5B,yCAAY,MAAM,CAAC,iBAAiB,eAAA,CAAA;QACpC,oCAAO,MAAM,CAAC,YAAY,UAAA,CAAA;IAC5B,CAAC,EAhBWa,UAAY,KAAZA,UAAY;;ICAxB;QASE,mCAAoB,gBAAqB,EAAE,cAAmB,EAAE,UAAe;YAApC,+BAAA,EAAA,kBAAkB,CAAC;YAAE,2BAAA,EAAA,cAAc,CAAC;YAA3D,qBAAgB,GAAhB,gBAAgB,CAAK;YANjC,iBAAY,GAAG,KAAK,CAAC;YACrB,mBAAc,GAAG,KAAK,CAAC;YAM7B,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;YAC9B,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC;SAEvC;QAED,2CAAO,GAAP,UAAQ,IAAa;YACnB,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,IAAI,CAAC;SACnC;QAED,sBAAI,kDAAW;iBAAf;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;;;WAAA;QAED,sBAAI,iDAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAa;gBAC1B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;aAC1B;;;WAJA;QAMD,sBAAI,qDAAc;iBAAlB;gBACE,OAAO,IAAI,CAAC,eAAe,CAAC;aAC7B;iBAED,UAAmB,KAAa;gBAC9B,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;aAC9B;;;WAJA;QAMD,8CAAU,GAAV;YACE,OAAO,IAAI,CAAC,gBAAgB,CAAC;SAC9B;QAED,0CAAM,GAAN;YACE,OAAO,IAAI,CAAC,eAAe,GAAG,CAAC,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC;SAC/F;QAED,uCAAG,GAAH,UAAI,MAAW;YACb,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;SAC1C;QAED,0CAAM,GAAN,UAAO,MAAW;YAChB,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SAC7C;QAED,mDAAe,GAAf,UAAgB,MAAW;YACzB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACtC;QAED,6CAAS,GAAT;YACE,IAAI,CAAC,OAAO,EAAE,CAAC;YACf,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC;SACnC;QAED,qDAAiB,GAAjB,UAAkB,QAAkB,EAAE,IAAY;YAAlD,iBAKC;YALqC,qBAAA,EAAA,YAAY;YAChD,IAAI,CAAC,0BAA0B,GAAG,EAAC,QAAQ,UAAA,EAAE,IAAI,MAAA,EAAC,CAAC;YACnD,OAAO;gBACL,KAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;aAC7C,CAAC;SACH;QAED,iDAAa,GAAb,UAAc,QAAkB,EAAE,IAAY;YAA9C,iBAQC;YARiC,qBAAA,EAAA,YAAY;YAC5C,IAAI,CAAC,sBAAsB,GAAG,EAAC,QAAQ,UAAA,EAAE,IAAI,MAAA,EAAC,CAAC;YAC/C,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,kBAAkB,EAAE,CAAC;aAC3B;YACD,OAAO;gBACL,KAAI,CAAC,sBAAsB,GAAG,SAAS,CAAC;aACzC,CAAC;SACH;QAED,0DAAsB,GAAtB;YACE,IAAI,IAAI,CAAC,0BAA0B,KAAK,SAAS,EAAE;gBACjD,IAAM,QAAQ,GAAG,IAAI,CAAC,0BAA0B,CAAC,QAAQ,CAAC;gBAC1D,IAAI,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE;oBACxC,IAAI,CAAC,0BAA0B,GAAG,SAAS,CAAC;iBAC7C;gBACD,QAAQ,EAAE,CAAC;aACZ;SACF;QAED,sDAAkB,GAAlB;YACE,IAAI,IAAI,CAAC,sBAAsB,KAAK,SAAS,EAAE;gBAC7C,IAAM,QAAQ,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC;gBACtD,IAAI,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE;oBACpC,IAAI,CAAC,sBAAsB,GAAG,SAAS,CAAC;iBACzC;gBACD,QAAQ,EAAE,CAAC;aACZ;SACF;QAEM,2CAAO,GAAP;YAAA,iBAkBN;YAjBC,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,EAAE;gBACxB,OAAO;aACR;YACD,IAAI,IAAI,CAAC,cAAc,EAAE;gBACvB,OAAO;aACR;YACD,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,CAAC;gBACtC,IAAI,CAAC,sBAAsB,EAAE,CAAC;gBAC9B,IAAI,CAAC,kBAAkB,GAAG,UAAU,CAAC;oBACnC,KAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;oBACrC,KAAI,CAAC,kBAAkB,EAAE,CAAC;oBAC1B,KAAI,CAAC,YAAY,GAAG,KAAK,CAAC;oBAC1B,KAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;iBACrC,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aACtB;SACF;QAEM,+CAAW,GAAX;YACL,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,CAAC;YACtC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;SAC5B;QAEM,8CAAU,GAAV;YACL,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;YACrC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;SAC7B;wCAEF;KAAA;;IC/HD;;;;;QAK2C,yCAAkB;QAI3D,+BACU,aAA4B,EAC5B,YAA0B,EAC1B,cAIP;YAJO,+BAAA,EAAA;gBACN,iBAAiB,EAAE,CAAC,CAAC;gBACrB,wBAAwB,EAAE,CAAC,CAAC;gBAC5B,iBAAiB,EAAE,CAAC;aACrB;YAPH,YASE,iBAAO,SASR;YAjBS,mBAAa,GAAb,aAAa,CAAe;YAC5B,kBAAY,GAAZ,YAAY,CAAc;YAC1B,oBAAc,GAAd,cAAc,CAIrB;YAVK,uBAAiB,GAAG,IAAI,GAAG,EAAkC,CAAC;YAapE,KAAI,CAAC,gBAAgB,GAAGA,UAAY,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;;YAGxD,KAAK,IAAM,CAAC,IAAIA,UAAY,EAAE;gBAC5B,IAAIA,UAAY,CAAC,CAAC,CAAQ,KAAK,KAAI,CAAC,YAAY,EAAE;oBAChD,KAAI,CAAC,gBAAgB,GAAG,CAAC,CAAC;iBAC3B;aACF;;SACF;QAEO,yDAAyB,GAAzB;YACN,IAAI,oBAAoB,GAAG,IAAI,CAAC;YAChC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAA,gBAAgB;gBAC7C,IAAI,gBAAgB,CAAC,MAAM,EAAE,EAAE;oBAC7B,oBAAoB,GAAG,gBAAgB,CAAC;iBACzC;aACF,CAAC,CAAC;YAEH,OAAO,oBAAoB,CAAC;SAC7B;QAED,oCAAI,GAAJ,UAAK,OAA+B;YAClC,IAAM,YAAY,GAAG,OAAO,IAAI,IAAI,CAAC,cAAc,CAAC;YACpD,IAAM,WAAW,GAAG,EAAE,CAAC;YACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,iBAAiB,EAAE,CAAC,EAAE,EAAE;gBACvD,IAAM,UAAU,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;gBACtE,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAC7B,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;gBAC3D,IAAI,CAAC,iBAAiB,CAAC,GAAG,CACxB,UAAU,CAAC,QAAQ,EACnB,IAAI,yBAAyB,CAAC,UAAU,CAAC,QAAQ,EAAE,YAAY,CAAC,iBAAiB,EAAE,YAAY,CAAC,wBAAwB,CAAC,CAC1H,CAAC;aACH;YAED,OAAO,WAAW,CAAC;SACpB;QAED,mCAAG,GAAH,UAAI,WAAgB;;YAClB,IAAM,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC;YACnE,IAAI,yBAAyB,KAAK,IAAI,EAAE;gBACtC,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAC;aACpD;YAED,IAAM,YAAY;oBAChB,QAAQ,EAAE,WAAW,CAAC,QAAQ,KAAK,SAAS,GAAG,WAAW,CAAC,QAAQ,GAAG,SAAS;oBAC/E,WAAW,EAAE,WAAW,CAAC,WAAW,KAAK,SAAS,GAAG,WAAW,CAAC,WAAW,GAAG,SAAS;oBACxF,WAAW,EAAE,WAAW,CAAC,WAAW,KAAK,SAAS,GAAG,WAAW,CAAC,WAAW,GAAG,SAAS;oBACxF,QAAQ,EAAE,WAAW,CAAC,QAAQ,KAAK,SAAS,GAAG,WAAW,CAAC,QAAQ,GAAG,SAAS;;gBAC/E,GAAC,IAAI,CAAC,gBAAgB,IAAG,WAAW;mBACrC,CAAC;YAEF,IAAI,WAAW,CAAC,IAAI,KAAK,SAAS,EAAE;gBAClC,YAAY,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;aACtC;YACD,IAAI,WAAW,CAAC,YAAY,KAAK,SAAS,EAAE;gBAC1C,YAAY,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;aACtD;YAED,OAAO,yBAAyB,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACpD;QAED,sCAAM,GAAN,UAAO,MAAW,EAAE,WAAgB;YAClC,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;YAErC,IAAI,MAAM,CAAC,QAAQ,YAAY,MAAM,CAAC,gBAAgB,EAAE;gBACtD,IAAI,MAAM,CAAC,QAAQ,CAAC,WAAW,EAAE;oBAC/B,MAAM,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC;iBACxC;aACF;YACD,MAAM,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,KAAK,SAAS,GAAG,WAAW,CAAC,QAAQ,GAAG,SAAS,CAAC;YACxF,MAAM,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,KAAK,SAAS,GAAG,WAAW,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;YAC9E,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,KAAK,SAAS,GAAG,WAAW,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC;YAC1G,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC,WAAW,KAAK,SAAS,GAAG,WAAW,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC;YAC1G,MAAM,CAAC,QAAQ,GAAG,WAAW,CAAC,QAAQ,KAAK,SAAS,GAAG,WAAW,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;YAC9F,MAAM,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,KAAK,SAAS,GAAG,WAAW,CAAC,YAAY,GAAG,WAAW,CAAC,YAAY,CAAC;YAEnH,IAAI,IAAI,CAAC,cAAc,EAAE;gBACvB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,WAAW,CAAC,CAAC;aACjE;iBAAM;gBACL,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,WAAW,CAAC,CAAC;aAC3D;SACF;QAED,sCAAM,GAAN,UAAO,MAAW;YAChB,IAAM,yBAAyB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;YACtF,yBAAyB,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SAC1C;QAED,yCAAS,GAAT;YACE,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAA,gBAAgB;gBAC7C,gBAAgB,CAAC,SAAS,EAAE,CAAC;aAC9B,CAAC,CAAC;SACJ;QAED,uCAAO,GAAP,UAAQ,SAAkB;YACxB,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAA,gBAAgB;gBAC7C,gBAAgB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;aACrC,CAAC,CAAC;SACJ;QAEO,uDAAuB,GAAvB,UAAwB,MAAW;YACzC,IAAM,EAAE,GAAG,MAAM,CAAC,gBAAgB,CAAC;YACnC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACnC,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;aACpE;YAED,IAAM,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACxD,gBAAgB,CAAC,OAAO,EAAE,CAAC;SAC5B;oCACF;KA3HD,CAA2C,kBAAkB;;ICN7D;;;;QAI4C,0CAAqB;QAC/D,gCAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEA,UAAY,CAAC,SAAS,CAAC;SAC7C;;KAHH,CAA4C,qBAAqB;;gBADhEb,eAAU;;;gBAPF,aAAa;;;ICKtB;;;;QAIuC,qCAAkB;QAIvD,2BACU,aAA4B;YADtC,YAGE,iBAAO,SACR;YAHS,mBAAa,GAAb,aAAa,CAAe;;SAGrC;QAGD,gCAAI,GAAJ,UAAK,OAA+B;YAClC,IAAM,WAAW,GAAG,EAAE,CAAC;YAEvB,IAAI,CAAC,UAAU,GAAG,IAAI,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;YAEpD,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAElC,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEhE,OAAO,WAAW,CAAC;SACpB;;QAGD,+BAAG,GAAH,UAAI,WAAgB;YAElB,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAEhD,OAAO,WAAW,CAAC;SACpB;QAED,kCAAM,GAAN,UAAO,MAAW,EAAE,WAAgB;YAClC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;SACjD;QAED,kCAAM,GAAN,UAAO,MAAW;YAChB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;SACzD;QAED,qCAAS,GAAT;YACE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;SACtC;QAED,mCAAO,GAAP,UAAQ,SAAkB;YACxB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,GAAG,SAAS,CAAC;SAC3C;;KA7CH,CAAuC,kBAAkB;;gBADxDA,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;QAI0C,wCAAqB;QAC7D,8BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,OAAO,CAAC;SAC3C;;KAHH,CAA0C,qBAAqB;;gBAD9Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAIwC,sCAAqB;QAC3D,4BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,KAAK,CAAC;SACzC;;KAHH,CAAwC,qBAAqB;;gBAD5Db,eAAU;;;gBAPF,aAAa;;;ICItB;;;;QAIwC,sCAAqB;QAC3D,4BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,KAAK,CAAC;SACzC;;KAHH,CAAwC,qBAAqB;;gBAD5Db,eAAU;;;gBAPF,aAAa;;;ICItB;;;;QAI0C,wCAAqB;QAC7D,8BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,OAAO,CAAC;SAC3C;;KAHH,CAA0C,qBAAqB;;gBAD9Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAI2C,yCAAqB;QAC9D,+BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,QAAQ,CAAC;SAC5C;;KAHH,CAA2C,qBAAqB;;gBAD/Db,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;;QAKoD,kDAAuB;QACzE,wCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,kBAAkB,EAAE,aAAa,CAAC;SAChD;QAED,4CAAG,GAAH,UAAI,WAAgB;YAClB,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC,CAAC;SACxE;QAED,+CAAM,GAAN,UAAO,YAAiB,EAAE,WAAgB;YACxC,IAAI,WAAW,CAAC,QAAQ,YAAY,MAAM,CAAC,KAAK,EAAE;gBAChD,IAAI,YAAY,CAAC,QAAQ,IAAI,YAAY,CAAC,QAAQ,CAAC,QAAQ;oBACzD,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,YAAY,MAAM,CAAC,KAAK,EAAE;oBAC9D,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;iBACrC;qBAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE;oBAC7E,YAAY,CAAC,QAAQ,CAAC,QAAQ,CAAC,KAAK,GAAG,WAAW,CAAC,QAAQ,CAAC;iBAC7D;aACF;YACD,iBAAM,MAAM,YAAC,YAAY,EAAE,WAAW,CAAC,CAAC;SACzC;QAED,0DAAiB,GAAjB,UAAkB,WAAgB;YAChC,IAAI,WAAW,CAAC,QAAQ,YAAY,MAAM,CAAC,KAAK,EAAE;gBAChD,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;gBACnD,QAAQ,CAAC,QAAQ,CAAC,KAAK,GAAG,WAAW,CAAC,QAAQ,CAAC;gBAC/C,WAAW,CAAC,QAAQ,GAAG,QAAQ,CAAC;aACjC;YAED,OAAO,WAAW,CAAC;SACpB;;KA7BH,CAAoD,uBAAuB;;gBAD1EA,eAAU;;;gBAPF,aAAa;;;ICDtB,WAAY,cAAc;QACxB,uEAAc,CAAA;QACd,yEAAe,CAAA;QACf,mEAAY,CAAA;QACZ,iEAAW,CAAA;QACX,6DAAS,CAAA;QACT,iEAAW,CAAA;QACX,6EAAiB,CAAA;QACjB,2EAAgB,CAAA;QAChB,uEAAc,CAAA;QACd,2EAAgB,CAAA;QAChB,gFAAkB,CAAA;QAClB,8EAAiB,CAAA;QACjB,kFAAmB,CAAA;QACnB,gFAAkB,CAAA;QAClB,4EAAgB,CAAA;QAChB,gFAAkB,CAAA;QAClB,wEAAc,CAAA;QACd,0EAAe,CAAA;IACjB,CAAC,EAnBWc,sBAAc,KAAdA,sBAAc;;;ICI1B,IAAM,8BAA8B,GAAG,KAAK,CAAC;IAC7C,IAAM,0BAA0B,GAAG,IAAI,CAAC;IACxC,IAAM,2BAA2B,GAAG,IAAI,CAAC;IACzC,IAAM,4BAA4B,GAAG,IAAI,CAAC;QAE7B,2BAA2B;;;;;QAKtC,GAACA,sBAAc,CAAC,cAAc,IAAG,UAAC,aAA4B,EAAE,MAAW;YACzE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;SAC9B;;;;;QAKD,GAACA,sBAAc,CAAC,eAAe,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC1E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC/B;;;;;QAKD,GAACA,sBAAc,CAAC,SAAS,IAAG,UAAC,aAA4B,EAAE,MAAW;YACpE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;SACzB;;;;;QAKD,GAACA,sBAAc,CAAC,WAAW,IAAG,UAAC,aAA4B,EAAE,MAAW;YACtE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SAC3B;;;;;QAKD,GAACA,sBAAc,CAAC,YAAY,IAAG,UAAC,aAA4B,EAAE,MAAW;YACvE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;SAC5B;;;;;QAKD,GAACA,sBAAc,CAAC,WAAW,IAAG,UAAC,aAA4B,EAAE,MAAW;YACtE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;YACvC,IAAM,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YAC3F,IAAM,QAAQ,GAAG,YAAY,IAAI,MAAM,CAAC,QAAQ,IAAI,8BAA8B,CAAC,CAAC;YACpF,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;SAC3B;;;;;QAKD,GAACA,sBAAc,CAAC,iBAAiB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC5E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,eAAe,GAAG,MAAM,CAAC,oBAAoB,CAAC;YACpD,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,IAAI,0BAA0B,CAAC;YACnE,MAAM,CAAC,SAAS,CAAC,eAAe,CAAC,QAAQ,GAAG,UAAU,CAAC,CAAC;SACzD;;;;;QAKD,GAACA,sBAAc,CAAC,gBAAgB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC3E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,eAAe,GAAG,MAAM,CAAC,oBAAoB,CAAC;YACpD,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,IAAI,0BAA0B,CAAC;YACnE,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,QAAQ,GAAG,UAAU,CAAC,CAAC;SACxD;;;;;QAKD,GAACA,sBAAc,CAAC,cAAc,IAAG,UAAC,aAA4B,EAAE,MAAW;YACzE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,eAAe,GAAG,MAAM,CAAC,oBAAoB,CAAC;YACpD,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,IAAI,0BAA0B,CAAC;YACnE,MAAM,CAAC,MAAM,CAAC,eAAe,CAAC,SAAS,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;SAC9D;;;;;QAKD,GAACA,sBAAc,CAAC,gBAAgB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC3E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,eAAe,GAAG,MAAM,CAAC,oBAAoB,CAAC;YACpD,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,IAAI,0BAA0B,CAAC;YACnE,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,SAAS,IAAI,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;SAChE;;;;;QAKD,GAACA,sBAAc,CAAC,kBAAkB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC7E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,MAAM,IAAI,2BAA2B,CAAC;YAChE,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;SAC/B;;;;;QAKD,GAACA,sBAAc,CAAC,iBAAiB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC5E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,MAAM,IAAI,2BAA2B,CAAC;YAChE,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;SAC9B;;;;;QAKD,GAACA,sBAAc,CAAC,mBAAmB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC9E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,KAAK,IAAI,4BAA4B,CAAC;YAChE,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;SAChC;;;;;QAKD,GAACA,sBAAc,CAAC,kBAAkB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC7E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,KAAK,IAAI,4BAA4B,CAAC;YAChE,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;SAC/B;;;;;QAKD,GAACA,sBAAc,CAAC,gBAAgB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC3E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,KAAK,IAAI,4BAA4B,CAAC;YAChE,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;SAC7B;;;;;QAKD,GAACA,sBAAc,CAAC,kBAAkB,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC7E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,UAAU,GAAG,MAAM,CAAC,KAAK,IAAI,4BAA4B,CAAC;YAChE,MAAM,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;SAC/B;;;;;QAKD,GAACA,sBAAc,CAAC,cAAc,IAAG,UAAC,aAA4B,EAAE,MAAW;YACzE,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;YAC7B,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACvB;;;;;QAKD,GAACA,sBAAc,CAAC,eAAe,IAAG,UAAC,aAA4B,EAAE,MAAW;YAC1E,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC;YAChD,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;YAC7B,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SACxB;;;ICrKH,IAAK,aAIJ;IAJD,WAAK,aAAa;QAChB,uDAAO,CAAA;QACP,+DAAW,CAAA;QACX,uDAAO,CAAA;IACT,CAAC,EAJI,aAAa,KAAb,aAAa,QAIjB;IAQD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiHE,gCAAoB,MAAc,EAAU,aAA4B,EAA4B,QAAa;YAA7F,WAAM,GAAN,MAAM,CAAQ;YAAU,kBAAa,GAAb,aAAa,CAAe;YAA4B,aAAQ,GAAR,QAAQ,CAAK;YAPzG,wBAAmB,GAA8B,IAAI,CAAC;YACtD,uBAAkB,GAAkD,EAAE,CAAC;YACvE,kBAAa,GAAa,IAAI,CAAC,mBAAmB,CAAC;SAM1D;;;;QAKD,qCAAI,GAAJ;YACE,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;YAC9C,MAAM,CAAC,gBAAgB,CAAC,OAAO,EAAE;gBAC/B,MAAM,CAAC,KAAK,EAAE,CAAC;aAChB,CAAC,CAAC;YAEH,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC9C;;;;;;;;;;;;;QAcD,oDAAmB,GAAnB,UAAoB,WAAsC,EACtC,YAAkD,EAClD,oBAA4B;YAFhD,iBAqBC;YAnBmB,qCAAA,EAAA,4BAA4B;YAC9C,IAAI,CAAC,WAAW,EAAE;gBAChB,OAAO,IAAI,CAAC,sBAAsB,EAAE,CAAC;aACtC;YAED,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC7B,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,CAAC;aAC3C;YAED,IAAI,CAAC,mBAAmB,GAAG,WAAW,CAAC;YACvC,IAAI,CAAC,aAAa,GAAG,YAAY,IAAI,IAAI,CAAC,mBAAmB,CAAC;YAE9D,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,OAAO,CAAC,UAAA,GAAG;gBAC/C,KAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG;oBAC7B,KAAK,EAAE,aAAa,CAAC,WAAW;oBAChC,MAAM,EAAE,IAAI;oBACZ,aAAa,EAAE,IAAI;iBACpB,CAAC;aACH,CAAC,CAAC;SACJ;;;;QAKD,uDAAsB,GAAtB;YACE,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;SACjC;;;;QAKO,0CAAS,GAAT,UAAU,IAAY;YAC5B,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;SAC/C;;;;QAKO,oDAAmB,GAAnB,UAAoB,QAAuB;YACjD,OAAO,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SAC9C;;;;QAKO,8CAAa,GAAb,UAAc,CAAgB;YACpC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACnC,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAEpC,IAAI,MAAM,EAAE;gBACV,IAAM,WAAW,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;gBAElD,IAAI,WAAW,CAAC,KAAK,KAAK,aAAa,CAAC,OAAO,EAAE;oBAC/C,IAAI,OAAO,GAAG,IAAI,CAAC;oBAEnB,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;oBAEhD,IAAI,MAAM,CAAC,UAAU,EAAE;wBACrB,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC;qBAC5D;oBAED,IAAI,OAAO,KAAK,IAAI,EAAE;wBACpB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG;4BAC9B,KAAK,EAAE,aAAa,CAAC,OAAO;4BAC5B,MAAM,QAAA;4BACN,aAAa,EAAE,CAAC;yBACjB,CAAC;qBACH;iBACF;aACF;SACF;;;;QAKO,4CAAW,GAAX,UAAY,CAAgB;YAClC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACnC,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;YAEpC,IAAI,MAAM,EAAE;gBACV,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG;oBAC9B,KAAK,EAAE,aAAa,CAAC,WAAW;oBAChC,MAAM,EAAE,IAAI;oBACZ,aAAa,EAAE,CAAC;iBACjB,CAAC;gBAEF,IAAI,MAAM,CAAC,IAAI,IAAI,OAAO,MAAM,CAAC,IAAI,KAAK,UAAU,EAAE;oBACpD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;iBACpC;aACF;SACF;;;;QAKO,2CAAU,GAAV;YAAA,iBAUP;YATC,IAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAExD,UAAU,CAAC,OAAO,CAAC,UAAA,GAAG;gBACpB,IAAM,WAAW,GAAG,KAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC;gBAEjD,IAAI,WAAW,KAAK,IAAI,IAAI,WAAW,CAAC,MAAM,KAAK,IAAI,IAAI,WAAW,CAAC,KAAK,KAAK,aAAa,CAAC,OAAO,EAAE;oBACtG,KAAI,CAAC,aAAa,CAAC,WAAW,CAAC,MAAM,EAAE,GAAG,EAAE,WAAW,CAAC,aAAa,CAAC,CAAC;iBACxE;aACF,CAAC,CAAC;SACJ;;;;;;;QAQO,0CAAS,GAAT,UAAU,SAAc,EAAE,aAA4B;YAC5D,IAAI,CAAC,SAAS,EAAE;gBACd,OAAO,EAAE,CAAC;aACX;YAED,IAAI,OAAO,SAAS,KAAK,UAAU,EAAE;gBACnC,OAAO,SAAS,CAAC,IAAI,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC;aACrD;YAED,OAAO,SAAS,CAAC;SAClB;;;;;;QAOO,8CAAa,GAAb,UAAc,SAAgC,EAAE,GAAW,EAAE,aAA4B;YAC/F,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC7B,OAAO;aACR;YAED,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;YAE/D,IAAIC,aAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE;gBAC9B,IAAM,gBAAgB,GAAG,2BAA2B,CAAC,SAAS,CAAC,MAAgB,CAAC,CAAC;gBAEjF,IAAI,gBAAgB,EAAE;oBACpB,gBAAgB,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC;iBAC7D;aACF;iBAAM,IAAI,OAAO,SAAS,CAAC,MAAM,KAAK,UAAU,EAAE;gBACjD,IAAM,iBAAiB,GAAG,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC;gBAEtF,IAAI,iBAAiB,KAAK,KAAK,EAAE;oBAC/B,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,GAAG;wBAC7B,KAAK,EAAE,aAAa,CAAC,OAAO;wBAC5B,MAAM,EAAE,IAAI;wBACZ,aAAa,EAAE,IAAI;qBACpB,CAAC;iBACH;aACF;SACF;;;;QAKO,+CAAc,GAAd,UAAe,oBAA6B;YAA5C,iBAYP;YAXC,IAAM,gBAAgB,GAAG;gBACvB,KAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,KAAI,CAAC,aAAa,CAAC,CAAC;gBAC9D,KAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,KAAI,CAAC,WAAW,CAAC,CAAC;gBAC1D,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAI,CAAC,UAAU,CAAC,CAAC;aAC/E,CAAC;YAEF,IAAI,oBAAoB,EAAE;gBACxB,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;aACjD;iBAAM;gBACL,gBAAgB,EAAE,CAAC;aACpB;SACF;;;;QAKO,iDAAgB,GAAhB;YACN,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YACjE,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAC7D,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClF;;;;gBA7NFf,eAAU;;;gBAzIkBC,WAAM;gBAG1B,aAAa;gDA+IuDG,WAAM,SAACY,eAAQ;;;IC/I5F;QAGE,iCAAsB,KAAkB,EAAY,QAA6B;YAA3D,UAAK,GAAL,KAAK,CAAa;YAAY,aAAQ,GAAR,QAAQ,CAAqB;SAChF;QAED,sCAAI,GAAJ,UAAK,aAAkB;YAAvB,iBAYC;YAXC,IAAI,CAAC,QAAQ,GAAGC,eAAU,CAAC,MAAM,CAAC,UAAC,QAAyB;gBACxD,aAAa,CAAC,cAAc,CAAC,UAAC,QAAa;oBACzC,IAAI,QAAQ,CAAC,QAAQ,EAAE;wBACrB,QAAQ,CAAC,aAAa,GAAG,QAAQ,CAAC,QAAQ,CAAC;wBAC3C,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,QAAQ,CAAC;qBAC1C;oBACD,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACzB,EAAE,KAAI,CAAC,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC;aAC/B,CACF,CAAC;YACF,OAAO,IAAI,CAAC,QAAQ,CAAC;SACtB;sCACF;KAAA;;IChBD;QAA6C,2CAAuB;QAGlE,iCAAsB,KAAkB,EAClB,QAA6B,EAC/B,YAAgC;YAFpD,YAGE,kBAAM,KAAK,EAAE,QAAQ,CAAC,SACvB;YAJqB,WAAK,GAAL,KAAK,CAAa;YAClB,cAAQ,GAAR,QAAQ,CAAqB;YAC/B,kBAAY,GAAZ,YAAY,CAAoB;;SAEnD;QAED,sCAAI,GAAJ;YACE,IAAI,UAAuB,CAAC;YAC5B,IAAI,SAAsB,CAAC;YAE3B,IAAI,IAAI,CAAC,KAAK,KAAKX,mBAAW,CAAC,eAAe,EAAE;gBAC9C,UAAU,GAAGA,mBAAW,CAAC,SAAS,CAAC;gBACnC,SAAS,GAAGA,mBAAW,CAAC,OAAO,CAAC;aACjC;iBAAM,IAAI,IAAI,CAAC,KAAK,KAAKA,mBAAW,CAAC,gBAAgB,EAAE;gBACtD,UAAU,GAAGA,mBAAW,CAAC,UAAU,CAAC;gBACpC,SAAS,GAAGA,mBAAW,CAAC,QAAQ,CAAC;aAClC;iBAAM,IAAI,IAAI,CAAC,KAAK,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;gBACvD,UAAU,GAAGA,mBAAW,CAAC,WAAW,CAAC;gBACrC,SAAS,GAAGA,mBAAW,CAAC,SAAS,CAAC;aACnC;YAED,IAAM,oBAAoB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9E,IAAM,mBAAmB,GAAGY,UAAK,CAC/B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,EAC/C,IAAI,CAAC,YAAY,CAAC,GAAG,CAACZ,mBAAW,CAAC,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC;aAC7D,CAAC;;YAGF,IAAM,mBAAmB,GAAGa,iBAAO,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAC7DC,kBAAQ,CAAC,UAAC,CAAC,IAAK,OAAAC,OAAY,CAAC,CAAC,CAAC,CAAC,IAAI,CAClCC,eAAK,CAAC,uBAAuB,CAAC,0BAA0B,CAAC,EACzDC,mBAAS,CAAC,mBAAmB,CAAC,CAAC,GAAA,CAAC,CACnC,CAAC,CAAC;YACH,OAAO,mBAAmB,CAAC;SAC5B;;KArCH,CAA6C,uBAAuB;IACpD,kDAA0B,GAAG,GAAG;;;QCI9C,4BAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;YAUxC,4BAAuB,GAAG,IAAI,GAAG,EAAsC,CAAC;SAT/E;QAWa,mCAAgB,GAAvB,UAAwB,KAAkB,EAAE,QAA8B;YAC/E,IAAI,QAAQ,EAAE;gBACZ,OAAU,KAAK,SAAI,QAAU,CAAC;aAC/B;iBAAM;gBACL,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;aACzB;SACF;QAED,iCAAI,GAAJ;YACE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,uBAAuB,CAAC;SAC7E;QAED,gCAAG,GAAH,UAAI,KAAkB,EAAE,QAA8B;YACpD,IAAM,SAAS,GAAG,kBAAkB,CAAC,gBAAgB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YACvE,IAAI,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;gBAC/C,OAAO,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;aACpD;iBAAM;gBACL,IAAM,aAAa,GAAG,IAAI,CAAC,2BAA2B,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;gBACxE,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;gBAC3D,OAAO,aAAa,CAAC;aACtB;SACF;QAEO,wDAA2B,GAA3B,UAA4B,KAAkB,EAAE,QAA8B;YACpF,IAAI,qBAAiD,CAAC;YACtD,IAAI,kBAAkB,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACjD,qBAAqB,GAAG,IAAI,CAAC,kCAAkC,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;aAClF;iBAAM;gBACL,qBAAqB,GAAGJ,iBAAO,EAAE,CAAC,IAAI,uBAAuB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC;aAC1G;YACD,qBAAqB,CAAC,OAAO,EAAE,CAAC;YAChC,OAAO,qBAAqB,CAAC;SAC9B;QAEO,+DAAkC,GAAlC,UAAmC,KAAkB,EAAE,QAA6B;;YAE1F,OAAO,IAAI,uBAAuB,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;SAClE;;;IA9Ca,kCAAe,GAAqB,IAAI,GAAG,CAAC;QACxDb,mBAAW,CAAC,eAAe;QAC3BA,mBAAW,CAAC,gBAAgB;QAC5BA,mBAAW,CAAC,iBAAiB;KAC9B,CAAC,CAAC;;gBAVJN,eAAU;;;gBARF,aAAa;;;ICItB;;;;;QAYE;YALQ,sBAAiB,GAAe,EAAE,CAAC;YAGnC,2BAAsB,GAAsB,IAAIQ,iBAAY,EAAE,CAAC;YAGrE,IAAI,CAAC,gBAAgB,GAAG,IAAIgB,YAAO,EAAe,CAAC;SACpD;QAED,sBAAI,iDAAqB;iBAAzB;gBACE,OAAO,IAAI,CAAC,sBAAsB,CAAC;aACpC;;;WAAA;QAED,sBAAI,wCAAY;iBAAhB;gBACE,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;;;WAAA;QAED,sBAAI,4CAAgB;iBAApB;gBACE,OAAO,IAAI,CAAC,iBAAiB,CAAC;aAC/B;;;WAAA;QAED,sBAAI,gDAAoB;iBAAxB;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;aACnC;;;WAAA;QAED,kCAAS,GAAT,UAAU,WAAwB;YAChC,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;YAChC,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,QAAQ,CAAC;YAC9C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;YAE1B,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAAC;YACnC,OAAO,IAAI,CAAC,gBAAgB,CAAC;SAC9B;QAED,uCAAc,GAAd,UAAe,MAAgB;YAC7B,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;YAC3B,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,CAAC,MAAM,CAAC,CAAC;YAEtC,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAAC;YACnC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SAC/C;;;;gBA3CFxB,eAAU;;;;aCRD,UAAC,KAAY;QACnB,OAAO,KAAK,CAAC,MAAM,CAAC,UAAC,WAAW,EAAE,YAAY;YAC5C,IAAI,WAAW,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;gBACzC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aAChC;YACD,OAAO,WAAW,CAAC;SACpB,EAAE,EAAE,CAAC,CAAC;IACT,CAAC;IARI,IAAM,YAAY,GAAG;QAC1B,MAAM,IAOL;KACF;;ICPD;QAAA;;QASgB,sCAAiB,GAAxB,UAAyB,SAAsB;YACpD,IAAI,cAAc,CAAC;YACnB,IAAI,YAAY,CAAC;YACjB,IAAI,SAAS,KAAKM,mBAAW,CAAC,eAAe,EAAE;gBAC7C,cAAc,GAAGA,mBAAW,CAAC,SAAS,CAAC;gBACvC,YAAY,GAAGA,mBAAW,CAAC,OAAO,CAAC;aACpC;iBAAM,IAAI,SAAS,KAAKA,mBAAW,CAAC,gBAAgB,EAAE;gBACrD,cAAc,GAAGA,mBAAW,CAAC,UAAU,CAAC;gBACxC,YAAY,GAAGA,mBAAW,CAAC,QAAQ,CAAC;aACrC;iBAAM,IAAI,SAAS,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;gBACtD,cAAc,GAAGA,mBAAW,CAAC,WAAW,CAAC;gBACzC,YAAY,GAAGA,mBAAW,CAAC,SAAS,CAAC;aACtC;YAED,OAAO,EAAC,cAAc,gBAAA,EAAE,YAAY,cAAA,EAAC,CAAC;SACvC;;;IAtBa,+BAAU,GAAqB,IAAI,GAAG,CAAC;QACnDA,mBAAW,CAAC,eAAe;QAC3BA,mBAAW,CAAC,gBAAgB;QAC5BA,mBAAW,CAAC,iBAAiB;KAC9B,CAAC;;ICMJ;QACE,sBAAmB,UAAmC,EAClC,OAAqB,EACrB,QAAgB,EAChB,QAAiB;YAHlB,eAAU,GAAV,UAAU,CAAyB;YAClC,YAAO,GAAP,OAAO,CAAc;YACrB,aAAQ,GAAR,QAAQ,CAAQ;YAChB,aAAQ,GAAR,QAAQ,CAAS;SACpC;2BACF;KAAA,IAAA;IAiBD;;;;;;;;;;;;;;;;QAqBE,iCAAoB,aAA4B,EAC5B,YAAgC,EAChC,cAA8B;YAF9B,kBAAa,GAAb,aAAa,CAAe;YAC5B,iBAAY,GAAZ,YAAY,CAAoB;YAChC,mBAAc,GAAd,cAAc,CAAgB;YAJ1C,uBAAkB,GAAG,IAAI,GAAG,EAA0B,CAAC;SAK9D;QAED,sCAAI,GAAJ;YACE,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;YACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC;SAC5C;;;;;;;QAQD,0CAAQ,GAAR,UAAS,KAA6B;YAAtC,iBA2BC;YA1BC,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;gBAC5B,MAAM,IAAI,KAAK,CAAC,qGAAqG,CAAC,CAAC;aACxH;YAED,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,IAAIC,mBAAW,CAAC,OAAO,CAAC;YAC/C,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,IAAI,CAAC,CAAC;YACrC,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,UAAU,IAAI,EAAE,CAAC;YAE1C,IAAI,KAAK,CAAC,UAAU,IAAI,KAAK,CAAC,IAAI,KAAKA,mBAAW,CAAC,OAAO,EAAE;gBAC1D,MAAM,IAAI,KAAK,CAAC,oDAAoD;oBAClE,mEAAmE,CAAC,CAAC;aACxE;YAED,IAAM,SAAS,GAAG,kBAAkB,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;YAEnF,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;gBAC3C,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;aAC5C;YAED,IAAM,iBAAiB,GAAG,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;YAC9D,IAAM,sBAAsB,GAAQ,iBAAiB,CAAC,UAAU,CAAC;YACjE,sBAAsB,CAAC,OAAO,GAAG,cAAM,OAAA,KAAI,CAAC,iBAAiB,CAAC,iBAAiB,EAAE,SAAS,CAAC,GAAA,CAAC;YAC5F,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAE/D,IAAI,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;YAC5C,OAA0C,sBAAsB,CAAC;SAClE;QAEO,mDAAiB,GAAjB,UAAkB,iBAA+B,EAAE,SAAiB;YAC1E,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAClC,IAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAC7D,IAAM,KAAK,GAAG,aAAa,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;YACvD,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;gBAChB,aAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aAChC;YACD,IAAI,CAAC,2BAA2B,CAAC,SAAS,CAAC,CAAC;SAC7C;QAEO,6DAA2B,GAA3B,UAA4B,SAAiB;YACnD,IAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;YAC7D,aAAa,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC,QAAQ,GAAA,CAAC,CAAC;YACtD,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC9B,OAAO;aACR;;YAGD,IAAM,eAAe,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;YAClD,aAAa,CAAC,OAAO,CAAC,UAAC,YAAY;gBACjC,YAAY,CAAC,QAAQ,GAAG,YAAY,CAAC,QAAQ,GAAG,eAAe,CAAC;aACjE,CAAC,CAAC;SAEJ;QAEO,yDAAuB,GAAvB,UAAwB,EAQyB;YARjD,iBAsCP;gBArCiC,KAAK,WAAA,EACL,QAAQ,cAAA,EACR,UAAU,gBAAA,EACJ,UAAU,UAAA,EAChB,QAAQ,cAAA,EACR,UAAU,gBAAA,EACV,UAAU,gBAAA;YAE1C,IAAM,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YACrE,IAAM,OAAO,GAAG,IAAIiB,YAAO,EAAO,CAAC;YAEnC,IAAM,YAAY,GAAG,IAAI,YAAY,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;YAC3E,IAAI,UAAmC,CAAC;YAExC,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBAC/C,UAAU,GAAG,qBAAqB,CAAC,IAAI,CACrCC,gBAAM,CAAC,cAAM,OAAA,CAAC,YAAY,CAAC,QAAQ,GAAA,CAAC,EACpCC,aAAG,CAAC,UAAC,QAAQ,IAAK,OAAA,KAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,UAAU,EAAE,UAAU,CAAC,GAAA,CAAC,EACrED,gBAAM,CAAC,UAAC,MAAM,IAAK,OAAA,MAAM,CAAC,cAAc,KAAK,IAAI,IAAI,UAAU,KAAK,SAAS,GAAA,CAAC,EAC9EC,aAAG,CAAC,UAAC,gBAAgB,IAAK,OAAA,KAAI,CAAC,WAAW,CAAC,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,UAAU,CAAC,GAAA,CAAC,EACjGD,gBAAM,CAAC,UAAC,MAAM,IAAK,OAAA,MAAM,CAAC,QAAQ,KAAK,IAAI,KAAK,UAAU,KAAK,SAAS,IAAI,CAAC,UAAU,CAAC,GAAA,CAAC,EACzFE,mBAAS,CAAC,UAAC,mBAAmB,IAAK,OAAA,KAAI,CAAC,OAAO,CAAC,mBAAmB,EAAE,UAAU,CAAC,GAAA,CAAC,EACjFJ,mBAAS,CAAC,OAAO,CAAC,CAAC,CAAC;aACvB;iBAAM;gBACL,UAAU,GAAG,IAAI,CAAC,eAAe,CAAC;oBAChC,KAAK,OAAA;oBACL,QAAQ,UAAA;oBACR,UAAU,YAAA;oBACV,IAAI,EAAE,UAAU;oBAChB,QAAQ,UAAA;oBACR,UAAU,YAAA;oBACV,UAAU,YAAA;iBACX,CAAC,CAAC,IAAI,CAACA,mBAAS,CAAC,OAAO,CAAC,CAAC,CAAC;aAC7B;YAED,YAAY,CAAC,UAAU,GAAG,UAAU,CAAC;YACrC,OAAO,YAAY,CAAC;SACrB;QAEO,iDAAe,GAAf,UAAgB,EAQyB;gBAPvB,KAAK,WAAA,EACL,QAAQ,cAAA,EACR,UAAU,gBAAA,EACJ,UAAU,UAAA,EAChB,QAAQ,cAAA,EACR,UAAU,gBAAA,EACV,UAAU,gBAAA;YAE5B,IAAA,KAAmC,oBAAoB,CAAC,iBAAiB,CAAC,KAAK,CAAC,EAA9E,cAAc,oBAAA,EAAE,YAAY,kBAAkD,CAAC;YAEvF,IAAM,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC9D,IAAM,mBAAmB,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAACjB,mBAAW,CAAC,UAAU,CAAC,CAAC;YAE1E,IAAM,qBAAqB,GAAG,IAAI,CAAC,uBAAuB,CAAC;gBACzD,KAAK,EAAE,cAAc;gBACrB,QAAQ,UAAA;gBACR,UAAU,YAAA;gBACV,IAAI,EAAE,UAAU;gBAChB,QAAQ,UAAA;gBACR,UAAU,YAAA;gBACV,UAAU,YAAA;aACX,CAAC,CAAC;YAEH,IAAM,WAAW,GAAG,IAAIkB,YAAO,EAAe,CAAC;YAC/C,IAAM,YAAY,GAAG,qBAAqB,CAAC,UAAU,CAAC,IAAI,CAACJ,kBAAQ,CAAC,UAAA,CAAC;gBACnE,IAAI,QAAQ,GAAQ,IAAI,CAAC;gBACzB,IAAM,kBAAkB,GAAG,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;gBACtD,IAAM,kBAAkB,GAAG,CAAC,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC;gBACtD,OAAO,mBAAmB,CAAC,IAAI,CAACM,aAAG,CAAC,UAAC,QAAQ;oBAC3C,QAAQ,GAAG;wBACT,QAAQ,EAAE;4BACR,IAAI,EAAE,KAAK;4BACX,aAAa,EAAE;gCACb,CAAC,EAAE,kBAAkB;gCACrB,CAAC,EAAE,kBAAkB;6BACtB;4BACD,WAAW,EAAE,QAAQ,CAAC,WAAW;yBAClC;wBACD,QAAQ,EAAE,CAAC,CAAC,QAAQ;wBACpB,cAAc,EAAE,CAAC,CAAC,cAAc;qBACjC,CAAC;oBACF,OAAO,QAAQ,CAAC;iBACjB,CAAC,EAAEH,mBAAS,CAAC,iBAAiB,CAAC,EAAEK,aAAG,CAAC;oBACpC,QAAQ,EAAE;;wBAER,IAAI,QAAQ,EAAE;4BACZ,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;4BAC9C,SAAS,CAAC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;4BAC/B,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;yBAC7B;qBACF;iBACF,CAAC,CAAC,CAAC;aACL,CAAC,CAAC,CAAC;YAEJ,OAAOV,UAAK,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;SAEzC;QAEO,6CAAW,GAAX,UAAY,QAAa,EAAE,WAAwB,EAAE,UAA6B;YACxF,IAAI,KAAK,GAAQ,EAAE,CAAC;YACpB,QAAQ,WAAW;gBACjB,KAAKX,mBAAW,CAAC,QAAQ,CAAC;gBAC1B,KAAKA,mBAAW,CAAC,QAAQ;oBACvB,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,EAAE,UAAU,CAAC,cAAc,EAAE,UAAU,CAAC,SAAS,EAAE,UAAU,CAAC,UAAU,CAAC,CAAC;oBAC3H,KAAK,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC;oBAC1C,MAAM;gBACR,KAAKA,mBAAW,CAAC,UAAU;oBACzB,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,UAAU,CAAC,SAAS,EAAE,UAAU,CAAC,UAAU,CAAC,CAAC;oBAChG,KAAK,GAAG,IAAI,KAAK,SAAS,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC;oBAC3C,MAAM;gBACR,KAAKA,mBAAW,CAAC,OAAO;oBACtB,MAAM;gBACR;oBACE,MAAM;aACT;;YAGD,IAAI,KAAK,EAAE;gBACT,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,EAAE,IAAI,IAAI,CAAC,EAAE,YAAY,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,SAAS,GAAA,CAAC,CAAC;aAC1G;YAED,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,cAAc,EAAE,KAAK,EAAE,CAAC;SACtD;QAEO,6CAAW,GAAX,UAAY,gBAAqB,EAAE,UAAe,EAAE,UAAuB,EAAE,UAA6B;YAEhH,IAAI,gBAAgB,CAAC,cAAc,KAAK,IAAI,EAAE;gBAC5C,gBAAgB,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACjC,OAAO,gBAAgB,CAAC;aACzB;YACD,IAAI,QAAQ,GAAG,EAAE,CAAC;YAClB,IAAI,UAAU,KAAKA,mBAAW,CAAC,OAAO,EAAE;gBACtC,IAAI,UAAU,EAAE;oBACd,QAAQ,GAAG,gBAAgB,CAAC,cAAc,CAAC,GAAG,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,QAAQ,GAAA,CAAC,CAAC,MAAM,CAAC,UAAC,QAAa;wBAChG,OAAO,QAAQ,IAAI,QAAQ,YAAY,UAAU,CAAC;qBACnD,CAAC,CAAC;iBACJ;qBAAM;oBACL,QAAQ,GAAG,gBAAgB,CAAC,cAAc,CAAC,GAAG,CAAC,UAAC,IAAS,IAAK,OAAA,IAAI,CAAC,QAAQ,GAAA,CAAC,CAAC;iBAC9E;gBAED,QAAQ,GAAG,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;gBACzC,QAAQ,GAAG,CAAC,UAAU,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;gBAC7E,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;oBACzB,QAAQ,GAAG,IAAI,CAAC;iBACjB;aACF;YAED,gBAAgB,CAAC,QAAQ,GAAG,QAAQ,CAAC;YAErC,OAAO,gBAAgB,CAAC;SACzB;QAEO,yCAAO,GAAP,UAAQ,mBAAgC,EAAE,UAAuB;YACvE,IAAI,UAAU,KAAKA,mBAAW,CAAC,QAAQ,IAAI,mBAAmB,CAAC,QAAQ,KAAK,IAAI,IAAI,mBAAmB,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3H,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;aAC3D;iBAAM;gBACL,OAAOc,OAAY,CAAC,mBAAmB,CAAC,CAAC;aAC1C;SACF;;;;gBA3OFrB,eAAU;;;gBAhDF,aAAa;gBACb,kBAAkB;gBAKlB,cAAc;;;;QCFrB,0BAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;YAFxC,sBAAiB,GAAU,EAAE,CAAC;SAIrC;QAED,mDAAwB,GAAxB,UAAyB,WAAkB,EAAE,MAAc;YAA3D,iBAKC;YAJC,WAAW,CAAC,OAAO,CAAC,UAAA,EAAE;gBACpB,EAAE,CAAC,MAAM,GAAG,MAAM,CAAC;gBACnB,KAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACjC,CAAC,CAAC;SACJ;QAED,wCAAa,GAAb;YAAA,iBAMC;YALC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,OAAA,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,GAAA,CAAC,CAAC;YAE3D,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,UAAC,UAAU;gBACxC,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aAC5D,CAAC,CAAC;SACJ;QAED,2CAAgB,GAAhB,UAAiB,WAAkB,EAAE,SAAiB;YAAtD,iBAYC;YAXC,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,EAAE;gBACrC,WAAW,CAAC,OAAO,CAAC,UAAC,EAAE;oBACrB,IAAM,KAAK,GAAG,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;oBACjD,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;wBAChB,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,SAAS,CAAC;qBAClD;iBACF,CAAC,CAAC;gBAEH,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;gBACvD,IAAI,CAAC,aAAa,EAAE,CAAC;aACtB;SACF;QAED,4CAAiB,GAAjB,UAAkB,WAAkB;YAApC,iBAQC;YAPC,WAAW,CAAC,OAAO,CAAC,UAAA,EAAE;gBACpB,IAAM,KAAK,GAAG,KAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;gBACjD,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;oBAChB,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;oBACxC,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;iBAC7D;aACF,CAAC,CAAC;SACJ;;;;gBA9CFA,eAAU;;;gBAHF,aAAa;;;ICGtB;;;;;QAWE;YALQ,qBAAgB,GAAG,CAAC,CAAC;YACrB,UAAK,GAAG,IAAI,GAAG,EAA0B,CAAC;YAE1C,yBAAoB,GAAe,EAAE,CAAC;SAG7C;QAED,mCAAM,GAAN,UAAO,EAAW;YAChB,IAAI,CAAC,EAAE,EAAE;gBACP,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;YACD,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC3B;QAED,yCAAY,GAAZ,UAAa,EAAU,EAAE,KAAqB;YAC5C,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBAClB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;aACvB;YAED,IAAM,KAAK,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACjD,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;gBACzB,MAAM,IAAI,KAAK,CAAC,kBAAgB,KAAK,mBAAgB,CAAC,CAAC;aACxD;YACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YAC7B,OAAO,KAAK,CAAC;SACd;QAED,2CAAc,GAAd,UAAe,EAAU;YACvB,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,QAAQ,EAAE;gBAC9D,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;gBACjC,IAAI,CAAC,IAAI,EAAE,CAAC;gBACZ,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC;aACnC;YACD,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC9B;QAEO,8CAAiB,GAAjB;YACN,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxB,OAAO,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC;SAClD;;;;;;;;QASD,8CAAiB,GAAjB,UAAkB,iBAA6E;YAA/F,iBA+CC;YA9CC,IAAM,mBAAmB,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAM,IAAI,GAAsF,iBAAiB,CAAC,GAAG,CAAC,UAAA,MAAM;gBAC1H,IAAM,GAAG,GAAG,KAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBACnC,IAAI,CAAC,GAAG,EAAE;oBACR,MAAM,IAAI,KAAK,CAAC,gCAA8B,MAAM,CAAC,EAAI,CAAC,CAAC;iBAC5D;gBAED,OAAO,EAAC,GAAG,KAAA,EAAE,OAAO,EAAE,EAAC,WAAW,EAAE,MAAM,CAAC,WAAW,EAAE,QAAQ,EAAE,MAAM,CAAC,QAAQ,EAAC,EAAC,CAAC;aACrF,CAAC,CAAC;YAEH,IAAI,CAAC,OAAO,CAAC,UAAA,eAAe;gBAC1B,IAAM,SAAS,GAAG,eAAe,CAAC,GAAG,CAAC;gBACtC,IAAM,OAAO,GAAG,eAAe,CAAC,OAAO,CAAC;gBACxC,IAAM,YAAY,GAAG,SAAS,CAAC,gBAAgB,EAAE,CAAC,SAAS,EAAE,CAAC;gBAC9D,IAAM,wBAAwB,GAAG,YAAY,CAAC,oBAAoB,CAAC;gBACnE,YAAY,CAAC,iBAAiB,GAAG,OAAO,CAAC,WAAW,IAAI,mBAAmB,CAAC;gBAC5E,IAAM,cAAc,GAAG,YAAY,CAAC,OAAO,CAAC,gBAAgB,CAAC;oBAC3D,IAAI,CAAC,OAAO,CAAC,UAAA,cAAc;wBACzB,IAAM,QAAQ,GAAG,cAAc,CAAC,GAAG,CAAC;wBACpC,IAAM,eAAe,GAAG,cAAc,CAAC,OAAO,CAAC;wBAC/C,IAAI,QAAQ,KAAK,SAAS,EAAE;4BAC1B,OAAO;yBACR;wBAED,IAAM,WAAW,GAAG,QAAQ,CAAC,gBAAgB,EAAE,CAAC,SAAS,EAAE,CAAC;wBAC5D,IAAM,uBAAuB,GAAG,WAAW,CAAC,oBAAoB,CAAC;wBACjE,IAAM,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,uBAAuB,CAAC;4BAC9D,SAAS,EAAE,wBAAwB,CAAC,SAAS;4BAC7C,QAAQ,EAAE,wBAAwB,CAAC,QAAQ;4BAC3C,MAAM,EAAE,eAAe,CAAC,QAAQ,GAAG,wBAAwB,CAAC,MAAM,GAAG,uBAAuB,CAAC,MAAM;yBACpG,CAAC,CAAC;wBAEH,IAAI,QAAQ,CAAC,eAAe,EAAE,CAAC,KAAK,CAAC,IAAI,KAAK,MAAM,CAAC,SAAS,CAAC,QAAQ,EAAE;4BACvE,WAAW,CAAC,OAAO,CAAC;gCAClB,WAAW,EAAE,QAAQ;gCACrB,WAAW,EAAE;oCACX,OAAO,EAAE,WAAW,CAAC,OAAO;oCAC5B,KAAK,EAAE,WAAW,CAAC,KAAK;iCACzB;6BACF,CAAC,CAAC;yBACJ;qBACF,CAAC,CAAC;iBACJ,CAAC,CAAC;gBACH,KAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;aAChD,CAAC,CAAC;SACJ;;;;QAKD,8CAAiB,GAAjB;YACE,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,UAAA,cAAc,IAAI,OAAA,cAAc,EAAE,GAAA,CAAC,CAAC;YACtE,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC;SAChC;;;;gBA1GFA,eAAU;;;;ICJX;;;;;;;;;;;;;;;QAgBE,2BAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;SAC/C;QAED,yDAA6B,GAA7B;YACE,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC;YAC9C,OAAO,MAAM,CAAC,SAAS,EAAE,CAAC;SAC3B;QAGD,iDAAqB,GAArB,UAAsB,QAAoB;YAApB,yBAAA,EAAA,oBAAoB;YACxC,IAAM,OAAO,GAAG,IAAI,CAAC,6BAA6B,EAAE,CAAC;YACrD,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACrC;QAEO,uCAAW,GAAX,UAAY,GAAW,EAAE,IAAY;YAC3C,IAAM,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;YACzC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;YAChB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;SACjC;;;;gBAvBFA,eAAU;;;gBAhBF,aAAa;;;ICwBtB;;;;;;;;;;;;;;;;QA+EE,wBACU,cAA6B,EAC7B,cAA6B,EAC7B,QAAoB,EACF,QAAQ,EAC1B,kBAAsC,EACtC,sBAA8C,EAC9C,kBAAsC,EACtC,oBAA0C,EAC1C,qBAA4C,EAC5C,oBAA0C,EAC1C,gBAAkC,EAClC,kBAAsC,EACtC,iBAAoC,EACpC,gBAAyC,EACzC,sBAA8C,EAC9C,gBAAkC,EAClC,oBAA0C,EAC1C,iBAAoC,EACrC,kBAAsC,EACrC,mBAAwC;YAnBxC,mBAAc,GAAd,cAAc,CAAe;YAC7B,mBAAc,GAAd,cAAc,CAAe;YAC7B,aAAQ,GAAR,QAAQ,CAAY;YACF,aAAQ,GAAR,QAAQ,CAAA;YAC1B,uBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,2BAAsB,GAAtB,sBAAsB,CAAwB;YAC9C,uBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,yBAAoB,GAApB,oBAAoB,CAAsB;YAC1C,0BAAqB,GAArB,qBAAqB,CAAuB;YAC5C,yBAAoB,GAApB,oBAAoB,CAAsB;YAC1C,qBAAgB,GAAhB,gBAAgB,CAAkB;YAClC,uBAAkB,GAAlB,kBAAkB,CAAoB;YACtC,sBAAiB,GAAjB,iBAAiB,CAAmB;YACpC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,2BAAsB,GAAtB,sBAAsB,CAAwB;YAC9C,qBAAgB,GAAhB,gBAAgB,CAAkB;YAClC,yBAAoB,GAApB,oBAAoB,CAAsB;YAC1C,sBAAiB,GAAjB,iBAAiB,CAAmB;YACrC,uBAAkB,GAAlB,kBAAkB,CAAoB;YACrC,wBAAmB,GAAnB,mBAAmB,CAAqB;;;;YAlDlD,0BAAqB,GAAG,KAAK,CAAC;YAoD5B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACvD,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YACvC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;YACxC,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,eAAe,CAAC;YAC9C,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;YAClD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;YAC9C,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAAC;YACnC,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;YAC/B,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC;YACjC,IAAI,CAAC,qBAAqB,CAAC,IAAI,EAAE,CAAC;YAClC,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC;YACjC,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC;YAC7B,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;YAC/B,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC;YAC9B,IAAI,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAAC;YACnC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;SACrD;QAED,iCAAQ,GAAR;YACE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YACpE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACrB,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aAC5D;SACF;QAED,oCAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,WAAW,CAAC,EAAE;gBACxB,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,CAAC;aACrE;YACD,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;gBACpB,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC;aAChE;YACD,IAAI,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,WAAW,EAAE;gBACjE,IAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,YAAY,CAAC,CAAC;gBAClF,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;iBACxC;qBAAM;oBACL,MAAM,IAAI,KAAK,CAAC,+BAA6B,OAAO,CAAC,aAAa,CAAC,CAAC,YAAc,CAAC,CAAC;iBACrF;aACF;SACF;QAED,wCAAe,GAAf;YAAA,iBAYC;YAXC,IAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,CAAC;YACtC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,UAAU,CAAC;oBACT,IAAM,OAAO,GAAG,KAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,KAAI,CAAC,WAAW,CAAC,CAAC;oBAC/D,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,WAAW,CAAC,KAAI,CAAC,YAAY,CAAC,CAAC;qBACxC;yBAAM;wBACL,MAAM,IAAI,KAAK,CAAC,+BAA6B,KAAI,CAAC,WAAa,CAAC,CAAC;qBAClE;iBACF,EAAE,CAAC,CAAC,CAAC;aACP;SACF;QAED,oCAAW,GAAX;YACE,IAAM,MAAM,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;YACtC,MAAM,CAAC,OAAO,EAAE,CAAC;YACjB,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC;YAC3B,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SACpD;;;;QAKD,yCAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,cAAc,CAAC;SAC5B;;;;QAKD,wCAAe,GAAf;YACE,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC;SACxC;QAGD,yCAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,cAAc,CAAC;SAC5B;QAED,8BAAK,GAAL;YACE,OAAO,IAAI,CAAC,KAAK,CAAC;SACnB;QAGD,wCAAe,GAAf;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;QAGD,4CAAmB,GAAnB;YACE,OAAO,IAAI,CAAC,gBAAgB,CAAC;SAC9B;QAED,8CAAqB,GAArB;YACE,OAAO,IAAI,CAAC,kBAAkB,CAAC;SAChC;QAED,6CAAoB,GAApB;YACE,OAAO,IAAI,CAAC,iBAAiB,CAAC;SAC/B;QAED,kDAAyB,GAAzB;YACE,OAAO,IAAI,CAAC,sBAAsB,CAAC;SACpC;QAED,+CAAsB,GAAtB;YACE,OAAO,IAAI,CAAC,mBAAmB,CAAC;SACjC;;;;gBArMF6B,cAAS,SAAC;oBACT,QAAQ,EAAE,QAAQ;oBAClB,QAAQ,EAAE,8KAIT;oBACD,SAAS,EAAE;wBACT,aAAa;wBACb,sBAAsB;wBACtB,kBAAkB;wBAClB,sBAAsB;wBACtB,uBAAuB;wBACvB,cAAc;wBACd,kBAAkB;wBAClB,qBAAqB;wBACrB,8BAA8B;wBAC9B,oBAAoB;wBACpB,kBAAkB;wBAClB,gBAAgB;wBAChB,iBAAiB;wBACjB,oBAAoB;wBACpB,gBAAgB;wBAChB,aAAa;wBACb,iBAAiB;wBACjB,kBAAkB;wBAClB,mBAAmB;qBACpB;iBACF;;;gBAlEQ,aAAa;gBAGb,aAAa;gBAJaC,eAAU;gDA2GxC1B,WAAM,SAACY,eAAQ;gBAvFX,kBAAkB;gBAZlB,sBAAsB;gBAGtB,kBAAkB;gBADlB,oBAAoB;gBAIpB,qBAAqB;gBADrB,oBAAoB;gBANpB,gBAAgB;gBAKhB,kBAAkB;gBAHlB,iBAAiB;gBASjB,uBAAuB;gBAFvB,sBAAsB;gBAGtB,gBAAgB;gBAjBhB,oBAAoB;gBAoBpB,iBAAiB;gBAjBjB,kBAAkB;gBAClB,mBAAmB;;;wCAkEzBe,UAAK;wBAOLA,UAAK;wBAMLA,UAAK;4BAMLA,UAAK;8BAOLA,UAAK;;;;QC/FR;YAOU,WAAM,GAAG,IAAI,CAAC;YACd,iBAAY,GAAmB,EAAE,CAAC;YAClC,gBAAW,GAAG,IAAIvB,iBAAY,EAAE,CAAC;SA8E1C;QA5EC,sBAAI,+BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;iBAED,UAAU,KAAc;gBACtB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAJA;QAMD,sBAAI,gCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,KAAa;gBACtB,IAAI,KAAK,KAAK,IAAI,CAAC,OAAO,EAAE;oBAC1B,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;iBACzB;gBACD,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtB;;;WAPA;QASD,sBAAI,8BAAI;iBAAR;gBACE,OAAO,IAAI,CAAC,KAAK,CAAC;aACnB;iBAED,UAAS,KAAc;gBACrB,IAAI,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;oBACxB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;iBACzB;gBACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;aACpB;;;WAPA;QASD,sBAAI,iCAAO;iBAAX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;iBAED,UAAY,KAAmB;gBAC7B,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;gBACtB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;aACzB;;;WALA;QAOD,sBAAI,iCAAO;iBAAX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;iBAED,UAAY,OAAO;gBACjB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;gBACxB,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;aACzB;;;WALA;QAOD,oCAAa,GAAb,UAAc,IAAY;YACxB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;QAED,oCAAa,GAAb;YACE,OAAO,IAAI,CAAC,WAAW,CAAC;SACzB;QAED,0CAAmB,GAAnB,UAAoB,oBAAkC;YACpD,IAAI,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,oBAAoB,CAAC,GAAG,CAAC,EAAE;gBACvD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;aAC9C;SACF;QAED,4CAAqB,GAArB,UAAsB,oBAAkC;YACtD,IAAM,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC;YAC9D,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;gBACd,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;aACpC;SACF;QAED,sCAAe,GAAf;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;QAED,mCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,WAAW,CAAC;SACzB;;;;gBAtFFR,eAAU;;;ICJX;;;IAGA,WAAY,UAAU;QACpB,uDAAU,CAAA;QACV,+CAAM,CAAA;IACR,CAAC,EAHWgC,kBAAU,KAAVA,kBAAU;;;QCDtB;YAEU,WAAM,GAAG,IAAI,GAAG,EAAe,CAAC;SAezC;QAbC,8BAAG,GAAH,UAAI,UAAkB,EAAE,QAAqB;YAC3C,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;gBAC/B,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aACpC;YAED,IAAM,KAAK,GAAG,QAAQ,EAAE,CAAC;YACzB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;YACnC,OAAO,KAAK,CAAC;SACd;QAED,gCAAK,GAAL;YACE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;SACrB;;;;gBAhBFhC,eAAU;;;ICFX;QAAA;SAcC;QAbQ,4BAAoB,GAA3B,UAA4B,MAAc,EAAE,aAAuB;YACjE,aAAa,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,OAAO,CAAC,iBAAiB,CAAC,MAAM,EAAE,YAAY,CAAC,GAAA,CAAC,CAAC;SACxF;QAEM,yBAAiB,GAAxB,UAAyB,KAAU,EAAE,IAAY;YAC/C,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE;gBACjC,MAAM,IAAI,KAAK,CAAC,YAAU,IAAI,oBAAiB,CAAC,CAAC;aAClD;SACF;QAEM,eAAO,GAAd,UAAe,KAAU;YACvB,OAAO,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,IAAI,CAAC;SAC9C;sBACF;KAAA;;ICPD;;;;;;;QAOiD,+CAAuB;QACtE,qCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,mBAAmB,EAAE,aAAa,CAAC;SACjD;QAED,yCAAG,GAAH,UAAI,WAAgB;YAClB,OAAO,CAAC,oBAAoB,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,eAAe,EAAE,eAAe,CAAC,CAAC,CAAC;YAExF,OAAO,iBAAM,GAAG,YAAC,IAAIiC,oCAAgB,CAAC,WAAW,CAAC,CAAC,CAAC;SACrD;QAED,4CAAM,GAAN,UAAO,OAAY,EAAE,WAAgB;YACnC,OAAO,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;YAExC,OAAO,OAAO,CAAC;SAChB;;KAfH,CAAiD,uBAAuB;;gBADvEjC,eAAU;;;gBAZF,aAAa;;;ICGtB;;;;QAIkD,gDAAuB;QACvE,sCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,kBAAkB,EAAE,aAAa,CAAC;SAChD;;KAHH,CAAkD,uBAAuB;;gBADxEA,eAAU;;;gBANF,aAAa;;;ICEtB;;;;;;QAKoD,yCAAuB;QACzE,+BAAoB,YAAiB,EAAE,aAA4B;YAAnE,YACE,kBAAM,MAAM,CAAC,mBAAmB,EAAE,aAAa,CAAC,SACjD;YAFmB,kBAAY,GAAZ,YAAY,CAAK;;SAEpC;QAED,mCAAG,GAAH,UAAI,aAAkB,EAAE,aAAkB,EAAE,cAAmB;YAC7D,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC3C,OAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,EAAE;aACnD;YACD,aAAa,CAAC,QAAQ,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;YAC9D,cAAc,CAAC,iBAAiB,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;YAC9E,cAAc,CAAC,YAAY,GAAG,KAAK,CAAC;YACpC,IAAM,SAAS,GAAG,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;YACvD,OAAO,iBAAM,GAAG,YAAC,SAAS,CAAC,CAAC;SAC7B;QAED,sCAAM,GAAN,UAAO,SAAc,EAAE,aAAkB,EAAE,aAAkB,EAAE,cAAmB;YAChF,aAAa,CAAC,QAAQ,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;YAC9D,cAAc,CAAC,iBAAiB,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;YAC9E,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;YACzC,OAAO,iBAAM,GAAG,YAAC,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC,CAAC;SACxD;oCACF;KAtBD,CAAoD,uBAAuB;;ICJ3E;;;;QAI+C,6CAAqB;QAClE,mCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,cAAc,EAAE,aAAa,CAAC;SAC5C;;KAHH,CAA+C,qBAAqB;;gBADnEA,eAAU;;;gBANF,aAAa;;;ICGtB;;;;;QAKiD,+CAAqB;QACpE,qCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,gBAAgB,EAAE,aAAa,CAAC;SAC9C;;;;QAKD,4CAAM,GAAN,UAAO,SAAc,EAAE,aAAkB,EAAE,aAAkB,EAAE,cAAmB;YAChF,IAAM,KAAK,GAAG,aAAa,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC;YAEnD,IAAI,SAAS,CAAC,KAAK,EAAE;gBACnB,SAAS,CAAC,6BAA6B,EAAE,CAAC,KAAK,GAAG,KAAK,CAAC;aACzD;iBAAM;gBACL,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,UAAC,cAAmB;oBAC3D,cAAc,CAAC,6BAA6B,EAAE,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;iBACpE,CAAC,CAAC;aACJ;YAED,OAAO,SAAS,CAAC;SAClB;;KApBH,CAAiD,qBAAqB;;gBADrEA,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;;;QAMgD,8CAAqB;QACnE,oCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,eAAe,EAAE,aAAa,CAAC;SAC7C;;KAHH,CAAgD,qBAAqB;;gBADpEA,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;;;QAMgD,8CAAqB;QACnE,oCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,eAAe,EAAE,aAAa,CAAC;SAC7C;;KAHH,CAAgD,qBAAqB;;gBADpEA,eAAU;;;gBAVF,aAAa;;;ICKtB;;;;QAIwC,sCAAqB;QAC3D,4BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,KAAK,CAAC;SACzC;;KAHH,CAAwC,qBAAqB;;gBAD5Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAIsC,oCAAqB;QACzD,0BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,GAAG,CAAC;SACvC;;KAHH,CAAsC,qBAAqB;;gBAD1Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAI2C,yCAAqB;QAC9D,+BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,QAAQ,CAAC;SAC5C;;KAHH,CAA2C,qBAAqB;;gBAD/Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAI2C,yCAAqB;QAC9D,+BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,QAAQ,CAAC;SAC5C;;KAHH,CAA2C,qBAAqB;;gBAD/Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAI4C,0CAAqB;QAC/D,gCAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,SAAS,CAAC;SAC7C;;KAHH,CAA4C,qBAAqB;;gBADhEb,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAIiD,+CAAqB;QACpE,qCAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,cAAc,CAAC;SAClD;;KAHH,CAAiD,qBAAqB;;gBADrEb,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAIuC,qCAAqB;QAC1D,2BAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,IAAI,CAAC;SACxC;;KAHH,CAAuC,qBAAqB;;gBAD3Db,eAAU;;;gBANF,aAAa;;;ICGtB;;;;QAI4C,0CAAqB;QAC/D,gCAAY,aAA4B;mBACtC,kBAAM,aAAa,EAAEa,UAAY,CAAC,SAAS,CAAC;SAC7C;;KAHH,CAA4C,qBAAqB;;gBADhEb,eAAU;;;gBANF,aAAa;;;ICEtB;;;;;QAKiD,+CAAuB;QACtE,qCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,eAAe,EAAE,aAAa,CAAC;SAC7C;;KAHH,CAAiD,uBAAuB;;gBADvEA,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;;QAKqD,mDAAuB;QAC1E,yCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,mBAAmB,EAAE,aAAa,CAAC;SACjD;;KAHH,CAAqD,uBAAuB;;gBAD3EA,eAAU;;;gBAPF,aAAa;;;ICGtB;;;;;QAKiD,+CAAuB;QACtE,qCAAY,aAA4B;mBACtC,kBAAM,MAAM,CAAC,wBAAwB,EAAE,aAAa,CAAC;SACtD;;KAHH,CAAiD,uBAAuB;;gBADvEA,eAAU;;;gBAPF,aAAa;;;;QCIiB,qCAAuB;QAC5D,2BAAoB,cAA6B;YAAjD,YACE,kBAAM,MAAM,CAAC,cAAc,EAAE,cAAc,CAAC,SAC7C;YAFmB,oBAAc,GAAd,cAAc,CAAe;;SAEhD;QAED,+BAAG,GAAH,UAAI,WAAgB;YAClB,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;YACnD,WAAW,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,eAAe,EAAE,CAAC;YAC1E,OAAO,iBAAM,GAAG,YAAC,WAAW,CAAC,CAAC;SAC/B;;KATH,CAAuC,uBAAuB;;gBAD7DA,eAAU;;;gBAHF,aAAa;;;ICwCtB;IACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAkGE,0BAAoB,YAA0B,EAC1B,iBAAmC,EACnC,gBAAkC,EAC1C,sBAA8C,EAC9C,kBAAsC,EACtC,oBAA0C,EAC1C,qBAA4C,EAC5C,oBAA0C,EAC1C,gBAAkC,EAClC,kBAAsC,EACtC,kBAAsC,EACtC,gBAAkC,EAClC,qBAA4C,EAC5C,qBAA4C,EAC5C,qBAA6C,EAC7C,2BAAwD,EACxD,iBAAoC,EACpC,sBAA8C,EAC9C,2BAAwD,EACxD,4BAA0D,EAC1D,yBAAoD,EACpD,2BAAwD,EACxD,0BAAsD,EACtD,0BAAsD,EACtD,8BAA8D,EAC9D,2BAAwD,EACxD,+BAAgE,EAChE,2BAAwD,EACxD,iBAAoC,EACpC,iBAAoC;YA7B5B,iBAAY,GAAZ,YAAY,CAAc;YAC1B,sBAAiB,GAAjB,iBAAiB,CAAkB;YACnC,qBAAgB,GAAhB,gBAAgB,CAAkB;YAzBtD,SAAI,GAAG,IAAI,CAAC;YAMZ,UAAK,GAAG,KAAK,CAAC;YAId,WAAM,GAAG,CAAC,CAAC;YAEX,UAAK,GAAG,KAAK,CAAC;YAEG,aAAQ,GAAG,sBAAsB,CAAC;YAE3C,mBAAc,GAAG,IAAIwB,YAAO,EAAO,CAAC;YAGpC,kBAAa,GAA4B,IAAIA,YAAO,EAAkB,CAAC;YACvE,kBAAa,GAAG,IAAI,GAAG,EAAe,CAAC;YACvC,2BAAsB,GAAU,EAAE,CAAC;YAiCzC,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,CAAC;gBACzB,CAAC,WAAW,EAAE,sBAAsB,CAAC;gBACrC,CAAC,OAAO,EAAE,kBAAkB,CAAC;gBAC7B,CAAC,SAAS,EAAE,oBAAoB,CAAC;gBACjC,CAAC,UAAU,EAAE,qBAAqB,CAAC;gBACnC,CAAC,SAAS,EAAE,oBAA0C,CAAC;gBACvD,CAAC,KAAK,EAAE,gBAAgB,CAAC;gBACzB,CAAC,OAAO,EAAE,kBAAkB,CAAC;gBAC7B,CAAC,OAAO,EAAE,kBAAkB,CAAC;gBAC7B,CAAC,KAAK,EAAE,gBAAgB,CAAC;gBACzB,CAAC,UAAU,EAAE,qBAAqB,CAAC;gBACnC,CAAC,UAAU,EAAE,qBAAqB,CAAC;gBACnC,CAAC,WAAW,EAAE,qBAAqB,CAAC;gBACpC,CAAC,gBAAgB,EAAE,2BAA2B,CAAC;gBAC/C,CAAC,WAAW,EAAE,sBAAsB,CAAC;gBACrC,CAAC,MAAM,EAAE,iBAAiB,CAAC;gBAC3B,CAAC,mBAAmB,EAAE,8BAA8B,CAAC;gBACrD,CAAC,gBAAgB,EAAE,2BAA2B,CAAC;gBAC/C,CAAC,oBAAoB,EAAE,+BAA+B,CAAC;gBACvD,CAAC,gBAAgB,EAAE,2BAA2B,CAAC;gBAC/C,CAAC,MAAM,EAAE,iBAAiB,CAAC;gBAC3B,CAAC,MAAM,EAAE,iBAAiB,CAAC;gBAE3B,CAAC,gBAAgB,EAAE,2BAA2B,CAAC;gBAC/C,CAAC,iBAAiB,EAAE,4BAA4B,CAAC;gBACjD,CAAC,cAAc,EAAE,yBAAyB,CAAC;gBAC3C,CAAC,gBAAgB,EAAE,2BAA2B,CAAC;gBAC/C,CAAC,eAAe,EAAE,0BAA0B,CAAC;gBAC7C,CAAC,eAAe,EAAE,0BAA0B,CAAC;aAC9C,CAAC,CAAC;SACJ;QAED,+BAAI,GAAJ;YAAA,iBA6BC;YA5BC,IAAI,CAAC,eAAe,EAAE,CAAC;YAEvBU,UAAe,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC,IAAI,CAAiBX,mBAAS,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,SAAS,CAAC,UAAC,YAAY;gBAC/H,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;gBAE/B,IAAI,KAAI,CAAC,KAAK,EAAE;oBACd,OAAO,CAAC,GAAG,CAAC,gCAAgC,EAAE,YAAY,CAAC,CAAC;iBAC7D;gBAED,IAAI,aAAa,GAAG,YAAY,CAAC,MAAM,CAAC;gBACxC,IAAI,KAAI,CAAC,KAAK,EAAE;oBACd,aAAa,GAAG,KAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;iBAChD;gBAED,KAAI,CAAC,OAAO,CAAC,KAAI,CAAC,UAAU,CAAC,GAAG,aAAa,CAAC;gBAC9C,KAAI,CAAC,YAAY,CAAC,eAAe,EAAE,CAAC,OAAO,CAAC,UAAC,oBAAoB;oBAC/D,QAAQ,YAAY,CAAC,UAAU;wBAC7B,KAAKS,kBAAU,CAAC,UAAU;4BACxB,oBAAoB,CAAC,IAAI,CAAC,KAAI,CAAC,OAAO,EAAE,YAAY,CAAC,EAAE,EAAE,aAAa,CAAC,CAAC;4BACxE,MAAM;wBACR,KAAKA,kBAAU,CAAC,MAAM;4BACpB,oBAAoB,CAAC,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;4BAC7C,MAAM;wBACR;4BACE,OAAO,CAAC,KAAK,CAAC,iEAAiE,GAAG,YAAY,CAAC,CAAC;qBACnG;iBACF,CAAC,CAAC;aACJ,CAAC,CAAC;SACJ;QAEO,sCAAW,GAAX,UAAY,YAA4B;YAC9C,IAAI,YAAY,CAAC,UAAU,KAAKA,kBAAU,CAAC,MAAM,EAAE;gBACjD,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,OAAO,SAAS,CAAC;aAClB;iBAAM;gBACL,IAAI,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE;oBAC3C,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;oBACvD,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;oBAC3C,OAAO,MAAM,CAAC;iBACf;qBAAM;oBACL,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,EAAE,YAAY,CAAC,MAAM,CAAC,CAAC;oBAC7D,OAAO,YAAY,CAAC,MAAM,CAAC;iBAC5B;aACF;SACF;QAEO,0CAAe,GAAf;YACN,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;gBACjB,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;aACzD;YAED,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBACnC,MAAM,IAAI,KAAK,CAAC,uGAAmG,IAAI,CAAC,KAAO,CAAC,CAAC;aAClI;YACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACvC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;gBACvC,MAAM,IAAI,KAAK,CAAC,0EAA0E,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;aAC/G;YAED,IAAI,CAAC,YAAY,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YACzC,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SAClD;;QAGO,uCAAY,GAAZ,UAAa,GAAQ;;;YAG3B,OAAO,GAAG,IAAI,OAAO,GAAG,CAAC,SAAS,KAAK,UAAU,CAAC;SACnD;QAED,6CAAkB,GAAlB;YACE,IAAI,CAAC,IAAI,EAAE,CAAC;SACb;QAED,mCAAQ,GAAR;YAAA,iBAgBC;YAfC,IAAI,CAAC,YAAY,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YACzC,IAAI,CAAC,YAAY,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YACzC,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;YACnC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;YACvC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAC,MAAM,EAAE,UAAU;;gBAC1C,IAAM,WAAW,GAAG,KAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC;gBACxE,IAAM,iBAAiB,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;;gBAEnD,IAAI,iBAAiB,EAAE;;;oBAGrB,CAAA,KAAA,KAAI,CAAC,sBAAsB,EAAC,IAAI,oBAAI,iBAAiB,GAAE;iBACxD;gBACD,MAAM,CAAC,OAAO,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC;aAC3B,CAAC,CAAC;SACJ;QAED,sCAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE;gBAC7C,IAAM,WAAS,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;gBAC/C,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,WAAS,CAAC;gBACnC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAC,MAAM,IAAK,OAAA,MAAM,CAAC,OAAO,CAAC,WAAS,CAAC,GAAA,CAAC,CAAC;aACjE;YAED,IAAI,OAAO,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE;gBACjD,IAAM,WAAW,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC;gBACnD,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,WAAW,CAAC;gBACvC,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,IAAI,CAAC,sBAAsB,EAAE,WAAW,CAAC,CAAC;aAClF;SACF;QAED,sCAAW,GAAX;YACE,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;YACrE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/B,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,0CAAe,GAAf;YACE,OAAO,IAAI,CAAC,YAAY,CAAC;SAC1B;;;;;QAMD,oDAAyB,GAAzB;YACE,OAAO,IAAI,CAAC,sBAAsB,CAAC;SACpC;;;;;;QAOD,qDAA0B,GAA1B,UAA2B,IAAY;YACrC,OAAO,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,IAAI,KAAK,IAAI,GAAA,CAAC,CAAC;SACjE;;;;QAKD,mCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;;;;QAKD,oCAAS,GAAT;YACE,IAAI,CAAC,YAAY,CAAC,eAAe,EAAE,CAAC,OAAO,CAAC,UAAC,WAAW,IAAK,OAAA,WAAW,CAAC,SAAS,EAAE,GAAA,CAAC,CAAC;YACtF,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SAC5B;;;;QAKD,iCAAM,GAAN,UAAO,QAAgB;YACrB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAEA,kBAAU,CAAC,MAAM,EAAC,CAAC,CAAC;YACvE,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;SACrC;;;;QAKD,6CAAkB,GAAlB,UAAmB,YAA4B;YAC7C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SACvC;;;;QAKD,iCAAM,GAAN,UAAO,MAAgB,EAAE,EAAU;YACjC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,EAAC,MAAM,QAAA,EAAE,EAAE,IAAA,EAAE,UAAU,EAAEA,kBAAU,CAAC,UAAU,EAAC,CAAC,CAAC;SAC1E;QAED,qCAAU,GAAV,UAAW,UAA4B;YAAvC,iBAGC;;YADCG,SAAc,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,UAAC,MAAM,IAAK,OAAA,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,GAAA,CAAC,CAAC;SACnF;;;;gBA7SFN,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,QAAQ,EAAE,2BAA2B;oBACrC,SAAS,EAAE;wBACT,YAAY;wBACZ,gBAAgB;wBAChB,sBAAsB;wBACtB,kBAAkB;wBAClB,oBAAoB;wBACpB,qBAAqB;wBACrB,gBAAgB;wBAChB,kBAAkB;wBAClB,oBAAoB;wBACpB,kBAAkB;wBAClB,gBAAgB;wBAChB,qBAAqB;wBACrB,qBAAqB;wBACrB,sBAAsB;wBACtB,2BAA2B;wBAC3B,iBAAiB;wBACjB,sBAAsB;wBACtB,8BAA8B;wBAC9B,2BAA2B;wBAC3B,+BAA+B;wBAC/B,2BAA2B;wBAC3B,iBAAiB;wBACjB,iBAAiB;wBAEjB,2BAA2B;wBAC3B,4BAA4B;wBAC5B,yBAAyB;wBACzB,2BAA2B;wBAC3B,0BAA0B;wBAC1B,0BAA0B;qBAC3B;oBACD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBA5GQ,YAAY;gBAGZ,gBAAgB;gBA2BhB,gBAAgB;gBAhChB,sBAAsB;gBAMtB,kBAAkB;gBAClB,oBAAoB;gBACpB,qBAAqB;gBAKrB,oBAAoB;gBAJpB,gBAAgB;gBAChB,kBAAkB;gBAWlB,kBAAkB;gBAClB,gBAAgB;gBAChB,qBAAqB;gBACrB,qBAAqB;gBACrB,sBAAsB;gBACtB,2BAA2B;gBAC3B,iBAAiB;gBACjB,sBAAsB;gBAbtB,2BAA2B;gBAC3B,4BAA4B;gBAC5B,yBAAyB;gBACzB,2BAA2B;gBAC3B,0BAA0B;gBAC1B,0BAA0B;gBAS1B,8BAA8B;gBAC9B,2BAA2B;gBAC3B,+BAA+B;gBAE/B,2BAA2B;gBAC3B,iBAAiB;gBACjB,iBAAiB;;;uBA6EvBL,UAAK;wBAELA,UAAK;0BAELA,UAAK;wBAELA,UAAK;0BAELA,UAAK;yBAELA,UAAK;wBAELA,UAAK;;;IC5HR;;;;QAYE,8BAAsB,OAA2B,EAAU,SAA2B;YAAhE,YAAO,GAAP,OAAO,CAAoB;YAAU,cAAS,GAAT,SAAS,CAAkB;SACrF;QAED,uCAAQ,GAAR;YACE,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,IAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;YACxC,IAAI,WAAW,EAAE;gBACf,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;;aAEhC;YACD,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;QAED,0CAAW,GAAX,UAAY,OAAsB;YAChC,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;YAC/B,IAAI,KAAK,CAAC,YAAY,KAAK,KAAK,CAAC,aAAa,EAAE;gBAC9C,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;QAED,wCAAS,GAAT;YACE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;YAChC,OAAO,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC1D;QAED,4CAAa,GAAb;YACE,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAChD;QAED,0CAAW,GAAX;YACE,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBAC5B,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;aAC5D;SACF;QAED,0CAAW,GAAX;YACE,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACnD,IAAI,CAAC,aAAa,EAAE,CAAC;SACtB;;;;gBAhDFM,cAAS;;;gBAND,kBAAkB;gBAClB,gBAAgB;;;wBAOtBN,UAAK;;;ICJR;;;;;;;;;;;;;;;;;;;;QAwB0C,wCAAoB;QAE5D,8BAAY,eAAuC,EAAE,SAA2B;mBAC9E,kBAAM,eAAe,EAAE,SAAS,CAAC;SAClC;;KAJH,CAA0C,oBAAoB;;gBAJ7DF,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,EAAE;iBACb;;;gBA1BQ,sBAAsB;gBACtB,gBAAgB;;;;QCIvB;YACE,IAAI,CAAC,OAAO,GAAG,IAAIS,iCAAgB,EAAE,CAAC;SACvC;QAED,wBAAG,GAAH,UAAI,UAAkB;YACpB,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACrC;;;;gBAVFtC,eAAU;;;;ICHX;;;IAGA;QAAA;SAqBC;QAnBQ,oBAAM,GAAb,UAAc,KAAoB,EAAE,cAA8B;YAApD,sBAAA,EAAA,UAAoB;YAAE,+BAAA,EAAA,qBAA8B;YAChE,IAAI,MAAM,GAAG,EAAE,CAAC;YAEhB,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;gBAChB,IAAI,CAAC,cAAc,EAAE;;oBAEnB,MAAM,IAAI,iBAAe,IAAI,wDAAmD,IAAI,kCAA6B,IAAI,mBAAc,IAAI,WAAQ,CAAC;iBACjJ;qBAAM;oBACL,MAAM,IAAI,gBAAc,IAAI,qDAAgD,IAAI,mBAAc,IAAI,SAAM,CAAC;iBAC1G;aACF,CAAC,CAAC;YAEH,MAAM,IAAI,aAAa,CAAC;YACxB,IAAM,QAAQ,GAAG,IAAI,QAAQ,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAEtD,OAAO,SAAS,aAAa,CAAC,IAAY,EAAE,IAAY;gBACtD,OAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;aAC7B,CAAC;SACH;4BACF;KAAA;;;QCbC,0BAAoB,OAAc,EACd,WAAuB;YADvB,YAAO,GAAP,OAAO,CAAO;YACd,gBAAW,GAAX,WAAW,CAAY;YAJnC,oBAAe,GAAG,IAAI,GAAG,EAAsD,CAAC;YAChF,qBAAgB,GAAG,IAAI,GAAG,EAAgE,CAAC;SAIlG;QAED,mCAAQ,GAAR,UAAS,UAAkB,EAAE,SAAgB;YAA7C,iBAyBC;YAzB4B,0BAAA,EAAA,gBAAgB;YAC3C,IAAM,UAAU,GAAG,EAAE,CAAC;YACtB,IAAM,QAAQ,GAAG,IAAI,GAAG,EAAiD,CAAC;YAE1E,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YAEnD,SAAS,CAAC,OAAO,CAAC,UAAC,gBAAgB,EAAE,IAAI,IAAK,OAAA,QAAQ,CAAC,GAAG,CAAC,IAAI,EAAE;gBAC/D,UAAU,EAAE,gBAAgB;gBAC5B,GAAG,EAAE,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC;aACzC,CAAC,GAAA,CAAC,CAAC;YAEJ,QAAQ,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,IAAI;gBAC3B,IAAI,SAAS,EAAE;oBACb,UAAU,CAAC,IAAI,IAAI,WAAW,CAAC,GAAG,gBAAe,KAAK,CAAC,UAAU,+BAA2B,IAAI,qBAAkB,CAAC;iBACpH;qBAAM;oBACL,UAAU,CAAC,IAAI,IAAI,WAAW,CAAC,GAAG,mBAAiB,IAAI,oBAAiB,CAAC;iBAC1E;aACF,CAAC,CAAC;YAEH,IAAM,MAAM,GAAG,YAAU,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,MAAG,CAAC;YACzE,IAAM,KAAK,GAAG,IAAI,QAAQ,CAAC,UAAU,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;YAEnE,OAAO,SAAS,mBAAmB,CAAC,KAAuB,EAAE,OAAe;gBAC1E,OAAO,KAAK,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;aACxC,CAAC;SACH;QAED,iCAAM,GAAN,UAAO,UAAkB;YACvB,IAAM,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;YAClE,IAAM,aAAa,GAAG,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAElD,OAAO,SAAS,iBAAiB,CAAC,MAAc,EAAE,MAAc;gBAC9D,OAAO,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;aACtC,CAAC;SACH;QAED,0CAAe,GAAf,UAAgB,UAAkB,EAAE,SAAgB,EAAE,YAAoB;YAAtC,0BAAA,EAAA,gBAAgB;YAAE,6BAAA,EAAA,oBAAoB;YACxE,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;gBAC1D,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aAC9C;YAED,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;YACzD,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;YAEnD,OAAO,WAAW,CAAC;SACpB;QAED,yCAAc,GAAd,UAAe,UAAkB;YAC/B,IAAI,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;gBACxC,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aAC7C;YAED,IAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;YACzC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;YAE/C,OAAO,QAAQ,CAAC;SACjB;;;;gBAjEFA,eAAU;;;gBAJFuC,mBAAK;gBADL,UAAU;;;ICanB;;;;;QAmBE,mBAAsB,OAA2B,EAC3B,aAA2B,EAC3B,iBAAmC,EACnC,iBAAmC;YAHnC,YAAO,GAAP,OAAO,CAAoB;YAC3B,kBAAa,GAAb,aAAa,CAAc;YAC3B,sBAAiB,GAAjB,iBAAiB,CAAkB;YACnC,sBAAiB,GAAjB,iBAAiB,CAAkB;YAZzD,WAAM,GAA+B,IAAI/B,iBAAY,EAAgB,CAAC;YAGtE,aAAQ,GAA+B,IAAIA,iBAAY,EAAgB,CAAC;YAE9D,sBAAiB,GAAqB,IAAI,GAAG,EAAe,CAAC;SAQtE;QAES,mCAAe,GAAf,UAAgB,OAAe;YACvC,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;SAC/D;QAES,qCAAiB,GAAjB;YAAA,iBAET;YADC,OAAO,UAAC,YAAoB,EAAE,IAAY,IAAK,OAAA,KAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAAC,GAAA,CAAC;SAC1F;QAED,mCAAe,GAAf;YACE,OAAO,IAAI,CAAC,aAAa,CAAC;SAC3B;QAED,mCAAe,GAAf,UAAgB,YAA0B;YACxC,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,YAAY,CAAC;YAClC,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YAC3G,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC3E;QAED,4BAAQ,GAAR;YACE,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBACf,OAAO,CAAC,KAAK,CAAC,sDAAsD,CAAC,CAAC;aACvE;YAED,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACrG,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC3E;QAEM,uCAAmB,GAAnB;YACL,OAAO,IAAI,CAAC,iBAAiB,CAAC;SAC/B;QAED,wBAAI,GAAJ,UAAK,OAAY,EAAE,EAAU,EAAE,MAAgB;YAC7C,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;YAElD,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACnC,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;gBACnD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;oBACf,QAAQ,EAAE,MAAM;oBAChB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,EAAE;iBACb,CAAC,CAAC;gBACH,YAAY,CAAC,QAAQ,GAAG,MAAM,CAAC;gBAC/B,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,EAAE,YAAY,CAAC,CAAC;aAC9C;iBAAM;gBACL,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACpD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;oBACf,QAAQ,EAAE,MAAM;oBAChB,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,EAAE;iBACb,CAAC,CAAC;gBACH,YAAY,CAAC,QAAQ,GAAG,MAAM,CAAC;gBAC/B,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,EAAE,CAAC,CAAC;gBACxD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;aAChD;SACF;QAED,0BAAM,GAAN,UAAO,EAAU;YACf,IAAM,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACpD,IAAI,YAAY,EAAE;gBAChB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;oBACjB,QAAQ,EAAE,YAAY,CAAC,QAAQ;oBAC/B,YAAY,EAAE,YAAY;oBAC1B,QAAQ,EAAE,EAAE;iBACb,CAAC,CAAC;gBACH,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;gBAClC,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;aACnC;SACF;QAED,6BAAS,GAAT;YACE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;YAC/B,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;SAC1B;QAED,+BAAW,GAAX;YACE,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAC/C,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;;;;gBArGF6B,cAAS;;;gBAbD,kBAAkB;gBAJlB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;wBAiBtBN,UAAK;yBAGLS,WAAM;2BAGNA,WAAM;;;ICnBT;;;;;;;;;;;;;;;;;;;;QAyB8C,4CAAS;QAErD,kCAAY,eAAuC,EAAE,YAA0B,EACnE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,eAAe,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACzE;;KALH,CAA8C,SAAS;;gBALtDX,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,wBAAwB,GAAA,CAAC,EAAC,CAAC;iBAC3F;;;gBA5BQ,sBAAsB;gBADtB,YAAY;gBAEZ,gBAAgB;gBAChB,gBAAgB;;;ICEzB;;;;;;;;;;;;;;;;;;;;QAwB4C,0CAAS;QACnD,gCAAY,aAAmC,EAAE,YAA0B,EAC/D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KAJH,CAA4C,SAAS;;gBALpDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,sBAAsB,GAAA,CAAC,EAAC,CAAC;iBACzF;;;gBAzBQ,oBAAoB;gBAFpB,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICMzB;;;;;;;;;;;;;;;;;;QAsB6C,2CAAS;QAEpD,iCAAY,4BAAmD,EAAE,YAA0B,EAC/E,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,4BAA4B,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACtF;;KALH,CAA6C,SAAS;;gBALrDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,uBAAuB,GAAA,CAAC,EAAC,CAAC;iBAC1F;;;gBAzBQ,qBAAqB;gBADrB,YAAY;gBAEZ,gBAAgB;gBAChB,gBAAgB;;;ICHzB;;;;;;;;;;;QAaA;;QAEE,mCAAS,GAAT,UAAU,KAAU,EAAE,IAAU;YAC9B,OAAO,IAAI,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;SAClD;;;;gBAPFC,SAAI,SAAC;oBACJ,IAAI,EAAE,aAAa;iBACpB;;;;QCTD;;QAEE,wCAAS,GAAT,UAAU,KAAU,EAAE,IAAU;YAC9B,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,GAAG,IAAI,CAAC,EAAE,CAAC,IAAI,GAAG,CAAC;SACxD;;;;gBAPFA,SAAI,SAAC;oBACJ,IAAI,EAAE,kBAAkB;iBACzB;;;ICGD;;;;;;;;;;;;;;;;;;;QAwB0C,wCAAS;QAEjD,8BAAY,WAA+B,EAAE,YAA0B,EAC3D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,WAAW,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACrE;;KALH,CAA0C,SAAS;;gBALlDb,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,oBAAoB,GAAA,CAAC,EAAC,CAAC;iBACvF;;;gBAzBQ,kBAAkB;gBADlB,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;;QCKzB;;;;;gBAJCE,aAAQ,SAAC;oBACR,OAAO,EAAE,CAACC,mBAAY,CAAC;oBACvB,SAAS,EAAE,EAAE;iBACd;;;ICCD;;;;;;;;;;;;;;;;;;;QAuB2C,yCAAS;QAClD,+BAAY,aAAmC,EAAE,YAA0B,EAC/D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;QAES,+CAAe,GAAf,UAAgB,OAAe;YACvC,IAAM,WAAW,GAAG,iBAAM,eAAe,YAAC,OAAO,CAAC,CAAC;YAEnD,WAAW,CAAC,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC;YAC/C,WAAW,CAAC,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC;YAC/C,OAAO,WAAW,CAAC,MAAM,CAAC;YAE1B,OAAO,WAAW,CAAC;SACpB;QAES,iDAAiB,GAAjB;YACR,OAAO,UAAC,YAAoB,EAAE,IAAY,IAAK,OAAA,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,IAAI,CAAC,GAAA,CAAC;SAClF;;KAlBH,CAA2C,SAAS;;gBALnDf,cAAS,SAAC;oBACT,QAAQ,EAAE,gBAAgB;oBAC1B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,qBAAqB,GAAA,CAAC,EAAC,CAAC;iBACxF;;;gBAxBQ,oBAAoB;gBAFpB,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICMzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAmCwC,sCAAS;QAE/C,4BAAY,SAA2B,EAAE,YAA0B,EACvD,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,SAAS,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACnE;;KALH,CAAwC,SAAS;;gBALhDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,kBAAkB,GAAA,CAAC,EAAC,CAAC;iBACrF;;;gBArCQ,gBAAgB;gBAHhB,YAAY;gBAEZ,gBAAgB;gBADhB,gBAAgB;;;ICFzB;;;;;;;;;;;;;;;QA4BE,kBAAY,IAAU;YACpB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;SAC3B;;;;;;QAbM,eAAM,GAAb,UAAc,IAAU;YACtB,IAAI,IAAI,EAAE;gBACR,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,QAAQ,EAAE,EAAE,IAAI,CAAC,CAAC;aAC5C;YACD,OAAO,IAAI,QAAQ,EAAE,CAAC;SACvB;uBASF;KAAA;;;QClBD;SAIC;6BAAA;KAAA;;ICjBD,WAAY,uBAAuB;QACjC,qEAAkB,MAAM,CAAC,8BAA8B,qBAAA,CAAA;QACvD,uEAAoB,MAAM,CAAC,gCAAgC,uBAAA,CAAA;QAC3D,oEAAiB,MAAM,CAAC,6BAA6B,oBAAA,CAAA;QACrD,mEAAgB,MAAM,CAAC,4BAA4B,mBAAA,CAAA;QACnD,uEAAoB,MAAM,CAAC,yBAAyB,uBAAA,CAAA;QACpD,mEAAgB,MAAM,CAAC,4BAA4B,mBAAA,CAAA;QACnD,8DAAW,MAAM,CAAC,uBAAuB,cAAA,CAAA;QACzC,+EAA4B,MAAM,CAAC,iCAAiC,+BAAA,CAAA;QACpE,4DAAS,MAAM,CAAC,qBAAqB,YAAA,CAAA;QACrC,gFAA6B,MAAM,CAAC,0BAA0B,gCAAA,CAAA;QAC9D,wEAAqB,MAAM,CAAC,0BAA0B,wBAAA,CAAA;QACtD,6DAAU,IAAI,aAAA,CAAA;IAChB,CAAC,EAbWI,+BAAuB,KAAvBA,+BAAuB;;ICAnC,WAAY,yBAAyB;QACnC,uEAAgB,MAAM,CAAC,qBAAqB,mBAAA,CAAA;QAC5C,8EAAuB,MAAM,CAAC,mCAAmC,0BAAA,CAAA;QACjE,+EAAwB,MAAM,CAAC,oCAAoC,2BAAA,CAAA;QACnE,oEAAa,MAAM,CAAC,yBAAyB,gBAAA,CAAA;QAC7C,mEAAY,MAAM,CAAC,wBAAwB,eAAA,CAAA;QAC3C,sEAAe,MAAM,CAAC,kBAAkB,kBAAA,CAAA;IAC1C,CAAC,EAPWC,iCAAyB,KAAzBA,iCAAyB;;ICKrC;;;;;;;;;;;;;;;QAkEE,qCAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;;;;YA1ChD,YAAO,GAAqB,EAAE,CAAC;;;;YAM/B,aAAQ,GAAQD,+BAAuB,CAAC,OAAO,CAAC;;;;YAYhD,SAAI,GAAG,IAAI,CAAC;;;;YAMZ,UAAK,GAAG,GAAG,CAAC;;;;YAMZ,eAAU,GAAG,GAAG,CAAC;;;;YAMjB,aAAQ,GAAG,GAAG,CAAC;YAOb,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,aAAa,CAAC;SAC5E;QAEO,8DAAwB,GAAxB;YACN,OAAO,MAAM,CAAC,mCAAmC,CAAC;gBAChD,GAAG,EAAE,MAAM,CAAC,cAAc,CAAC,gCAAgC,CAAC;aAC7D,CAAC,CAAC;SACJ;QAED,8CAAQ,GAAR;YACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,QAAQ,KAAKA,+BAAuB,CAAC,OAAO,EAAE;gBAC3F,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;aAC5C;YACD,QAAQ,IAAI,CAAC,QAAQ;gBACnB,KAAKA,+BAAuB,CAAC,aAAa,CAAC;gBAC3C,KAAKA,+BAAuB,CAAC,iBAAiB,CAAC;gBAC/C,KAAKA,+BAAuB,CAAC,eAAe,CAAC;gBAC7C,KAAKA,+BAAuB,CAAC,iBAAiB,CAAC;gBAC/C,KAAKA,+BAAuB,CAAC,QAAQ,CAAC;gBACtC,KAAKA,+BAAuB,CAAC,yBAAyB,CAAC;gBACvD,KAAKA,+BAAuB,CAAC,MAAM,CAAC;gBACpC,KAAKA,+BAAuB,CAAC,0BAA0B,CAAC;gBACxD,KAAKA,+BAAuB,CAAC,kBAAkB,CAAC;gBAChD,KAAKA,+BAAuB,CAAC,cAAc,CAAC;gBAC5C,KAAKA,+BAAuB,CAAC,aAAa;oBACxC,IAAI,CAAC,aAAa,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACrD,MAAM;gBACR,KAAKA,+BAAuB,CAAC,OAAO;oBAClC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;oBACrD,MAAM;gBACR;oBACE,OAAO,CAAC,GAAG,CAAC,sFAAsF,CAAC,CAAC;oBACpG,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;oBACrD,MAAM;aACT;YACD,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;gBACpG,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;gBACrC,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;gBAC3C,IAAI,CAAC,YAAY,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;aAChD;SACF;QAED,iDAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,EAAE;gBACvD,IAAM,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;gBAC/C,IAAI,SAAS,EAAE;oBACb,IAAI,IAAI,CAAC,YAAY,EAAE;wBACrB,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;qBACjE;yBAAM;wBACL,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,uBAAuB,CAAC,kBAAkB,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;wBACpG,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;wBACrC,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;wBAC3C,IAAI,CAAC,YAAY,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;qBAChD;iBACF;qBAAM,IAAI,IAAI,CAAC,YAAY,EAAE;oBAC5B,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;iBAC/D;aACF;YAED,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,IAAI,IAAI,CAAC,YAAY,EAAE;gBAC9E,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;aACtC;YACD,IAAI,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,aAAa,EAAE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACpF,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;aAC5C;YACD,IAAI,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,aAAa,EAAE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACxF,IAAI,CAAC,YAAY,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;aAChD;SACF;QAED,iDAAW,GAAX;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;aAC9D;SACF;;;;gBAhIFhB,cAAS,SAAC;oBACT,QAAQ,EAAE,uBAAuB;oBACjC,QAAQ,EAAE,EAAE;iBACb;;;gBArBQ,aAAa;;;0BA2BnBE,UAAK;2BAMLA,UAAK;wBAMLA,UAAK;uBAMLA,UAAK;wBAMLA,UAAK;6BAMLA,UAAK;2BAMLA,UAAK;;;IC3DR;;;;;;;;;;;;QAsCE,uCAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;;;;YAjBhD,YAAO,GAAqB,EAAE,CAAC;;;;YAY/B,SAAI,GAAG,IAAI,CAAC;SAMX;QAED,gDAAQ,GAAR;YACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;mBACjC,IAAI,CAAC,QAAQ,KAAKe,iCAAyB,CAAC,SAAS;mBACrD,IAAI,CAAC,QAAQ,KAAKA,iCAAyB,CAAC,YAAY,EAAE;gBAC7D,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;aAC5C;YACD,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,eAAe,CAAC;YAC7E,QAAQ,IAAI,CAAC,QAAQ;gBACnB,KAAKA,iCAAyB,CAAC,aAAa,CAAC;gBAC7C,KAAKA,iCAAyB,CAAC,oBAAoB,CAAC;gBACpD,KAAKA,iCAAyB,CAAC,qBAAqB,CAAC;gBACrD,KAAKA,iCAAyB,CAAC,UAAU,CAAC;gBAC1C,KAAKA,iCAAyB,CAAC,SAAS;oBACtC,IAAI,CAAC,eAAe,GAAG,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACvD,MAAM;gBACR,KAAKA,iCAAyB,CAAC,YAAY;oBACzC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;oBACnD,MAAM;gBACR;oBACE,OAAO,CAAC,GAAG,CAAC,wFAAwF,CAAC,CAAC;oBACtG,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC;oBACnD,MAAM;aACT;YACD,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;aACvE;SACF;QAED,mDAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,EAAE;gBACvD,IAAM,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;gBAC/C,IAAI,SAAS,EAAE;oBACb,IAAI,IAAI,CAAC,eAAe,EAAE;wBACxB,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;qBACvE;iBACF;qBAAM;oBACL,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC;iBAC9E;aACF;SACF;QAED,mDAAW,GAAX;YACE,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC;SAC9E;;;;gBAzEFjB,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;iBACb;;;gBAlBQ,aAAa;;;0BAwBnBE,UAAK;2BAMLA,UAAK;uBAMLA,UAAK;;;IC9BR;;;;;;;;;;;;;;;;;;QAsB0C,wCAAS;QAEjD,8BAAY,kBAAsC,EAAE,YAA0B,EAClE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,kBAAkB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SAC5E;;KALH,CAA0C,SAAS;;gBALlDF,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,oBAAoB,GAAA,CAAC,EAAC,CAAC;iBACvF;;;gBAzBQ,kBAAkB;gBADlB,YAAY;gBAEZ,gBAAgB;gBAChB,gBAAgB;;;ICAzB;;;;;;;;;;;;;;;;;;;QAuBsC,oCAAoB;QAExD,0BAAY,WAA+B,EAAE,SAA2B;mBACtE,kBAAM,WAAW,EAAE,SAAS,CAAC;SAC9B;;KAJH,CAAsC,oBAAoB;;gBAJzDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,QAAQ,EAAE,EAAE;iBACb;;;gBAzBQ,kBAAkB;gBAClB,gBAAgB;;;ICEzB;;;;;;;;;;;;;;;;;;QAsByC,uCAAoB;QAE3D,6BAAY,cAAqC,EAAE,SAA2B;mBAC5E,kBAAM,cAAc,EAAE,SAAS,CAAC;SACjC;;KAJH,CAAyC,oBAAoB;;gBAJ5DA,cAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,QAAQ,EAAE,EAAE;iBACb;;;gBAvBQ,qBAAqB;gBADrB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuBwC,sCAAoB;QAE1D,4BAAY,aAAmC,EAAE,SAA2B;mBAC1E,kBAAM,aAAa,EAAE,SAAS,CAAC;SAChC;;KAJH,CAAwC,oBAAoB;;gBAJ3DA,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,EAAE;iBACb;;;gBAzBQ,oBAAoB;gBACpB,gBAAgB;;;ICEzB;;;;;;;;;;;;;;;;;QAqBsC,oCAAoB;QAExD,0BAAY,WAA+B,EAAE,SAA2B;mBACtE,kBAAM,WAAW,EAAE,SAAS,CAAC;SAC9B;;KAJH,CAAsC,oBAAoB;;gBAJzDA,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;oBACpB,QAAQ,EAAE,EAAE;iBACb;;;gBAvBQ,kBAAkB;gBAClB,gBAAgB;;;ICAzB;;;;;;;;;;;QA0BE,yBAAoB,aAA4B,EAAU,UAAsB,EAAU,QAAmB;YAAzF,kBAAa,GAAb,aAAa,CAAe;YAAU,eAAU,GAAV,UAAU,CAAY;YAAU,aAAQ,GAAR,QAAQ,CAAW;YAHrG,WAAM,GAAG,KAAK,CAAC;SAItB;QAED,2CAAiB,GAAjB,UAAkB,cAAmB;YACnC,IAAI,cAAc,EAAE;gBAClB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,KAAK,EAAK,cAAc,CAAC,CAAC,OAAI,CAAC,CAAC;gBACtF,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,MAAM,EAAK,cAAc,CAAC,CAAC,OAAI,CAAC,CAAC;aACxF;SACF;QAED,kCAAQ,GAAR;YACE,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,eAAe,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;YACzF,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,KAAK,EAAE;gBAC7B,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;QAED,gCAAM,GAAN;YACE,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;gBACpB,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;gBACzF,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;QAED,qCAAW,GAAX;YACE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;SAC1E;QAED,6BAAG,GAAH;YAAA,iBAWC;YAVC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBAChB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,sBAAsB,GAAG;oBAC5B,IAAM,cAAc,GAAG,MAAM,CAAC,eAAe,CAAC,wBAAwB,CAAC,KAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,EAClG,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;oBACvB,KAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC;iBACxC,CAAC;gBACF,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;gBAC1E,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;aACvF;SACF;QAED,mCAAS,GAAT;YACE,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;gBACpD,IAAI,CAAC,GAAG,EAAE,CAAC;aACZ;iBAAM;gBACL,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SACF;QAED,qCAAW,GAAX;YACE,IAAI,CAAC,MAAM,EAAE,CAAC;SACf;;;;gBAnEFA,cAAS,SAAC;oBACT,QAAQ,EAAE,SAAS;oBACnB,QAAQ,EAAE,2BAA2B;6BAC5B,wFAGL;iBACL;;;gBApBQ,aAAa;gBADOC,eAAU;gBAA4BiB,cAAS;;;wBAyBzEhB,UAAK;;;ICpBR;;;;;;;;;;;;;;;;;;;QAuBuC,qCAAoB;QAEzD,2BAAY,oBAA0C,EAAE,SAA2B;mBACjF,kBAAM,oBAAoB,EAAE,SAAS,CAAC;SACvC;QAEO,8CAAkB,GAAlB;YACN,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;YAC7C,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;YAC7C,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC;SAC3B;QAED,qCAAS,GAAT;YACE,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC1B,iBAAM,SAAS,WAAE,CAAC;SACnB;QAED,uCAAW,GAAX;YACE,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC1B,iBAAM,WAAW,WAAE,CAAC;SACrB;;KApBH,CAAuC,oBAAoB;;gBAJ1DF,cAAS,SAAC;oBACT,QAAQ,EAAE,WAAW;oBACrB,QAAQ,EAAE,EAAE;iBACb;;;gBAzBQ,oBAAoB;gBACpB,gBAAgB;;;ICEzB;;;;;;;;;;;;;;;;;;;;;;;QA2BoC,kCAAoB;QAStD,wBAAY,SAA2B,EAAE,SAA2B;mBAClE,kBAAM,SAAS,EAAE,SAAS,CAAC;SAC5B;QAED,oCAAW,GAAX;YACE,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBAC5B,IAAI,CAAC,aAAa,EAAE,CAAC;gBACrB,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB;SACF;QAED,kCAAS,GAAT;YACE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;YAChC,OAAO,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;SAC3G;QAED,oCAAW,GAAX,UAAY,OAAsB;YAChC,IAAM,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;YAC/C,IAAM,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;YAC/C,IAAM,cAAc,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;YACjD,IAAI,aAAa,CAAC,YAAY,KAAK,aAAa,CAAC,aAAa;gBAC5D,aAAa,CAAC,YAAY,KAAK,aAAa,CAAC,aAAa;gBAC1D,cAAc,CAAC,YAAY,KAAK,cAAc,CAAC,aAAa,EAAE;gBAC9D,IAAI,CAAC,WAAW,EAAE,CAAC;aACpB;SACF;;KAlCH,CAAoC,oBAAoB;;gBAJvDA,cAAS,SAAC;oBACT,QAAQ,EAAE,QAAQ;oBAClB,QAAQ,EAAE,EAAE;iBACb;;;gBA7BQ,gBAAgB;gBAChB,gBAAgB;;;gCA+BtBE,UAAK;gCAELA,UAAK;iCAELA,UAAK;;;IC/BR;;;;;;;;;;;;;;;;;QAqB4C,0CAAS;QAEnD,gCAAY,aAAmC,EAAE,YAA0B,EAC/D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAA4C,SAAS;;gBALpDF,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,sBAAsB,GAAA,CAAC,EAAC,CAAC;iBACzF;;;gBAzBQ,oBAAoB;gBACpB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;;QCqCvB,mCAAmB,cAA8B,EAC7B,EAAqB,EACrB,YAAiC;YAFlC,mBAAc,GAAd,cAAc,CAAgB;YAC7B,OAAE,GAAF,EAAE,CAAmB;YACrB,iBAAY,GAAZ,YAAY,CAAqB;SACpD;QAED,4CAAQ,GAAR;YAAA,iBAEC;YADC,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,GAAA,CAAC,CAAC;SACpF;QAED,sBAAI,sDAAe;iBAAnB;gBACE,IAAI,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE;oBACpC,IAAM,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CAAC,WAAW,CAAC;oBACvE,OAAO,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;iBACxD;aACF;;;WAAA;QAED,gDAAY,GAAZ,UAAa,MAAW;YACtB,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;SAC5C;;;;gBAxDFZ,cAAS,SACR;oBACE,QAAQ,EAAE,oBAAoB;oBAC9B,QAAQ,EAAE,oaAWT;oBAkBD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;oBAC/C,SAAS,EAAE,CAAC,mBAAmB,CAAC;6BAlBvB,iZAgBR;iBAGF;;;gBArCM,cAAc;gBADWY,sBAAiB;gBAE1C,mBAAmB;;;ICG5B;;;;;;;;;;;;;;;;;;;QAsBwC,sCAAoB;QAC1D,4BAAY,aAAmC,EAAE,SAA2B;mBAC1E,kBAAM,aAAa,EAAE,SAAS,CAAC;SAChC;;KAHH,CAAwC,oBAAoB;;gBAJ3DnB,cAAS,SAAC;oBACT,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,EAAE;iBACb;;;gBAzBQ,oBAAoB;gBAEpB,gBAAgB;;;;QCMqB,4CAAS;QAYrD,kCAAsB,sBAA6C,EAAE,YAA0B,EACnF,gBAAkC,EAAE,gBAAkC;YADlF,YAEE,kBAAM,sBAAsB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC,SAChF;YAHqB,4BAAsB,GAAtB,sBAAsB,CAAuB;;SAGlE;QAED,2CAAQ,GAAR;YACE,IAAI,CAAC,aAAa,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAE7C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC1F,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC1F,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SAC7F;QAED,uCAAI,GAAJ,UAAK,OAAY,EAAE,EAAU,EAAE,MAAgB;YAC7C,IAAM,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;YACpF,IAAM,aAAa,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;YACpF,IAAM,cAAc,GAAG,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;YAEtF,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACnC,IAAM,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,aAAa,EAAE,aAAa,EAAE,cAAc,CAAC,CAAC;gBAChG,SAAS,CAAC,QAAQ,GAAG,MAAM,CAAC;gBAC5B,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;aAC3C;iBAAM;gBACL,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACjD,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,SAAS,EAAE,aAAa,EAAE,aAAa,EAAE,cAAc,CAAC,CAAC;aAC7F;SACF;;KAtCH,CAA8C,SAAS;;gBADtDQ,cAAS;;;gBAHD,qBAAqB;gBAHrB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;gCAMtBN,UAAK;gCAELA,UAAK;iCAELA,UAAK;;;ICPR;;;;;;;;;;;;;;;;;;;;;;;;;QA4BkD,gDAAwB;QACxE,sCAAY,aAAyC,EAAE,YAA0B,EACrE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KAJH,CAAkD,wBAAwB;;gBAJzEF,cAAS,SAAC;oBACT,QAAQ,EAAE,wBAAwB;oBAClC,QAAQ,EAAE,EAAE;iBACb;;;gBA7BQ,0BAA0B;gBAJ1B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICIzB;;;;;;;;;;;;;;;;;;;;;;;;;;QA6BmD,iDAAS;QAC1D,uCAAY,aAA0C,EAAE,YAA0B,EACtE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KAJH,CAAmD,SAAS;;gBAJ3DA,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;iBACb;;;gBA9BQ,2BAA2B;gBAF3B,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICOzB;IACA;;;;;;;;;;;;;;;;QAmBoD,kDAAS;QAE3D,wCAAY,4BAA0D,EAAE,YAA0B,EACtF,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,4BAA4B,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACtF;;KALH,CAAoD,SAAS;;gBAJ5DA,cAAS,SAAC;oBACT,QAAQ,EAAE,0BAA0B;oBACpC,QAAQ,EAAE,EAAE;iBACb;;;gBArBQ,4BAA4B;gBAH5B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;IACA;;;;;;;;;;;;;;;;;;;;;;QAyBkD,gDAAwB;QACxE,sCAAY,aAAyC,EAAE,YAA0B,EACrE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KAJH,CAAkD,wBAAwB;;gBAJzEA,cAAS,SAAC;oBACT,QAAQ,EAAE,wBAAwB;oBAClC,QAAQ,EAAE,EAAE;iBACb;;;gBA3BQ,0BAA0B;gBAJ1B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;;;QAwBiD,+CAAwB;QACvE,qCAAY,kBAA6C,EAAE,YAA0B,EACzE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,kBAAkB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SAC5E;;KAJH,CAAiD,wBAAwB;;gBAJxEA,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,EAAE;iBACb;;;gBAzBQ,yBAAyB;gBAJzB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICIzB;;;;;;;;;;;;;;;;;;;;;;;QA0BkD,gDAAS;QACzD,sCAAY,aAA0C,EAAE,YAA0B,EACtE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;QAES,sDAAe,GAAf,UAAgB,OAAe;YACvC,IAAM,WAAW,GAAG,iBAAM,eAAe,YAAC,OAAO,CAAC,CAAC;YAEnD,WAAW,CAAC,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC;YAC/C,WAAW,CAAC,aAAa,GAAG,WAAW,CAAC,MAAM,CAAC;YAE/C,OAAO,WAAW,CAAC;SACpB;;KAbH,CAAkD,SAAS;;gBAJ1DA,cAAS,SAAC;oBACT,QAAQ,EAAE,wBAAwB;oBAClC,QAAQ,EAAE,EAAE;iBACb;;;gBA3BQ,2BAA2B;gBAF3B,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICOzB;IAEA;;;;;;;;;;;;;;;;;;;;;;QAyBmD,iDAAwB;QACzE,uCAAY,qBAAkD,EAAE,YAA0B,EAC9E,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,qBAAqB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SAC/E;;KAJH,CAAmD,wBAAwB;;gBAJ1EA,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;iBACb;;;gBAhCQ,2BAA2B;gBAC3B,YAAY;gBAEZ,gBAAgB;gBADhB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;QAsB0C,wCAAS;QAEjD,8BAAY,WAA+B,EAAE,YAA0B,EAC3D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,WAAW,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACrE;;KALH,CAA0C,SAAS;;gBALlDA,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,oBAAoB,GAAA,CAAC,EAAC,CAAC;iBACvF;;;gBAvBQ,kBAAkB;gBAHlB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICAzB;;;;;;;;;;;;;QA4CE,8BAAoB,aAA4B;YAA5B,kBAAa,GAAb,aAAa,CAAe;;;;YAvBhD,YAAO,GAAqB,EAAE,CAAC;;;;YAY/B,SAAI,GAAG,IAAI,CAAC;YAQL,oBAAe,GAAQ,IAAI,CAAC;SAIlC;QAED,uCAAQ,GAAR;YACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBACtC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;aAC5C;YAED,IAAI,CAAC,kBAAkB,GAAG,IAAI,MAAM,CAAC,mBAAmB,EAAE,CAAC;YAC3D,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAEtE,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;gBACzG,IAAI,IAAI,CAAC,KAAK,EAAE;oBACd,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;iBACvE;aACF;SACF;QAED,0CAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,aAAa,EAAE,EAAE;gBACvD,IAAM,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC;gBAE/C,IAAI,SAAS,EAAE;oBACb,IAAI,IAAI,CAAC,eAAe,EAAE;wBACxB,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;qBAC/D;yBAAM;wBACL,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;wBACzG,IAAI,IAAI,CAAC,KAAK,EAAE;4BACd,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;yBACvE;qBACF;iBACF;qBAAM,IAAI,IAAI,CAAC,eAAe,EAAE;oBAC/B,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;iBAC7D;aACF;YACD,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,aAAa,EAAE,EAAE;gBACzD,IAAM,UAAU,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC;gBACjD,IAAI,IAAI,CAAC,eAAe,EAAE;oBACxB,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,IAAI,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;iBACvE;aACF;SACF;QAED,0CAAW,GAAX;YACE,IAAI,IAAI,CAAC,eAAe,EAAE;gBACxB,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;aAC7D;SACF;;;;gBAhFFZ,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,EAAE;iBACb;;;gBAlBQ,aAAa;;;0BAuBnBE,UAAK;wBAMLA,UAAK;uBAMLA,UAAK;wBAMLA,UAAK;;;ICnCR;;;;;;;;;;;;;;;;;;;QAuBwC,sCAAS;QAE/C,4BAAY,aAA+B,EAAE,YAA0B,EAC3D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAAwC,SAAS;;gBALhDF,cAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,kBAAkB,GAAA,CAAC,EAAC,CAAC;iBACrF;;;gBAxBQ,gBAAgB;gBAHhB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuB6C,2CAAS;QAEpD,iCAAY,aAAoC,EAAE,YAA0B,EAChE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAA6C,SAAS;;gBALrDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,uBAAuB,GAAA,CAAC,EAAC,CAAC;iBAC1F;;;gBAxBQ,qBAAqB;gBAHrB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuB6C,2CAAS;QAEpD,iCAAY,aAAoC,EAAE,YAA0B,EAChE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAA6C,SAAS;;gBALrDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,uBAAuB,GAAA,CAAC,EAAC,CAAC;iBAC1F;;;gBAxBQ,qBAAqB;gBAHrB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuB8C,4CAAS;QAErD,kCAAY,aAAqC,EAAE,YAA0B,EACjE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAA8C,SAAS;;gBALtDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,wBAAwB,GAAA,CAAC,EAAC,CAAC;iBAC3F;;;gBAxBQ,sBAAsB;gBAHtB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAsBmD,iDAAS;QAE1D,uCAAY,aAA0C,EAAE,YAA0B,EACtE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAAmD,SAAS;;gBAJ3DZ,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;iBACb;;;gBAvBQ,2BAA2B;gBAH3B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuByC,uCAAS;QAEhD,6BAAY,aAAgC,EAAE,YAA0B,EAC5D,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAAyC,SAAS;;gBALjDA,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,mBAAmB,GAAA,CAAC,EAAC,CAAC;iBACtF;;;gBAxBQ,iBAAiB;gBAHjB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAuB8C,4CAAS;QAErD,kCAAY,aAAqC,EAAE,YAA0B,EACjE,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,aAAa,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACvE;;KALH,CAA8C,SAAS;;gBALtDZ,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,wBAAwB,GAAA,CAAC,EAAC,CAAC;iBAC3F;;;gBAxBQ,sBAAsB;gBAHtB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;;QAwBuD,qDAAS;QAE9D,2CAAY,wBAAyD,EAAE,YAA0B,EACrF,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,wBAAwB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SAClF;;KALH,CAAuD,SAAS;;gBAL/DZ,cAAS,SAAC;oBACT,QAAQ,EAAE,6BAA6B;oBACvC,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,iCAAiC,GAAA,CAAC,EAAC,CAAC;iBACpG;;;gBAzBQ,+BAA+B;gBAH/B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;QAuBmD,iDAAS;QAE1D,uCAAY,oBAAiD,EAAE,YAA0B,EAC7E,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,oBAAoB,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SAC9E;;KALH,CAAmD,SAAS;;gBAL3DZ,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,6BAA6B,GAAA,CAAC,EAAC,CAAC;iBAChG;;;gBAxBQ,2BAA2B;gBAD3B,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICKzB;;;;;;;;;;;;;;;;;QAqBsD,oDAAS;QAE7D,0CAAY,8BAA8D,EAAE,YAA0B,EAC1F,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,8BAA8B,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACxF;;KALH,CAAsD,SAAS;;gBAL9DZ,cAAS,SAAC;oBACT,QAAQ,EAAE,4BAA4B;oBACtC,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,CAAC,EAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAEY,eAAU,CAAC,cAAM,OAAA,gCAAgC,GAAA,CAAC,EAAC,CAAC;iBACnG;;;gBAtBQ,8BAA8B;gBAH9B,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;ICAzB;QAWE,uBAAY,OAAY,EAAE,UAAiC;YAAjC,2BAAA,EAAA,iBAAiC;YACzD,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;gBAC/B,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;aAC/D;YAED,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;YAC3B,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,YAAY,CAAC;YAC1C,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC;YACjC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;YACjC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;YACvC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;YAC/B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;SAC9B;QAED,sBAAI,gCAAK;iBAAT,UAAU,KAAU;gBAClB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAAA;QAED,sBAAI,+BAAI;iBAYR;gBACE,OAAO,IAAI,CAAC,KAAK,CAAC;aACnB;iBAdD,UAAS,IAAa;gBACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAElB,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;oBAChC,IAAI,IAAI,EAAE;wBACR,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;qBACvC;yBAAM;wBACL,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;qBACtC;iBACF;aACF;;;WAAA;QAMD,sBAAI,mCAAQ;iBAIZ;gBACE,OAAO,IAAI,CAAC,SAAS,CAAC;aACvB;iBAND,UAAa,QAAoB;gBAC/B,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;aAC3B;;;WAAA;QAMD,sBAAI,sCAAW;iBAIf;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;iBAND,UAAgB,WAAuB;gBACrC,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;aACjC;;;WAAA;QAMD,sBAAI,kCAAO;iBAUX;gBACE,OAAO,IAAI,CAAC,QAAQ,CAAC;aACtB;iBAZD,UAAY,OAAoB;gBAC9B,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;gBAExB,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;oBAC3B,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;oBACxC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;oBAC1C,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;iBAC1D;aACF;;;WAAA;QAMD,sBAAI,qCAAU;iBAId;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAND,UAAe,UAA0B;gBACvC,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;aAC/B;;;WAAA;QAMD,8BAAM,GAAN;YACE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBACjE,OAAO;aACR;YAED,IAAI,cAAc,GAAG,MAAM,CAAC,eAAe,CAAC,wBAAwB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAElG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE;gBACnC,cAAc,GAAG,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;aAC1D;iBAAM,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE;gBAC1H,cAAc,CAAC,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;gBACxC,cAAc,CAAC,CAAC,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;aACzC;YAED,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,cAAc,CAAC,EAAE;gBACnE,OAAO;aACR;YAED,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAM,cAAc,CAAC,CAAC,OAAI,CAAC;YAClD,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAM,cAAc,CAAC,CAAC,OAAI,CAAC;YACnD,IAAI,CAAC,aAAa,GAAG,cAAc,CAAC;SACrC;QAED,8BAAM,GAAN;YACE,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;aACxB;SACF;4BACF;KAAA;;ICjHD;QAAA;YACU,gBAAW,GAAoB,EAAE,CAAC;SAgD3C;QA9CC,sBAAI,kCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;aAChC;;;WAAA;QAED,4BAAG,GAAH,UAAI,KAAa;YACf,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;SAChC;QAED,4BAAG,GAAH,UAAI,OAAY;YACd,IAAM,IAAI,GAAG,IAAI,aAAa,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;YAC9C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE5B,OAAO,IAAI,CAAC;SACb;QAED,+BAAM,GAAN,UAAO,IAAmB;YACxB,IAAM,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE;gBAClB,OAAO,KAAK,CAAC;aACd;YAED,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;YACjC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAClC,OAAO,IAAI,CAAC;SACb;QAED,+BAAM,GAAN;YACE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBAC3D,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC;aAC9B;SACF;QAED,kCAAS,GAAT;YACE,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClC,IAAM,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC;gBACpC,IAAI,CAAC,MAAM,EAAE,CAAC;aACf;SACF;QAED,iCAAQ,GAAR,UAAS,IAAmB;YAC1B,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC;SACzD;QAED,gCAAO,GAAP;YACE,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;6BACF;KAAA;;IChDD;QAAA;SAKC;QAJQ,qBAAM,GAAb;YACE,MAAM,CAAC,aAAa,GAAG,aAAa,CAAC;YACrC,MAAM,CAAC,cAAc,GAAG,cAAc,CAAC;SACxC;6BACF;KAAA;;;QCFC;YACE,IAAI,CAAC,SAAS,GAAG,IAAI,GAAG,EAAY,CAAC;SACtC;QAED,2BAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC/B;QAED,2BAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC/B;QAED,mCAAW,GAAX,UAAY,EAAO,EAAE,IAAqC;YACxD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;SAC9B;QAED,8BAAM,GAAN,UAAO,EAAU;YACf,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC3B;QAED,+BAAO,GAAP,UAAQ,QAAa;YACnB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;SAClC;;;;gBA1BFzC,eAAU;;;;;QCGT,uBACS,EAAO,EACP,OAAY;YADZ,OAAE,GAAF,EAAE,CAAK;YACP,YAAO,GAAP,OAAO,CAAK;SAEpB;4BACF;KAAA,IAAA;;QASC,yBACU,YAAwC,EACxC,iBAAmC,EACnC,eAAkC,EAClC,aAA2B,EAC3B,cAA6B;YAJ7B,iBAAY,GAAZ,YAAY,CAA4B;YACxC,sBAAiB,GAAjB,iBAAiB,CAAkB;YACnC,oBAAe,GAAf,eAAe,CAAmB;YAClC,kBAAa,GAAb,aAAa,CAAc;YAC3B,mBAAc,GAAd,cAAc,CAAe;YAP/B,WAAM,GAAG,IAAI,GAAG,EAAuC,CAAC;SAS/D;QAED,kCAAQ,GAAR;SAEC;QAEO,qCAAW,GAAX,UAAY,EAAO,EAAE,SAAc,EAAE,MAAW;YACtD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,IAAI,EAAE;gBAC1C,IAAM,OAAO,GAAG,IAAI,aAAa,CAAC,EAAE,EAAE,EAAC,SAAS,EAAE,MAAM,EAAC,CAAC,CAAC;gBAC3D,IAAM,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;gBACtF,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,EAAC,OAAO,SAAA,EAAE,OAAO,SAAA,EAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;aACtC;iBAAO,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,SAAS,CAAC,IAAI,EAAE;gBACjD,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,CAAC;aACtC;SACF;QAED,qCAAW,GAAX,UAAY,EAAO,EAAE,SAAc;YACjC,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;YAC3C,IAAM,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,aAAa,EAAE,CAAC,CAAC;YAE3D,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACvB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,GAAG,MAAM,CAAC;aACxD;YAED,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE,EAAE,EAAC,MAAM,QAAA,EAAE,SAAS,WAAA,EAAC,CAAC,CAAC;YACzD,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;SACzC;QAED,gCAAM,GAAN,UAAO,EAAO,EAAE,SAAc;YAC5B,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACxB,OAAO;aACR;YAEM,IAAA,OAAO,GAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,QAAvB,CAAwB;YACtC,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;YACvE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YACvB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/B,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC;SAC1B;;;;gBArDFqC,cAAS,SAAC;oBACT,QAAQ,EAAE,UAAU;iBACrB;;;gBAd8CY,gBAAW;gBAAEC,qBAAgB;gBAAnEF,sBAAiB;gBACjB,YAAY;gBACZ,aAAa;;;ICOtB;;;;;;;;;;;;;;;;;;;;;;;QAiCyC,uCAAS;QAKhD,6BAAY,UAA6B,EAAE,YAA0B,EACzD,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,UAAU,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACpE;QAED,sCAAQ,GAAR;YACE,iBAAM,QAAQ,WAAE,CAAC;YAEjB,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;gBACvB,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;aACpE;YAED,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;gBACxB,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;aAChE;SACF;QAED,kCAAI,GAAJ,UAAK,OAAY,EAAE,EAAO;YACxB,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;YAClD,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBACnC,IAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;gBAChD,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;gBAC1C,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;aAC/C;iBAAM;gBACL,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACjD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,EAAE,WAAW,CAAC,CAAC;gBAC5C,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;aAC/C;SACF;QAED,oCAAM,GAAN,UAAO,EAAU;YACf,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACjD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;YAC/B,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAClC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;SAC1C;QAED,uCAAS,GAAT;YAAA,iBAMC;YALC,IAAI,CAAC,iBAAiB,CAAC,OAAO,EAAE,UAAC,SAAS,EAAE,EAAE;gBAC5C,KAAI,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;aAC1C,EAAE,CAAC;YACJ,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;YAC/B,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;SAC1B;;KAhDH,CAAyC,SAAS;;gBAXjDnB,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,SAAS,EAAE,CAAC,aAAa,CAAC;oBAC1B,QAAQ,EAAE,+TAMC;iBACZ;;;gBApCQ,iBAAiB;gBAHjB,YAAY;gBACZ,gBAAgB;gBAChB,gBAAgB;;;gCAwCtBsB,cAAS,SAAC,eAAe,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;iCACzCC,iBAAY,SAACH,gBAAW,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;;;;QCnCzC,kCACU,QAAoB,EACpB,cAA6B;YAD7B,aAAQ,GAAR,QAAQ,CAAY;YACpB,mBAAc,GAAd,cAAc,CAAe;SAEtC;QAED,sBACI,qDAAe;iBADnB,UACoB,EAAU;gBAC5B,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;aACf;;;WAAA;QAED,2CAAQ,GAAR;YACE,IAAI,IAAI,CAAC,GAAG,KAAK,SAAS,EAAE;gBAC1B,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;aAClE;YAED,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YACjD,MAAM,CAAC,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC;SACxD;;;;gBAzBFZ,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;iBAC9B;;;gBALmBP,eAAU;gBACrB,aAAa;;;kCAenBC,UAAK;;;ICFR;;;;;;;;;;;;;;;;;;;;;;;;;QA0CE,uCAAmB,kBAAsC,EACrC,EAAqB,EACrB,wBAAkD;YAFnD,uBAAkB,GAAlB,kBAAkB,CAAoB;YACrC,OAAE,GAAF,EAAE,CAAmB;YACrB,6BAAwB,GAAxB,wBAAwB,CAA0B;SACrE;QAED,gDAAQ,GAAR;YAAA,iBAWC;YAVC,IAAI,CAAC,6BAA6B;gBAChC,IAAI,CAAC,kBAAkB,CAAC,yBAAyB,CAAC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,GAAA,CAAC,CAAC;YAC7F,IAAI,CAAC,2BAA2B;gBAC9B,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,SAAS,CAAC;oBACvC,IAAM,gBAAgB,GAAG,KAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAAC,KAAI,CAAC,kBAAkB,CAAC,OAAc,CAAC,CAAC;oBACvH,KAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;oBAC9B,IAAM,YAAY,GAAG,KAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;oBAC5E,YAAY,CAAC,QAA6B,CAAC,IAAI,GAAG,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,IAAI,CAAC;oBACxF,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;iBACzB,CAAC,CAAC;SACN;QAED,mDAAW,GAAX;YACE,IAAI,IAAI,CAAC,6BAA6B,EAAE;gBACtC,IAAI,CAAC,6BAA6B,CAAC,WAAW,EAAE,CAAC;aAClD;YAED,IAAI,IAAI,CAAC,2BAA2B,EAAE;gBACpC,IAAI,CAAC,2BAA2B,CAAC,WAAW,EAAE,CAAC;aAChD;SACF;;;;gBA3CFF,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,+LAIT;oBAED,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBAtCQ,kBAAkB;gBARzBY,sBAAiB;gBAEjBK,6BAAwB;;;mCAkDvBF,cAAS,SAAC,sBAAsB,EAAE,EAAE,IAAI,EAAED,qBAAgB,EAAE;;;ICjC/D;;;;;;;;;;;;;;;;;;;;;;;;;;QAyDE,8BAAmB,YAA0B,EAAU,EAAqB;YAAzD,iBAAY,GAAZ,YAAY,CAAc;YAAU,OAAE,GAAF,EAAE,CAAmB;YAZnE,SAAI,GAAG,IAAI,CAAC;YAIb,gBAAW,GAAG,IAAI,GAAG,EAAoB,CAAC;YAE1C,OAAE,GAAG,CAAC,CAAC;YACE,aAAQ,GAAG,sBAAsB,CAAC;YAGnD,qBAAgB,GAAG,IAAI1B,YAAO,EAAkB,CAAC;SAGhD;QAED,0CAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE;gBAChC,IAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC;gBAClD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;oBACpC,MAAM,IAAI,KAAK,CAAC,uGAAmG,WAAa,CAAC,CAAC;iBACnI;gBACD,IAAM,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAC1D,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAC7B,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;aAC/B;SACF;QAED,uCAAQ,GAAR;YAAA,iBAQC;YAPC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,KAAK,GAAG,KAAK,CAAC;aAC5C;YAED,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,CAAC,SAAS,CAAC;gBACzE,KAAI,CAAC,EAAE,CAAC,aAAa,EAAE,CAAC;aACzB,CAAC,CAAC;SACJ;QAED,iDAAkB,GAAlB;YAAA,iBAaC;YAZC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,kBAAkB,CAAC,GAAG,IAAI,CAAC,gBAAgB,CAAC;YACtE,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAC5C,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,SAAoB;gBACpD,SAAS,CAAC,eAAe,CAAC,KAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAC;aACzD,CAAC,CAAC;YACH,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,SAA+B;gBAC/D,KAAI,CAAC,YAAY,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;gBACnD,KAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,mBAAmB,CAAC,SAAS,CAAC,CAAC;gBAC5D,SAAS,CAAC,YAAY,GAAG,KAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC;gBACtD,SAAS,CAAC,eAAe,CAAC,KAAI,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAC;aACzD,CAAC,CAAC;SACJ;QAED,0CAAW,GAAX;YACE,IAAI,IAAI,CAAC,wBAAwB,EAAE;gBACjC,IAAI,CAAC,wBAAwB,CAAC,WAAW,EAAE,CAAC;aAC7C;SACF;QAED,8CAAe,GAAf,UAAgB,YAA0B;YACxC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;SAClC;QAED,mCAAI,GAAJ,UAAK,OAAY,EAAE,EAAU,EAAE,aAAkB;YAAjD,iBAyBC;YAxBC,IAAM,GAAG,GAAG8B,eAAI,CAAC;YACjB,IAAM,aAAa,GAAU,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAC1D,IAAI,CAAC,aAAa,EAAE;gBAClB,OAAO;aACR;YACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACzD,IAAM,eAAe,GAAU,EAAE,CAAC;YAClC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;YAE1C,aAAa,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;gBAChC,KAAI,CAAC,YAAY,CAAC,OAAO,CAAC,KAAI,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC;gBAClD,IAAM,WAAW,GAAG,KAAI,CAAC,kBAAkB,CAAC,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;gBAC7D,eAAe,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAClC,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;aAC/C,CAAC,CAAC;YAEH,IAAI,uBAAuB,EAAE;gBAC3B,IAAM,gBAAgB,GAAG,IAAI,CAAC,QAAQ;oBACpC,uBAAuB,CAAC,MAAM,CAAC,UAAC,QAAQ,IAAK,OAAA,eAAe,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAA,CAAC;oBACnF,uBAAuB,CAAC;gBAC1B,IAAI,gBAAgB,EAAE;oBACpB,gBAAgB,CAAC,OAAO,CAAC,UAAC,QAAQ,IAAK,OAAA,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,CAAC;iBACrE;aACF;SACF;QAED,qCAAM,GAAN,UAAO,EAAU;YAAjB,iBAMC;YALC,IAAM,eAAe,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACjD,IAAI,eAAe,EAAE;gBACnB,eAAe,CAAC,OAAO,CAAC,UAAC,QAAQ,IAAK,OAAA,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,CAAC;aACpE;YACD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC7B;QAED,wCAAS,GAAT;YACE,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;YACvB,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;SAC1B;QAED,6CAAc,GAAd;YACE,OAAO,UAAO,IAAI,CAAC,UAAU,GAAG,SAAS,0BAAsB,CAAC;SACjE;QAEO,iDAAkB,GAAlB,UAAmB,QAAgB,EAAE,SAAc,EAAE,KAAa;YACxE,IAAI,WAAW,CAAC;YAChB,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;aAC/C;iBAAM;gBACL,WAAW,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,MAAM,CAAC,gBAAgB,CAAC;aACrD;YACD,OAAO,QAAQ,GAAG,WAAW,CAAC;SAC/B;;;;gBArIFzB,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,QAAQ,EAAE,6TAQT;oBACD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBAzCQ,YAAY;gBAfnBY,sBAAiB;;;wBA2DhBjB,UAAK;2BAELA,UAAK;uBAELA,UAAK;wBACLoB,cAAS,SAAC,OAAO,EAAE,EAAC,MAAM,EAAE,IAAI,EAAC;6BACjCI,oBAAe,SAAC,SAAS,EAAE,EAAC,WAAW,EAAE,KAAK,EAAC;6BAC/CA,oBAAe,SAAC,oBAAoB,EAAE,EAAC,WAAW,EAAE,KAAK,EAAC;;;IC9D7D;;;;;;;;;;;;;;;;QAoBmD,iDAAS;QAE1D,uCAAY,2BAAwD,EAAE,YAA0B,EACpF,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,2BAA2B,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACrF;;KALH,CAAmD,SAAS;;gBAJ3D1B,cAAS,SAAC;oBACT,QAAQ,EAAE,yBAAyB;oBACnC,QAAQ,EAAE,EAAE;iBACb;;;gBArBQ,2BAA2B;gBAD3B,YAAY;gBADZ,gBAAgB;gBADhB,gBAAgB;;;ICGzB;;;;;;;;;;;;;;;;;;QAsBkD,gDAAoB;QAEpE,sCAAY,cAA8C,EAAE,SAA2B;mBACrF,kBAAM,cAAc,EAAE,SAAS,CAAC;SACjC;;KAJH,CAAkD,oBAAoB;;gBAJrEA,cAAS,SAAC;oBACT,QAAQ,EAAE,uBAAuB;oBACjC,QAAQ,EAAE,EAAE;iBACb;;;gBAvBQ,8BAA8B;gBAD9B,gBAAgB;;;ICCzB;AACA,iCAAe;QACb,EAAC,QAAQ,EAAE,aAAa,EAAE,YAAY,EAAE,IAAI,eAAe,EAAE,EAAC;QAC9D,EAAC,QAAQ,EAAE,kBAAkB,EAAE,YAAY,EAAE,IAAI,oBAAoB,EAAE,EAAC;KACzE;;ICCD;;;;;;;;;;;;;;;;;;;;;;;;;QA4ByC,uCAAS;QAChD,6BAAY,UAA6B,EAAE,YAA0B,EACzD,gBAAkC,EAAE,gBAAkC;mBAChF,kBAAM,UAAU,EAAE,YAAY,EAAE,gBAAgB,EAAE,gBAAgB,CAAC;SACpE;;KAJH,CAAyC,SAAS;;gBAJjDA,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,EAAE;iBACb;;;gBA9BQ,iBAAiB;gBACjB,YAAY;gBAFZ,gBAAgB;gBADhB,gBAAgB;;;ICEzB;;;;;;;;;;;;;;;;;;QAqB0C,wCAAoB;QAC5D,8BAAY,eAAuC,EAAE,SAA2B;mBAC9E,kBAAM,eAAe,EAAE,SAAS,CAAC;SAClC;;KAHH,CAA0C,oBAAoB;;gBAJ7DA,cAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,EAAE;iBACb;;;gBAxBQ,sBAAsB;gBAEtB,gBAAgB;;;;QC8LvB;YACE,cAAc,CAAC,MAAM,EAAE,CAAC;SACzB;QAdM,2BAAO,GAAd,UAAe,MAA4B;YACzC,OAAO;gBACL,QAAQ,EAAE,mBAAmB;gBAC7B,SAAS,EAAE;oBACT,UAAU,EAAE,gBAAgB,EAAE,eAAe,EAAE,aAAa,EAAE,kBAAkB,EAAE,oBAAoB;oBACtG,EAAC,OAAO,EAAE,qBAAqB,EAAE,QAAQ,EAAE,MAAM,EAAC;oBAClD,EAAC,OAAO,EAAE2B,0BAAY,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,IAAI,MAAM,CAAC,WAAW,IAAI,EAAE,EAAC;oBAClF,EAAC,OAAO,EAAEA,0BAAY,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,sBAAsB,EAAC;iBACvE;aACF,CAAC;SACH;;;;gBA5HFb,aAAQ,SAAC;oBACR,OAAO,EAAE;wBACPC,mBAAY;wBACZa,iCAAmB;wBACnB,WAAW;qBACZ;oBACD,YAAY,EAAE;wBACZ,cAAc;wBACd,gBAAgB;wBAChB,oBAAoB;wBACpB,wBAAwB;wBACxB,iCAAiC;wBACjC,oBAAoB;wBACpB,6BAA6B;wBAC7B,sBAAsB;wBACtB,uBAAuB;wBACvB,gCAAgC;wBAChC,eAAe;wBACf,oBAAoB;wBACpB,qBAAqB;wBACrB,kBAAkB;wBAClB,2BAA2B;wBAC3B,6BAA6B;wBAC7B,oBAAoB;wBACpB,gBAAgB;wBAChB,mBAAmB;wBACnB,4BAA4B;wBAC5B,kBAAkB;wBAClB,gBAAgB;wBAChB,oBAAoB;wBACpB,eAAe;wBACf,iBAAiB;wBACjB,cAAc;wBACd,sBAAsB;wBACtB,kBAAkB;wBAClB,yBAAyB;wBACzB,oBAAoB;wBACpB,oBAAoB;wBACpB,kBAAkB;wBAClB,uBAAuB;wBACvB,uBAAuB;wBACvB,wBAAwB;wBACxB,6BAA6B;wBAC7B,mBAAmB;wBACnB,wBAAwB;wBACxB,6BAA6B;wBAC7B,6BAA6B;wBAC7B,mBAAmB;wBACnB,eAAe;wBACf,wBAAwB;wBACxB,oBAAoB;wBACpB,mBAAmB;wBAEnB,4BAA4B;wBAC5B,6BAA6B;wBAC7B,8BAA8B;wBAC9B,6BAA6B;wBAC7B,4BAA4B;wBAC5B,2BAA2B;wBAC3B,4BAA4B;wBAC5B,oBAAoB;qBACrB;oBACD,OAAO,EAAE;wBACP,cAAc;wBACd,oBAAoB;wBACpB,wBAAwB;wBACxB,iCAAiC;wBACjC,oBAAoB;wBACpB,6BAA6B;wBAC7B,sBAAsB;wBACtB,uBAAuB;wBACvB,gCAAgC;wBAChC,gBAAgB;wBAChB,qBAAqB;wBACrB,kBAAkB;wBAClB,2BAA2B;wBAC3B,6BAA6B;wBAC7B,oBAAoB;wBACpB,gBAAgB;wBAChB,mBAAmB;wBACnB,4BAA4B;wBAC5B,kBAAkB;wBAClB,gBAAgB;wBAChB,oBAAoB;wBACpB,eAAe;wBACf,iBAAiB;wBACjB,cAAc;wBACd,sBAAsB;wBACtB,kBAAkB;wBAClB,yBAAyB;wBACzB,oBAAoB;wBACpB,oBAAoB;wBACpB,kBAAkB;wBAClB,uBAAuB;wBACvB,uBAAuB;wBACvB,wBAAwB;wBACxB,6BAA6B;wBAC7B,mBAAmB;wBACnB,wBAAwB;wBACxB,6BAA6B;wBAC7B,mBAAmB;wBACnB,oBAAoB;wBACpB,mBAAmB;wBACnB,oBAAoB;wBACpB,4BAA4B;wBAC5B,6BAA6B;wBAC7B,8BAA8B;wBAC9B,6BAA6B;wBAC7B,4BAA4B;wBAC5B,2BAA2B;wBAC3B,4BAA4B;qBAC7B;iBACF;;;;;QCjL4C,wCAAa;QAA1D;;SAEC;mCAAA;KAFD,CAA6CxC,eAAa;;ICF1D;;;IAGA,WAAY,mBAAmB;QAC7B,iDAAM,MAAM,CAAC,qBAAqB,CAAC,GAAG,SAAA,CAAA;QACtC,kDAAO,MAAM,CAAC,qBAAqB,CAAC,IAAI,UAAA,CAAA;QACxC,mDAAQ,MAAM,CAAC,qBAAqB,CAAC,KAAK,WAAA,CAAA;IAC5C,CAAC,EAJWyC,2BAAmB,KAAnBA,2BAAmB;;ICc/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAmCE,iCAAoB,WAA+B;YAA/B,gBAAW,GAAX,WAAW,CAAoB;YAJnD,2BAAsB,GAAgC,IAAIC,oBAAe,CAAa,EAAE,CAAC,CAAC;YAC1F,2BAAsB,GAAsB,IAAInC,YAAO,EAAY,CAAC;SAInE;QAED,mDAAiB,GAAjB;YACE,OAAO,IAAI,CAAC,sBAAsB,CAAC,YAAY,EAAE,CAAC;SACnD;QAED,kDAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,CAAC;SAC/C;QAED,iDAAe,GAAf;YACE,OAAO,IAAI,CAAC,sBAAsB,CAAC;SACpC;QAED,iDAAe,GAAf,UAAgB,MAAgB,EAAE,oBAA6B;YAC7D,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxC,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;gBAClC,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,oBAAoB,CAAC,CAAC;aAClD;iBAAM;gBACL,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,oBAAoB,CAAC,CAAC;aACnD;SACF;QAEO,+CAAa,GAAb,UAAc,MAAgB,EAAE,oBAA6B;YACnE,IAAI,oBAAoB,EAAE;gBACxB,MAAM,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC;aAC3B;YAED,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxC,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACzC,IAAI,CAAC,sBAAsB,CAAC,IAAI,UAAK,OAAO,GAAE,MAAM,GAAE,CAAC;SACxD;QAEO,gDAAc,GAAd,UAAe,MAAgB,EAAE,oBAA6B;YACpE,IAAI,oBAAoB,EAAE;gBACxB,MAAM,CAAC,UAAU,CAAC,GAAG,KAAK,CAAC;aAC5B;YAED,IAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxC,IAAM,WAAW,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAC5C,IAAI,WAAW,KAAK,CAAC,CAAC,EAAE;gBACtB,OAAO,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;gBAC/B,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAC1C,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAC1C;SACF;QAED,+CAAa,GAAb,UAAc,gBAAmC,EAAE,oBAA2B,EAAE,aAAsB,EAAE,KAAc;YAAtH,iBA2BC;YA3BkD,qCAAA,EAAA,2BAA2B;YAC5E,IAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YACpD,IAAI,CAAC,YAAY,EAAE;gBACjB,OAAO;aACR;YAED,IAAI,CAAC,uBAAuB,GAAG,YAAY,CAAC,mBAAmB,EAAE,CAAC;YAElE,IAAI,CAAC,gBAAgB,EAAE;gBACrB,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,EAAC,KAAK,EAAElB,mBAAW,CAAC,UAAU,EAAC,CAAC,CAAC;aAClE;YAED,IAAM,iBAAiB,GAAG,IAAI,CAAC,uBAAuB,CAAC,QAAQ,CAAC;gBAC9D,KAAK,EAAE,gBAAgB,CAAC,KAAK;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,QAAQ;gBAC1B,QAAQ,EAAE,gBAAgB,CAAC,QAAQ;gBACnC,UAAU,EAAE,gBAAgB,CAAC,UAAU;gBACvC,QAAQ,EAAE,aAAa;aACxB,CAAC,CAAC;YAEH,iBAAiB,CAAC,IAAI,CACpBmB,aAAG,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,QAAQ,GAAA,CAAC,EAC9BD,gBAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,GAAA,CAAC,CAAC;iBACnD,SAAS,CAAC,UAAA,QAAQ;gBACjB,IAAM,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAC3B,KAAI,CAAC,eAAe,CAAC,MAAM,EAAE,oBAAoB,CAAC,CAAC;aACpD,CAAC,CAAC;SACN;;;;gBAjFFzB,eAAU;;;gBAtCF,kBAAkB;;;ICR3B;;ICAA,WAAY,SAAS;QACnB,6CAAM,CAAA;QACN,yCAAI,CAAA;QACJ,6DAAc,CAAA;IAChB,CAAC,EAJW4D,iBAAS,KAATA,iBAAS;;ICArB,WAAY,WAAW;QACrB,6CAAI,CAAA;QACJ,yDAAU,CAAA;QACV,uDAAS,CAAA;QACT,iEAAc,CAAA;QACd,iEAAc,CAAA;QACd,6DAAY,CAAA;QACZ,yDAAU,CAAA;QACV,uEAAiB,CAAA;QACjB,yDAAU,CAAA;QACV,uEAAiB,CAAA;QACjB,8CAAI,CAAA;QACJ,oDAAO,CAAA;QACP,kDAAM,CAAA;QACN,oDAAO,CAAA;QACP,oGAA+B,CAAA;QAC/B,0EAAkB,CAAA;QAClB,8DAAY,CAAA;QACZ,wDAAS,CAAA;IACX,CAAC,EAnBWC,mBAAW,KAAXA,mBAAW;;;QCIQ,6BAAQ;QASrC,mBAAY,QAAgB,EAAE,QAAoB,EAAE,UAAuB,EAAE,YAAoB;YAApB,6BAAA,EAAA,oBAAoB;YAAjG,YACE,iBAAO,SAMR;YATO,WAAK,GAAG,IAAI,CAAC;YAInB,KAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;YAC/B,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACzB,KAAI,CAAC,EAAE,GAAG,KAAI,CAAC,UAAU,EAAE,CAAC;YAC5B,KAAI,CAAC,UAAU,qBAAO,UAAU,CAAC,CAAC;YAClC,KAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC;;SACvC;QAED,sBAAI,2BAAI;iBAAR;gBACE,OAAO,IAAI,CAAC,KAAK,CAAC;aACnB;iBAED,UAAS,KAAK;gBACZ,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;aACpB;;;WAJA;QAMD,sBAAI,4BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,UAAU,CAAC;aACxB;iBAED,UAAU,KAAiB;gBACzB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;aACzB;;;WAJA;QAMD,sCAAkB,GAAlB;YACE,OAAO,IAAI,CAAC,iBAAiB,CAAC;SAC/B;QAED,uCAAmB,GAAnB,UAAoB,KAAc;YAChC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;SAChC;QAED,qCAAiB,GAAjB;YACE,OAAO,IAAI,CAAC,cAAc,CAAC;SAC5B;QAED,+BAAW,GAAX;YACE,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SAC9B;QAED,+CAA2B,GAA3B;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACxE;QAGD,+BAAW,GAAX,UAAY,QAAoB;YAC9B,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;SAC9B;QAED,yBAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;QAEO,8BAAU,GAAV;YACN,OAAO,aAAa,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC;SAC5C;;KAnEH,CAA+B,QAAQ;IAC9B,iBAAO,GAAG,CAAC;;aCLJ,WAAW,CAAC,MAAW;QAAX,uBAAA,EAAA,WAAW;QACrC,IAAI,EAAE,GAAG,EAAE,CAAC;QACZ,IAAM,QAAQ,GAAG,gEAAgE,CAAC;QAClF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;YAC/B,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC;SACpE;QAED,OAAO,EAAE,CAAC;IACZ,CAAC;aAEe,QAAQ,CAAC,IAAI,EAAE,IAAI;QACjC,IAAI,OAAO,CAAC;QACZ,OAAO;YAAU,cAAO;iBAAP,UAAO,EAAP,qBAAO,EAAP,IAAO;gBAAP,yBAAO;;YACtB,IAAM,OAAO,GAAG,IAAI,CAAC;YACrB,YAAY,CAAC,OAAO,CAAC,CAAC;YACtB,OAAO,GAAG,UAAU,CAAC,cAAM,OAAA,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,GAAA,EAAE,IAAI,CAAC,CAAC;SAC7D,CAAC;IACJ;;QCIa,qBAAqB,GAAqB;QACrD,iBAAiB,EAAEvD,mBAAW,CAAC,UAAU;QACzC,gBAAgB,EAAEA,mBAAW,CAAC,WAAW;QACzC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC;YACzC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,IAAI,EAAE,IAAI;YACV,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAGU,kBAAa,GAAG,IAAIkB,YAAO,EAAmB,CAAC;YAC/C,oBAAe,GAAGL,iBAAO,EAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAIjE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;SA+TzE;QA5TC,kCAAI,GAAJ,UAAK,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,YAAkC,EAClC,YAA2B;YAC9B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;YACjC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YAE/B,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;SAC5C;QAED,sCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAEO,8CAAgB,GAAhB,UAAiB,UAAU;YACjC,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;;YAG3E,IAAI,UAAU,EAAE;gBACd,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;gBAClE,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aAC3D;YACD,OAAO,UAAU,CAAC;SACnB;QAED,oCAAM,GAAN,UAAO,OAA+B,EAAE,aAAmB;YAA3D,iBAiEC;YAjEM,wBAAA,EAAA,+BAA+B;YAAE,8BAAA,EAAA,mBAAmB;YACzD,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAE9C,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAkB;gBAC7D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,YAAY,EAAE,YAAY;aAC3B,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG,UAAC,QAAoB;gBAC1C,OAAO,KAAI,CAAC,gBAAgB,CAC1B,EAAE,EACF,iBAAiB,EACjB,QAAQ,EACR,aAAa,EACb,YAAY,EACZ,gBAAgB,EAChB,IAAI,CACL,CAAC;aACH,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;gBACvB,UAAU,EAAE,OAAO,CAAC,iBAAiB;aACtC,CAAC,CAAC;YACH,IAAM,wBAAwB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC9D,KAAK,EAAE,YAAY,CAAC,iBAAiB;gBACrC,QAAQ,EAAE,YAAY,CAAC,oBAAoB;gBAC3C,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;gBACvB,UAAU,EAAE,OAAO,CAAC,iBAAiB;aACtC,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,wBAAwB,CAAC,CAAC,CAAC;YAC/E,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;gBACpD,IAAI,QAAQ,EAAE;oBAEZ,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;wBACtB,EAAE,IAAA;wBACF,QAAQ,UAAA;wBACR,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YACH,wBAAwB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBAC3D,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;gBACpD,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;aAC3C,CAAC,CAAC;YACH,OAAO,gBAAgB,CAAC;SACzB;QAEO,8CAAgB,GAAhB,UAAiB,EAAE,EACF,iBAAiB,EACjB,QAAoB,EACpB,aAAa,EACb,YAAY,EACZ,gBAAgB,EAChB,cAAuB;YAC9C,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAED,iBAAS,CAAC,cAAc;gBAClC,eAAe,EAAE,QAAQ;gBACzB,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,KACT,QAAQ,EAAE,QAAQ,EAClB,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;YAEH,IAAM,UAAU,GAAG;gBACjB,EAAE,IAAA;gBACF,QAAQ,EAAED,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACpC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACnC,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBAC/B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;aAC7E;YACD,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/B,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,QAAQ,EAAE,aAAa,EAAE,iBAAiB,EAAE,YAAY,EAAE,gBAAgB,CAAC,CAAC;YAC/F,cAAc,GAAG,IAAI,CAAC;YACtB,OAAO,cAAc,CAAC;SACvB;QAED,kCAAI,GAAJ,UAAK,QAAoB,EAAE,OAA+B,EAAE,QAAc;YAA/C,wBAAA,EAAA,+BAA+B;YAAE,yBAAA,EAAA,cAAc;YACxE,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC9C,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAkB;gBACvD,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YACH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,YAAY,EAAE,YAAY;aAC3B,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,QAAQ,EAAE,QAAQ,EAClB,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;YACH,OAAO,IAAI,CAAC,SAAS,CACnB,EAAE,EACF,QAAQ,EACR,QAAQ,EACR,WAAW,EACX,YAAY,CACb,CAAC;SACH;QAEO,uCAAS,GAAT,UAAU,EAAU,EACP,QAAoB,EACpB,QAAgB,EAChB,WAAqC,EACrC,OAAyB,EACzB,cAAsC;YALnD,iBAkDP;YA5CC,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEtD,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAM,uBAAuB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC7D,KAAK,EAAE,OAAO,CAAC,gBAAgB;gBAC/B,QAAQ,EAAE,OAAO,CAAC,mBAAmB;gBACrC,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEA,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,qBAAqB,CAAC,IAAI,CACxBqB,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBACtE,SAAS,CAAC,UAAC,EAA6C;oBAA3C,gBAA+B,EAAnB,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACrD,IAAM,eAAe,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;gBAC3D,IAAI,CAAC,eAAe,EAAE;oBACpB,OAAO;iBACR;gBACD,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;oBACxB,eAAe,iBAAA;oBACf,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;iBAC1E,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,QAAQ,EAAE,eAAe,EACzB,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;aAEJ,CAAC,CAAC;YAEL,IAAM,WAAW,GAAG,CAAC,qBAAqB,EAAE,uBAAuB,CAAC,CAAC;YACrE,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACrD;QAEO,wCAAU,GAAV,UAAW,OAAyB;YAC1C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC;YACvE,IAAM,YAAY,GAAqB,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAC5E,YAAY,CAAC,UAAU,mCAAO,qBAAqB,CAAC,UAAU,GAAK,OAAO,CAAC,UAAU,CAAC,CAAC;YACvF,YAAY,CAAC,UAAU,mCAAO,qBAAqB,CAAC,UAAU,GAAK,OAAO,CAAC,UAAU,CAAC,CAAC;YACvF,OAAO,YAAY,CAAC;SACrB;QAGO,oDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAAkD;YAA9G,iBA+EP;YA7EC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAE,KAAI,CAAC,WAAW,CAAC,EAAE,CAAC;oBAC9B,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAE,KAAI,CAAC,WAAW,CAAC,EAAE,CAAC;oBAC9B,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAAC,KAGpB,EAAE,UAAuB;gBACrC,IAAM,QAAQ,GAAG,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC3C,QAAQ,CAAC,WAAW,CAAC,KAAK,EAAE,UAAU,CAAC,CAAC;gBACxC,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAAa;gBACnD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,kEAAkE,CAAC,CAAC;iBACrF;gBAED,OAAO,cAAc,CAAC,IAAI,CAAC,CAAC;aAC7B,CAAC;YAEF,kBAAkB,CAAC,eAAe,GAAG,cAAM,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAA,CAAC;YAE7D,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YAEpF,OAAO,kBAA2C,CAAC;SACpD;QAEO,yCAAW,GAAX,UAAY,EAAU;YAC5B,IAAM,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACxC,OAAO,KAAK,CAAC,WAAW,EAAE,CAAC;SAC5B;QAEO,sCAAQ,GAAR,UAAS,EAAU;YACzB,IAAM,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACxC,IAAI,KAAK,EAAE;gBACT,OAAO,KAAK,CAAC,eAAe,EAAE,CAAC;aAChC;SACF;;;;gBAtUF7D,eAAU;;;QCjBE,iBAAiB,GAAe;QAC3C,eAAe,EAAE,IAAI,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC;QAC3D,iBAAiB,EAAE,IAAI,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,CAAC;QAChD,wBAAwB,EAAE,SAAS;QACnC,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;QAC7B,IAAI,EAAE,iBAAiB;QACvB,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,IAAI;QAC5C,gBAAgB,EAAE,MAAM,CAAC,gBAAgB,CAAC,IAAI;QAC9C,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;QAChC,YAAY,EAAE,GAAG;QACjB,WAAW,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI;QACnC,0BAA0B,EAAE,SAAS;QACrC,KAAK,EAAE,GAAG;QACV,eAAe,EAAE,SAAS;QAC1B,IAAI,EAAE,IAAI;QACV,cAAc,EAAE,KAAK;QACrB,KAAK,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI;QAC7B,IAAI,EAAE,EAAE;QACR,sBAAsB,EAAE,SAAS;QACjC,cAAc,EAAE,MAAM,CAAC,cAAc,CAAC,QAAQ;QAC9C,SAAS,EAAE,MAAM,CAAC,UAAU,CAAC,IAAI;QACjC,wBAAwB,EAAE,CAAC;;;;QC5DM,iCAAQ;QAMzC,uBAAoB,EAAU,EACV,UAA4B,EAC5B,mBAAwC,EACxC,WAA6B,EACrC,QAAqB;YAJjC,YAKE,iBAAO,SAKR;YAVmB,QAAE,GAAF,EAAE,CAAQ;YACV,gBAAU,GAAV,UAAU,CAAkB;YAC5B,yBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,iBAAW,GAAX,WAAW,CAAkB;YAPzC,iBAAW,GAAG,IAAI,CAAC;YAEnB,aAAO,GAAiB,EAAE,CAAC;YAQjC,KAAI,CAAC,MAAM,qBAAO,WAAW,CAAC,UAAU,CAAC,CAAC;YAC1C,IAAI,QAAQ,EAAE;gBACZ,KAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;aACnC;;SACF;QAED,sBAAI,iCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAC7B,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;gBAC1C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;qBAC3B;oBACD,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAbA;QAeD,sBAAI,gCAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;iBAED,UAAU,KAAiB;gBACzB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAJA;QAMD,sBAAI,qCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAC3B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,KAAK,EAAE;oBACT,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC;iBAC7C;qBAAM;oBACL,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;oBAC9C,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,GAAG,EAAE,CAAC;iBACjC;gBACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;;;WAXA;QAaO,0CAAkB,GAAlB,UAAmB,QAAoB;YAC7C,IAAI,CAAC,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;YAC3D,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;QAEO,mCAAW,GAAX,UAAY,KAA0C;YAC5D,IAAK,KAAgC,CAAC,QAAQ,EAAE;gBAC9C,OAAO,IAAI,CAAC;aACb;YACD,OAAO,KAAK,CAAC;SACd;QAED,mCAAW,GAAX,UAAY,KAA0C,EAAE,KAAkB;YACxE,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;gBACpB,MAAM,IAAI,KAAK,CAAC,2DAA2D,CAAC,CAAC;aAC9E;YACD,IAAI,QAAQ,GAAG,KAAK,CAAC;YACrB,IAAI,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;gBAC3B,QAAQ,GAAG,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC,SAAS,GAAG,KAAK,CAAC;gBACrD,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;aACxC;iBAAM;gBACL,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;aAC/B;YACD,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,QAAQ,CAAC;YAC5B,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;QAED,oCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACjC,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;QAED,iCAAS,GAAT,UAAU,UAAsB;YAC9B,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;gBACf,IAAI,CAAC,KAAK,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;aAC9D;iBAAM;gBACL,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;aACpC;YACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;QAED,uCAAe,GAAf;YACE,OAAO,IAAI,CAAC,KAAK,CAAC;SACnB;QAED,mCAAW,GAAX;YACE,OAAO,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;SACjC;QAED,mDAA2B,GAA3B;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACxE;QAEO,wCAAgB,GAAhB;YACN,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACxD;QAED,8BAAM,GAAN;YACE,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;QAED,+BAAO,GAAP;YACE,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SAC5C;QAED,6BAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;4BACF;KA9HD,CAAmC,QAAQ;;;QCN3C;YAEE,WAAM,GAA+B,IAAI,GAAG,EAAyB,CAAC;SAyCvE;QAvCC,kDAAmB,GAAnB,UAAoB,EAAU,EACV,cAAgC,EAChC,mBAAwC,EACxC,WAA8B,EAC9B,QAAqB;YACvC,IAAM,aAAa,GAAG,IAAI,aAAa,CACrC,EAAE,EACF,cAAc,EACd,mBAAmB,EACnB,WAAW,EACX,QAAQ,CAAC,CAAC;YACZ,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,aAAa,CAChC,CAAC;SACH;QAED,wCAAS,GAAT;YACE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,UAAU,GAAG,IAAI,GAAA,CAAC,CAAC;SACvD;QAED,yCAAU,GAAV;YACE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,UAAU,GAAG,KAAK,GAAA,CAAC,CAAC;SACxD;QAED,sCAAO,GAAP,UAAQ,EAAU;YAChB,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAClC,IAAI,KAAK,CAAC,eAAe,EAAE,EAAE;gBAC3B,KAAK,CAAC,OAAO,EAAE,CAAC;aACjB;YACD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACxB;QAED,kCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC5B;QAED,oCAAK,GAAL;YACE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YAC9C,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;SACrB;;;;gBA1CFA,eAAU;;;;QCwET,+BACU,YAAiC,EACjC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,aAAmC,EACnC,aAA4B;YAL5B,iBAAY,GAAZ,YAAY,CAAqB;YACjC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,kBAAa,GAAb,aAAa,CAAsB;YACnC,kBAAa,GAAb,aAAa,CAAe;YAb/B,WAAM,GAAG,MAAM,CAAC;YAChB,eAAU,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC3C,iBAAY,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAalD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YAC/H,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,6DAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAAuB;gBAC7D,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,0CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,gDAAgB,GAAhB,UAAiB,KAAoB,EAAE,MAAuB,EAAE,MAAqB;YACnF,IAAI,MAAM,EAAE;gBACV,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;gBACtB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;gBACnD,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,MAAM,CAAC,QAAQ,GAAG,KAAK,CAAC,WAAW,EAAE,CAAC;YACtC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,eAAe,EAAE,CAAC;YACvC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;YAC7D,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACpD;QAED,gDAAgB,GAAhB,UAAiB,KAAoB;YACnC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;YAClB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SAC7C;QAED,mDAAmB,GAAnB,UAAoB,MAAuB;YACzC,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,aAAa,CAAC,mBAAmB,CACpC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,YAAY,EACnB,MAAM,CAAC,QAAQ,CAChB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC3C,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACxC,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,KAAK,IAAI,KAAK,CAAC,eAAe,EAAE,EAAE;wBACpC,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;qBAC9B;oBACD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtC,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;oBACpC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;oBACrC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC1D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC1D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,iDAAiB,GAAjB,UAAkB,MAAuB;YACvC,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,aAAa,CAAC,mBAAmB,CACpC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,cAAc,EACnB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,YAAY,EACnB,MAAM,CAAC,QAAQ,CAChB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,KAAK,IAAI,KAAK,CAAC,UAAU,EAAE;wBAC7B,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACxC,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,KAAK,IAAI,KAAK,CAAC,UAAU,EAAE;wBAC7B,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACxC,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,KAAK,EAAE;wBACT,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAChD,IAAI,KAAK,EAAE;wBACT,KAAK,CAAC,UAAU,GAAG,IAAI,CAAC;wBACxB,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;qBACtC;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,2CAAW,GAAX;YACE,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SAC5B;QAED,4CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,4CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBArOFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,eAAe;oBACzB,QAAQ,WAAW,68DA+ClB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,oBAAoB,CAAC;oBACtD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBA1DQ,mBAAmB;gBALnB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAGb,oBAAoB;gBAXpB,aAAa;;;iCA2EnBe,cAAS,SAAC,gBAAgB;mCAC1BA,cAAS,SAAC,kBAAkB;;;;QCzEG,gCAAQ;QAOxC,sBAAY,QAAgB,EAAE,aAAyB,EAAE,WAAuB,EAAE,aAA6B;YAA/G,YACE,iBAAO,SAKR;YAJC,KAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;YAC/B,KAAI,CAAC,EAAE,GAAG,KAAI,CAAC,UAAU,EAAE,CAAC;YAC5B,KAAI,CAAC,SAAS,GAAG,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;YAC9C,KAAI,CAAC,cAAc,qBAAO,aAAa,CAAC,CAAC;;SAC1C;QAED,sBAAI,+BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;iBAED,UAAU,KAAoB;gBAC5B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;;;WAJA;QAMD,wCAAiB,GAAjB;YACE,OAAO,IAAI,CAAC,cAAc,CAAC;SAC5B;QAED,mCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;SAC3C;QAGD,mDAA4B,GAA5B;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACzE;QAED,wCAAiB,GAAjB;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,SAAS,CAAC;SAC3E;QAED,uCAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAC1B;QAED,qCAAc,GAAd;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;SAC1B;QAED,uCAAgB,GAAhB,UAAiB,QAAoB;YACnC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC;SAC9B;QAED,qCAAc,GAAd,UAAe,QAAoB;YACjC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC;SAC9B;QAED,4BAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;QAEO,iCAAU,GAAV;YACN,OAAO,gBAAgB,GAAG,YAAY,CAAC,OAAO,EAAE,CAAC;SAClD;;KA9DH,CAAkC,QAAQ;IACjC,oBAAO,GAAG,CAAC;;;QCOiB,mCAAQ;QAY3C,yBAAoB,EAAU,EACV,aAA+B,EAC/B,WAA6B,EAC7B,cAAgC,EAChC,mBAAwC,EACxC,cAAkC,EAC1C,SAAwB;YANpC,YAOE,iBAAO,SAOR;YAdmB,QAAE,GAAF,EAAE,CAAQ;YACV,mBAAa,GAAb,aAAa,CAAkB;YAC/B,iBAAW,GAAX,WAAW,CAAkB;YAC7B,oBAAc,GAAd,cAAc,CAAkB;YAChC,yBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,oBAAc,GAAd,cAAc,CAAoB;YAhB9C,eAAS,GAAgB,EAAE,CAAC;YAC5B,eAAS,GAAmB,EAAE,CAAC;YAE/B,kBAAY,GAAG,KAAK,CAAC;YACrB,iBAAW,GAAG,IAAI,CAAC;YAKnB,aAAO,GAAiB,EAAE,CAAC;YAUjC,KAAI,CAAC,YAAY,qBAAO,cAAc,CAAC,YAAY,CAAC,CAAC;YACrD,KAAI,CAAC,iBAAiB,qBAAO,cAAc,CAAC,UAAU,CAAC,CAAC;YACxD,KAAI,CAAC,oBAAoB,qBAAO,cAAc,CAAC,aAAa,CAAC,CAAC;YAC9D,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;gBACtC,KAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;aACpC;;SACF;QAED,sBAAI,mCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAC7B,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC1C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,KAAK,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;qBACnC;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAdA;QAgBD,sBAAI,iDAAoB;iBAAxB;gBACE,OAAO,IAAI,CAAC,qBAAqB,CAAC;aACnC;iBAED,UAAyB,KAAoB;gBAC3C,IAAI,CAAC,qBAAqB,GAAG,KAAK,CAAC;aACpC;;;WAJA;QAMD,sBAAI,8CAAiB;iBAArB;gBACE,OAAO,IAAI,CAAC,kBAAkB,CAAC;aAChC;iBAUD,UAAsB,KAAiB;gBACrC,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;aACjC;;;WAZA;QAED,sBAAI,yCAAY;iBAAhB;gBACE,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;iBAED,UAAiB,KAAmB;gBAClC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;aAC5B;;;WAJA;QAUD,sBAAI,uCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAA7B,iBAMC;gBALC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;oBAC1B,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;oBACnB,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;iBACtC,CAAC,CAAC;aACJ;;;WARA;QAUO,4CAAkB,GAAlB,UAAmB,SAAuB;YAA1C,iBAOP;YANC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACzB,KAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;aACrC,CAAC,CAAC;YACH,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAC/B,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;SAC1B;QAED,2CAAiB,GAAjB,UAAkB,MAAyE,EAAE,YAA2B;YAAxH,iBAsBC;YArBC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,MAAM,IAAI,KAAK,CAAC,6DAA6D,CAAC,CAAC;aAChF;YAED,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YAChE,IAAM,SAAS,GAAgB,EAAE,CAAC;YAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACtC,IAAM,gBAAgB,GAAQ,MAAM,CAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,QAAQ,GAAG,IAAI,CAAC;gBACpB,IAAI,gBAAgB,CAAC,UAAU,EAAE;oBAC/B,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,CAAC,QAAQ,EAAE,gBAAgB,CAAC,UAAU,CAAC,CAAC;iBAC3F;qBAAM;oBACL,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;iBAC7E;gBACD,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC1B;YACD,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,YAAY,GAAG,YAAY,GAAG,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;YACpE,IAAI,CAAC,iBAAiB,OAAtB,IAAI,YAAmB,IAAI,GAAK,IAAI,CAAC,SAAS,GAAE;YAChD,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAC/B,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAEO,iDAAuB,GAAvB;YAAA,iBASP;YARC,IAAM,aAAa,YAAO,IAAI,CAAC,SAAS,CAAC,CAAC;YAC1C,aAAa,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,KAAK;gBAC/B,IAAM,YAAY,GAAG,GAAG,CAAC;gBACzB,IAAM,SAAS,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC;gBACvD,IAAM,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC;gBAC3C,IAAM,QAAQ,GAAG,KAAI,CAAC,qBAAqB,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;gBACrE,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;aACzC,CAAC,CAAC;SACJ;QAEO,+CAAqB,GAArB,UAAsB,MAAiB,EAAE,OAAkB;YACjE,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,OAAO,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAC7H,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,kBAAkB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACpF,QAAQ,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAEnC,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAClD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,GAAG,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;YACnD,OAAO,QAAQ,CAAC;SACjB;QAEO,kDAAwB,GAAxB,UAAyB,gBAA2B,EAAE,SAAoB,EAAE,SAAoB;YACtG,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE,SAAS,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAClI,gBAAgB,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;SAClD;QAED,uDAA6B,GAA7B,UAA8B,KAAgB;YAC5C,KAAK,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;YACjC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACjD,IAAM,SAAS,GAAG,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC;YACnD,IAAM,QAAQ,GAAG,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC;YAEhE,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YAC5C,IAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YAE1C,IAAM,aAAa,GAAG,IAAI,CAAC,qBAAqB,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YAClE,IAAM,WAAW,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;YACjE,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,aAAa,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;YAChE,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAE5B;QAEO,yCAAe,GAAf;YAAA,iBAWP;YAVC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YACjF,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YACpB,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,GAAG,IAAI,OAAA,CAAC,GAAG,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC;YAC3E,UAAU,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;gBAC9B,IAAM,SAAS,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,UAAU,CAAC,MAAM,CAAC,CAAC;gBACpD,IAAM,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC;gBACxC,IAAM,QAAQ,GAAG,IAAI,YAAY,CAAC,KAAI,CAAC,EAAE,EAAE,KAAK,CAAC,WAAW,EAAE,EAAE,SAAS,CAAC,WAAW,EAAE,EAAE,KAAI,CAAC,oBAAoB,CAAC,CAAC;gBACpH,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC9B,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;aACxD,CAAC,CAAC;SACJ;QAED,8CAAoB,GAApB,UAAqB,QAAoB;YACvC,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC1E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;SACxC;QAGD,kCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YACD,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5C,IAAI,YAAY,EAAE;gBAChB,IAAM,UAAU,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBAC5E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAChC,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aAC1C;YAED,IAAI,CAAC,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACpF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAEtC,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAC/C,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,yCAAe,GAAf,UAAgB,SAAoB;YAClC,IAAI,IAAI,CAAC,cAAc,CAAC,eAAe,EAAE;gBACvC,SAAS,CAAC,KAAK,CAAC,wBAAwB,GAAG,MAAM,CAAC,iBAAiB,CAAC;gBACpE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;aAC1C;SACF;QAED,mCAAS,GAAT,UAAU,UAAsB,EAAE,SAAoB;YACpD,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAClC,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,SAAS,CAAC,KAAK,CAAC,wBAAwB,IAAI,IAAI,CAAC,cAAc,CAAC,eAAe,EAAE;;oBAEnF,SAAS,CAAC,KAAK,CAAC,wBAAwB,GAAG,SAAS,CAAC;oBACrD,OAAO;iBACR;gBAED,IAAI,SAAS,CAAC,kBAAkB,EAAE,EAAE;oBAClC,IAAI,CAAC,6BAA6B,CAAC,SAAS,CAAC,CAAC;iBAC/C;gBACD,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;gBACrD,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;gBAC1E,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;gBACvE,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC,CAAC;gBACxF,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC,CAAC;gBACrF,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,EAAE,SAAS,EAAE,aAAa,CAAC,CAAC;gBAC1E,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,EAAE,SAAS,EAAE,aAAa,CAAC,CAAC;aAC3E;YACD,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACzC;QAED,6CAAmB,GAAnB,UAAoB,UAAsB;YACxC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aAC9C;SACF;QAED,qCAAW,GAAX,UAAY,mBAA+B,EAAE,iBAA6B;YAA1E,iBAgBC;YAfC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,OAAO;aACR;YACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,mBAAmB,CAAC;aAClD;YAED,IAAM,KAAK,GAAG,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,iBAAiB,CAAC,CAAC;YAC/F,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;gBAC1B,IAAM,MAAM,GAAG,eAAe,CAAC,kBAAkB,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;gBACpF,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aAC3B,CAAC,CAAC;YACH,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;YAC/C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,KAAK,CAAC,GAAA,CAAC,CAAC;SACtE;QAED,wCAAc,GAAd;YACE,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;SACxC;QAED,qCAAW,GAAX,UAAY,aAAwB;YAApC,iBAWC;YAVC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YACnC,IAAI,CAAC,SAAS;iBACX,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,kBAAkB,EAAE,GAAA,CAAC;iBACnC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;YACxC,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAE/B,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE;gBAC9B,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;aAC1C;SACF;QAED,sCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACtC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAE3B,IAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC;QAED,0CAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SACrE;QAED,uCAAa,GAAb;YAAA,iBAEC;YADC,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC,QAAQ,CAAC,kBAAkB,EAAE,IAAI,QAAQ,KAAK,KAAI,CAAC,WAAW,GAAA,CAAC,CAAC;SAC3G;QAED,mCAAS,GAAT;YAAA,iBAEC;YADC,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,KAAK,KAAI,CAAC,WAAW,GAAA,CAAC,CAAC;SACzE;QAED,+CAAqB,GAArB;YACE,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC,QAAQ,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,CAAC,KAAK,EAAE,GAAA,CAAC,CAAC;YACpI,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;SAC/C;QAED,+DAAqC,GAArC;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SAClF;QAEO,wCAAc,GAAd,UAAe,KAAgB;YACrC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,KAAK,KAAK,GAAA,CAAC,CAAC;YAC3D,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACxC;QAEO,6CAAmB,GAAnB;YACN,IAAI,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE;gBAC9B,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;aAC1C;SACF;QAEO,2CAAiB,GAAjB,UAAkB,eAAsB;YAAxC,iBAKP;YALyB,gCAAA,EAAA,sBAAsB;YAAE,gBAAsB;iBAAtB,UAAsB,EAAtB,qBAAsB,EAAtB,IAAsB;gBAAtB,+BAAsB;;YACtE,IAAI,eAAe,EAAE;gBACnB,IAAI,CAAC,eAAe,EAAE,CAAC;aACxB;YACD,MAAM,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;SAC5D;QAED,iCAAO,GAAP;YAAA,iBAYC;YAXC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAEnC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,SAAS;gBAC9B,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;aAC5C,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YACzE,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;aAC9B;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,wCAAc,GAAd;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;SAC9B;QAED,+BAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;8BACF;KAtVD,CAAqC,QAAQ;;;QCL7C;YAEE,aAAQ,GAAiC,IAAI,GAAG,EAA2B,CAAC;SA8B7E;QA5BC,sDAAqB,GAArB,UAAsB,EAAU,EAAE,iBAAmC,EAAE,eAAiC,EAClF,kBAAoC,EAAE,mBAAwC,EAC9E,cAAmC,EAAE,SAAwB;YACjF,IAAM,eAAe,GAAG,IAAI,eAAe,CACzC,EAAE,EACF,iBAAiB,EACjB,eAAe,EACf,kBAAkB,EAClB,mBAAmB,EACnB,cAAc,EACd,SAAS,CAAC,CAAC;YACb,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,eAAe,CACpC,CAAC;SACH;QAED,wCAAO,GAAP,UAAQ,EAAU;YAChB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;YAChC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC1B;QAED,oCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC9B;QAED,sCAAK,GAAL;YACE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO,IAAI,OAAA,OAAO,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YACpD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SACvB;;;;gBA/BFnD,eAAU;;;eCyCG,cAAM,OAAA,MAAM,CAAC,KAAK,CAAC,KAAK;QAxBzB,uBAAuB,GAAuB;QACzD,aAAa,EAAEM,mBAAW,CAAC,UAAU;QACrC,iBAAiB,EAAEA,mBAAW,CAAC,iBAAiB;QAChD,gBAAgB,EAAEA,mBAAW,CAAC,WAAW;QACzC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC;YACzC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;QACD,YAAY,EAAE;YACZ,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC;YACpD,IAAI,EAAE,IAAI;YACV,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;YAClD,MAAM,EAAE,CAAC;SACV;QACD,aAAa,EAAE;YACb,QAAQ,MAA0B;YAClC,KAAK,EAAE,CAAC;YACR,aAAa,EAAE,KAAK;YACpB,MAAM,EAAE,CAAC;YACT,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;SACnD;QACD,eAAe,EAAE,KAAK;QACtB,sBAAsB,EAAE;YACtB,cAAc,EAAE,KAAK;YACrB,iBAAiB,EAAE,IAAI;YACvB,sBAAsB,EAAE,CAAC;SAC1B;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAAA,iBAiiBC;YA9hBS,kBAAa,GAAG,IAAIkB,YAAO,EAAqB,CAAC;YACjD,oBAAe,GAAGL,iBAAO,EAAqB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAInE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;YAGhE,yBAAoB,GAAG,QAAQ,CAAC,UAAC,EAAE,EAAE,eAAwB,EAAE,sBAAsB;gBAC3F,KAAI,CAAC,WAAW,CAAC,EAAE,EAAE,eAAe,EAAE,sBAAsB,CAAC,CAAC;aAC/D,EAAE,GAAG,CAAC,CAAC;SAohBT;QAlhBC,oCAAI,GAAJ,UAAK,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,eAAuC,EACvC,YAA2B;YAE9B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;YACvC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YAE/B,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;SAC5C;QAED,wCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAEO,2CAAW,GAAX,UAAY,EAAE,EAAE,eAAwB,EAAE,EAA+E;YAAzH,iBA2BP;gBA3BmD,cAAc,oBAAA,EAAE,iBAAiB,uBAAA,EAAE,sBAAsB,4BAAA;YAC3G,IAAI,eAAe,IAAI,iBAAiB,EAAE;gBACxC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC7C,IAAM,QAAM,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;gBAEnC,IAAI,CAAC,cAAc,EAAE;;oBAEnB,QAAM,CAAC,OAAO,CAAC,UAAA,KAAK;wBAClB,KAAK,CAAC,WAAW,CAAC,KAAI,CAAC,WAAW,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,sBAAsB,CAAC,CAAC,CAAC;qBAC3G,CAAC,CAAC;;;;;;;;iBAQJ;qBAAM;oBACL,IAAM,aAAa,GAAG,QAAM,CAAC,GAAG,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,mBAAmB,CAAC,wBAAwB,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,GAAA,CAAC,CAAC;oBAClH,IAAM,OAAO,GAAG,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE,EAAE,EAAE,aAAa,CAAC,CAAC;oBAC1F,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,UAAC,gBAAgB;wBACpC,QAAM,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;4BAC1B,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;yBAC7E,CAAC,CAAC;qBACJ,CAAC,CAAC;iBACJ;aACF;SACF;QAEO,gDAAgB,GAAhB,UAAiB,UAAU,EAAE,eAAwB,EAAE,EAA4D;YAAnH,iBAwBP;gBAxBgE,sBAAsB,4BAAA,EAAE,cAAc,oBAAA;YACrG,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;;YAG3E,IAAI,eAAe,IAAI,UAAU,EAAE;gBACjC,IAAM,iBAAiB,GAAG;oBACxB,IAAM,GAAG,GAAG,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;oBAClE,OAAO,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,KAAI,CAAC,WAAW,CAAC,CAAC;iBAC3D,CAAC;;gBAGF,IAAI,cAAc,EAAE;oBAClB,OAAO,iBAAiB,EAAE,CAAC;iBAC5B;qBAAM;oBACL,IAAM,sBAAsB,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;oBACzE,IAAM,MAAM,GAAG,mBAAmB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,CAAC;oBAC9E,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;wBACrB,OAAO,iBAAiB,EAAE,CAAC;qBAC5B;oBACD,OAAO,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,sBAAsB,EAAE,SAAS,EAAE,sBAAsB,CAAC,CAAC;iBAClG;aACF;YAED,OAAO,UAAU,CAAC;SACnB;QAED,sCAAM,GAAN,UAAO,OAAiC,EAAE,QAAc;YAAxD,iBAmIC;YAnIM,wBAAA,EAAA,iCAAiC;YAAE,yBAAA,EAAA,cAAc;YACtD,IAAM,SAAS,GAAiB,EAAE,CAAC;YACnC,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAEhD,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAoB;gBAC/D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,SAAS,WAAA;gBACT,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,cAAc,EAAE,cAAc;aAC/B,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG,UAAC,QAAoB;gBAC1C,OAAO,KAAI,CAAC,gBAAgB,CAC1B,EAAE,EACF,QAAQ,EACR,iBAAiB,EACjB,SAAS,EACT,QAAQ,EACR,cAAc,EACd,gBAAgB,EAChB,cAAc,CAAC,CAAC;aACnB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAE,cAAc,CAAC,aAAa;gBACnC,QAAQ,EAAE,cAAc,CAAC,gBAAgB;gBACzC,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YACH,IAAM,wBAAwB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC9D,KAAK,EAAE,cAAc,CAAC,iBAAiB;gBACvC,QAAQ,EAAE,cAAc,CAAC,oBAAoB;gBAC7C,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,EAAE,wBAAwB,CAAC,CAAC,CAAC;YACrG,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,cAAc,CAAC,eAAe,EAAE,cAAc,CAAC,sBAAsB,CAAC,CAAC;gBAE3H,IAAI,QAAQ,EAAE;oBACZ,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;wBACtB,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACvD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,cAAc,CAAC,eAAe,EAAE,cAAc,CAAC,sBAAsB,CAAC,CAAC;gBAC3H,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAI,YAAY,CAAC,IAAI,CAAC,UAAC,SAAS,IAAK,OAAA,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,EAAE;oBAChE,OAAO;iBACR;gBAED,IAAM,WAAW,GAAG;oBAClB,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,eAAe,EAAE,QAAQ;oBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;iBAClC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,IAAI,cAAc,CAAC,qBAAqB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,KAAK,cAAc,CAAC,qBAAqB,EAAE;oBAC5G,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;YAGH,wBAAwB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBAC3D,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,cAAc,CAAC,eAAe,EAAE,cAAc,CAAC,sBAAsB,CAAC,CAAC;gBAC3H,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;;gBAGD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAC,SAAS,IAAK,OAAA,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,EAAE;oBACjE,IAAM,WAAW,GAAG;wBAClB,EAAE,IAAA;wBACF,SAAS,EAAE,YAAY;wBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;qBAClC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;oBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;iBACJ;gBAED,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;aAC3C,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAEO,gDAAgB,GAAhB,UAAiB,EAAE,EACF,QAAQ,EACR,iBAAiB,EACjB,SAAuB,EACvB,QAAQ,EACR,cAAc,EACd,gBAAgB,EAChB,cAAuB;YAC9C,IAAM,WAAW,GAAG;gBAClB,EAAE,IAAA;gBACF,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC;gBAChC,QAAQ,EAAED,iBAAS,CAAC,MAAM;gBAC1B,eAAe,EAAE,QAAQ;gBACzB,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;YAEH,IAAM,UAAU,GAAG;gBACjB,EAAE,IAAA;gBACF,QAAQ,EAAED,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACpC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACnC,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBAC/B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;aAC7E;YACD,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/B,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,iBAAiB,EAAE,cAAc,EAAE,gBAAgB,CAAC,CAAC;YAC/F,cAAc,GAAG,IAAI,CAAC;YACtB,OAAO,cAAc,CAAC;SACvB;QAED,oCAAI,GAAJ,UAAK,SAAuB,EAAE,OAAiC,EAAE,QAAc;YAAjD,wBAAA,EAAA,iCAAiC;YAAE,yBAAA,EAAA,cAAc;YAC7E,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,MAAM,IAAI,KAAK,CAAC,wEAAwE,CAAC,CAAC;aAC3F;YACD,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAChD,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAoB;gBACzD,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YACH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,cAAc,EAAE,cAAc;aAC/B,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;YACH,OAAO,IAAI,CAAC,WAAW,CACrB,EAAE,EACF,SAAS,EACT,QAAQ,EACR,WAAW,EACX,cAAc,CACf,CAAC;SACH;QAEO,2CAAW,GAAX,UAAY,EAAU,EACV,SAAuB,EACvB,QAAgB,EAChB,WAAuC,EACvC,OAA2B,EAC3B,cAAwC;YALpD,iBA+HP;YAzHC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;YAE9E,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEtD,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAE,OAAO,CAAC,cAAc;oBAC7B,UAAU,EAAE,eAAe;oBAC3B,IAAI,EAAEA,mBAAW,CAAC,UAAU;oBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,QAAQ,UAAA;oBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YACD,IAAM,uBAAuB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC7D,KAAK,EAAE,OAAO,CAAC,gBAAgB;gBAC/B,UAAU,EAAE,SAAS;gBACrB,QAAQ,EAAE,OAAO,CAAC,mBAAmB;gBACrC,IAAI,EAAEA,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,qBAAqB,CAAC,IAAI,CACxBqB,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBACjH,SAAS,CAAC,UAAC,EAA6C;oBAA3C,gBAA+B,EAAnB,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACrD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;gBAC7G,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAErC,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;oBACxB,eAAe,EAAE,QAAQ;oBACzB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;iBAC1E,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,KAAI,CAAC,oBAAoB,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;aACxF,CAAC,CAAC;YAEL,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAACjC,aAAG,CAAC,UAAC,EAAsB;wBAAR,IAAI,mBAAA;oBAAS,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBACvH,SAAS,CAAC,UAAC,EAA4D;wBAA1D,gBAA8C,EAAlC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;oBACpE,IAAM,eAAe,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,KAAK,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;oBAClG,IAAM,iBAAiB,GAAG,KAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;oBACtG,IAAI,CAAC,eAAe,EAAE;wBACpB,OAAO;qBACR;oBAED,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;wBACxB,eAAe,EAAE,eAAe;wBAChC,eAAe,EAAE,iBAAiB;wBAClC,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;qBAC1E,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,uBAAuB,CAAC,SAAS,CAAC,UAAC,EAAY;oBAAV,QAAQ,cAAA;gBAC3C,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAM,YAAY,YAAO,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;gBAChD,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,OAAO;iBACR;gBACD,IAAM,KAAK,GAAG,YAAY,CAAC,SAAS,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAK,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,QAAsB,CAAC,GAAA,CAAC,CAAC;gBACrG,IAAI,KAAK,GAAG,CAAC,EAAE;oBACb,OAAO;iBACR;gBAED,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,KAAI,CAAC,WAAW,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;aAC/E,CAAC,CAAC;YAEH,IAAM,WAAW,GAAG,CAAC,qBAAqB,EAAE,uBAAuB,CAAC,CAAC;YACrE,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,cAAc,IAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACvE;QAEO,0CAAU,GAAV,UAAW,OAA2B;YAC5C,IAAI,OAAO,CAAC,qBAAqB,IAAI,OAAO,CAAC,qBAAqB,GAAG,CAAC,EAAE;gBACtE,OAAO,CAAC,IAAI,CAAC,qCAAqC;oBAChD,2EAA2E,CAAC,CAAC;gBAC/E,OAAO,CAAC,qBAAqB,GAAG,CAAC,CAAC;aACnC;YAED,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,CAAC,CAAC;YACzE,IAAM,cAAc,GAAuB,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAChF,cAAc,CAAC,UAAU,mCAAQ,uBAAuB,CAAC,UAAU,GAAK,OAAO,CAAC,UAAU,CAAC,CAAC;YAC5F,cAAc,CAAC,YAAY,mCAAO,uBAAuB,CAAC,YAAY,GAAK,OAAO,CAAC,YAAY,CAAC,CAAC;YACjG,cAAc,CAAC,aAAa,mCAAO,uBAAuB,CAAC,aAAa,GAAK,OAAO,CAAC,aAAa,CAAC,CAAC;YACpG,cAAc,CAAC,sBAAsB,mCAAQ,uBAAuB,CAAC,sBAAsB,GAAK,OAAO,CAAC,sBAAsB,CAAC,CAAC;YAEhI,IAAI,OAAO,CAAC,eAAe,EAAE;gBAC3B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,qBAAqB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,sBAAsB,EAAE;oBACvF,MAAM,IAAI,KAAK,CAAC,gFAAgF,CAAC,CAAC;iBACnG;gBAED,IAAI,IAAI,CAAC,WAAW,CAAC,oBAAoB,EAAE;oBACzC,OAAO,CAAC,IAAI,CAAC,kGAAkG,CAAC,CAAC;iBAClH;gBAED,IAAI,cAAc,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,KAAK,CAAC,IAAI,cAAc,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,KAAK,CAAC,EAAE;oBACrG,OAAO,CAAC,IAAI,CAAC,+FAA+F,CAAC,CAAC;iBAC/G;gBAED,cAAc,CAAC,SAAS,GAAG,KAAK,CAAC;gBACjC,cAAc,CAAC,aAAa,CAAC,aAAa,GAAG,IAAI,CAAC;gBAClD,cAAc,CAAC,UAAU,CAAC,eAAe,GAAG,cAAc,CAAC,sBAAsB,CAAC,cAAc;oBAC9F,MAAM,CAAC,eAAe,CAAC,eAAe,GAAG,MAAM,CAAC,eAAe,CAAC,kBAAkB,CAAC;gBACrF,cAAc,CAAC,UAAU,CAAC,wBAAwB,GAAG,MAAM,CAAC,iBAAiB,CAAC;aAC/E;YACD,OAAO,cAAc,CAAC;SACvB;QAGO,sDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAAkD;YAA9G,iBA2EP;YAzEC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YACF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YACF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YACF,kBAAkB,CAAC,WAAW,GAAG,UAAC,MAEhB,EAAE,YAA2B;gBAC7C,IAAM,OAAO,GAAG,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC7C,OAAO,CAAC,iBAAiB,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;gBAChD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAAa;gBACnD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,oEAAoE,CAAC,CAAC;iBACvF;gBAED,OAAO,cAAc,CAAC,IAAI,CAAC,CAAC;aAC7B,CAAC;YAEF,kBAAkB,CAAC,gBAAgB,GAAG,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAA,CAAC;YAE/D,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YAEvF,OAAO,kBAA6C,CAAC;SACtD;QAEO,4CAAY,GAAZ,UAAa,EAAU;YAC7B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC7C,OAAO,OAAO,CAAC,gBAAgB,EAAE,CAAC;SACnC;QAEO,yCAAS,GAAT,UAAU,EAAU;YAC1B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC7C,OAAO,OAAO,CAAC,aAAa,EAAE,CAAC;SAChC;;;;gBAhiBF7D,eAAU;;;;QCWT,iCACU,cAAqC,EACrC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,eAAuC,EACvC,aAA4B;YAL5B,mBAAc,GAAd,cAAc,CAAuB;YACrC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,oBAAe,GAAf,eAAe,CAAwB;YACvC,kBAAa,GAAb,aAAa,CAAe;YAf/B,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,mBAAc,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAC/C,kBAAa,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAcnD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YACxI,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,+DAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAAyB;gBACjE,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,4CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,kDAAgB,GAAhB,UAAiB,OAAwB,EAAE,MAAyB,EAAE,MAAqB;YACzF,MAAM,CAAC,SAAS,GAAG,OAAO,CAAC,gBAAgB,EAAE,CAAC;YAC9C,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,aAAa,EAAE,CAAC;YAExC,IAAI,MAAM,EAAE;gBACV,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;gBACxB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;gBACxD,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;YACjE,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;SACzD;QAED,kDAAgB,GAAhB,UAAiB,OAAwB;YACvC,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC;YACpB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;SACzD;QAED,qDAAmB,GAAnB,UAAoB,MAAyB;YAC3C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,eAAe,CAAC,qBAAqB,CACxC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,kBAAkB,EACvB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,cAAc,CACtB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,OAAO,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACpD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,OAAO,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACpD,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACzC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC7C,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,OAAO,EAAE,CAAC;wBAClB,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;wBAC/B,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;qBACrC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;oBACvC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC5D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC5D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,mDAAiB,GAAjB,UAAkB,MAAyB;YACzC,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,eAAe,CAAC,qBAAqB,CACxC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,kBAAkB,EACvB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,cAAc,EACrB,MAAM,CAAC,SAAS,CACjB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;wBAC/D,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;wBAE7C,IAAI,MAAM,CAAC,YAAY,CAAC,kBAAkB,EAAE,EAAE;4BAC5C,OAAO,CAAC,6BAA6B,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;4BAC3D,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;yBACxC;qBACF;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;wBACzC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC3B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACpE,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBAED,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,cAAc,EAAE,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,UAAU,GAAG,IAAI,CAAC;wBAC1B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,6CAAW,GAAX;YACE,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;SAC9B;QAED,8CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,8CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBA1SFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,QAAQ,WAAW,w0FAwElB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,sBAAsB,CAAC;oBACxD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBAjFQ,qBAAqB;gBANrB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAEb,sBAAsB;gBAXtB,aAAa;;;oCAqGnBe,cAAS,SAAC,mBAAmB;kCAC7BA,cAAS,SAAC,iBAAiB;qCAC3BA,cAAS,SAAC,oBAAoB;;;;QCpGJ,2BAAQ;QASnC,iBAAY,QAAgB,EAAE,MAAkB,EAAE,MAAc,EAAE,KAAa,EAAE,KAAa,EAAU,SAAwB;YAAhI,YACE,iBAAO,SAOR;YARuG,eAAS,GAAT,SAAS,CAAe;YAE9H,KAAI,CAAC,EAAE,GAAG,KAAI,CAAC,UAAU,EAAE,CAAC;YAC5B,KAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;YAC/B,KAAI,CAAC,OAAO,GAAG,MAAM,CAAC;YACtB,KAAI,CAAC,OAAO,GAAG,MAAM,CAAC;YACtB,KAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,KAAI,CAAC,MAAM,GAAG,KAAK,CAAC;;SACrB;QAED,sBAAI,0BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,SAAS,CAAC;aACvB;iBAED,UAAU,KAAoB;gBAC5B,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;aACxB;;;WAJA;QAMD,sBAAI,0BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;iBAED,UAAU,KAAa;gBACrB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAJA;QAMD,sBAAI,0BAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;iBAED,UAAU,KAAa;gBACrB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;;;WAJA;QAMD,sBAAI,2BAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,KAAa;gBACtB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtB;;;WAJA;QAMD,sBAAI,2BAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,KAAiB;gBAC1B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;aACtB;;;WAJA;QAMD,8BAAY,GAAZ,UAAa,MAAkB;YAC7B,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;SAC3B;QAED,uBAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;QAEO,4BAAU,GAAV;YACN,OAAO,WAAW,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC;SACxC;;KAvEH,CAA6B,QAAQ;IAC5B,eAAO,GAAG,CAAC;;;QCOgB,kCAAQ;QAY1C,wBACU,EAAU,EACV,YAA8B,EAC9B,WAA6B,EAC7B,SAA2B,EAC3B,OAA0B;YALpC,YAOE,iBAAO,SAIR;YAVS,QAAE,GAAF,EAAE,CAAQ;YACV,kBAAY,GAAZ,YAAY,CAAkB;YAC9B,iBAAW,GAAX,WAAW,CAAkB;YAC7B,eAAS,GAAT,SAAS,CAAkB;YAC3B,aAAO,GAAP,OAAO,CAAmB;YAb5B,kBAAY,GAAG,KAAK,CAAC;YACrB,iBAAW,GAAG,IAAI,CAAC;YAKnB,aAAO,GAAiB,EAAE,CAAC;YAUjC,KAAI,CAAC,YAAY,qBAAO,OAAO,CAAC,WAAW,CAAC,CAAC;YAC7C,KAAI,CAAC,WAAW,qBAAO,OAAO,CAAC,UAAU,CAAC,CAAC;YAC3C,KAAI,CAAC,cAAc,qBAAO,OAAO,CAAC,aAAa,CAAC,CAAC;;SAClD;QAED,sBAAI,kCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAA/B,iBAeC;gBAdC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;oBAClD,OAAO;iBACR;gBACD,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,IAAI,KAAK,KAAK,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC/B,KAAK,CAAC,QAAQ,GAAG,KAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;yBAC7C;6BAAM;4BACL,KAAK,CAAC,QAAQ,GAAG,KAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;yBAClD;qBACF;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAjBA;QAmBD,sBAAI,yCAAa;iBAAjB;gBACE,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;iBAED,UAAkB,KAAoB;gBACpC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;;;WAJA;QAMD,sBAAI,sCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAiB;gBAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;aAC1B;;;WAJA;QAMD,sBAAI,uCAAW;iBAAf;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;iBAED,UAAgB,KAAmB;gBACjC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;aAC3B;;;WAJA;QAMD,sBAAI,kCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;;;WAAA;QAED,sBAAI,uCAAW;iBAAf;gBACE,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;;;WAAA;QAED,sBAAI,sCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAC3B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;gBAC1B,IAAI,CAAC,YAAY,CAAC,IAAI,GAAG,KAAK,CAAC;gBAC/B,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;;;WAPA;QASD,oCAAW,GAAX,UACE,MAAkB,EAClB,WAAuB,EACvB,eAAiC,EACjC,eAAiC,EACjC,UAA6B;YAF7B,gCAAA,EAAA,kBAAkB,IAAI,CAAC,UAAU;YACjC,gCAAA,EAAA,kBAAkB,IAAI,CAAC,UAAU;YACjC,2BAAA,EAAA,aAAa,IAAI,CAAC,WAAW;YAE7B,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;gBACjB,IAAI,CAAC,OAAO,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;aAChE;iBAAM;gBACL,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aAClC;YAED,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,IAAI,CAAC,YAAY,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,WAAW,EAAE,eAAe,CAAC,CAAC;aAC1E;iBAAM;gBACL,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;aAC5C;YAED,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACrB,IAAI,CAAC,gBAAgB,EAAE,CAAC;aACzB;iBAAM;gBACL,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;aAC5C;YAED,IAAI,CAAC,WAAW,GAAG,UAAU,CAAC;YAC9B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAED,iCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;gBACjB,IAAI,CAAC,OAAO,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;gBACjE,IAAI,CAAC,YAAY,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;gBAC9E,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;oBACrB,IAAI,CAAC,gBAAgB,EAAE,CAAC;iBACzB;aACF;YAED,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAED,qCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBAC5D,OAAO;aACR;YAED,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACxC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YAEzB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAED,kCAAS,GAAT,UAAU,UAAsB;YAC9B,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACvC,OAAO;aACR;YAED,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAC1C,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;YAE3C,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;QAED,mCAAU,GAAV,UAAW,iBAA6B,EAAE,eAA2B;YACnE,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,OAAO;aACR;YACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;aAChD;YAED,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;YAChC,IAAM,KAAK,GAAG,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,eAAe,CAAC,CAAC;YAC7F,IAAM,iBAAiB,GAAG,eAAe,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;YAC5F,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;YAC5C,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;YAC7H,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;YAC3C,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;YACrD,IAAI,CAAC,eAAe,EAAE,CAAC;YACvB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC1B,IAAI,CAAC,qBAAqB,GAAG,eAAe,CAAC;SAC9C;QAED,uCAAc,GAAd;YACE,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;SACxC;QAED,kCAAS,GAAT;YACE,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACvC,OAAO,CAAC,CAAC;aACV;YACD,OAAO,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC;SAC9F;QAED,kDAAyB,GAAzB;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACtE;QAED,kCAAS,GAAT;YACE,OAAO,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,SAAS,CAAC;SAC9D;QAED,kDAAyB,GAAzB;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACtE;QAED,uCAAc,GAAd;YACE,OAAO,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,GAAG,SAAS,CAAC;SACxE;QAED,gCAAO,GAAP;YACE,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;aAC/C;YAED,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC;aACpD;YAED,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;aACjD;YAED,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACnC;QAED,8BAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;QAEO,2CAAkB,GAAlB;YACN,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;SACzC;QAEO,0CAAiB,GAAjB;YACN,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;aAC7D;YACD,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC;aACvE;SACF;QAEO,wCAAe,GAAf;YACN,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACrB,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;SACnE;QAEO,yCAAgB,GAAhB;YACN,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACvC,OAAO;aACR;YACD,IAAI,CAAC,WAAW,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,SAAS,EAAE,EAAE,IAAI,CAAC,SAAS,EAAE,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;SACjH;6BACF;KAlQD,CAAoC,QAAQ;;;QCP5C;YAEU,YAAO,GAAG,IAAI,GAAG,EAA0B,CAAC;SA4BrD;QA1BC,oDAAoB,GAApB,UAAqB,EAAU,EACV,gBAAkC,EAClC,eAAiC,EACjC,aAA+B,EAC/B,aAAgC;YACnD,IAAM,cAAc,GAAG,IAAI,cAAc,CAAC,EAAE,EAAE,gBAAgB,EAAE,eAAe,EAAE,aAAa,EAAE,aAAa,CAAC,CAAC;YAC/G,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,cAAc,CAAC,CAAC;YACrC,OAAO,cAAc,CAAC;SACvB;QAED,uCAAO,GAAP,UAAQ,EAAU;YAChB,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACpC,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,OAAO,EAAE,CAAC;aAClB;YACD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACzB;QAED,mCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC7B;QAED,qCAAK,GAAL;YACE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,MAAM,IAAI,OAAA,MAAM,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YACjD,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;SACtB;;;;gBA7BFnD,eAAU;;;eC+CG,cAAM,OAAA,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,GAAA;QA3BxC,sBAAsB,GAAsB;QACvD,aAAa,EAAEM,mBAAW,CAAC,UAAU;QACrC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,WAAW,EAAE;YACX,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC;YACpD,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,KAAK;YACd,YAAY,EAAE,CAAC;YACf,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;YAClD,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;SACpC;QACD,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;YACzB,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;QACD,aAAa,EAAE;YACb,KAAK,EAAE,CAAC;YACR,QAAQ,MAAyC;SAClD;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAGU,kBAAa,GAAG,IAAIkB,YAAO,EAAoB,CAAC;YAChD,oBAAe,GAAGL,iBAAO,EAAoB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAIlE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;SA0YzE;QAxYC,mCAAI,GAAJ,UACE,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,cAAqC;YAErC,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;YACrC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;SAChC;QAED,uCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAED,qCAAM,GAAN,UAAO,OAAgC,EAAE,QAAc;YAAvD,iBAwHC;YAxHM,wBAAA,EAAA,gCAAgC;YAAE,yBAAA,EAAA,cAAc;YACrD,IAAI,MAAW,CAAC;YAChB,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC/C,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAmB;gBAC9D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,aAAa,eAAA;aACd,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG,UAAC,QAAoB;gBAC1C,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,MAAM,QAAA;oBACN,WAAW,EAAE,QAAQ;oBACrB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;gBAEH,IAAM,UAAU,GAAG;oBACjB,EAAE,IAAA;oBACF,MAAM,QAAA;oBACN,WAAW,EAAE,QAAQ;oBACrB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBAEF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;gBACH,IAAI,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;oBAC/B,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC7E;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,iBAAiB,EAAE,aAAa,EAAE,gBAAgB,CAAC,CAAC;gBAClF,cAAc,GAAG,IAAI,CAAC;gBACtB,OAAO,cAAc,CAAC;aACvB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAED,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,CAAC,CAAC,CAAC;YAC3E,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACvD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBAED,IAAI,CAAC,MAAM,EAAE;oBACX,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,MAAM,EAAE,QAAQ;wBAChB,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,UAAU,EAAEC,mBAAW,CAAC,SAAS;qBAClC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;oBACH,MAAM,GAAG,QAAQ,CAAC;iBACnB;qBAAM;oBACL,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;YAEH,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAE1E,IAAI,QAAQ,EAAE;oBACZ,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,MAAM,QAAA;wBACN,WAAW,EAAE,QAAQ;wBACrB,QAAQ,EAAED,iBAAS,CAAC,MAAM;wBAC1B,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAED,mCAAI,GAAJ,UAAK,MAAkB,EAAE,MAAc,EAAE,OAAgC,EAAE,QAAc;YAAhD,wBAAA,EAAA,gCAAgC;YAAE,yBAAA,EAAA,cAAc;YACvF,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC/C,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAmB;gBACxD,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YAEH,IAAM,WAAW,GAAe,eAAe,CAAC,iCAAiC,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;YAErH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,MAAM,QAAA;gBACN,WAAW,aAAA;gBACX,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,aAAa,eAAA;aACd,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,GACN,IAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;YAEH,OAAO,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,WAAW,EAAE,aAAa,CAAC,CAAC;SAClE;QAEO,yCAAU,GAAV,UACN,EAAU,EACV,QAAgB,EAChB,WAAsC,EACtC,OAA0B,EAC1B,cAAuC;YALjC,iBAqGP;YA9FC,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,eAAe;gBAClC,UAAU,EAAE,SAAS;gBACrB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,IAAI,EAAEC,mBAAW,CAAC,UAAU;gBAC5B,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAED,mBAAW,CAAC,eAAe;oBAClC,UAAU,EAAE,cAAc;oBAC1B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,IAAI,EAAEC,mBAAW,CAAC,UAAU;oBAC5B,QAAQ,EAAE,QAAQ;oBAClB,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YAED,qBAAqB;iBAClB,IAAI,CAACqB,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBAC5E,SAAS,CAAC,UAAC,EAA4D;oBAA1D,gBAA8C,EAAlC,WAAW,iBAAA,EAAE,aAAa,mBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACpE,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;gBACrF,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBACjF,IAAI,CAAC,eAAe,EAAE;oBACpB,OAAO;iBACR;gBAED,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAM,aAAa,GAAG,KAAK,KAAK,KAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;gBACxD,IAAI,UAAU,CAAC;gBACf,IAAI,IAAI,EAAE;oBACR,UAAU,GAAG,aAAa,GAAGiC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,iBAAiB,CAAC;iBAC5F;qBAAM;oBACL,UAAU,GAAG,aAAa,GAAGA,mBAAW,CAAC,UAAU,GAAGA,mBAAW,CAAC,UAAU,CAAC;iBAC9E;gBAED,IAAI,CAAC,OAAO,CAAC,SAAS,KAAK,UAAU,KAAKA,mBAAW,CAAC,UAAU,IAAI,UAAU,KAAKA,mBAAW,CAAC,iBAAiB,CAAC,EAAE;oBACjH,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;oBACtC,OAAO;iBACR;gBAED,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,MAAM,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBAClC,WAAW,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBACvC,iBAAiB,mBAAA;oBACjB,eAAe,iBAAA;oBACf,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,YAAA;iBACX,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;aACJ,CAAC,CAAC;YAEL,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAAChC,aAAG,CAAC,UAAC,EAAsB;wBAAR,IAAI,mBAAA;oBAAS,OAAA,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBAC5E,SAAS,CAAC,UAAC,EAAkD;wBAAhD,gBAA8C,EAAlC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA;oBACxD,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;oBACrF,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;oBACjF,IAAI,CAAC,eAAe,IAAI,CAAC,iBAAiB,EAAE;wBAC1C,OAAO;qBACR;oBAED,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,MAAM,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;wBAClC,WAAW,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;wBACvC,iBAAiB,mBAAA;wBACjB,eAAe,iBAAA;wBACf,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;wBACxB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;qBAC1E,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,GACN,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,EAC/B,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,IAAM,WAAW,GAAG,CAAC,qBAAqB,CAAC,CAAC;YAC5C,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,cAAc,IAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACvE;QAEO,qDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAAkD;YAA9G,iBAuFP;YArFC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,MAAM,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBAClC,WAAW,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBACvC,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,MAAM,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBAClC,WAAW,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBACvC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,MAAM,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBAClC,WAAW,EAAE,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC;oBACvC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAC/B,MAAkB,EAClB,MAAc,EACd,eAA4B,EAC5B,eAA4B,EAC5B,UAAyB;gBAEzB,IAAM,WAAW,GAAG,eAAe,CAAC,iCAAiC,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;gBACzG,IAAM,MAAM,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC3C,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,EAAE,eAAe,EAAE,eAAe,EAAE,UAAU,CAAC,CAAC;gBACtF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAA8E;gBACpH,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,mEAAmE,CAAC,CAAC;iBACtF;gBAED,OAAO,cAAc,CAAC,IAAI,CAAC,CAAC;aAC7B,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YACtF,kBAAkB,CAAC,SAAS,GAAG,cAAkB,OAAA,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,GAAA,CAAC;YAC5E,kBAAkB,CAAC,SAAS,GAAG,cAAc,OAAA,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAA,CAAC;YAEhE,OAAO,kBAA4C,CAAC;SACrD;QAEO,yCAAU,GAAV,UAAW,OAA0B;YAC3C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,sBAAsB,CAAC,CAAC,CAAC;YACxE,IAAM,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAC3D,aAAa,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,sBAAsB,CAAC,UAAU,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;YACpG,aAAa,CAAC,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,sBAAsB,CAAC,WAAW,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC;YACvG,aAAa,CAAC,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,sBAAsB,CAAC,aAAa,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC;YAC7G,OAAO,aAAa,CAAC;SACtB;QAEO,gDAAiB,GAAjB,UAAkB,EAAU;YAClC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC;SAChD;QAEO,6CAAc,GAAd,UAAe,EAAU;YAC/B,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC;SAC3C;QAEO,gDAAiB,GAAjB,UAAkB,EAAU;YAClC,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,cAAc,EAAE,CAAC;SACrD;QAEO,wCAAS,GAAT,UAAU,EAAU;YAC1B,OAAO,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC;SAChD;QAEO,kDAAmB,GAAnB,UAAoB,EAAU;YACpC,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC3C,OAAO;gBACL,MAAM,EAAE,MAAM,CAAC,SAAS,EAAE;gBAC1B,WAAW,EAAE,MAAM,CAAC,cAAc,EAAE;gBACpC,MAAM,EAAE,MAAM,CAAC,SAAS,EAAE;aAC3B,CAAC;SACH;;;;gBAjZF7D,eAAU;;;;QCwBT,gCACU,aAAmC,EACnC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,cAAqC;YAJrC,kBAAa,GAAb,aAAa,CAAsB;YACnC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,mBAAc,GAAd,cAAc,CAAuB;YAdxC,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,iBAAY,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAC7C,cAAS,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAa/C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;YAClH,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,8DAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAA,MAAM;gBAC5C,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,2CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,iDAAgB,GAAhB,UAAiB,MAAsB,EAAE,MAAwB,EAAE,MAAqB;YACtF,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;YACnC,MAAM,CAAC,WAAW,GAAG,MAAM,CAAC,cAAc,EAAE,CAAC;YAC7C,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;YAEnC,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;gBACvB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;gBACrD,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;YAC/D,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;SACtD;QAED,iDAAgB,GAAhB,UAAiB,MAAsB;YACrC,MAAM,CAAC,MAAM,GAAG,EAAE,CAAC;YACnB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;SACtD;QAED,oDAAmB,GAAnB,UAAoB,MAAwB;YAC1C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,cAAc,CAAC,oBAAoB,CACtC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,aAAa,EAClB,MAAM,CAAC,aAAa,CACrB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,CAAC,WAAW,EAAE;wBACtB,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;wBACrC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,CAAC,MAAM,EAAE;wBACjB,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAC/B,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,CAAC,WAAW,EAAE;wBACtB,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;wBACxC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,EAAE;wBACV,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;wBAC9B,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;oBACtC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC3D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC3D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,kDAAiB,GAAjB,UAAkB,MAAwB;YACxC,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,oBAAoB,CACrD,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,aAAa,EAClB,MAAM,CAAC,aAAa,CACrB,CAAC;oBACF,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,WAAW,CAAC,CAAC;oBACtD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,CAAC;gBACnC,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,IAAI,MAAM,CAAC,UAAU,EAAE;wBAC/B,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACzC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,IAAI,MAAM,CAAC,UAAU,EAAE;wBAC/B,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACpE,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,IAAI,MAAM,CAAC,UAAU,EAAE;wBAC/B,MAAM,CAAC,cAAc,EAAE,CAAC;wBACxB,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,EAAE;wBACV,MAAM,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC1B,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAClD,IAAI,MAAM,EAAE;wBACV,MAAM,CAAC,UAAU,GAAG,IAAI,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;qBACvC;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,4CAAW,GAAX;YACE,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,CAAC;SAC7B;QAED,6CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,6CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBA1RFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,gBAAgB;oBAC1B,QAAQ,WAAW,qzGAgFlB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,qBAAqB,CAAC;oBACvD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBA1FQ,oBAAoB;gBANpB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAEb,qBAAqB;;;mCAmG3Be,cAAS,SAAC,kBAAkB;gCAC5BA,cAAS,SAAC,eAAe;kCACzBA,cAAS,SAAC,iBAAiB;;;;QCpGO,mCAAQ;QAe3C,yBACU,EAAU,EACV,aAA+B,EAC/B,WAA6B,EAC7B,mBAAwC,EACxC,OAA2B;YALrC,YAOE,iBAAO,SAGR;YATS,QAAE,GAAF,EAAE,CAAQ;YACV,mBAAa,GAAb,aAAa,CAAkB;YAC/B,iBAAW,GAAX,WAAW,CAAkB;YAC7B,yBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,aAAO,GAAP,OAAO,CAAoB;YAf7B,eAAS,GAAG,CAAC,CAAC;YACd,kBAAY,GAAG,KAAK,CAAC;YACrB,iBAAW,GAAG,IAAI,CAAC;YACnB,wBAAkB,GAAgB,EAAE,CAAC;YAKrC,aAAO,GAAiB,EAAE,CAAC;YAUjC,KAAI,CAAC,aAAa,qBAAO,OAAO,CAAC,YAAY,CAAC,CAAC;YAC/C,KAAI,CAAC,WAAW,qBAAO,OAAO,CAAC,UAAU,CAAC,CAAC;;SAC5C;QAED,sBAAI,mCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAA/B,iBAsBC;gBArBC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;oBAC5B,OAAO;iBACR;gBACD,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,IAAI,KAAK,KAAK,CAAC,EAAE;4BACf,KAAK,CAAC,QAAQ,GAAG,KAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;yBAC7C;6BAAM,IAAI,KAAK,KAAK,CAAC,EAAE;4BACtB,KAAK,CAAC,QAAQ,GAAG,KAAI,CAAC,iBAAiB;kCACnC,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAI,CAAC,SAAS,EAAE,EAAE,KAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC;kCAC3G,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC;yBAC7B;6BAAM,IAAI,KAAK,KAAK,CAAC,EAAE;4BACtB,KAAK,CAAC,QAAQ;gCACZ,KAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,CAAC,IAAI,KAAI,CAAC,YAAY;sCACnD,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,KAAI,CAAC,SAAS,EAAE,EAAE,KAAI,CAAC,2BAA2B,EAAE,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC;sCACzG,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC;yBAC/B;qBACF;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAxBA;QA0BD,sBAAI,0CAAa;iBAAjB;gBACE,OAAO,IAAI,CAAC,cAAc,CAAC;aAC5B;iBAED,UAAkB,KAAoB;gBACpC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;aAC7B;;;WAJA;QAMD,sBAAI,uCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAiB;gBAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;aAC1B;;;WAJA;QAMD,sBAAI,yCAAY;iBAAhB;gBACE,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;iBAED,UAAiB,KAAmB;gBAClC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;aAC5B;;;WAJA;QAMD,sBAAI,mCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;;;WAAA;QAED,sBAAI,6CAAgB;iBAApB;gBACE,OAAO,IAAI,CAAC,iBAAiB,CAAC;aAC/B;;;WAAA;QAED,qDAA2B,GAA3B;YACE,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBAC3B,OAAO,SAAS,CAAC;aAClB;YAED,OAAO,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;SAC7C;QAED,qDAA2B,GAA3B;YACE,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtC,OAAO,SAAS,CAAC;aAClB;YAED,OAAO,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;SACjD;QAED,sBAAI,uCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAC3B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;gBAC1B,IAAI,CAAC,iBAAiB,CAAC,IAAI,GAAG,KAAK,CAAC;gBACpC,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;;;WAPA;QASD,qCAAW,GAAX,UACE,MAAkB,EAClB,WAAmB,EACnB,QAAsB,EACtB,WAAoB,EACpB,eAAiC,EACjC,eAAiC,EACjC,WAA+B;YAJ/B,yBAAA,EAAA,WAAW,IAAI,CAAC,EAAE,GAAG,CAAC;YAEtB,gCAAA,EAAA,kBAAkB,IAAI,CAAC,UAAU;YACjC,gCAAA,EAAA,kBAAkB,IAAI,CAAC,UAAU;YACjC,4BAAA,EAAA,cAAc,IAAI,CAAC,YAAY;YAE/B,IAAI,WAAW,GAAG,WAAW,EAAE;gBAC7B,MAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;aAC5E;YACD,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;YAC1B,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;YAChC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;gBACjB,IAAI,CAAC,OAAO,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;aAChE;iBAAM;gBACL,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aAClC;YAED,IAAM,mBAAmB,GAAG,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;YAEhI,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBAC3B,IAAI,CAAC,iBAAiB,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,mBAAmB,EAAE,eAAe,CAAC,CAAC;aACvF;iBAAM;gBACL,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;aACzD;YAED,IAAI,WAAW,EAAE;gBACf,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;aACjC;YAED,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;YAChC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,kCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;gBACjB,IAAI,CAAC,OAAO,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;gBACjE,IAAI,CAAC,iBAAiB,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;gBACnF,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;aACvB;YAED,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,4CAAkB,GAAlB;YACE,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YAED,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YAC1C,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,sCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBACjE,OAAO;aACR;YAED,IAAM,SAAS,GAAG,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,QAAQ,CAAC,CAAC;YACjF,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YAC7C,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;YAC9B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YAEzB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,6BAA6B,EAAE;gBAC/C,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;aACvC;YAED,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,mCAAS,GAAT,UAAU,UAAsB,EAAE,SAAoB;YACpD,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBAC5C,OAAO;aACR;YAED,IAAM,SAAS,GAAG,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,UAAU,CAAC,CAAC;YACnF,IAAI,IAAI,CAAC,gBAAgB,KAAK,SAAS,EAAE;gBACvC,IAAI,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE;oBACjC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;oBACtC,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAChC,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,SAAS,CAAC,CACvG,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;oBAC9C,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;iBAC/B;aACF;iBAAM;gBACL,IAAI,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE;oBACjC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;iBACvC;qBAAM;oBACL,IAAI,CAAC,YAAY,GAAG,SAAS,CAAC;iBAC/B;aACF;YAED,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;QAED,qCAAW,GAAX,UAAY,iBAA6B,EAAE,eAA2B;YACpE,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,OAAO;aACR;YACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;aAChD;YAED,IAAM,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;YAC1C,IAAM,QAAQ,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;YACpC,IAAM,KAAK,GAAG,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,eAAe,CAAC,CAAC;YAC7F,IAAM,iBAAiB,GAAG,eAAe,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;YAC5F,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;YAC5C,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC,CAAC;YAC9H,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,2BAA2B,EAAE,CAAC;YACnC,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC3B,IAAI,CAAC,qBAAqB,GAAG,eAAe,CAAC;SAC9C;QAED,wCAAc,GAAd;YACE,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;SACxC;QAEO,qDAA2B,GAA3B;YACN,IAAI,IAAI,CAAC,YAAY,KAAK,SAAS,EAAE;gBACnC,OAAO;aACR;YACD,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC;gBACrG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC;aACtG;YAED,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,WAAW,CACpC,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CACnI,CAAC;YAEF,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,WAAW,CACpC,eAAe,CAAC,iCAAiC,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,CACnI,CAAC;SACH;QAED,wCAAc,GAAd;YACE,OAAO,IAAI,CAAC,YAAY,IAAI,CAAC,CAAC;SAC/B;QAED,wCAAc,GAAd;YACE,IAAI,IAAI,CAAC,YAAY,KAAK,SAAS,EAAE;gBACnC,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC;aAC9B;iBAAM;gBACL,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;SACF;QAED,qCAAW,GAAX;YACE,OAAO,IAAI,CAAC,SAAS,IAAI,CAAC,CAAC;SAC5B;QAED,wCAAc,GAAd;YACE,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;gBAC3B,OAAO,CAAC,CAAC;aACV;YAED,IAAM,gBAAgB,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC,CAAC;YAC7H,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YACzD,OAAO,IAAI,CAAC,SAAS,CAAC;SACvB;QAED,qDAA2B,GAA3B;YAAA,iBAEC;YADC,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,cAAM,OAAA,IAAI,CAAC,EAAE,GAAG,CAAC,GAAG,KAAI,CAAC,WAAW,EAAE,GAAA,EAAE,KAAK,CAAC,CAAC;SACnF;QAED,wDAA8B,GAA9B;YAAA,iBAEC;YADC,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,cAAM,OAAA,KAAI,CAAC,cAAc,EAAE,GAAA,EAAE,KAAK,CAAC,CAAC;SACxE;QAED,wDAA8B,GAA9B;YAAA,iBAEC;YADC,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,cAAM,OAAA,KAAI,CAAC,cAAc,EAAE,GAAA,EAAE,KAAK,CAAC,CAAC;SACxE;QAED,mCAAS,GAAT;YACE,OAAO,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,SAAS,CAAC;SAC9D;QAED,mDAAyB,GAAzB;YAAA,iBAEC;YADC,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,cAAM,OAAA,KAAI,CAAC,SAAS,EAAE,GAAA,EAAE,KAAK,CAAC,CAAC;SACnE;QAED,iCAAO,GAAP;YAAA,iBAcC;YAbC,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;aAC/C;YAED,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC,CAAC;aACzD;YAED,IAAI,IAAI,CAAC,kBAAkB,EAAE;gBAC3B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;aAClF;YAED,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACpC;QAED,+BAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;QAEO,6CAAmB,GAAnB;YACN,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;SAC1C;QAEO,2CAAiB,GAAjB;YACN,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;aAC7D;YACD,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC,CAAC;aACjF;YACD,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;gBACxF,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;aACzF;SACF;8BACF;KAnWD,CAAqC,QAAQ;;;QCL7C;YAEU,aAAQ,GAAG,IAAI,GAAG,EAA2B,CAAC;SAyBvD;QAvBC,sDAAqB,GAArB,UAAsB,EAAU,EACV,iBAAmC,EACnC,eAAiC,EACjC,mBAAwC,EACxC,cAAkC;YACtD,IAAM,eAAe,GAAG,IAAI,eAAe,CAAC,EAAE,EAAE,iBAAiB,EAAE,eAAe,EAAE,mBAAmB,EAAE,cAAc,CAAC,CAAC;YACzH,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC;YACvC,OAAO,eAAe,CAAC;SACxB;QAED,wCAAO,GAAP,UAAQ,EAAU;YAChB,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;YAChC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC1B;QAED,oCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC9B;QAED,sCAAK,GAAL;YACE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO,IAAI,OAAA,OAAO,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YACpD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;SACvB;;;;gBA1BFnD,eAAU;;;eCgDG,cAAM,OAAA,MAAM,CAAC,KAAK,CAAC,KAAK,GAAA;QA7BzB,uBAAuB,GAAuB;QACzD,aAAa,EAAEM,mBAAW,CAAC,UAAU;QACrC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,6BAA6B,EAAEA,mBAAW,CAAC,UAAU;QACrD,qCAAqC,EAAEoD,2BAAmB,CAAC,GAAG;QAC9D,SAAS,EAAE,IAAI;QACf,YAAY,EAAE;YACZ,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC;YACpD,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,IAAI;YACb,YAAY,EAAE,CAAC;YACf,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;YAClD,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;SACpC;QACD,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;YACzB,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;QACD,aAAa,EAAE;YACb,KAAK,EAAE,CAAC;YACR,QAAQ,MAA0B;SACnC;QACD,6BAA6B,EAAE,KAAK;MACpC;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAGU,kBAAa,GAAG,IAAIlC,YAAO,EAAqB,CAAC;YACjD,oBAAe,GAAGL,iBAAO,EAAqB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAInE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;SA6azE;QA1aC,oCAAI,GAAJ,UACE,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,eAAuC,EACvC,YAA2B;YAE3B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,eAAe,GAAG,eAAe,CAAC;YACvC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YAE/B,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;SAC5C;QAED,wCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAED,sCAAM,GAAN,UAAO,OAAiC,EAAE,QAAc;YAAxD,iBAmHC;YAnHM,wBAAA,EAAA,iCAAiC;YAAE,yBAAA,EAAA,cAAc;YACtD,IAAI,MAAW,CAAC;YAChB,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAChD,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAoB;gBAC/D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,cAAc,gBAAA;aACf,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG,UAAC,QAAoB;gBAC1C,IAAM,MAAM,GAAsB;oBAChC,EAAE,IAAA;oBACF,MAAM,QAAA;oBACN,eAAe,EAAE,QAAQ;oBACzB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,iBAAiB,CAAC,IAAI,mBACjB,MAAM,EACT,CAAC;gBAEH,IAAM,UAAU,GAAsB;oBACpC,EAAE,IAAA;oBACF,MAAM,QAAA;oBACN,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBAEF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,iBAAiB,CAAC,IAAI,mBACjB,MAAM,EACT,CAAC;gBACH,IAAI,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;oBAC/B,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC7E;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,WAAW,CAAC,EAAE,EAAE,QAAQ,EAAE,iBAAiB,EAAE,cAAc,EAAE,gBAAgB,CAAC,CAAC;gBACpF,cAAc,GAAG,IAAI,CAAC;gBACtB,OAAO,cAAc,CAAC;aACvB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAE,cAAc,CAAC,aAAa;gBACnC,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,CAAC,CAAC,CAAC;YAC3E,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACvD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBAED,IAAI,CAAC,MAAM,EAAE;oBACX,IAAM,MAAM,GAAsB;wBAChC,EAAE,IAAA;wBACF,MAAM,EAAE,QAAQ;wBAChB,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,UAAU,EAAEC,mBAAW,CAAC,SAAS;qBAClC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,iBAAiB,CAAC,IAAI,mBACjB,MAAM,EACT,CAAC;oBACH,MAAM,GAAG,QAAQ,CAAC;iBACnB;qBAAM;oBACL,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;YAEH,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAE1E,IAAI,QAAQ,EAAE;oBACZ,IAAM,MAAM,GAAsB;wBAChC,EAAE,IAAA;wBACF,MAAM,QAAA;wBACN,eAAe,EAAE,QAAQ;wBACzB,QAAQ,EAAED,iBAAS,CAAC,MAAM;wBAC1B,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,iBAAiB,CAAC,IAAI,mBACjB,MAAM,EACT,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAED,oCAAI,GAAJ,UACE,MAAkB,EAClB,WAAmB,EACnB,QAAsB,EACtB,WAAoB,EACpB,OAAiC,EACjC,QAAc;YAHd,yBAAA,EAAA,WAAW,IAAI,CAAC,EAAE,GAAG,CAAC;YAEtB,wBAAA,EAAA,iCAAiC;YACjC,yBAAA,EAAA,cAAc;YAEd,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAChD,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAoB;gBACzD,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YAEH,IAAM,MAAM,GAAsB;gBAChC,EAAE,IAAA;gBACF,MAAM,QAAA;gBACN,WAAW,aAAA;gBACX,QAAQ,UAAA;gBACR,WAAW,aAAA;gBACX,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,cAAc,gBAAA;aACf,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,mBACX,MAAM,EACT,CAAC;YAEH,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,QAAQ,EAAE,WAAW,EAAE,cAAc,CAAC,CAAC;SACpE;QAEO,2CAAW,GAAX,UACN,EAAU,EACV,QAAgB,EAChB,WAAuC,EACvC,OAA2B,EAC3B,cAAwC;YALlC,iBAkIP;YA3HC,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,IAAI,EAAEtD,mBAAW,CAAC,UAAU;gBAC5B,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAI,2BAA2B,CAAC;YAChC,IAAI,OAAO,CAAC,6BAA6B,EAAE;gBACzC,2BAA2B,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBAC3D,KAAK,EAAE,OAAO,CAAC,6BAA6B;oBAC5C,QAAQ,EAAE,OAAO,CAAC,qCAAqC;oBACvD,UAAU,EAAE,eAAe;oBAC3B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,IAAI,EAAEA,mBAAW,CAAC,UAAU;oBAC5B,QAAQ,UAAA;oBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YAED,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAE,OAAO,CAAC,cAAc;oBAC7B,UAAU,EAAE,eAAe;oBAC3B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,IAAI,EAAEA,mBAAW,CAAC,UAAU;oBAC5B,QAAQ,EAAE,QAAQ;oBAClB,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YAED,qBAAqB;iBAClB,IAAI,CAACqB,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBACvH,SAAS,CAAC,UAAC,EAA4D;oBAA1D,gBAA8C,EAAlC,WAAW,iBAAA,EAAE,aAAa,mBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACpE,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;gBACrF,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBACjF,IAAI,CAAC,eAAe,EAAE;oBACpB,OAAO;iBACR;gBAED,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAM,aAAa,GAAG,KAAK,KAAK,KAAI,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;gBACxD,IAAI,UAAU,CAAC;gBACf,IAAI,IAAI,EAAE;oBACR,UAAU,GAAG,aAAa,GAAGiC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,iBAAiB,CAAC;iBAC5F;qBAAM;oBACL,UAAU,GAAG,aAAa,GAAGA,mBAAW,CAAC,UAAU,GAAGA,mBAAW,CAAC,UAAU,CAAC;iBAC9E;gBAED,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU;qBAC9D,UAAU,KAAKA,mBAAW,CAAC,UAAU,IAAI,UAAU,KAAKA,mBAAW,CAAC,iBAAiB,CAAC,EAAE;oBACzF,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;oBACtC,OAAO;iBACR;gBAED,IAAM,MAAM,mBACV,EAAE,IAAA,EACF,YAAY,EAAE,KAAK,EACnB,iBAAiB,mBAAA;oBACjB,eAAe,iBAAA,EACf,QAAQ,EAAED,iBAAS,CAAC,IAAI,EACxB,UAAU,YAAA,IACP,KAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CACjC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,mBACX,MAAM,EACT,CAAC;aACJ,CAAC,CAAC;YAEL,IAAI,2BAA2B,EAAE;gBAC/B,2BAA2B,CAAC,SAAS,CAAC,UAAC,EAA4D;wBAA1D,gBAA8C,EAAlC,WAAW,iBAAA,EAAE,aAAa,mBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;oBAC/F,IAAM,MAAM,mBACV,EAAE,IAAA,EACF,QAAQ,EAAEA,iBAAS,CAAC,IAAI,EACxB,UAAU,EAAEC,mBAAW,CAAC,SAAS,IAC9B,KAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CACjC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,mBACX,MAAM,EACT,CAAC;iBACJ,CAAC,CAAC;aACJ;YAED,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAACjC,aAAG,CAAC,UAAC,EAAsB;wBAAR,IAAI,mBAAA;oBAAS,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBACvH,SAAS,CAAC,UAAC,EAAkD;wBAAhD,gBAA8C,EAAlC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA;oBACxD,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;oBACrF,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;oBACjF,IAAI,CAAC,eAAe,IAAI,CAAC,iBAAiB,EAAE;wBAC1C,OAAO;qBACR;oBAED,IAAM,MAAM,mBACV,EAAE,IAAA;wBACF,iBAAiB,mBAAA;wBACjB,eAAe,iBAAA,EACf,QAAQ,EAAEgC,iBAAS,CAAC,IAAI,EACxB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU,IACtE,KAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CACjC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,mBACX,MAAM,EACT,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,IAAM,WAAW,GAAG,CAAC,qBAAqB,CAAC,CAAC;YAC5C,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YACD,IAAI,2BAA2B,EAAE;gBAC/B,WAAW,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;aAC/C;YAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,cAAc,IAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACvE;QAEO,sDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAAkD;YAA9G,iBAqFP;YAnFC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBACX,CAAC,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBACtB,EAAE,IAAA,EACF,QAAQ,EAAED,iBAAS,CAAC,IAAI,EACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM,IAC3B,KAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CACZ,CAAC,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,gBACtB,EAAE,IAAA,EACF,QAAQ,EAAED,iBAAS,CAAC,IAAI,EACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO,IAC5B,KAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CACZ,CAAC,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAC/B,MAAkB,EAClB,WAAmB,EACnB,QAAiB,EACjB,WAAoB,EACpB,eAA4B,EAC5B,eAA4B,EAC5B,WAA0B;gBAE1B,IAAM,OAAO,GAAG,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC7C,OAAO,CAAC,WAAW,CAAC,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,eAAe,EAAE,eAAe,EAAE,WAAW,CAAC,CAAC;gBAC/G,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAA8E;gBACpH,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACJ,CAAC,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACA,CAAC,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,oEAAoE,CAAC,CAAC;iBACvF;gBAED,OAAO,cAAc,CAAC,IAAI,CAAC,CAAC;aAC7B,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YACvF,kBAAkB,CAAC,SAAS,GAAG,cAAkB,OAAA,KAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,GAAA,CAAC;YAC5E,kBAAkB,CAAC,cAAc,GAAG,cAAc,OAAA,KAAI,CAAC,cAAc,CAAC,EAAE,CAAC,GAAA,CAAC;YAC1E,kBAAkB,CAAC,cAAc,GAAG,cAAc,OAAA,KAAI,CAAC,cAAc,CAAC,EAAE,CAAC,GAAA,CAAC;YAE1E,OAAO,kBAA6C,CAAC;SACtD;QAEO,0CAAU,GAAV,UAAW,OAA2B;YAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,CAAC,CAAC;YACzE,IAAM,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAC5D,cAAc,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,uBAAuB,CAAC,UAAU,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;YACtG,cAAc,CAAC,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,uBAAuB,CAAC,YAAY,EAAE,OAAO,CAAC,YAAY,CAAC,CAAC;YAC5G,cAAc,CAAC,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,uBAAuB,CAAC,aAAa,EAAE,OAAO,CAAC,aAAa,CAAC,CAAC;YAC/G,OAAO,cAAc,CAAC;SACvB;QAEO,iDAAiB,GAAjB,UAAkB,EAAU;YAClC,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC;SACjD;QAEO,8CAAc,GAAd,UAAe,EAAU;YAC/B,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC;SAC5C;QAEO,8CAAc,GAAd,UAAe,EAAU;YAC/B,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,cAAc,EAAE,CAAC;SACtD;QAEO,8CAAc,GAAd,UAAe,EAAU;YAC/B,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,cAAc,EAAE,CAAC;SACtD;QAEO,oDAAoB,GAApB,UAAqB,EAAU;YACrC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC7C,OAAO;gBACL,MAAM,EAAE,OAAO,CAAC,SAAS,EAAE;gBAC3B,QAAQ,EAAE,OAAO,CAAC,WAAW,EAAE;gBAC/B,WAAW,EAAE,OAAO,CAAC,cAAc,EAAE;gBACrC,WAAW,EAAE,OAAO,CAAC,cAAc,EAAE;gBACrC,wBAAwB,EAAE,OAAO,CAAC,2BAA2B,EAAE;gBAC/D,wBAAwB,EAAE,OAAO,CAAC,2BAA2B,EAAE;aAChE,CAAC;SACH;;;;gBApbF7D,eAAU;;;;QCOT,iCACU,cAAqC,EACrC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,eAAuC,EACvC,aAA4B;YAL5B,mBAAc,GAAd,cAAc,CAAuB;YACrC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,oBAAe,GAAf,eAAe,CAAwB;YACvC,kBAAa,GAAb,aAAa,CAAe;YAb/B,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,kBAAa,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAanD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YACxI,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,+DAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAA,MAAM;gBAC7C,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,4CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,kDAAgB,GAAhB,UAAiB,OAAwB,EAAE,MAAyB,EAAE,MAAqB;YACzF,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;YACpC,MAAM,CAAC,WAAW,GAAG,OAAO,CAAC,cAAc,EAAE,CAAC;YAC9C,MAAM,CAAC,WAAW,GAAG,OAAO,CAAC,cAAc,EAAE,CAAC;YAC9C,MAAM,CAAC,QAAQ,GAAG,OAAO,CAAC,WAAW,EAAE,CAAC;YAExC,IAAI,MAAM,EAAE;gBACV,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;gBACxB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;gBACxD,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;YACjE,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;SACzD;QAED,kDAAgB,GAAhB,UAAiB,OAAwB;YACvC,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC;YACpB,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC;SACzD;QAED,qDAAmB,GAAnB,UAAoB,MAAyB;YAC3C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,eAAe,CAAC,qBAAqB,CACxC,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,cAAc,CACtB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC;wBACpE,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,MAAM,EAAE;wBACjB,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBAChC,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC7C,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;wBAC/B,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;oBACvC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC5D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC5D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,mDAAiB,GAAjB,UAAkB,MAAyB;YACzC,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,qBAAqB,CACxD,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,cAAc,CACtB,CAAC;oBACF,OAAO,CAAC,WAAW,CACjB,MAAM,CAAC,MAAM,EACb,MAAM,CAAC,WAAW,EAClB,MAAM,CAAC,QAAQ,EACf,MAAM,CAAC,WAAW,EAClB,CAAC,MAAM,CAAC,cAAc,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,KAAK,SAAS,EACxE,CAAC,MAAM,CAAC,cAAc,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,KAAK,SAAS,EACxE,CAAC,MAAM,CAAC,cAAc,IAAI,MAAM,CAAC,cAAc,CAAC,YAAY,KAAK,SAAS,CAC3E,CAAC;oBACF,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;oBACvC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,CAAC;gBACnC,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;wBAC/D,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,iBAAiB,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACtE,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,cAAc,EAAE,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,IAAI,OAAO,CAAC,UAAU,EAAE;wBACjC,OAAO,CAAC,kBAAkB,EAAE,CAAC;wBAC7B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC3B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACpD,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,UAAU,GAAG,IAAI,CAAC;wBAC1B,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;qBACxC;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,6CAAW,GAAX;YACE,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;SAC9B;QAED,8CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,8CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBA9RFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,iBAAiB;oBAC3B,QAAQ,WAAW,q0GAmElB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,sBAAsB,CAAC;oBACxD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBA7EQ,qBAAqB;gBANrB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAEb,sBAAsB;gBAVtB,aAAa;;;oCA+FnBe,cAAS,SAAC,mBAAmB;kCAC7BA,cAAS,SAAC,iBAAiB;;;;QCtFQ,oCAAQ;QAY5C,0BAAoB,EAAU,EACV,WAA6B,EAC7B,cAAgC,EAChC,mBAAwC,EACxC,WAAgC,EACxC,SAAwB;YALpC,YAME,iBAAO,SAMR;YAZmB,QAAE,GAAF,EAAE,CAAQ;YACV,iBAAW,GAAX,WAAW,CAAkB;YAC7B,oBAAc,GAAd,cAAc,CAAkB;YAChC,yBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,iBAAW,GAAX,WAAW,CAAqB;YAf5C,eAAS,GAAgB,EAAE,CAAC;YAE5B,eAAS,GAAmB,EAAE,CAAC;YAE/B,kBAAY,GAAG,KAAK,CAAC;YACrB,iBAAW,GAAG,IAAI,CAAC;YAInB,aAAO,GAAiB,EAAE,CAAC;YASjC,KAAI,CAAC,WAAW,qBAAO,WAAW,CAAC,UAAU,CAAC,CAAC;YAC/C,KAAI,CAAC,KAAK,qBAAO,WAAW,CAAC,aAAa,CAAC,CAAC;YAC5C,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;gBACtC,KAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;aACpC;;SACF;QAED,sBAAI,oCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAC7B,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC1C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,KAAK,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;qBACnC;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAdA;QAgBD,sBAAI,mCAAK;iBAAT;gBACE,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;iBAED,UAAU,KAAoB;gBAC5B,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;aAC5B;;;WAJA;QAMD,sBAAI,wCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAiB;gBAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;aAC1B;;;WAJA;QAMD,sBAAI,wCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAA7B,iBAMC;gBALC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;oBAC1B,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;oBACnB,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;iBACtC,CAAC,CAAC;aACJ;;;WARA;QAUO,6CAAkB,GAAlB,UAAmB,SAAuB;YAA1C,iBAMP;YALC,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;gBACzB,KAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;aACrC,CAAC,CAAC;YACH,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;SAC1B;QAED,sCAAW,GAAX,UAAY,MAGM,EAAE,aAA6B;YAHjD,iBAyBC;YArBC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,MAAM,IAAI,KAAK,CAAC,8DAA8D,CAAC,CAAC;aACjF;YACD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YAEhE,IAAM,SAAS,GAAgB,EAAE,CAAC;YAClC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACtC,IAAM,gBAAgB,GAAQ,MAAM,CAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,QAAQ,GAAG,IAAI,CAAC;gBACpB,IAAI,gBAAgB,CAAC,UAAU,EAAE;oBAC/B,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,CAAC,QAAQ,EAAE,gBAAgB,CAAC,UAAU,CAAC,CAAC;iBAC3F;qBAAM;oBACL,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;iBACvE;gBACD,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC1B;YACD,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;YAC3B,IAAI,CAAC,aAAa,GAAG,aAAa,GAAG,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;YAExE,IAAI,CAAC,iBAAiB,OAAtB,IAAI,YAAmB,IAAI,GAAK,IAAI,CAAC,SAAS,GAAE;YAChD,IAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC;QAEO,kDAAuB,GAAvB;YAAA,iBAaP;YAZC,IAAM,aAAa,YAAO,IAAI,CAAC,SAAS,CAAC,CAAC;YAC1C,aAAa,CAAC,OAAO,CAAC,UAAC,GAAG,EAAE,KAAK;gBAC/B,IAAI,KAAK,KAAK,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;oBACtC,IAAM,YAAY,GAAG,GAAG,CAAC;oBACzB,IAAM,SAAS,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,aAAa,CAAC,MAAM,CAAC,CAAC;oBACvD,IAAM,SAAS,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC;oBAE3C,IAAM,QAAQ,GAAG,KAAI,CAAC,qBAAqB,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;oBAErE,KAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;iBACzC;aACF,CAAC,CAAC;SACJ;QAEO,gDAAqB,GAArB,UAAsB,MAAiB,EAAE,OAAkB;YACjE,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,OAAO,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAC7H,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,kBAAkB,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAC9E,QAAQ,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YAEnC,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YAClD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,GAAG,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;YACnD,OAAO,QAAQ,CAAC;SACjB;QAEO,mDAAwB,GAAxB,UAAyB,gBAA2B,EAAE,SAAoB,EAAE,SAAoB;YACtG,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,EAAE,SAAS,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAClI,gBAAgB,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;SAClD;QAED,wDAA6B,GAA7B,UAA8B,KAAgB;YAC5C,KAAK,CAAC,mBAAmB,CAAC,KAAK,CAAC,CAAC;YACjC,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACjD,IAAM,SAAS,GAAG,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC;YACnD,IAAM,QAAQ,GAAG,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC;YAEhE,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YAC5C,IAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;YAE1C,IAAM,aAAa,GAAG,IAAI,CAAC,qBAAqB,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YAClE,IAAM,WAAW,GAAG,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;YACjE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,aAAa,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;SAElE;QAEO,0CAAe,GAAf;YAAA,iBAaP;YAZC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YACjF,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;YACpB,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,KAAK,IAAI,OAAA,CAAC,KAAK,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC;YAC/E,UAAU,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;gBAC9B,IAAI,KAAK,KAAK,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;oBACnC,IAAM,SAAS,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC;oBAC9B,IAAM,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC;oBACxC,IAAM,QAAQ,GAAG,IAAI,YAAY,CAAC,KAAI,CAAC,EAAE,EAAE,KAAK,CAAC,WAAW,EAAE,EAAE,SAAS,CAAC,WAAW,EAAE,EAAE,KAAI,CAAC,aAAa,CAAC,CAAC;oBAC7G,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAC9B,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;iBACxD;aACF,CAAC,CAAC;SACJ;QAED,+CAAoB,GAApB,UAAqB,QAAoB;YACvC,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YACpE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;SACxC;QAGD,mCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YACD,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5C,IAAI,YAAY,EAAE;gBAChB,IAAM,UAAU,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;gBACtE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAChC,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;aAC1C;YAED,IAAI,CAAC,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;YAC9E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAEtC,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;SAChD;QAED,0CAAe,GAAf,UAAgB,SAAoB;YAClC,IAAI,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE;gBACpC,SAAS,CAAC,KAAK,CAAC,wBAAwB,GAAG,MAAM,CAAC,iBAAiB,CAAC;gBACpE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;aAC1C;SACF;QAED,oCAAS,GAAT,UAAU,UAAsB,EAAE,SAAoB;YACpD,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAClC,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,SAAS,CAAC,KAAK,CAAC,wBAAwB,IAAI,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE;;oBAEhF,SAAS,CAAC,KAAK,CAAC,wBAAwB,GAAG,SAAS,CAAC;oBACrD,OAAO;iBACR;gBAED,IAAI,SAAS,CAAC,kBAAkB,EAAE,EAAE;oBAClC,IAAI,CAAC,6BAA6B,CAAC,SAAS,CAAC,CAAC;iBAC/C;gBACD,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;gBAErD,IAAI,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC1C,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;oBAC1E,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,UAAU,GAAG,CAAC,KAAK,WAAW,CAAC,CAAC,CAAC;oBACvE,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,EAAE,SAAS,EAAE,aAAa,CAAC,CAAC;iBAC3E;gBACD,IAAI,UAAU,GAAG,CAAC,EAAE;oBAClB,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC,CAAC;oBACxF,IAAM,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,UAAU,GAAG,CAAC,IAAI,WAAW,IAAI,WAAW,CAAC,CAAC;oBACrF,IAAI,CAAC,wBAAwB,CAAC,gBAAgB,EAAE,SAAS,EAAE,aAAa,CAAC,CAAC;iBAC3E;aACF;YACD,IAAI,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;SACzC;QAED,8CAAmB,GAAnB,UAAoB,UAAsB;YACxC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aAC9C;SACF;QAED,oCAAS,GAAT,UAAU,mBAA+B,EAAE,iBAA6B;YACtE,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;gBACtB,OAAO;aACR;YACD,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,mBAAmB,CAAC;aAClD;YAED,IAAM,KAAK,GAAG,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,iBAAiB,CAAC,CAAC;YAC/F,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;gBAC1B,IAAM,MAAM,GAAG,eAAe,CAAC,kBAAkB,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;gBACpF,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aAC3B,CAAC,CAAC;YACH,IAAI,CAAC,iBAAiB,OAAtB,IAAI,YAAmB,IAAI,GAAK,IAAI,CAAC,SAAS,GAAE;YAChD,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;SAChD;QAED,uCAAY,GAAZ;YACE,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;YACvC,IAAI,CAAC,iBAAiB,OAAtB,IAAI,YAAmB,IAAI,GAAK,IAAI,CAAC,SAAS,GAAE;SACjD;QAED,sCAAW,GAAX,UAAY,aAAwB;YAApC,iBAQC;YAPC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YACnC,IAAI,CAAC,SAAS;iBACX,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,kBAAkB,EAAE,GAAA,CAAC;iBACnC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;YACxC,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAE/B,IAAI,CAAC,eAAe,EAAE,CAAC;SACxB;QAED,uCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACtC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YAExB,IAAI,CAAC,uBAAuB,EAAE,CAAC;SAChC;QAED,2CAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,aAAa,EAAE;iBACxB,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SAC5C;QAED,wCAAa,GAAb;YAAA,iBAGC;YAFC,OAAO,IAAI,CAAC,SAAS;iBAClB,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC,QAAQ,CAAC,kBAAkB,EAAE,IAAI,QAAQ,KAAK,KAAI,CAAC,WAAW,GAAA,CAAC,CAAC;SACxF;QAED,oCAAS,GAAT;YAAA,iBAEC;YADC,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,KAAK,KAAI,CAAC,WAAW,GAAA,CAAC,CAAC;SACzE;QAED,uCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SAC/D;QAED,uDAA4B,GAA5B;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACzE;QAEO,yCAAc,GAAd,UAAe,KAAgB;YACrC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,KAAK,KAAK,GAAA,CAAC,CAAC;YAC3D,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACxC;QAEO,4CAAiB,GAAjB,UAAkB,eAAsB;YAAxC,iBAKP;YALyB,gCAAA,EAAA,sBAAsB;YAAE,eAAqB;iBAArB,UAAqB,EAArB,qBAAqB,EAArB,IAAqB;gBAArB,8BAAqB;;YACrE,IAAI,eAAe,EAAE;gBACnB,IAAI,CAAC,eAAe,EAAE,CAAC;aACxB;YACD,KAAK,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;SAC3D;QAED,iCAAM,GAAN;YACE,IAAI,CAAC,iBAAiB,EAAE,CAAC;SAC1B;QAED,kCAAO,GAAP;YAAA,iBAUC;YATC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,SAAS;gBAC9B,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;aAC5C,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YACzE,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;aAC9B;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,yCAAc,GAAd;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;SAC9B;QAED,gCAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;+BACF;KA/UD,CAAsC,QAAQ;;;QCAP,qCAAQ;QAU7C,2BACU,EAAU,EACV,WAA6B,EAC7B,cAAgC,EAChC,mBAAwC,EAChD,WAAiC,EACjC,SAAwB;YAN1B,YAQE,iBAAO,SAQR;YAfS,QAAE,GAAF,EAAE,CAAQ;YACV,iBAAW,GAAX,WAAW,CAAkB;YAC7B,oBAAc,GAAd,cAAc,CAAkB;YAChC,yBAAmB,GAAnB,mBAAmB,CAAqB;YAb1C,eAAS,GAAgB,EAAE,CAAC;YAE5B,UAAI,GAAG,KAAK,CAAC;YACb,iBAAW,GAAG,IAAI,CAAC;YAInB,aAAO,GAAiB,EAAE,CAAC;YAWjC,KAAI,CAAC,iBAAiB,qBAAO,WAAW,CAAC,UAAU,CAAC,CAAC;YACrD,KAAI,CAAC,cAAc,qBAAO,WAAW,CAAC,cAAc,CAAC,CAAC;YACtD,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACvC,KAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;aACpC;iBAAM,IAAI,SAAS,EAAE;gBACpB,MAAM,IAAI,KAAK,CAAC,6CAA6C,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;aACnF;;SACF;QAED,sBAAI,qCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAC7B,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC1C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,KAAK,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;qBACnC;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAdA;QAgBD,sBAAI,6CAAc;iBAAlB;gBACE,OAAO,IAAI,CAAC,eAAe,CAAC;aAC7B;iBAED,UAAmB,KAAqB;gBACtC,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;aAC9B;;;WAJA;QAMD,sBAAI,gDAAiB;iBAArB;gBACE,OAAO,IAAI,CAAC,kBAAkB,CAAC;aAChC;iBAED,UAAsB,KAAiB;gBACrC,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;aACjC;;;WAJA;QAMD,sBAAI,yCAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAA7B,iBAMC;gBALC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;oBAC1B,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;oBACnB,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;iBAC/B,CAAC,CAAC;aACJ;;;WARA;QAUO,8CAAkB,GAAlB,UAAmB,SAAuB;YAA1C,iBAOP;YANC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;gBACxB,KAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;aACrC,CAAC,CAAC;YACH,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;YAC1C,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SAClB;QAED,6CAAiB,GAAjB,UAAkB,MAAmB,EAAE,WAAoB;YAA3D,iBAQC;YAPC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;gBACd,MAAM,IAAI,KAAK,CAAC,+DAA+D,CAAC,CAAC;aAClF;YACD,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YAChE,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;YACxB,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,MAAM,GAAE;YAClC,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QAED,gDAAoB,GAApB,UAAqB,QAAoB;YACvC,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC1E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;SAClC;QAED,oCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,OAAO;aACR;YACD,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5C,IAAI,YAAY,EAAE;gBAChB,IAAM,UAAU,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBAC5E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAChC,IAAI,CAAC,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBACpF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACtC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;aACpC;iBAAM;gBAEL,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;gBAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;gBACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aACzB;SACF;QAED,qCAAS,GAAT,UAAU,UAAsB,EAAE,SAAoB;YACpD,IAAI,CAAC,SAAS,CAAC,kBAAkB,EAAE,EAAE;gBACnC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;gBAClC,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;gBAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;SACF;QAED,qCAAS,GAAT,UAAU,mBAA+B,EAAE,iBAA6B;YACtE,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,mBAAmB,CAAC;aAClD;YAED,IAAM,uBAAuB,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;YAC9F,IAAM,6BAA6B,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;YAC3F,IAAI,CAAC,aAAa,EAAE,CAAC,OAAO,CAAC,UAAA,KAAK;gBAChC,IAAM,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;gBAC5E,YAAY,CAAC,SAAS,KAAK,6BAA6B,CAAC,SAAS,GAAG,uBAAuB,CAAC,SAAS,CAAC,CAAC;gBACxG,YAAY,CAAC,QAAQ,KAAK,6BAA6B,CAAC,QAAQ,GAAG,uBAAuB,CAAC,QAAQ,CAAC,CAAC;gBACrG,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,EAAE,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;aACpG,CAAC,CAAC;YAEH,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;YAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;SAChD;QAED,wCAAY,GAAZ;YAAA,iBAIC;YAHC,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;YACvC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;YAC/D,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QAED,wCAAY,GAAZ;YACE,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;SAC3C;QAED,+CAAmB,GAAnB,UAAoB,UAAsB;YACxC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aAC9C;SACF;QAED,uCAAW,GAAX,UAAY,aAAwB;YAApC,iBAGC;YAFC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YACnC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;SACzF;QAED,wCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACtC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;QAED,4CAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SACrE;QAED,4DAAgC,GAAhC;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SAC7E;QAED,yCAAa,GAAb;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC,QAAQ,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC;SAC1E;QAED,wCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SAC/D;QAED,wCAAY,GAAZ;YACE,IAAM,aAAa,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC,GAAG,CAAC,UAAA,SAAS,IAAI,OAAA,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,SAAS,CAAC,GAAA,CAAC,CAAC;YACzG,IAAM,UAAU,GAAG,aAAa,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,SAAS,GAAA,CAAC,CAAC;YACrE,IAAM,SAAS,GAAG,aAAa,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAK,OAAA,QAAQ,CAAC,QAAQ,GAAA,CAAC,CAAC;YAEpE,OAAO,IAAI,MAAM,CAAC,SAAS,CACzB,IAAI,CAAC,GAAG,OAAR,IAAI,WAAQ,UAAU,IACtB,IAAI,CAAC,GAAG,OAAR,IAAI,WAAQ,SAAS,IACrB,IAAI,CAAC,GAAG,OAAR,IAAI,WAAQ,UAAU,IACtB,IAAI,CAAC,GAAG,OAAR,IAAI,WAAQ,SAAS,GACtB,CAAC;SACH;QAED,wDAA4B,GAA5B;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SACzE;QAEO,0CAAc,GAAd,UAAe,KAAgB;YACrC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,KAAK,GAAA,CAAC,CAAC;YACzD,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACxC;QAEO,6CAAiB,GAAjB;YAAA,iBAEP;YAFyB,eAAqB;iBAArB,UAAqB,EAArB,qBAAqB,EAArB,IAAqB;gBAArB,0BAAqB;;YAC7C,KAAK,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;SAC3D;QAEO,gDAAoB,GAApB;YACN,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;SAC3C;QAED,mCAAO,GAAP;YAAA,iBAWC;YAVC,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAEpC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,SAAS;gBAC9B,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;aAC5C,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;aAC9B;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,0CAAc,GAAd;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;SAC9B;QAED,iCAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;gCACF;KAnPD,CAAuC,QAAQ;;;QCRN,oCAAa;QAAtD;;SASC;+BAAA;KATD,CAAyClC,eAAa;;;QCGX,yCAAiC;QAA5E;;SAGC;oCAAA;KAHD,CAA2C,gBAAiC;;;QCC9B,4CAAoC;QAAlF;;SAGC;uCAAA;KAHD,CAA8C,gBAAoC;;;QCCrC,2CAAmC;QAAhF;;SAIC;sCAAA;KAJD,CAA6C,gBAAmC;;;QCFjC,6CAAqC;QAApF;;SAQC;wCAAA;KARD,CAA+C,gBAAqC;;;QCAxC,0CAAkC;QAA9E;;SAKC;qCAAA;KALD,CAA4C,gBAAkC;;;QCAjC,2CAAmC;QAAhF;;SAaC;sCAAA;KAbD,CAA6C,gBAAmC;;;QCAhC,8CAAsC;QAAtF;;SAQC;yCAAA;KARD,CAAgD,gBAAsC;;;QCI9C,sCAAQ;QAU9C,4BACU,EAAU,EACV,WAA6B,EAC7B,eAAiC,EACjC,mBAAwC,EAChD,WAAkC,EAClC,SAAwB;YAN1B,YAQE,iBAAO,SAQR;YAfS,QAAE,GAAF,EAAE,CAAQ;YACV,iBAAW,GAAX,WAAW,CAAkB;YAC7B,qBAAe,GAAf,eAAe,CAAkB;YACjC,yBAAmB,GAAnB,mBAAmB,CAAqB;YAb1C,eAAS,GAAgB,EAAE,CAAC;YAE5B,UAAI,GAAG,KAAK,CAAC;YACb,iBAAW,GAAG,IAAI,CAAC;YAInB,aAAO,GAAiB,EAAE,CAAC;YAWjC,KAAI,CAAC,iBAAiB,qBAAO,WAAW,CAAC,UAAU,CAAC,CAAC;YACrD,KAAI,CAAC,eAAe,qBAAO,WAAW,CAAC,eAAe,CAAC,CAAC;YACxD,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBACvC,KAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;aACpC;iBAAM,IAAI,SAAS,EAAE;gBACpB,MAAM,IAAI,KAAK,CAAC,8CAA8C,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;aACpF;;SACF;QAED,sBAAI,sCAAM;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC;aACrB;iBAED,UAAW,MAAoB;gBAC7B,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO;iBACR;gBACD,IAAM,SAAS,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC1C,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK;oBACrC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;wBACnB,KAAK,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;qBACnC;oBAED,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,iBAAiB,EAAE,KAAK,CAAC,CAAC;iBACpD,CAAC,CAAC;aACJ;;;WAdA;QAgBD,sBAAI,+CAAe;iBAAnB;gBACE,OAAO,IAAI,CAAC,gBAAgB,CAAC;aAC9B;iBAED,UAAoB,KAAsB;gBACxC,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC;aAC/B;;;WAJA;QAMD,sBAAI,iDAAiB;iBAArB;gBACE,OAAO,IAAI,CAAC,kBAAkB,CAAC;aAChC;iBAED,UAAsB,KAAiB;gBACrC,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;aACjC;;;WAJA;QAMD,sBAAI,0CAAU;iBAAd;gBACE,OAAO,IAAI,CAAC,WAAW,CAAC;aACzB;iBAED,UAAe,KAAc;gBAA7B,iBAMC;gBALC,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK;oBAC1B,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC;oBACnB,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;iBAC/B,CAAC,CAAC;aACJ;;;WARA;QAUO,+CAAkB,GAAlB,UAAmB,SAAuB;YAA1C,iBAQP;YAPC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ;gBACxB,KAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;aACrC,CAAC,CAAC;YACH,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;YAC1C,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;SAClB;QAED,8CAAiB,GAAjB,UAAkB,MAAmB,EAAE,WAAoB;YAA3D,iBAUC;YATC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;gBACd,MAAM,IAAI,KAAK,CAAC,8DAA8D,CAAC,CAAC;aACjF;YACD,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,WAAW,GAAG,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;YACpF,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;YAChE,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;YACxB,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,MAAM,GAAE;YAClC,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QAED,iDAAoB,GAApB,UAAqB,QAAoB;YACvC,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAC1E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;SAClC;QAED,qCAAQ,GAAR,UAAS,QAAoB;YAC3B,IAAI,IAAI,CAAC,IAAI,EAAE;gBACb,OAAO;aACR;YACD,IAAM,YAAY,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YAC5C,IAAI,YAAY,EAAE;gBAChB,IAAM,UAAU,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBAC5E,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBAChC,IAAI,CAAC,WAAW,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,QAAQ,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;gBACpF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACtC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;aACpC;iBAAM;gBACL,IAAI,CAAC,sBAAsB,EAAE,CAAC;gBAE9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;gBAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;gBACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;aACzB;SACF;QAEO,mDAAsB,GAAtB;YAAA,iBAaP;YAZC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;YAExF,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;YACvC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;YAErC,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAC1H,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;YAEzG,IAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;YAClE,IAAI,CAAC,yBAAyB,CAAC,kBAAkB,EAAE,SAAS,CAAC,CAAC;YAC9D,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;YACpE,IAAI,CAAC,yBAAyB,CAAC,kBAAkB,EAAE,WAAW,CAAC,CAAC;SACjE;QAEO,sDAAyB,GAAzB,UAA0B,kBAAuB,EAAE,OAAe;YACxE,IAAM,gBAAgB,GAAG,eAAe,CAAC,iCAAiC,CACxE,kBAAkB,EAClB,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,CAAC,EAC9B,OAAO,EACP,IAAI,CACL,CAAC;YACF,IAAM,QAAQ,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,gBAAgB,EAAE,IAAI,CAAC,iBAAiB,CAAC,CAAC;YAClF,QAAQ,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;YACnC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC/B;QAED,sCAAS,GAAT,UAAU,UAAsB,EAAE,SAAoB;YACpD,IAAI,CAAC,SAAS,CAAC,kBAAkB,EAAE,EAAE;gBACnC,SAAS,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;gBAClC,IAAI,CAAC,sBAAsB,EAAE,CAAC;gBAC9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;gBAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;aAC7B;iBAAM;gBACL,IAAI,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;aACxC;SACF;QAEO,kDAAqB,GAArB,UAAsB,UAAsB;YAClD,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;YACvC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;YACrC,IAAM,kBAAkB,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,IAAI,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;YAE1H,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,kBAAkB,EAAE,UAAU,CAAC,CAAC;YAC/F,IAAI,oBAAoB,GAAG,UAAU,CAAC;YACtC,IAAI,UAAU,GAAG,GAAG,EAAE;gBACpB,oBAAoB,GAAG,UAAU,GAAG,GAAG,CAAC;aACzC;iBAAM,IAAI,UAAU,GAAG,GAAG,EAAE;gBAC3B,oBAAoB,GAAG,UAAU,GAAG,GAAG,CAAC;aACzC;YACD,IAAI,wBAAwB,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;YACrH,IAAI,wBAAwB,GAAG,GAAG,EAAE;gBAClC,wBAAwB,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC;aAClH;YACD,IAAI,eAAe,GACjB,wBAAwB,GAAG,oBAAoB;kBAC3C,wBAAwB,GAAG,oBAAoB;kBAC/C,oBAAoB,GAAG,wBAAwB,CAAC;YAEtD,IAAI,UAAU,GAAG,GAAG,EAAE;gBACpB,eAAe,GAAG,UAAU,GAAG,wBAAwB,CAAC;aACzD;YAED,IAAM,cAAc,GAAG,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,QAAQ,CAAC,kBAAkB,EAAE,UAAU,CAAC,CAAC,CAAC;YAC1F,IAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC,GAAG,cAAc,CAAC;YAEtF,IAAI,CAAC,eAAe,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YACvD,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;YAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QAED,sCAAS,GAAT,UAAU,mBAA+B,EAAE,iBAA6B;YACtE,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,GAAG,mBAAmB,CAAC;aAClD;YAED,IAAM,KAAK,GAAG,eAAe,CAAC,iBAAiB,CAAC,IAAI,CAAC,qBAAqB,EAAE,iBAAiB,CAAC,CAAC;YAC/F,IAAI,CAAC,aAAa,EAAE,CAAC,OAAO,CAAC,UAAA,KAAK;gBAChC,IAAM,MAAM,GAAG,eAAe,CAAC,kBAAkB,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;gBACpF,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;aAC3B,CAAC,CAAC;YACH,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;YAC1C,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,qBAAqB,GAAG,iBAAiB,CAAC;SAChD;QAED,yCAAY,GAAZ;YAAA,iBAKC;YAJC,IAAI,CAAC,qBAAqB,GAAG,SAAS,CAAC;YACvC,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,GAAA,CAAC,CAAC;YAC/D,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QAED,yCAAY,GAAZ;YACE,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,iBAAiB,OAAtB,IAAI,WAAsB,IAAI,CAAC,SAAS,GAAE;SAC3C;QAED,gDAAmB,GAAnB,UAAoB,UAAsB;YACxC,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;aAC9C;SACF;QAED,wCAAW,GAAX,UAAY,aAAwB;YAApC,iBAGC;YAFC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YACnC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAA,CAAC,CAAC;SACzF;QAED,yCAAY,GAAZ,UAAa,QAAoB;YAC/B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACtC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;SACzB;QAED,6CAAgB,GAAhB;YACE,OAAO,IAAI,CAAC,aAAa,EAAE,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SACrE;QAED,6DAAgC,GAAhC;YACE,OAAO,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;SAC7E;QAED,0CAAa,GAAb;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAA,QAAQ,IAAI,OAAA,CAAC,QAAQ,CAAC,kBAAkB,EAAE,GAAA,CAAC,CAAC;SAC1E;QAED,qCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC;SACnC;QAED,yCAAY,GAAZ;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,WAAW,EAAE,GAAA,CAAC,CAAC;SAC/D;QAEO,2CAAc,GAAd,UAAe,KAAgB;YACrC,IAAM,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,KAAK,KAAK,GAAA,CAAC,CAAC;YACzD,IAAI,KAAK,GAAG,CAAC,EAAE;gBACb,OAAO;aACR;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;SACxC;QAEO,8CAAiB,GAAjB;YAAA,iBAEP;YAFyB,eAAqB;iBAArB,UAAqB,EAArB,qBAAqB,EAArB,IAAqB;gBAArB,0BAAqB;;YAC7C,KAAK,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,GAAA,CAAC,CAAC;SAC3D;QAEO,iDAAoB,GAApB;YACN,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;SAC5C;QAED,oCAAO,GAAP;YAAA,iBAWC;YAVC,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAErC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,SAAS;gBAC9B,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;aAC5C,CAAC,CAAC;YACH,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,CAAC;gBAClD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;aAC9B;YACD,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC;SAC3B;QAED,2CAAc,GAAd;YACE,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;SAC9B;QAED,kCAAK,GAAL;YACE,OAAO,IAAI,CAAC,EAAE,CAAC;SAChB;iCACF;KAzSD,CAAwC,QAAQ;;eC+BlC,cAAM,OAAA,MAAM,CAAC,KAAK,CAAC,KAAK,GAAA;QAlBzB,wBAAwB,GAAwB;QAC3D,aAAa,EAAEX,mBAAW,CAAC,UAAU;QACrC,iBAAiB,EAAEA,mBAAW,CAAC,iBAAiB;QAChD,gBAAgB,EAAEA,mBAAW,CAAC,WAAW;QACzC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC;YACzC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;QACD,aAAa,EAAE;YACb,QAAQ,MAA0B;YAClC,KAAK,EAAE,CAAC;YACR,aAAa,EAAE,KAAK;YACpB,MAAM,EAAE,CAAC;YACT,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;SACnD;QACD,eAAe,EAAE,KAAK;QACtB,sBAAsB,EAAE;YACtB,cAAc,EAAE,KAAK;YACrB,iBAAiB,EAAE,IAAI;YACvB,sBAAsB,EAAE,CAAC;SAC1B;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAAA,iBAmhBC;YAhhBS,kBAAa,GAAG,IAAIkB,YAAO,EAAsB,CAAC;YAClD,oBAAe,GAAGL,iBAAO,EAAsB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAIpE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;YAGhE,yBAAoB,GAAG,QAAQ,CAAC,UAAC,EAAE,EAAE,eAAwB,EAAE,sBAAsB;gBAC3F,KAAI,CAAC,WAAW,CAAC,EAAE,EAAE,eAAe,EAAE,sBAAsB,CAAC,CAAC;aAC/D,EAAE,GAAG,CAAC,CAAC;SAsgBT;QApgBC,qCAAI,GAAJ,UAAK,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,gBAAyC,EACzC,YAA2B;YAC9B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YAE/B,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;SAC5C;QAED,yCAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAEO,4CAAW,GAAX,UAAY,EAAE,EAAE,eAAwB,EAAE,EAA+E;YAAzH,iBAoBP;gBApBmD,cAAc,oBAAA,EAAE,iBAAiB,uBAAA,EAAE,sBAAsB,4BAAA;YAC3G,IAAI,eAAe,IAAI,iBAAiB,EAAE;gBACxC,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC/C,IAAM,QAAM,GAAG,QAAQ,CAAC,SAAS,EAAE,CAAC;gBAEpC,IAAI,CAAC,cAAc,EAAE;;oBAEnB,QAAM,CAAC,OAAO,CAAC,UAAA,KAAK;wBAClB,KAAK,CAAC,WAAW,CAAC,KAAI,CAAC,WAAW,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,SAAS,EAAE,sBAAsB,CAAC,CAAC,CAAC;qBAC3G,CAAC,CAAC;iBACJ;qBAAM;oBACL,IAAM,aAAa,GAAG,QAAM,CAAC,GAAG,CAAC,UAAA,KAAK,IAAI,OAAA,KAAI,CAAC,mBAAmB,CAAC,wBAAwB,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,GAAA,CAAC,CAAC;oBAClH,IAAM,OAAO,GAAG,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE,EAAE,EAAE,aAAa,CAAC,CAAC;oBAC1F,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,gBAAgB;wBAC7C,QAAM,CAAC,OAAO,CAAC,UAAC,KAAK,EAAE,KAAK;4BAC1B,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,CAAC,WAAW,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;yBAC7E,CAAC,CAAC;qBACJ,CAAC,CAAC;iBACJ;aACF;SACF;QAGO,iDAAgB,GAAhB,UAAiB,UAAU,EAAE,eAAwB,EAAE,EAA0D;YAAjH,iBAwBP;gBAxB+D,sBAAsB,4BAAA,EAAE,cAAc,oBAAA;YACpG,IAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;;YAG3E,IAAI,eAAe,IAAI,UAAU,EAAE;gBACjC,IAAM,iBAAiB,GAAG;oBACxB,IAAM,GAAG,GAAG,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;oBAClE,OAAO,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,KAAI,CAAC,WAAW,CAAC,CAAC;iBAC3D,CAAC;;gBAGF,IAAI,cAAc,EAAE;oBAClB,OAAO,iBAAiB,EAAE,CAAC;iBAC5B;qBAAM;oBACL,IAAM,sBAAsB,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;oBACzE,IAAM,MAAM,GAAG,mBAAmB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,CAAC;oBAC9E,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;wBACrB,OAAO,iBAAiB,EAAE,CAAC;qBAC5B;oBACD,OAAO,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,sBAAsB,EAAE,SAAS,EAAE,sBAAsB,CAAC,CAAC;iBAClG;aACF;YAED,OAAO,UAAU,CAAC;SACnB;QAED,uCAAM,GAAN,UAAO,OAAkC,EAAE,aAAmB;YAA9D,iBA+HC;YA/HM,wBAAA,EAAA,kCAAkC;YAAE,8BAAA,EAAA,mBAAmB;YAC5D,IAAM,SAAS,GAAiB,EAAE,CAAC;YACnC,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAEjD,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAqB;gBAChE,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,SAAS,WAAA;gBACT,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,eAAe,EAAE,eAAe;aACjC,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG,UAAC,QAAoB;gBAC1C,OAAO,KAAI,CAAC,gBAAgB,CAC1B,EAAE,EACF,QAAQ,EACR,iBAAiB,EACjB,SAAS,EACT,aAAa,EACb,eAAe,EACf,gBAAgB,EAChB,cAAc,CAAC,CAAC;aACnB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;gBACvB,UAAU,EAAE,OAAO,CAAC,iBAAiB;aACtC,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAE,eAAe,CAAC,aAAa;gBACpC,QAAQ,EAAE,eAAe,CAAC,gBAAgB;gBAC1C,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;gBACvB,UAAU,EAAE,OAAO,CAAC,iBAAiB;aACtC,CAAC,CAAC;YACH,IAAM,wBAAwB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC9D,KAAK,EAAE,eAAe,CAAC,iBAAiB;gBACxC,QAAQ,EAAE,eAAe,CAAC,oBAAoB;gBAC9C,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;gBACvB,UAAU,EAAE,OAAO,CAAC,iBAAiB;aACtC,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,EAAE,wBAAwB,CAAC,CAAC,CAAC;YACrG,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,eAAe,CAAC,eAAe,EAAE,eAAe,CAAC,sBAAsB,CAAC,CAAC;gBAC7H,IAAI,QAAQ,EAAE;oBACZ,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;wBACtB,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACvD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,eAAe,CAAC,eAAe,EAAE,eAAe,CAAC,sBAAsB,CAAC,CAAC;gBAC7H,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAI,YAAY,CAAC,IAAI,CAAC,UAAC,SAAS,IAAK,OAAA,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,EAAE;oBAChE,OAAO;iBACR;gBACD,IAAM,WAAW,GAAG;oBAClB,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,eAAe,EAAE,QAAQ;oBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;iBAClC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBACH,IAAI,eAAe,CAAC,qBAAqB,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,KAAK,eAAe,CAAC,qBAAqB,EAAE;oBAC9G,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;iBAC3C;aACF,CAAC,CAAC;YAEH,wBAAwB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBAC3D,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,eAAe,CAAC,eAAe,EAAE,eAAe,CAAC,sBAAsB,CAAC,CAAC;gBAC7H,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;;gBAGD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,UAAC,SAAS,IAAK,OAAA,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAA,CAAC,EAAE;oBACjE,IAAM,WAAW,GAAG;wBAClB,EAAE,IAAA;wBACF,SAAS,EAAE,YAAY;wBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;qBAClC,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;oBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;iBACJ;gBAED,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;aAC3C,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAEO,iDAAgB,GAAhB,UAAiB,EAAE,EACF,QAAQ,EACR,iBAAiB,EACjB,SAAuB,EACvB,aAAa,EACb,eAAe,EACf,gBAAgB,EAChB,cAAuB;YAC9C,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC;gBAChC,QAAQ,EAAED,iBAAS,CAAC,MAAM;gBAC1B,eAAe,EAAE,QAAQ;gBACzB,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,iBAAiB,CAAC,IAAI,iCACjB,MAAM,KACT,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;YAEH,IAAM,UAAU,GAAG;gBACjB,EAAE,IAAA;gBACF,QAAQ,EAAED,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;aACvC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACpC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACnC,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;gBAC/B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;aAC7E;YACD,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC/B,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE,SAAS,EAAE,aAAa,EAAE,iBAAiB,EAAE,eAAe,EAAE,gBAAgB,CAAC,CAAC;YACtG,cAAc,GAAG,IAAI,CAAC;YACtB,OAAO,cAAc,CAAC;SACvB;QAED,qCAAI,GAAJ,UAAK,SAAuB,EAAE,OAAkC,EAAE,QAAc;YAAlD,wBAAA,EAAA,kCAAkC;YAAE,yBAAA,EAAA,cAAc;YAC9E,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;gBACxB,MAAM,IAAI,KAAK,CAAC,0EAA0E,CAAC,CAAC;aAC7F;YACD,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YACjD,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAqB;gBAC1D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YACH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,eAAe,EAAE,eAAe;aACjC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;YACH,OAAO,IAAI,CAAC,YAAY,CACtB,EAAE,EACF,SAAS,EACT,QAAQ,EACR,WAAW,EACX,eAAe,CAChB,CAAC;SACH;QAEO,6CAAY,GAAZ,UAAa,EAAU,EACV,SAAuB,EACvB,QAAgB,EAChB,WAAwC,EACxC,OAA4B,EAC5B,cAAyC;YALtD,iBA+HP;YAzHC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;YAE9E,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEtD,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAM,uBAAuB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC7D,KAAK,EAAE,OAAO,CAAC,gBAAgB;gBAC/B,QAAQ,EAAE,OAAO,CAAC,mBAAmB;gBACrC,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEA,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAE,OAAO,CAAC,cAAc;oBAC7B,UAAU,EAAE,YAAY;oBACxB,IAAI,EAAEA,mBAAW,CAAC,UAAU;oBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,QAAQ,UAAA;oBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;iBACnD,CAAC,CAAC;aACJ;YAED,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAACqB,aAAG,CAAC,UAAC,EAAsB;wBAAR,IAAI,mBAAA;oBAAS,OAAA,KAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBACxH,SAAS,CAAC,UAAC,EAA4D;wBAA1D,gBAA8C,EAAlC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;oBACpE,IAAM,eAAe,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,KAAK,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;oBAClG,IAAM,iBAAiB,GAAG,KAAI,CAAC,gBAAgB,CAAC,aAAa,EAAE,KAAK,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;oBACtG,IAAI,CAAC,eAAe,EAAE;wBACpB,OAAO;qBACR;oBAED,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;wBACxB,eAAe,EAAE,eAAe;wBAChC,eAAe,EAAE,iBAAiB;wBAClC,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;qBAC1E,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,qBAAqB,CAAC,IAAI,CACxBjC,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBAClH,SAAS,CAAC,UAAC,EAA6C;oBAA3C,gBAA+B,EAAnB,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACrD,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;gBAC7G,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAErC,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;oBACxB,eAAe,EAAE,QAAQ;oBACzB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;iBAC1E,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,KAAI,CAAC,oBAAoB,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;aACxF,CAAC,CAAC;YAEL,uBAAuB,CAAC,SAAS,CAAC,UAAC,EAAY;oBAAV,QAAQ,cAAA;gBAC3C,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAM,YAAY,YAAO,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;gBAChD,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;oBAC3B,OAAO;iBACR;gBACD,IAAM,KAAK,GAAG,YAAY,CAAC,SAAS,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAK,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,QAAsB,CAAC,GAAA,CAAC,CAAC;gBACrG,IAAI,KAAK,GAAG,CAAC,EAAE;oBACb,OAAO;iBACR;gBAED,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,KAAI,CAAC,WAAW,CAAC,EAAE,EAAE,OAAO,CAAC,eAAe,EAAE,OAAO,CAAC,sBAAsB,CAAC,CAAC;aAC/E,CAAC,CAAC;YAEH,IAAM,WAAW,GAAG,CAAC,qBAAqB,EAAE,uBAAuB,CAAC,CAAC;YACrE,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YACD,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACrD;QAEO,2CAAU,GAAV,UAAW,OAA4B;YAC7C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,wBAAwB,CAAC,CAAC,CAAC;YAC1E,IAAM,eAAe,GAAwB,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAClF,eAAe,CAAC,UAAU,mCAAO,wBAAwB,CAAC,UAAU,GAAK,OAAO,CAAC,UAAU,CAAC,CAAC;YAC7F,eAAe,CAAC,aAAa,mCAAO,wBAAwB,CAAC,aAAa,GAAK,OAAO,CAAC,aAAa,CAAC,CAAC;YACtG,eAAe,CAAC,sBAAsB,mCAAO,wBAAwB,CAAC,sBAAsB,GAAK,OAAO,CAAC,sBAAsB,CAAC,CAAC;YAEjI,IAAI,OAAO,CAAC,eAAe,EAAE;gBAC3B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,qBAAqB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,sBAAsB,EAAE;oBACvF,MAAM,IAAI,KAAK,CAAC,gFAAgF,CAAC,CAAC;iBACnG;gBAED,IAAI,IAAI,CAAC,WAAW,CAAC,oBAAoB,EAAE;oBACzC,OAAO,CAAC,IAAI,CAAC,kGAAkG,CAAC,CAAC;iBAClH;gBAED,IAAI,eAAe,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,KAAK,CAAC,IAAI,eAAe,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,KAAK,CAAC,EAAE;oBACvG,OAAO,CAAC,IAAI,CAAC,+FAA+F,CAAC,CAAC;iBAC/G;gBAED,eAAe,CAAC,SAAS,GAAG,KAAK,CAAC;gBAClC,eAAe,CAAC,aAAa,CAAC,aAAa,GAAG,IAAI,CAAC;gBACnD,eAAe,CAAC,UAAU,CAAC,eAAe,GAAG,eAAe,CAAC,sBAAsB,CAAC,cAAc;oBAChG,MAAM,CAAC,eAAe,CAAC,eAAe,GAAG,MAAM,CAAC,eAAe,CAAC,kBAAkB,CAAC;gBACrF,eAAe,CAAC,UAAU,CAAC,wBAAwB,GAAG,MAAM,CAAC,iBAAiB,CAAC;aAChF;YACD,OAAO,eAAe,CAAC;SACxB;QAGO,uDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAAkD;YAA9G,iBA+EP;YA7EC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAAC,MAGhB,EAAE,aAA6B;gBAC/C,IAAM,QAAQ,GAAG,KAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAC/C,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;gBAC5C,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAAa;gBACnD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,qEAAqE,CAAC,CAAC;iBACxF;gBAED,OAAO,cAAc,CAAC,IAAI,CAAC,CAAC;aAC7B,CAAC;YAEF,kBAAkB,CAAC,gBAAgB,GAAG,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAA,CAAC;YAE/D,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YAExF,OAAO,kBAA8C,CAAC;SACvD;QAEO,6CAAY,GAAZ,UAAa,EAAU;YAC7B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC/C,OAAO,QAAQ,CAAC,gBAAgB,EAAE,CAAC;SACpC;QAEO,0CAAS,GAAT,UAAU,EAAU;YAC1B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAC/C,OAAO,QAAQ,CAAC,aAAa,EAAE,CAAC;SACjC;;;;gBAlhBF7D,eAAU;;;;QCjFX;YAEE,cAAS,GAAkC,IAAI,GAAG,EAA4B,CAAC;SAuBhF;QArBC,wDAAsB,GAAtB,UAAuB,EAAU,EAAE,kBAAoC,EAAE,eAAiC,EACnF,mBAAwC,EAAE,eAAoC,EAAE,SAAwB;YAC7H,IAAM,gBAAgB,GAAG,IAAI,gBAAgB,CAC3C,EAAE,EACF,kBAAkB,EAClB,eAAe,EACf,mBAAmB,EACnB,eAAe,EACf,SAAS,CAAC,CAAC;YACb,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,EAAE,gBAAgB,CACtC,CAAC;SACH;QAED,qCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAC/B;QAED,uCAAK,GAAL;YACE,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAA,QAAQ,IAAI,OAAA,QAAQ,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YACvD,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;SACxB;;;;gBAxBFA,eAAU;;;;QCwFT,kCACU,eAAuC,EACvC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,gBAAyC,EACzC,aAA4B;YAL5B,oBAAe,GAAf,eAAe,CAAwB;YACvC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAf/B,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,mBAAc,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAC/C,oBAAe,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAcrD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,gBAAgB,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YACrI,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,gEAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAA0B;gBACnE,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,6CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,mDAAgB,GAAhB,UAAiB,QAA0B,EAAE,MAA0B,EAAE,MAAqB;YAC5F,MAAM,CAAC,SAAS,GAAG,QAAQ,CAAC,gBAAgB,EAAE,CAAC;YAC/C,MAAM,CAAC,MAAM,GAAG,QAAQ,CAAC,aAAa,EAAE,CAAC;YAEzC,IAAI,MAAM,EAAE;gBACV,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC;gBACzB,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;gBAC5D,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;YACnE,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;SAC7D;QAED,mDAAgB,GAAhB,UAAiB,QAA0B;YACzC,QAAQ,CAAC,MAAM,GAAG,EAAE,CAAC;YACrB,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC;SACnD;QAED,sDAAmB,GAAnB,UAAoB,MAA0B;YAC5C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,gBAAgB,CAAC,sBAAsB,CAC1C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,kBAAkB,EACvB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,eAAe,CACvB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,QAAQ,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACrD,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,QAAQ,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACrD,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC1C,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC9C,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,EAAE;wBACZ,QAAQ,CAAC,OAAO,EAAE,CAAC;wBACnB,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;wBAChC,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;qBACrC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;oBACxC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC7D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC7D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,oDAAiB,GAAjB,UAAkB,MAA0B;YAC1C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,gBAAgB,CAAC,sBAAsB,CAC1C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,kBAAkB,EACvB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,eAAe,EACtB,MAAM,CAAC,SAAS,CACjB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;wBACnC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;wBAChE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;wBACnC,QAAQ,CAAC,eAAe,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;wBAE9C,IAAI,MAAM,CAAC,YAAY,CAAC,kBAAkB,EAAE,EAAE;4BAC5C,QAAQ,CAAC,6BAA6B,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;4BAC5D,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;yBACzC;qBACF;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;wBACnC,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;wBAC1C,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,EAAE;wBACZ,QAAQ,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC5B,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,EAAE;wBACZ,QAAQ,CAAC,UAAU,GAAG,IAAI,CAAC;wBAC3B,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;wBACnC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACnE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBAED,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACtD,IAAI,QAAQ,IAAI,QAAQ,CAAC,UAAU,EAAE;wBACnC,QAAQ,CAAC,YAAY,EAAE,CAAC;wBACxB,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;qBACzC;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,8CAAW,GAAX;YACE,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;SAC/B;QAED,+CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,+CAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBA7RFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,kBAAkB;oBAC5B,QAAQ,WAAW,w9EA6DlB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,uBAAuB,CAAC;oBACzD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBAxEQ,sBAAsB;gBALtB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAGb,uBAAuB;gBAXvB,aAAa;;;kCA0FnBe,cAAS,SAAC,iBAAiB;qCAC3BA,cAAS,SAAC,oBAAoB;sCAC9BA,cAAS,SAAC,qBAAqB;;;;QCtFlC;YAEE,gBAAW,GAAoC,IAAI,GAAG,EAA8B,CAAC;SAuBtF;QArBC,2DAAwB,GAAxB,UAAyB,EAAU,EAAE,mBAAqC,EAAE,eAAiC,EACpF,mBAAwC,EAAE,qBAA6C,EACvF,SAAwB;YAC/C,IAAM,kBAAkB,GAAG,IAAI,kBAAkB,CAC/C,EAAE,EACF,mBAAmB,EACnB,eAAe,EACf,mBAAmB,EACnB,qBAAqB,EACrB,SAAS,CAAC,CAAC;YACb,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,EAAE,kBAAkB,CAAC,CAAC;SAC9C;QAED,sCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SACjC;QAED,wCAAK,GAAL;YACE,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YAC7D,IAAI,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC;SAC1B;;;;gBAxBFnD,eAAU;;;QCeE,0BAA0B,GAA0B;QAC/D,aAAa,EAAEM,mBAAW,CAAC,UAAU;QACrC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,eAAe,EAAE;YACf,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC;YACpD,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,QAAQ;YACf,YAAY,EAAE,CAAC;YACf,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;YAClD,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,MAAM,CAAC,UAAU,CAAC,QAAQ;SACpC;QACD,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;YACzB,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAkCA;YAGU,kBAAa,GAAG,IAAIkB,YAAO,EAAwB,CAAC;YACpD,oBAAe,GAAGL,iBAAO,EAAwB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAItE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;SA0VzE;QAxVC,sCAAI,GAAJ,UAAK,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,cAAwC;YAC3C,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,iBAAiB,GAAG,cAAc,CAAC;YACxC,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;SAChC;QAED,0CAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAED,wCAAM,GAAN,UAAO,OAAoC,EAAE,aAAmB;YAAhE,iBAoGC;YApGM,wBAAA,EAAA,oCAAoC;YAAE,8BAAA,EAAA,mBAAmB;YAC9D,IAAM,SAAS,GAAiB,EAAE,CAAC;YACnC,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,iBAAiB,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAEnD,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAuB;gBAClE,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,SAAS,WAAA;gBACT,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,iBAAiB,EAAE,iBAAiB;aACrC,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG;gBACrB,IAAM,UAAU,GAAG;oBACjB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACnC,IAAI,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;oBAC/B,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC7E;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,cAAc,CAAC,EAAE,EAAE,aAAa,EAAE,iBAAiB,EAAE,iBAAiB,EAAE,gBAAgB,CAAC,CAAC;gBAC/F,cAAc,GAAG,IAAI,CAAC;gBACtB,OAAO,cAAc,CAAC;aACvB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;aACxB,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAE,iBAAiB,CAAC,aAAa;gBACtC,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,QAAQ,EAAE,aAAa;aACxB,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,CAAC,CAAC,CAAC;YAC3E,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAAyB;oBAAb,WAAW,0BAAA;gBACtD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAE1E,IAAI,QAAQ,EAAE;oBACZ,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;wBACtB,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAAyB;oBAAb,WAAW,0BAAA;gBACrD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBAED,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;gBAExD,IAAM,WAAW,GAAG;oBAClB,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,eAAe,EAAE,QAAQ;oBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;iBAClC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAC1B,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;gBAEH,IAAI,CAAC,YAAY,EAAE;oBACjB,cAAc,GAAG,cAAc,EAAE,CAAC;iBACnC;aACF,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAED,sCAAI,GAAJ,UAAK,SAAuB,EAAE,OAAoC,EAAE,QAAc;YAApD,wBAAA,EAAA,oCAAoC;YAAE,yBAAA,EAAA,cAAc;YAChF,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,MAAM,IAAI,KAAK,CAAC,+EAA+E,GAAG,SAAS,CAAC,CAAC;aAC9G;YACD,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,qBAAqB,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YACvD,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAuB;gBAC5D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YACH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,iBAAiB,EAAE,qBAAqB;aACzC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAC1B,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;YACH,OAAO,IAAI,CAAC,cAAc,CACxB,EAAE,EACF,QAAQ,EACR,WAAW,EACX,qBAAqB,CACtB,CAAC;SACH;QAEO,gDAAc,GAAd,UAAe,EAAU,EACV,QAAgB,EAChB,WAA0C,EAC1C,OAA8B,EAC9B,cAA2C;YAJ1D,iBAsFP;YAjFC,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAE,OAAO,CAAC,cAAc;oBAC7B,UAAU,EAAE,kBAAkB;oBAC9B,IAAI,EAAEtD,mBAAW,CAAC,UAAU;oBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,QAAQ,UAAA;oBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YACD,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEA,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,qBAAqB,CAAC,IAAI,CACxBqB,aAAG,CAAC,UAAC,EAAkB;oBAAN,IAAI,mBAAA;gBAAO,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBAC/G,SAAS,CAAC,UAAC,EAAyC;oBAAxC,gBAA6B,EAAlB,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAG,QAAQ,cAAA;gBAClD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAErC,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;oBACxB,eAAe,EAAE,QAAQ;oBACzB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;iBAC1E,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAC1B,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;aACJ,CAAC,CAAC;YAEL,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAACjC,aAAG,CAAC,UAAC,EAAkB;wBAAN,IAAI,mBAAA;oBAAO,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBACrH,SAAS,CAAC,UAAC,EAAwD;wBAAvD,gBAA4C,EAAjC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAG,QAAQ,cAAA;oBACjE,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;oBACjF,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;oBACrF,IAAI,CAAC,eAAe,EAAE;wBACpB,OAAO;qBACR;oBAED,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;wBACxB,eAAe,EAAE,eAAe;wBAChC,eAAe,EAAE,iBAAiB;wBAClC,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;qBAC1E,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAC1B,KAAK,EAAE,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,IACxB,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,IAAM,WAAW,GAAG,CAAC,qBAAqB,CAAC,CAAC;YAC5C,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACrD;QAEO,4CAAU,GAAV,UAAW,OAA8B;YAC/C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAA0B,CAAC,CAAC,CAAC;YAC5E,IAAM,iBAAiB,GAAG,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAC/D,iBAAiB,CAAC,eAAe,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,0BAA0B,CAAC,eAAe,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC;YAC3H,iBAAiB,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,0BAA0B,CAAC,UAAU,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;YAC5G,OAAO,iBAAiB,CAAC;SAC1B;QAGO,wDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAA8B;YAA1F,iBAiFP;YAhFC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAAC,aAAyB,EACzB,cAA0B,EAC1B,WAAmB,EACnB,cAA2B,EAC3B,eAA4B;gBAC5D,IAAM,MAAM,GAAG,IAAI,SAAS,CAAC,EAAE,EAAE,aAAa,EAAE,cAAc,GAAG,cAAc,GAAG,0BAA0B,CAAC,UAAU,CAAC,CAAC;gBACzH,IAAM,IAAI,GAAG,IAAI,SAAS,CAAC,EAAE,EAAE,cAAc,EAAE,eAAe,GAAG,eAAe,GAAG,0BAA0B,CAAC,UAAU,CAAC,CAAC;gBAE1H,IAAM,UAAU,GAAG,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAClD,UAAU,CAAC,iBAAiB,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,WAAW,CAAC,CAAC;gBAC1D,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAAa;gBACnD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,sEAAsE,CAAC,CAAC;iBACzF;gBAED,OAAO,cAAc,EAAE,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,gBAAgB,GAAG,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAA,CAAC;YAC/D,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YACtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YACzF,kBAAkB,CAAC,eAAe,GAAG,cAAc,OAAA,KAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAA,CAAC;YAErE,OAAO,kBAAgD,CAAC;SACzD;QAEO,8CAAY,GAAZ,UAAa,EAAO;YAC1B,IAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAClD,OAAO,UAAU,CAAC,gBAAgB,EAAE,CAAC;SACtC;QAEO,2CAAS,GAAT,UAAU,EAAO;YACvB,IAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAClD,OAAO,UAAU,CAAC,aAAa,EAAE,CAAC;SACnC;QAEO,0CAAQ,GAAR,UAAS,EAAU;YACzB,IAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YAClD,OAAO,UAAU,CAAC,QAAQ,EAAE,CAAC;SAC9B;;;;gBAjWF7D,eAAU;;;;QCMT,mCACU,iBAA0C,EAC1C,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,kBAA4C;YAJ5C,sBAAiB,GAAjB,iBAAiB,CAAyB;YAC1C,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,uBAAkB,GAAlB,kBAAkB,CAA0B;YAZ/C,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,qBAAgB,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAYtD,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAC;YACrH,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,iEAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAA4B;gBACvE,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,8CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,oDAAgB,GAAhB,UAAiB,UAA8B,EAAE,MAA4B,EAAE,MAAqB;YAClG,MAAM,CAAC,SAAS,GAAG,UAAU,CAAC,gBAAgB,EAAE,CAAC;YACjD,MAAM,CAAC,MAAM,GAAG,UAAU,CAAC,aAAa,EAAE,CAAC;YAE3C,IAAI,MAAM,EAAE;gBACV,UAAU,CAAC,MAAM,GAAG,MAAM,CAAC;gBAC3B,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,UAAU,EAAE,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC;gBACjE,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,UAAU,CAAC,MAAM,CAAC,CAAC;YACvE,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,UAAU,EAAE,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC;SAClE;QAED,oDAAgB,GAAhB,UAAiB,UAA8B;YAC7C,UAAU,CAAC,MAAM,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,UAAU,EAAE,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC;SAClE;QAED,uDAAmB,GAAnB,UAAoB,MAA4B;YAC9C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAC9C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,oBAAoB,EACzB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,iBAAiB,CACzB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACvD,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,UAAU,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACvD,UAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC5C,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,EAAE;wBACd,UAAU,CAAC,OAAO,EAAE,CAAC;wBACrB,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;qBACnC;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;oBAC1C,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC/D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC/D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,qDAAiB,GAAjB,UAAkB,MAA4B;YAC5C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAC9C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,oBAAoB,EACzB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,iBAAiB,EACxB,MAAM,CAAC,SAAS,CACjB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,IAAI,UAAU,CAAC,UAAU,EAAE;wBACvC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;wBAClE,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,IAAI,UAAU,CAAC,UAAU,EAAE;wBACvC,UAAU,CAAC,YAAY,EAAE,CAAC;wBAC1B,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,EAAE;wBACd,UAAU,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC9B,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,EAAE;wBACd,UAAU,CAAC,UAAU,GAAG,IAAI,CAAC;wBAC7B,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,IAAI,UAAU,CAAC,UAAU,EAAE;wBACvC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACrE,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBAED,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBAC1D,IAAI,UAAU,IAAI,UAAU,CAAC,UAAU,EAAE;wBACvC,UAAU,CAAC,YAAY,EAAE,CAAC;wBAC1B,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;qBAC3C;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,+CAAW,GAAX;YACE,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,CAAC;SACjC;QAED,gDAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,gDAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBAnQFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,WAAW,+rFA2DlB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,wBAAwB,CAAC;oBAC1D,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBArEQ,uBAAuB;gBANvB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAEb,wBAAwB;;;kCA6E9Be,cAAS,SAAC,iBAAiB;uCAC3BA,cAAS,SAAC,sBAAsB;;;ICvEnC;;;;;QAaE,+BAAsC,QAAa,EAAU,WAA+B;YAAtD,aAAQ,GAAR,QAAQ,CAAK;YAAU,gBAAW,GAAX,WAAW,CAAoB;YAFpF,gBAAW,GAAG,IAAI3B,YAAO,EAAiB,CAAC;SAGlD;QAED,sDAAsB,GAAtB,UAAuB,mBAAwC;YAC7D,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;SAChD;QAED,oCAAI,GAAJ,UAAK,QAAgB,EAAE,KAAW;YAAlC,iBAyCC;YAxCC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE;gBAC7B,IAAM,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;gBAC/C,IAAI,YAAY,EAAE;oBAChB,IAAI,CAAC,mBAAmB,GAAG,YAAY,CAAC,sBAAsB,EAAE,CAAC;iBAClE;aACF;YACD,IAAI,CAAC,MAAM,EAAE,CAAC;YACd,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACjD,UAAU,CAAC,GAAG,GAAG,QAAQ,CAAC;YAC1B,UAAU,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;YACpC,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,QAAQ,CAAC;YACvC,UAAU,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YAChC,UAAU,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;YACjC,UAAU,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,MAAM,CAAC;YACvC,UAAU,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC;YACzC,UAAU,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,MAAM,CAAC;YAC9C,UAAU,CAAC,KAAK,CAAC,mBAAmB,CAAC,GAAG,MAAM,CAAC;YAC/C,UAAU,CAAC,KAAK,CAAC,qBAAqB,CAAC,GAAG,MAAM,CAAC;YACjD,UAAU,CAAC,KAAK,CAAC,iBAAiB,CAAC,GAAG,MAAM,CAAC;YAC7C,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;YACvC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAEtC,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC5B,IAAI,CAAC,cAAc,CAAC,SAAS,CAC3B,UAAC,CAAC;gBACA,UAAU,CAAC,KAAK,CAAC,UAAU,GAAG,SAAS,CAAC;gBACxC,UAAU,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,GAAG,UAAU,CAAC,WAAW,GAAG,CAAC,GAAG,IAAI,CAAC;gBAC/E,UAAU,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,GAAG,UAAU,CAAC,YAAY,GAAG,CAAC,GAAG,IAAI,CAAC;gBAC/E,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBACzB,IAAI,CAAC,CAAC,IAAI,EAAE;oBACV,UAAU,CAAC,MAAM,EAAE,CAAC;iBACrB;aACF,EACD,UAAC,CAAM;gBACL,UAAU,CAAC,MAAM,EAAE,CAAC;aACrB,EACD;gBACE,UAAU,CAAC,MAAM,EAAE,CAAC;aACrB,CACF,CAAC;SACH;QAED,2CAAW,GAAX;YACE,OAAO,IAAI,CAAC,WAAW,CAAC;SACzB;QAED,sCAAM,GAAN;YACE,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBACxB,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;gBACzB,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC;aACjC;SACF;QAEO,oDAAoB,GAApB;YAAA,iBAsCP;YArCC,IAAM,OAAO,GAAG,IAAIA,YAAO,EAAE,CAAC;YAC9B,IAAM,WAAW,GAAG,IAAIA,YAAO,EAAO,CAAC;YACvC,IAAM,SAAS,GAAGsC,cAAmB,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;YAC7D,IAAM,WAAW,GAAGA,cAAmB,CAAC,QAAQ,EAAE,aAAa,CAAC,CAAC;YAEjE,IAAI,kBAA0B,CAAC;YAC/B,IAAI,kBAA0B,CAAC;YAC/B,IAAI,QAAa,CAAC;YAClB,IAAM,cAAc,GAAG,WAAW,CAAC,IAAI,CAACpC,aAAG,CAAC,UAAC,CAAM;gBAC/C,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB,GAAG,CAAC,CAAC,CAAC,CAAC;gBACnE,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB,GAAG,CAAC,CAAC,CAAC,CAAC;gBACnE,QAAQ,GAAG;oBACT,IAAI,EAAE,KAAK;oBACX,qBAAqB,EAAE;wBACrB,CAAC,EAAE,kBAAkB;wBACrB,CAAC,EAAE,kBAAkB;qBACtB;oBACD,cAAc,EAAE;wBACd,CAAC,EAAE,CAAC,CAAC,CAAC;wBACN,CAAC,EAAE,CAAC,CAAC,CAAC;qBACP;oBACD,WAAW,EAAE,KAAI,CAAC,mBAAmB;wBACnC,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,EAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC,CAAC,GAAG,SAAS;iBAC5E,CAAC;gBACF,OAAO,QAAQ,CAAC;aACjB,CAAC,EACFH,mBAAS,CAAC,SAAS,CAAC,EACpBK,aAAG,CAAC,SAAS,EAAE,SAAS,EAAE;gBACxB,IAAI,QAAQ,EAAE;oBACZ,IAAM,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;oBAC9C,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;oBACtB,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBAC7B;aACF,CAAC,CAAG,CAAC;YAER,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC,IAAI,CAACV,eAAK,CAAC,WAAW,CAAC,EAAEK,mBAAS,CAAC,OAAO,CAAC,CAAG,CAAC;YACpF,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;SACxB;;;;gBA5GFvB,eAAU;;;gDAQII,WAAM,SAACY,eAAQ;gBAtBrB,kBAAkB;;;ICL3B;;;;;;;;;;;;;;;;;;;;;;;;;QA+BE,iCAAY,EAAc,EAAU,eAAsC;YAAtC,oBAAe,GAAf,eAAe,CAAuB;YACxE,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,MAAM,CAAC;YAC7C,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,GAAG,MAAM,CAAC;YAC/C,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,MAAM,CAAC;YACpD,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,mBAAmB,CAAC,GAAG,MAAM,CAAC;YACrD,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,qBAAqB,CAAC,GAAG,MAAM,CAAC;YACvD,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,iBAAiB,CAAC,GAAG,MAAM,CAAC;SACpD;QAED,0CAAQ,GAAR;YACE,IAAI,OAAO,IAAI,CAAC,cAAc,KAAK,QAAQ,EAAE;gBAC3C,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC;aAChC;iBAAM;gBACL,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC;gBACnC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC;aACxC;SACF;QAGD,6CAAW,GAAX;YACE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;SACjD;;;;gBA3BFqB,cAAS,SAAC,EAAC,QAAQ,EAAE,kBAAkB,EAAC;;;gBA5BrBP,eAAU;gBACrB,qBAAqB;;;iCA6B3BC,UAAK;8BAsBLgC,iBAAY,SAAC,WAAW;;;ICnC3B;;;;;;;;;;;;;;;;QA8DE,4BAAoB,OAAmB,EAAU,aAA4B;YAAzD,YAAO,GAAP,OAAO,CAAY;YAAU,kBAAa,GAAb,aAAa,CAAe;YAf7E,cAAS,GAAG,IAAI,CAAC;YAEjB,WAAM,GAAG,IAAIvD,iBAAY,EAAc,CAAC;YAExC,cAAS,GAAG;gBACV,WAAW,EAAE,EAAE;gBACf,UAAU,EAAE,EAAE;aACf,CAAC;SAQ+E;QAEjF,qCAAQ,GAAR;YACE,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,eAAe,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;YACtF,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;SACF;QAGD,wCAAW,GAAX,UAAY,OAAsB;YAChC,IAAI,OAAO,CAAC,SAAS,IAAI,OAAO,CAAC,SAAS,CAAC,YAAY,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,aAAa,EAAE;gBAC3F,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;YAED,IAAI,OAAO,CAAC,SAAS,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,YAAY,IAAI,OAAO,CAAC,SAAS,CAAC,aAAa,EAAE;gBAC3F,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;aACrC;SACF;QAED,wCAAW,GAAX;YACE,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACzB,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;aACrC;SACF;QAEO,8CAAiB,GAAjB;YAAA,iBAiBP;YAhBC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,IAAIsD,cAAmB,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;YAClG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,IAAIA,cAAmB,CAAC,QAAQ,EAAE,WAAW,CAA2B,CAAC;YAC1G,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAIA,cAAmB,CAAC,QAAQ,EAAE,SAAS,CAA2B,CAAC;YAEpG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK;gBACV,IAAI,CAAC,UAAU,CAAC,IAAI,CACjBnC,mBAAS,CAAC,cAAM,OAAA,KAAI,CAAC,UAAU,CAAC,IAAI,CAClCC,aAAG,CAAC,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EACrBL,mBAAS,CAAC,KAAI,CAAC,QAAQ,CAAC,CACzB,GAAA,CAAC,CACJ,CAAC;YAEf,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAC,KAAiB;gBAC7D,KAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,GAAM,KAAK,CAAC,CAAC,OAAI,CAAC;gBACvD,KAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAM,KAAK,CAAC,CAAC,OAAI,CAAC;aACvD,CAAC,CAAC;SACJ;;;;gBA1FFM,cAAS,SACR;oBACE,QAAQ,EAAE,YAAY;oBACtB,QAAQ,EAAE,oSAUT;oBAYD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;6BAXtC,4OAUR;iBAEF;;;gBAvDDN,eAAU;gBAWH,aAAa;;;+BA+CnBC,UAAK;4BAELA,UAAK;yBAELS,WAAM;;;;QCRP;SACC;;;;gBAxDFX,cAAS,SACR;oBACE,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,knDAgDT;iBACF;;;;ICpDH;;;;;;;;;;;;;;;;;QAkEE;YAFA,YAAO,GAAG,IAAIrB,iBAAY,EAAE,CAAC;SAG5B;QAED,2CAAQ,GAAR;SAEC;;;;gBAvDFqB,cAAS,SACR;oBACE,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,EAAE,yOAKT;oBAyBD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;6BAxBtC,imBAuBR;iBAEF;;;;0BAIAL,UAAK;8BAGLA,UAAK;4BAGLA,UAAK;0BAGLS,WAAM;;;ICvDT;;;;;;;;;;;;;;;;;;;;;;;;;QAyCE,kCAAoB,cAAsC,EAAU,mBAAwC;YAAxF,mBAAc,GAAd,cAAc,CAAwB;YAAU,wBAAmB,GAAnB,mBAAmB,CAAqB;YARnG,oBAAe,GAAyB,EAAE,CAAC;YAC3C,gBAAW,GAAgB,EAAE,CAAC;YAC9B,wBAAmB,GAAgB,EAAE,CAAC;YACtC,uBAAkB,GAAgB,EAAE,CAAC;SAM7C;QAED,yCAAM,GAAN,UACE,EAQmH;YATrH,iBA+GC;gBA9GC,qBAQ4B,EAAC,eAAe,EAAE,EAAE,EAAE,WAAW,EAAE,EAAE,EAAE,mBAAmB,EAAE,EAAE,EAAE,kBAAkB,EAAE,EAAE,EAAC,KAAA,EAPjH,uBAAoB,EAApB,eAAe,mBAAG,EAAE,KAAA,EACpB,mBAAgB,EAAhB,WAAW,mBAAG,EAAE,KAAA,EAChB,2BAAwB,EAAxB,mBAAmB,mBAAG,EAAE,KAAA,EACxB,0BAAuB,EAAvB,kBAAkB,mBAAG,EAAE,KAAA,EACvB,eAAe,qBAAA,EACf,gBAAgB,sBAAA,EAChB,cAAc,oBAAA;YAGhB,IAAM,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,+BACpC,SAAS,EAAE,KAAK,EAChB,UAAU,EAAE;oBACV,WAAW,EAAE,KAAK;oBAClB,SAAS,EAAE,CAAC;iBACb,EACD,aAAa,EAAE;oBACb,KAAK,EAAE,CAAC;iBACT,IACE,IAAI,CAAC,eAAe,GACpB,eAAe,EAClB,CAAC;YAEH,IAAI,cAAc,EAAE;gBAClB,GAAG,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC;aACvC;iBAAM,IAAI,IAAI,CAAC,cAAc,EAAE;gBAC9B,GAAG,CAAC,iBAAiB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;aAC5C;iBAAM;gBACL,GAAG,CAAC,iBAAiB,CAAC,UAAA,MAAM;oBAC1B,IAAM,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;oBACnC,IAAI,aAAa,GAAG,CAAC,CAAC;oBACtB,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;wBACxC,OAAO,EAAE,CAAC;qBACX;oBACD,OAAO,CAAC,MAAM,CAAC,QAAQ,KAAKoB,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,UAAU,KAAKC,mBAAW,CAAC,cAAc;mCACtF,SAAS,GAAE,MAAM,CAAC,eAAe,KACrC,SAAS,EACb,MAAM,CACN,UAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK;wBAC7B,IAAI,KAAK,KAAK,CAAC,EAAE;4BACf,IAAM,gBAAgB,GAAG,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;4BAC1C,IAAM,OAAO,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;4BACxF,IAAM,QAAQ,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,CAAC,gBAAgB,EAAE,QAAQ,CAAC,GAAG,IAAI,CAAC;4BAC/E,MAAM,CAAC,IAAI,2DAEP,IAAI,EACF,CAAC,eAAe,IAAI,eAAe,CAAC,OAAO,CAAC;qCAC3C,KAAI,CAAC,eAAe,IAAI,KAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;oCACpD,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,WAAG,EAC1B,KAAK,EAAE,GAAG,EACV,IAAI,EAAE,gBAAgB,EACtB,WAAW,EAAE,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAC3C,QAAQ,EAAE,IAAI,MAAM,CAAC,UAAU,CAC7B,CAAC,QAAQ,CAAC,CAAC,GAAG,gBAAgB,CAAC,CAAC,IAAI,CAAC,EACrC,CAAC,QAAQ,CAAC,CAAC,GAAG,gBAAgB,CAAC,CAAC,IAAI,CAAC,EACrC,CAAC,QAAQ,CAAC,CAAC,GAAG,gBAAgB,CAAC,CAAC,IAAI,CAAC,CACtC,EACD,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAC7B,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAChC,cAAc,EAAE,IAAI,IAChB,KAAI,CAAC,WAAmB,GACxB,WAAmB,GACnB,KAAI,CAAC,kBAA0B,GAC/B,kBAA0B,6DAG9B,IAAI,EACF,CAAC,gBAAgB,IAAI,gBAAgB,CAAC,aAAa,GAAG,QAAQ,CAAC;qCAC9D,KAAI,CAAC,gBAAgB,IAAI,KAAI,CAAC,gBAAgB,CAAC,aAAa,GAAG,QAAQ,CAAC,CAAC;oCACvE,CAAC,aAAa,GAAG,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC,QAAK,EAC/C,KAAK,EAAE,GAAG,EACV,IAAI,EAAE,gBAAgB,EACtB,WAAW,EAAE,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAC3C,QAAQ,EAAE,QAAQ,EAClB,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAC7B,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAChC,cAAc,EAAE,IAAI,IAChB,KAAI,CAAC,WAAmB,GACxB,WAAmB,GACnB,KAAI,CAAC,mBAA2B,GAChC,mBAA2B,EAElC,CAAC;4BAEF,aAAa,IAAI,QAAQ,CAAC;yBAC3B;wBAED,OAAO,MAAM,CAAC;qBACf,EACD;kFAEI,IAAI,EAAE,CAAC,gBAAgB,IAAI,gBAAgB,CAAC,CAAC,CAAC,MAAM,KAAI,CAAC,gBAAgB,IAAI,KAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,MAAM,EAChH,KAAK,EAAE,GAAG,EACV,IAAI,EAAE,gBAAgB,EACtB,WAAW,EAAE,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAC3C,QAAQ,EAAE,SAAS,CAAC,CAAC,CAAC,EACtB,SAAS,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAC7B,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,EAChC,cAAc,EAAE,IAAI,IAChB,KAAI,CAAC,WAAmB,GACxB,WAAmB,GACnB,KAAI,CAAC,mBAA2B,GAChC,mBAA2B;qBAElC,CACF,CAAC;iBACH,CAAC,CAAC;aACJ;YAED,OAAO,GAAG,CAAC;SACZ;;;;gBAnIFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,EAAE,iDAET;oBACD,eAAe,EAAEO,4BAAuB,CAAC,MAAM;oBAC/C,SAAS,EAAE,CAAC,sBAAsB,CAAC;iBACpC;;;gBAjCQ,sBAAsB;gBAPtB,mBAAmB;;;kCA0CzBL,UAAK;8BACLA,UAAK;sCACLA,UAAK;qCACLA,UAAK;kCACLA,UAAK;mCACLA,UAAK;iCACLA,UAAK;;;ICER,WAAY,YAAY;QACtB,+CAAQ,CAAA;QACR,mDAAU,CAAA;QACV,iDAAS,CAAA;IACX,CAAC,EAJWiC,oBAAY,KAAZA,oBAAY,QAIvB;;QAIC,gCACU,WAA+B,EAC3B,aAA4B,EAC5B,aAA4B;YAFhC,gBAAW,GAAX,WAAW,CAAoB;YAQjC,qBAAgB,GAAG,IAAI,GAAG,EAAoB,CAAC;YAC/C,mBAAc,GAAG;gBACvB,0BAA0B,EAAE,GAAG;gBAC/B,YAAY,EAAE,EAAE;gBAChB,WAAW,EAAE,2BAA2B;gBACxC,eAAe,EAAE,iBAAiB;gBAClC,iBAAiB,EAAE,IAAI;gBACvB,SAAS,EAAE,CAAC;gBACZ,YAAY,EAAE,IAAI;gBAClB,WAAW,EAAEA,oBAAY,CAAC,IAAI;aAC/B,CAAC;SAfE;QAiBJ,qCAAI,GAAJ,UAAK,aAA4B,EAAE,aAA4B;YAC7D,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;SACpC;QAED,yCAAQ,GAAR,UACE,OAWM,EACN,KAAc;YAbhB,iBA6IC;YA5IC,wBAAA,EAAA,YAWM;YAGN,IAAI,CAAC,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,IAAI,CAAC,aAAa,KAAK,CAAC,KAAK,EAAE;gBAC1D,MAAM,IAAI,KAAK,CAAC,qEAAqE,CAAC,CAAC;aACxF;YACD,IAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;YACrE,IAAI,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;YACvC,IAAI,YAAY,CAAC;YACjB,IAAI,GAAG,CAAC;YACR,IAAI,IAAI,CAAC,aAAa,EAAE;gBACtB,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,SAAS,CAAC;gBACxD,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;aACnC;YACD,IAAI,KAAK,EAAE;gBACT,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;gBACrC,IAAI,CAAC,GAAG,EAAE;oBACR,MAAM,IAAI,KAAK,CAAC,4BAA0B,KAAO,CAAC,CAAC;iBACpD;gBACD,aAAa,GAAG,GAAG,CAAC,gBAAgB,EAAE,CAAC;gBACvC,YAAY,GAAG,GAAG,CAAC,eAAe,EAAE,CAAC,SAAS,CAAC;aAChD;YAED,IAAI,CAAC,aAAa,IAAI,CAAC,YAAY,EAAE;gBACnC,MAAM,IAAI,KAAK,CAAC,qEAAqE,CAAC,CAAC;aACxF;YACD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACpB,IAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAChD,YAAY,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;YACzC,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;YACtC,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;YAC/B,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;YAChC,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;YAC1B,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;YAC3B,YAAY,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YACpC,IAAM,WAAW,GAAa,EAAE,SAAS,WAAA,EAAE,CAAC;YAC5C,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,KAAK,EAAE,EAAE,WAAW,CAAC,CAAC;YACrF,IAAI,KAAK,GAAG;gBACV,IAAI,EAAE,CAAC;gBACP,IAAI,EAAE,CAAC;gBACP,MAAM,EAAE,CAAC;gBACT,MAAM,EAAE,CAAC;aACV,CAAC;YACF,IAAI,aAAsC,CAAC;YAE3C,SAAS,CAAC,WAAW,GAAG,UAAA,CAAC;gBACvB,IAAI,CAAC,CAAC,MAAM,KAAK,YAAY,CAAC,WAAW,EAAE;oBACzC,OAAO;iBACR;gBACD,IAAI,CAAC,aAAa,EAAE;oBAClB,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,EAAE;wBAC9B,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;qBACtB;oBAED,IAAM,IAAI,GAAI,CAAC,CAAC,aAAqB,CAAC,qBAAqB,EAAE,CAAC;oBAC9D,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC;oBACtC,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;oBACrC,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;oBACvB,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;oBACvB,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;oBAC9C,aAAa,CAAC,SAAS,GAAG,0BAA0B,CAAC;oBACrD,aAAa,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;oBAC1C,aAAa,CAAC,KAAK,CAAC,MAAM,GAAG,YAAY,CAAC,WAAW,CAAC;oBACtD,aAAa,CAAC,KAAK,CAAC,eAAe,GAAG,YAAY,CAAC,eAAe,CAAC;oBACnE,aAAa,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;oBAC/C,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;oBAC9C,SAAS,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;oBACrC,WAAW,CAAC,aAAa,GAAG,aAAa,CAAC;iBAC3C;aACF,CAAC;YAEF,SAAS,CAAC,SAAS,GAAG,UAAA,CAAC;gBACrB,IAAI,aAAa,EAAE;oBACjB,IAAI,WAAW,SAAA,CAAC;oBAChB,IAAI,KAAK,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,YAAY,CAAC,SAAS,EAAE;wBAC/G,WAAW,GAAG,KAAI,CAAC,qBAAqB,CACtC,aAAa,EACb,KAAK,EACL,YAAY,CAAC,0BAA0B,EACvC,YAAY,CACb,CAAC;qBACH;oBACD,aAAa,CAAC,MAAM,EAAE,CAAC;oBACvB,aAAa,GAAG,SAAS,CAAC;oBAC1B,WAAW,CAAC,aAAa,GAAG,SAAS,CAAC;oBACtC,KAAK,GAAG;wBACN,IAAI,EAAE,CAAC;wBACP,IAAI,EAAE,CAAC;wBACP,MAAM,EAAE,CAAC;wBACT,MAAM,EAAE,CAAC;qBACV,CAAC;oBACF,IAAI,CAAC,CAAC,YAAY,CAAC,UAAU,EAAE;wBAC7B,YAAY,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;qBAC9B;oBACD,IAAI,YAAY,CAAC,iBAAiB,IAAI,WAAW,EAAE;wBACjD,KAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;qBACrB;iBACF;aACF,CAAC;YAEF,SAAS,CAAC,WAAW,GAAG,UAAA,CAAC;gBACvB,IAAI,aAAa,EAAE;oBACjB,IAAM,IAAI,GAAI,CAAC,CAAC,aAAqB,CAAC,qBAAqB,EAAE,CAAC;oBAC9D,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC;oBACtC,IAAM,OAAO,GAAG,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;oBACrC,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;oBACrB,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;oBACrB,aAAa,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;oBACvE,aAAa,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;oBACxE,aAAa,CAAC,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;oBACrE,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;iBACrE;aACF,CAAC;YAEF,IAAM,kBAAkB,GAAG,UAAA,CAAC;gBAC1B,IAAI,CAAC,CAAC,OAAO,KAAK,YAAY,CAAC,YAAY,IAAI,aAAa,EAAE;oBAC5D,aAAa,CAAC,MAAM,EAAE,CAAC;oBACvB,aAAa,GAAG,SAAS,CAAC;oBAC1B,WAAW,CAAC,aAAa,GAAG,SAAS,CAAC;oBACtC,KAAK,GAAG;wBACN,IAAI,EAAE,CAAC;wBACP,IAAI,EAAE,CAAC;wBACP,MAAM,EAAE,CAAC;wBACT,MAAM,EAAE,CAAC;qBACV,CAAC;iBACH;aACF,CAAC;YACF,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,kBAAkB,CAAC,CAAC;YACzD,WAAW,CAAC,sBAAsB,GAAG,kBAAkB,CAAC;SACzD;QAED,wCAAO,GAAP,UAAQ,KAAc;YACpB,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,CAAC,KAAK,EAAE;gBACjC,MAAM,IAAI,KAAK,CAAC,+EAA+E,CAAC,CAAC;aAClG;YACD,IAAM,IAAI,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,KAAK,IAAI,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC;YACrF,IAAI,IAAI,EAAE;gBACR,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;gBACxB,IAAI,IAAI,CAAC,aAAa,EAAE;oBACtB,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC;iBAC7B;gBACD,IAAI,IAAI,CAAC,sBAAsB,EAAE;oBAC/B,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,IAAI,CAAC,sBAAsB,CAAC,CAAC;iBACtE;aACF;YACD,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SACrC;QAEO,sDAAqB,GAArB,UACN,aAA4B,EAC5B,SAAyE,EACzE,iBAAiB,EACjB,OAAO;YAEP,IAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC;YACzC,IAAM,UAAU,GAAG,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC;YACtF,IAAM,UAAU,GAAG,MAAM,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,IAAI,EAAE,CAAC,EAAE,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC;YAClF,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,EAAE;gBAC9B,OAAO,KAAK,CAAC;aACd;YACD,IAAM,aAAa,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YACpE,IAAM,aAAa,GAAG,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YACpE,aAAa,CAAC,WAAW,CAAC;gBACxB,WAAW,EAAE,IAAI,MAAM,CAAC,SAAS,CAC/B,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,SAAS,EAAE,aAAa,CAAC,SAAS,CAAC,EAC1D,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,EAAE,aAAa,CAAC,QAAQ,CAAC,EACxD,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,SAAS,EAAE,aAAa,CAAC,SAAS,CAAC,EAC1D,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,QAAQ,EAAE,aAAa,CAAC,QAAQ,CAAC,CACzD;gBACD,WAAW,EAAE,OAAO,CAAC,YAAY,GAAG,EAAE,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,GAAG,SAAS;gBAC3E,QAAQ,EAAE,iBAAiB;aAC5B,CAAC,CAAC;YACH,OAAO,IAAI,CAAC;SACb;;;;gBArNFhE,eAAU;;;gBAxDF,kBAAkB;gBAClB,aAAa,uBA2DjBE,aAAQ;gBA1DJ,aAAa,uBA2DjBA,aAAQ;;;;QCvDb;YAEE,eAAU,GAAmC,IAAI,GAAG,EAA6B,CAAC;SAmCnF;QAjCC,0DAAuB,GAAvB,UACE,EAAU,EACV,mBAAqC,EACrC,eAAiC,EACjC,mBAAwC,EACxC,gBAAuC,EACvC,SAAwB;YAExB,IAAM,iBAAiB,GAAG,IAAI,iBAAiB,CAC7C,EAAE,EACF,eAAe,EACf,mBAAmB,EACnB,mBAAmB,EACnB,gBAAgB,EAChB,SAAS,CACV,CAAC;YAEF,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,EAAE,iBAAiB,CAAC,CAAC;SAC5C;QAED,0CAAO,GAAP,UAAQ,EAAU;YAChB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;YAClC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SAC5B;QAED,sCAAG,GAAH,UAAI,EAAU;YACZ,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;SAChC;QAED,wCAAK,GAAL;YACE,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;YAC1D,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SACzB;;;;gBApCFF,eAAU;;;QCgBE,yBAAyB,GAAyB;QAC7D,aAAa,EAAEM,mBAAW,CAAC,UAAU;QACrC,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,cAAc,EAAEA,mBAAW,CAAC,eAAe;QAC3C,SAAS,EAAE,IAAI;QACf,UAAU,EAAE;YACV,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;YACzB,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC;YAC/C,YAAY,EAAE,CAAC;YACf,SAAS,EAAE,EAAE;YACb,qBAAqB,EAAE,CAAC;YACxB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,IAAI;YACjB,wBAAwB,EAAE,MAAM,CAAC,iBAAiB;SACnD;QACD,cAAc,EAAE;YACd,MAAM,EAAE,CAAC;YACT,cAAc,EAAE,CAAC;YACjB,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC;YACpD,IAAI,EAAE,IAAI;YACV,kBAAkB,EAAE,MAAM,CAAC,kBAAkB,CAAC,IAAI;YAClD,OAAO,EAAE,IAAI;YACb,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK;YAChC,MAAM,EAAE,CAAC;SACV;QACD,eAAe,EAAE,KAAK;QACtB,sBAAsB,EAAE;YACtB,cAAc,EAAE,KAAK;SACtB;MACD;IAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCA;YAGU,kBAAa,GAAG,IAAIkB,YAAO,EAAuB,CAAC;YACnD,oBAAe,GAAGL,iBAAO,EAAuB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAIrE,mBAAc,GAAG,IAAI,GAAG,EAAuC,CAAC;SA0WzE;QAvWC,sCAAI,GAAJ,UAAK,gBAAyC,EACzC,mBAAwC,EACxC,aAA4B,EAC5B,iBAA2C,EAC3C,YAA2B;YAE9B,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;YAC/C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;YACnC,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;YAC3C,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YAE/B,IAAI,CAAC,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,CAAC;SAC5C;QAED,0CAAQ,GAAR;YACE,OAAO,IAAI,CAAC,eAAe,CAAC;SAC7B;QAED,wCAAM,GAAN,UAAO,OAAmC,EAAE,QAAc;YAA1D,iBAmGC;YAnGM,wBAAA,EAAA,mCAAmC;YAAE,yBAAA,EAAA,cAAc;YACxD,IAAM,SAAS,GAAiB,EAAE,CAAC;YACnC,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,gBAAgB,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAElD,IAAM,iBAAiB,GAAG,IAAIwC,oBAAe,CAAsB;gBACjE,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,MAAM;aAC3B,CAAC,CAAC;YACH,IAAI,cAAc,GAAG,KAAK,CAAC;YAE3B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC;gBACtB,EAAE,IAAA;gBACF,SAAS,WAAA;gBACT,QAAQ,EAAEA,iBAAS,CAAC,MAAM;gBAC1B,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,gBAAgB,EAAE,gBAAgB;aACnC,CAAC,CAAC;YAEH,IAAM,cAAc,GAAG;gBACrB,IAAM,UAAU,GAAG;oBACjB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,UAAU,EAAEC,mBAAW,CAAC,cAAc;iBACvC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACpC,iBAAiB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACnC,IAAI,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;oBAC/B,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC7E;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,gBAAgB,CAAC,CAAC;gBACnG,cAAc,GAAG,IAAI,CAAC;gBACtB,OAAO,cAAc,CAAC;aACvB,CAAC;YAEF,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAEvD,mBAAW,CAAC,UAAU;gBAC7B,IAAI,EAAEC,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YACH,IAAM,oBAAoB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC1D,KAAK,EAAE,gBAAgB,CAAC,aAAa;gBACrC,IAAI,EAAEA,mBAAW,CAAC,OAAO;gBACzB,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;aACT,CAAC,CAAC;YAEH,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,qBAAqB,EAAE,oBAAoB,CAAE,CAAC,CAAC;YAC5E,IAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,CAAC,iBAAiB,EAAE,EAAE,EAAE,cAAc,CAAC,CAAC;YAE5F,qBAAqB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACxD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAE1E,IAAI,QAAQ,EAAE;oBACZ,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;wBACtB,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEqD,iBAAS,CAAC,MAAM;wBAC1B,eAAe,EAAE,QAAQ;wBACzB,UAAU,EAAEC,mBAAW,CAAC,UAAU;qBACnC,CAAC,CAAC;iBACJ;aACF,CAAC,CAAC;YAEH,oBAAoB,CAAC,SAAS,CAAC,UAAC,EAA6B;oBAAf,WAAW,0BAAA;gBACvD,IAAI,cAAc,EAAE;oBAClB,OAAO;iBACR;gBACD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;gBAC3C,IAAM,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;gBAExD,IAAM,WAAW,GAAG;oBAClB,EAAE,IAAA;oBACF,SAAS,EAAE,YAAY;oBACvB,QAAQ,EAAED,iBAAS,CAAC,MAAM;oBAC1B,eAAe,EAAE,QAAQ;oBACzB,UAAU,EAAEC,mBAAW,CAAC,SAAS;iBAClC,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBACrC,iBAAiB,CAAC,IAAI,iCACjB,WAAW,KACd,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;gBAEH,IAAI,CAAC,YAAY,EAAE;oBACjB,cAAc,GAAG,cAAc,EAAE,CAAC;iBACnC;aAEF,CAAC,CAAC;YAEH,OAAO,gBAAgB,CAAC;SACzB;QAED,sCAAI,GAAJ,UAAK,SAAuB,EAAE,OAAmC,EAAE,QAAc;YAAnD,wBAAA,EAAA,mCAAmC;YAAE,yBAAA,EAAA,cAAc;YAC/E,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1B,MAAM,IAAI,KAAK,CAAC,4EAA4E,CAAC,CAAC;aAC/F;YACD,IAAM,EAAE,GAAG,WAAW,EAAE,CAAC;YACzB,IAAM,gBAAgB,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAClD,IAAM,WAAW,GAAG,IAAIF,oBAAe,CAAsB;gBAC3D,EAAE,IAAA;gBACF,UAAU,EAAE,IAAI;gBAChB,QAAQ,EAAEC,iBAAS,CAAC,IAAI;aACzB,CAAC,CAAC;YACH,IAAM,MAAM,GAAG;gBACb,EAAE,IAAA;gBACF,SAAS,EAAE,SAAS;gBACpB,QAAQ,EAAEA,iBAAS,CAAC,IAAI;gBACxB,UAAU,EAAEC,mBAAW,CAAC,IAAI;gBAC5B,gBAAgB,EAAE,gBAAgB;aACnC,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;YACH,OAAO,IAAI,CAAC,aAAa,CACvB,EAAE,EACF,SAAS,EACT,QAAQ,EACR,WAAW,EACX,gBAAgB,CACjB,CAAC;SACH;QAEO,+CAAa,GAAb,UAAc,EAAU,EACZ,SAAuB,EACvB,QAAgB,EAChB,WAAyC,EACzC,OAA6B,EAC7B,cAA0C;YALtD,iBAuFP;YAhFC,IAAM,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;gBAC3D,KAAK,EAAE,OAAO,CAAC,cAAc;gBAC7B,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAEtD,mBAAW,CAAC,UAAU;gBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;gBACrC,QAAQ,UAAA;gBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,cAAc,GAAA;aACnD,CAAC,CAAC;YAEH,IAAI,qBAAqB,CAAC;YAC1B,IAAI,OAAO,CAAC,SAAS,EAAE;gBACrB,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;oBACrD,KAAK,EAAE,OAAO,CAAC,cAAc;oBAC7B,UAAU,EAAE,iBAAiB;oBAC7B,IAAI,EAAEA,mBAAW,CAAC,UAAU;oBAC5B,UAAU,EAAE,OAAO,CAAC,iBAAiB;oBACrC,QAAQ,UAAA;oBACR,UAAU,EAAE,UAAA,MAAM,IAAI,OAAA,EAAE,KAAK,MAAM,CAAC,EAAE,GAAA;iBACvC,CAAC,CAAC;aACJ;YAED,qBAAqB,CAAC,IAAI,CACxBqB,aAAG,CAAC,UAAC,EAAsB;oBAAR,IAAI,mBAAA;gBAAS,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;aAAA,CAAC,CAAC;iBACnH,SAAS,CAAC,UAAC,EAA6C;oBAA3C,gBAA+B,EAAnB,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;gBACrD,IAAM,QAAQ,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBAC1E,IAAI,CAAC,QAAQ,EAAE;oBACb,OAAO;iBACR;gBACD,IAAM,KAAK,GAAc,QAAQ,CAAC,CAAC,CAAC,CAAC;gBAErC,IAAM,MAAM,GAAG;oBACb,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;oBACxB,eAAe,EAAE,QAAQ;oBACzB,YAAY,EAAE,KAAK;oBACnB,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;iBAC1E,CAAC;gBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;aACJ,CAAC,CAAC;YAEL,IAAI,qBAAqB,EAAE;gBACzB,qBAAqB;qBAClB,IAAI,CAACjC,aAAG,CAAC,UAAC,EAAsB;wBAAR,IAAI,mBAAA;oBAAS,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,UAAU,IAAI,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC;iBAAA,CAAC,CAAC;qBACzH,SAAS,CAAC,UAAC,EAA4D;wBAA1D,gBAA8C,EAAlC,aAAa,mBAAA,EAAE,WAAW,iBAAA,EAAE,IAAI,UAAA,EAAI,QAAQ,cAAA;oBACpE,IAAM,eAAe,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;oBACjF,IAAM,iBAAiB,GAAG,KAAI,CAAC,mBAAmB,CAAC,kBAAkB,CAAC,aAAa,CAAC,CAAC;oBACrF,IAAI,CAAC,eAAe,EAAE;wBACpB,OAAO;qBACR;oBAED,IAAM,MAAM,GAAG;wBACb,EAAE,IAAA;wBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;wBAChC,QAAQ,EAAEgC,iBAAS,CAAC,IAAI;wBACxB,eAAe,EAAE,eAAe;wBAChC,eAAe,EAAE,iBAAiB;wBAClC,UAAU,EAAE,IAAI,GAAGC,mBAAW,CAAC,iBAAiB,GAAGA,mBAAW,CAAC,UAAU;qBAC1E,CAAC;oBACF,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBAChC,WAAW,CAAC,IAAI,iCACX,MAAM,KACT,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChC,MAAM,EAAE,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAC1B,CAAC;iBACJ,CAAC,CAAC;aACN;YAED,IAAM,WAAW,GAAG,CAAC,qBAAqB,CAAC,CAAC;YAC5C,IAAI,qBAAqB,EAAE;gBACzB,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;aACzC;YAED,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;YACzC,OAAO,cAAc,IAAI,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;SACvE;QAEO,4CAAU,GAAV,UAAW,OAA6B;YAC9C,IAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,yBAAyB,CAAC,CAAC,CAAC;YAC3E,IAAM,gBAAgB,GAAyB,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YACpF,gBAAgB,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,yBAAyB,CAAC,UAAU,EAAE,OAAO,CAAC,UAAU,CAAC,CAAC;YAC1G,gBAAgB,CAAC,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,yBAAyB,CAAC,cAAc,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;YAEtH,IAAI,OAAO,CAAC,eAAe,EAAE;gBAC3B,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,qBAAqB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,sBAAsB,EAAE;oBACvF,MAAM,IAAI,KAAK,CAAC,gFAAgF,CAAC,CAAC;iBACnG;gBAED,IAAI,IAAI,CAAC,WAAW,CAAC,oBAAoB,EAAE;oBACzC,OAAO,CAAC,IAAI,CAAC,kGAAkG,CAAC,CAAC;iBAClH;gBAED,IAAI,gBAAgB,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,KAAK,CAAC,IAAI,gBAAgB,CAAC,UAAU,CAAC,YAAY,CAAC,KAAK,KAAK,CAAC,EAAE;oBACzG,OAAO,CAAC,IAAI,CAAC,+FAA+F,CAAC,CAAC;iBAC/G;gBAED,gBAAgB,CAAC,UAAU,CAAC,eAAe,GAAI,gBAAgB,CAAC,sBAAsB,CAAC,cAAc;oBACnG,MAAM,CAAC,eAAe,CAAC,eAAe,GAAG,MAAM,CAAC,eAAe,CAAC,kBAAkB,CAAC;gBACrF,gBAAgB,CAAC,UAAU,CAAC,wBAAwB,GAAG,MAAM,CAAC,iBAAiB,CAAC;aACjF;YACD,OAAO,gBAAgB,CAAC;SACzB;QAGO,wDAAsB,GAAtB,UAAuB,kBAAuB,EAAE,EAAU,EAAE,cAA8B;YAA1F,iBA+EP;YA9EC,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,IAAM,WAAW,GAAG,KAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAChD,IAAI,WAAW,EAAE;oBACf,WAAW,CAAC,OAAO,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,OAAO,EAAE,GAAA,CAAC,CAAC;iBAC3C;gBACD,KAAI,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YACF,kBAAkB,CAAC,MAAM,GAAG;gBAC1B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,MAAM;iBAC/B,CAAC,CAAC;aACJ,CAAC;YACF,kBAAkB,CAAC,OAAO,GAAG;gBAC3B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,SAAS,EAAE,KAAI,CAAC,YAAY,CAAC,EAAE,CAAC;oBAChC,QAAQ,EAAED,iBAAS,CAAC,IAAI;oBACxB,UAAU,EAAEC,mBAAW,CAAC,OAAO;iBAChC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,WAAW,GAAG,UAAC,aAAyB,EACzB,cAA0B,EAC1B,cAA2B,EAC3B,eAA4B;gBAC5D,IAAM,MAAM,GAAG,IAAI,SAAS,CAAC,EAAE,EAAE,aAAa,EAAE,cAAc,GAAG,cAAc,GAAG,yBAAyB,CAAC,UAAU,CAAC,CAAC;gBACxH,IAAM,IAAI,GAAG,IAAI,SAAS,CAAC,EAAE,EAAE,cAAc,EAAE,eAAe,GAAG,eAAe,GAAG,yBAAyB,CAAC,UAAU,CAAC,CAAC;gBAEzH,IAAM,SAAS,GAAG,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBACjD,SAAS,CAAC,iBAAiB,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;gBAC5C,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,YAAY;iBACrC,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,iBAAiB,GAAG,UAAC,QAAa;gBACnD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,+BAA+B;oBACvD,cAAc,EAAE,QAAQ;iBACzB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,YAAY,GAAG,UAAC,MAAoB;gBACrD,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC;oBACtB,EAAE,IAAA;oBACF,QAAQ,EAAED,iBAAS,CAAC,cAAc;oBAClC,UAAU,EAAEC,mBAAW,CAAC,kBAAkB;oBAC1C,YAAY,EAAE,MAAM;iBACrB,CAAC,CAAC;aACJ,CAAC;YAEF,kBAAkB,CAAC,cAAc,GAAG;gBAClC,IAAI,CAAC,cAAc,EAAE;oBACnB,MAAM,IAAI,KAAK,CAAC,sEAAsE,CAAC,CAAC;iBACzF;gBAED,OAAO,cAAc,EAAE,CAAC;aACzB,CAAC;YAEF,kBAAkB,CAAC,gBAAgB,GAAG,cAAM,OAAA,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAA,CAAC;YAE/D,kBAAkB,CAAC,YAAY,GAAG,cAAM,OAAA,kBAAkB,CAAC,QAAQ,EAAE,GAAA,CAAC;YAEtE,kBAAkB,CAAC,SAAS,GAAG,cAAoB,OAAA,KAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,MAAM,GAAA,CAAC;YAEzF,OAAO,kBAA+C,CAAC;SACxD;QAEO,8CAAY,GAAZ,UAAa,EAAO;YAC1B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACjD,OAAO,SAAS,CAAC,gBAAgB,EAAE,CAAC;SACrC;QAEO,2CAAS,GAAT,UAAU,EAAO;YACvB,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;YACjD,OAAO,SAAS,CAAC,aAAa,EAAE,CAAC;SAClC;;;;gBAjXF7D,eAAU;;;;QCOT,mCACU,gBAAyC,EACzC,mBAAwC,EACxC,gBAAyC,EACzC,aAA4B,EAC5B,iBAA2C,EAC3C,aAA4B;YAL5B,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,wBAAmB,GAAnB,mBAAmB,CAAqB;YACxC,qBAAgB,GAAhB,gBAAgB,CAAyB;YACzC,kBAAa,GAAb,aAAa,CAAe;YAC5B,sBAAiB,GAAjB,iBAAiB,CAA0B;YAC3C,kBAAa,GAAb,aAAa,CAAe;YAb/B,WAAM,GAAG,MAAM,CAAC;YAChB,gBAAW,GAAG,IAAIwB,YAAO,EAAkB,CAAC;YAC5C,oBAAe,GAAG,IAAIA,YAAO,EAAkB,CAAC;YAarD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CACxB,IAAI,CAAC,gBAAgB,EACrB,IAAI,CAAC,mBAAmB,EACxB,IAAI,CAAC,aAAa,EAClB,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,aAAa,CACnB,CAAC;YACF,IAAI,CAAC,6BAA6B,EAAE,CAAC;SACtC;QAEO,iEAA6B,GAA7B;YAAA,iBAQP;YAPC,IAAI,CAAC,gBAAgB,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,UAAC,MAA2B;gBACrE,IAAI,MAAM,CAAC,QAAQ,KAAKoC,iBAAS,CAAC,MAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,cAAc,EAAE;oBACxF,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;iBAClC;qBAAM,IAAI,MAAM,CAAC,QAAQ,KAAKA,iBAAS,CAAC,IAAI,EAAE;oBAC7C,KAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;iBAChC;aACF,CAAC,CAAC;SACJ;QAED,8CAAU,GAAV,UAAW,OAAY,EAAE,KAAa;YACpC,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;SACzB;QAED,oDAAgB,GAAhB,UAAiB,SAA4B,EAAE,MAA2B,EAAE,MAAqB;YAC/F,MAAM,CAAC,SAAS,GAAG,SAAS,CAAC,gBAAgB,EAAE,CAAC;YAChD,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,aAAa,EAAE,CAAC;YAE1C,IAAI,MAAM,EAAE;gBACV,SAAS,CAAC,MAAM,GAAG,MAAM,CAAC;gBAC1B,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;gBAC9D,OAAO;aACR;YAED,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;gBAC5B,OAAO;aACR;YAED,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;YACrE,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;SAC/D;QAED,oDAAgB,GAAhB,UAAiB,SAA4B;YAC3C,SAAS,CAAC,MAAM,GAAG,EAAE,CAAC;YACtB,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC;SAC/D;QAED,uDAAmB,GAAnB,UAAoB,MAA2B;YAC7C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKC,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAC5C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,mBAAmB,EACxB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,gBAAgB,CACxB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,SAAS,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACtD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,SAAS,EAAE;oBAC1B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,SAAS,CAAC,mBAAmB,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBACtD,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC3C,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,cAAc,EAAE;oBAC/B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,MAAM,CAAC,eAAe,EAAE;wBAC1B,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;wBAC/C,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,EAAE;wBACb,SAAS,CAAC,OAAO,EAAE,CAAC;wBACpB,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;qBAClC;oBACD,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAC;oBACpC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,+BAA+B,EAAE;oBAChD,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,CAAC,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC;oBAChD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;oBACzC,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,kBAAkB,EAAE;oBACnC,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC9D,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,YAAY,EAAE;oBAC7B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;oBAC9D,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,qDAAiB,GAAjB,UAAkB,MAA2B;YAC3C,QAAQ,MAAM,CAAC,UAAU;gBACvB,KAAKA,mBAAW,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,iBAAiB,CAAC,uBAAuB,CAC5C,MAAM,CAAC,EAAE,EACT,IAAI,CAAC,mBAAmB,EACxB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,mBAAmB,EACxB,MAAM,CAAC,gBAAgB,EACvB,MAAM,CAAC,SAAS,CACjB,CAAC;oBACF,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,EAAE;wBACrC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC;wBACjE,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,EAAE;wBACrC,SAAS,CAAC,YAAY,EAAE,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,OAAO,EAAE;oBACxB,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,EAAE;wBACb,SAAS,CAAC,UAAU,GAAG,KAAK,CAAC;wBAC7B,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,MAAM,EAAE;oBACvB,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,EAAE;wBACb,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC;wBAC5B,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,KAAKA,mBAAW,CAAC,UAAU,EAAE;oBAC3B,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,EAAE;wBACrC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,eAAe,CAAC,CAAC;wBACpE,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBAED,KAAKA,mBAAW,CAAC,iBAAiB,EAAE;oBAClC,IAAM,SAAS,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;oBACxD,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,EAAE;wBACrC,SAAS,CAAC,YAAY,EAAE,CAAC;wBACzB,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;qBAC1C;oBACD,MAAM;iBACP;gBACD,SAAS;oBACP,OAAO;iBACR;aACF;SACF;QAED,+CAAW,GAAX;YACE,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,CAAC;SAChC;QAED,gDAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,qBAAqB,GAAG,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC;SAC/F;QAED,gDAAY,GAAZ,UAAa,KAAgB;YAC3B,OAAO,KAAK,CAAC,IAAI,KAAK,KAAK,CAAC,kBAAkB,EAAE,GAAG,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SAChG;;;;gBAtRFhC,cAAS,SAAC;oBACT,QAAQ,EAAE,mBAAmB;oBAC7B,QAAQ,WAAW,+kFA8DlB;oBACD,SAAS,EAAE,CAAC,mBAAmB,EAAE,wBAAwB,CAAC;oBAC1D,eAAe,EAAEO,4BAAuB,CAAC,MAAM;iBAChD;;;gBAvEQ,uBAAuB;gBANvB,mBAAmB;gBACnB,uBAAuB;gBAEvB,aAAa;gBAEb,wBAAwB;gBAXxB,aAAa;;;sCA0FnBe,cAAS,SAAC,qBAAqB;kCAC/BA,cAAS,SAAC,iBAAiB;;;;QCxC9B;;;;;gBAlCCR,aAAQ,SAAC;oBACR,OAAO,EAAE,CAACC,mBAAY,EAAE,mBAAmB,CAAC;oBAC5C,YAAY,EAAE;wBACZ,qBAAqB;wBACrB,yBAAyB;wBACzB,uBAAuB;wBACvB,yBAAyB;wBACzB,sBAAsB;wBACtB,uBAAuB;wBACvB,wBAAwB;wBACxB,uBAAuB;wBACvB,iBAAiB;wBACjB,kBAAkB;wBAClB,wBAAwB;wBACxB,wBAAwB;qBACzB;oBACD,OAAO,EAAE;wBACP,qBAAqB;wBACrB,yBAAyB;wBACzB,uBAAuB;wBACvB,yBAAyB;wBACzB,sBAAsB;wBACtB,uBAAuB;wBACvB,wBAAwB;wBACxB,uBAAuB;wBACvB,kBAAkB;wBAClB,wBAAwB;wBACxB,wBAAwB;qBACzB;oBACD,SAAS,EAAE;wBACT,qBAAqB;wBACrB,sBAAsB;qBACvB;iBACF;;;ICnDD;;;;ICAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}